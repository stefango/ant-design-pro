(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"+K+b":function(we,x,a){var S=a("JHRd");function v(Z){var N=new Z.constructor(Z.byteLength);return new S(N).set(new S(Z)),N}we.exports=v},"+Qka":function(we,x,a){var S=a("fmRc"),v=a("t2Dn"),Z=a("cq/+"),N=a("T1AV"),o=a("GoyQ"),X=a("mTTR"),F=a("itsj");function K(q,Ce,$,He,Be){q!==Ce&&Z(Ce,function(ce,st){if(Be||(Be=new S),o(ce))N(q,Ce,st,$,K,He,Be);else{var ut=He?He(F(q,st),ce,st+"",q,Ce,Be):void 0;ut===void 0&&(ut=ce),v(q,st,ut)}},X)}we.exports=K},"+VLl":function(we,x,a){"use strict";a.d(x,"a",function(){return ce});var S=a("lSNA"),v=a.n(S),Z=a("J4zp"),N=a.n(Z),o=a("Hel2"),X=Math.PI/3,F=[0,X,2*X,3*X,4*X,5*X];function K(st){return st[0]}function q(st){return st[1]}var Ce=function(){var st=0,ut=0,Me=1,bt=1,xt=K,Mt=q,De,ar,$t;function Ht(Ze){var Et={},Le=[],at,Wt=Ze.length;for(at=0;at<Wt;++at)if(!(isNaN(dt=+xt.call(null,St=Ze[at],at,Ze))||isNaN(H=+Mt.call(null,St,at,Ze)))){var St,dt,H,z=Math.round(H=H/$t),V=Math.round(dt=dt/ar-(z&1)/2),be=H-z;if(Math.abs(be)*3>1){var me=dt-V,le=V+(dt<V?-1:1)/2,fe=z+(H<z?-1:1),Ne=dt-le,lt=H-fe;me*me+be*be>Ne*Ne+lt*lt&&(V=le+(z&1?1:-1)/2,z=fe)}var rt=V+"-"+z,ue=Et[rt];ue?ue.push(St):(Le.push(ue=Et[rt]=[St]),ue.x=(V+(z&1)/2)*ar,ue.y=z*$t)}return Le}function vt(Ze){var Et=0,Le=0;return F.map(function(at){var Wt=Math.sin(at)*Ze,St=-Math.cos(at)*Ze,dt=Wt-Et,H=St-Le;return Et=Wt,Le=St,[dt,H]})}return Ht.hexagon=function(Ze){return"m"+vt(Ze==null?De:+Ze).join("l")+"z"},Ht.centers=function(){for(var Ze=[],Et=Math.round(ut/$t),Le=Math.round(st/ar),at=Et*$t;at<bt+De;at+=$t,++Et)for(var Wt=Le*ar+(Et&1)*ar/2;Wt<Me+ar/2;Wt+=ar)Ze.push([Wt,at]);return Ze},Ht.mesh=function(){var Ze=vt(De).slice(0,4).join("l");return Ht.centers().map(function(Et){return"M"+Et+"m"+Ze}).join("")},Ht.x=function(Ze){return arguments.length?(xt=Ze,Ht):xt},Ht.y=function(Ze){return arguments.length?(Mt=Ze,Ht):Mt},Ht.radius=function(Ze){return arguments.length?(De=+Ze,ar=De*2*Math.sin(X),$t=De*1.5,Ht):De},Ht.size=function(Ze){return arguments.length?(st=ut=0,Me=+Ze[0],bt=+Ze[1],Ht):[Me-st,bt-ut]},Ht.extent=function(Ze){return arguments.length?(st=+Ze[0][0],ut=+Ze[0][1],Me=+Ze[1][0],bt=+Ze[1][1],Ht):[[st,ut],[Me,bt]]},Ht.radius(1)};function $(st,ut){var Me=Object.keys(st);if(Object.getOwnPropertySymbols){var bt=Object.getOwnPropertySymbols(st);ut&&(bt=bt.filter(function(xt){return Object.getOwnPropertyDescriptor(st,xt).enumerable})),Me.push.apply(Me,bt)}return Me}function He(st){for(var ut=1;ut<arguments.length;ut++){var Me=arguments[ut]!=null?arguments[ut]:{};ut%2?$(Object(Me),!0).forEach(function(bt){v()(st,bt,Me[bt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(st,Object.getOwnPropertyDescriptors(Me)):$(Object(Me)).forEach(function(bt){Object.defineProperty(st,bt,Object.getOwnPropertyDescriptor(Me,bt))})}return st}var Be=6378e3;function ce(st,ut){var Me=st.dataArray,bt=ut.size,xt=bt===void 0?10:bt,Mt=ut.method,De=Mt===void 0?"sum":Mt,ar=xt/(2*Math.PI*Be)*(256<<20)/2,$t=Me.map(function(Et){var Le=Object(o.d)(Et.coordinates),at=N()(Le,2),Wt=at[0],St=at[1];return He(He({},Et),{},{coordinates:[Wt,St]})}),Ht=Ce().radius(ar).x(function(Et){return Et.coordinates[0]}).y(function(Et){return Et.coordinates[1]}),vt=Ht($t),Ze={dataArray:vt.map(function(Et,Le){var at;if(ut.field&&De){var Wt=o.c.getColumn(Et,ut.field);Et[De]=o.c.statMap[De](Wt)}return at={},v()(at,ut.method,Et[De]),v()(at,"count",Et.length),v()(at,"rawData",Et),v()(at,"coordinates",[Et.x,Et.y]),v()(at,"_id",Le),at}),radius:ar,xOffset:ar,yOffset:ar,type:"hexagon"};return Ze}},"+em5":function(we,x,a){"use strict";a.d(x,"a",function(){return H});var S=a("lSNA"),v=a.n(S),Z=a("yG8O"),N=a.n(Z),o=a("lwsE"),X=a.n(o),F=a("W8MJ"),K=a.n(F),q=a("U+yc"),Ce=a.n(q),$=a("1ABj"),He=a.n($),Be=a("gQMU"),ce=a.n(Be),st=a("J2iB"),ut=a.n(st),Me=a("u6S6"),bt=a.n(Me),xt=a("4cb6"),Mt=a.n(xt),De=a("h1nZ"),ar=a("bB6j"),$t=a("bPkA"),Ht,vt,Ze,Et,Le,at;function Wt(z,V){var be=Object.keys(z);if(Object.getOwnPropertySymbols){var me=Object.getOwnPropertySymbols(z);V&&(me=me.filter(function(le){return Object.getOwnPropertyDescriptor(z,le).enumerable})),be.push.apply(be,me)}return be}function St(z){for(var V=1;V<arguments.length;V++){var be=arguments[V]!=null?arguments[V]:{};V%2?Wt(Object(be),!0).forEach(function(me){v()(z,me,be[me])}):Object.getOwnPropertyDescriptors?Object.defineProperties(z,Object.getOwnPropertyDescriptors(be)):Wt(Object(be)).forEach(function(me){Object.defineProperty(z,me,Object.getOwnPropertyDescriptor(be,me))})}return z}var dt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,H=(Ht=Object(xt.injectable)(),vt=Object(xt.inject)(ar.a.IShaderModuleService),Ht(Ze=(Et=(at=function(){function z(){X()(this,z),N()(this,"shaderModuleService",Le,this),this.rendererService=void 0,this.config=void 0,this.quad=dt,this.enabled=!0,this.renderToScreen=!1,this.model=void 0,this.name=void 0,this.optionsToUpdate={}}return K()(z,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(be){this.name=be}},{key:"getType",value:function(){return $t.a.PostProcessing}},{key:"init",value:function(be,me){this.config=me,this.rendererService=be.getContainer().get(ar.a.IRendererService);var le=this.rendererService,fe=le.createAttribute,Ne=le.createBuffer,lt=le.createModel,rt=this.setupShaders(),ue=rt.vs,ye=rt.fs,Ue=rt.uniforms;this.model=lt({vs:ue,fs:ye,attributes:{a_Position:fe({buffer:Ne({data:[-4,-4,4,-4,0,4],type:De.gl.FLOAT}),size:2})},uniforms:St(St({u_Texture:null},Ue),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(be){var me=this,le=be.multiPassRenderer.getPostProcessor(),fe=this.rendererService,Ne=fe.useFramebuffer,lt=fe.getViewportSize,rt=fe.clear,ue=lt(),ye=ue.width,Ue=ue.height;Ne(this.renderToScreen?null:le.getWriteFBO(),function(){rt({framebuffer:le.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),me.model.draw({uniforms:St({u_Texture:le.getReadFBO(),u_ViewportSize:[ye,Ue]},me.convertOptionsToUniforms(me.optionsToUpdate))})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(be){this.enabled=be}},{key:"setRenderToScreen",value:function(be){this.renderToScreen=be}},{key:"updateOptions",value:function(be){this.optionsToUpdate=St(St({},this.optionsToUpdate),be)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(be){var me={};return Object.keys(be).forEach(function(le){ut()(be[le])||(me["u_".concat(ce()(bt()(le)))]=be[le])}),me}}]),z}(),at),Le=Ce()(Et.prototype,"shaderModuleService",[vt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Et))||Ze)},"+iFO":function(we,x,a){var S=a("dTAl"),v=a("LcsW"),Z=a("6sVZ");function N(o){return typeof o.constructor=="function"&&!Z(o)?S(v(o)):{}}we.exports=N},"/33/":function(we,x){},"/Uc5":function(we,x){},"/ezw":function(we,x,a){"use strict";var S=a("rePB"),v=a("wx14"),Z=a("U8pU"),N=a("q1tI"),o=a("TSYQ"),X=a.n(o),F=function(H){var z=H.prefixCls,V=H.className,be=H.width,me=H.style;return N.createElement("h3",{className:X()(z,V),style:Object(v.a)({width:be},me)})},K=F,q=a("KQm4"),Ce=function(H){var z=function(lt){var rt=H.width,ue=H.rows,ye=ue===void 0?2:ue;if(Array.isArray(rt))return rt[lt];if(ye-1===lt)return rt},V=H.prefixCls,be=H.className,me=H.style,le=H.rows,fe=Object(q.a)(Array(le)).map(function(Ne,lt){return N.createElement("li",{key:lt,style:{width:z(lt)}})});return N.createElement("ul",{className:X()(V,be),style:me},fe)},$=Ce,He=a("H84U"),Be=function(H){var z,V,be=H.prefixCls,me=H.className,le=H.style,fe=H.size,Ne=H.shape,lt=X()((z={},Object(S.a)(z,"".concat(be,"-lg"),fe==="large"),Object(S.a)(z,"".concat(be,"-sm"),fe==="small"),z)),rt=X()((V={},Object(S.a)(V,"".concat(be,"-circle"),Ne==="circle"),Object(S.a)(V,"".concat(be,"-square"),Ne==="square"),Object(S.a)(V,"".concat(be,"-round"),Ne==="round"),V)),ue=typeof fe=="number"?{width:fe,height:fe,lineHeight:"".concat(fe,"px")}:{};return N.createElement("span",{className:X()(be,lt,rt,me),style:Object(v.a)(Object(v.a)({},ue),le)})},ce=Be,st=a("bT9E"),ut=function(H){var z=function(be){var me=be.getPrefixCls,le=H.prefixCls,fe=H.className,Ne=H.active,lt=me("skeleton",le),rt=Object(st.a)(H,["prefixCls"]),ue=X()(lt,"".concat(lt,"-element"),Object(S.a)({},"".concat(lt,"-active"),Ne),fe);return N.createElement("div",{className:ue},N.createElement(ce,Object(v.a)({prefixCls:"".concat(lt,"-avatar")},rt)))};return N.createElement(He.a,null,z)};ut.defaultProps={size:"default",shape:"circle"};var Me=ut,bt=function(H){var z=function(be){var me=be.getPrefixCls,le=H.prefixCls,fe=H.className,Ne=H.active,lt=me("skeleton",le),rt=Object(st.a)(H,["prefixCls"]),ue=X()(lt,"".concat(lt,"-element"),Object(S.a)({},"".concat(lt,"-active"),Ne),fe);return N.createElement("div",{className:ue},N.createElement(ce,Object(v.a)({prefixCls:"".concat(lt,"-button")},rt)))};return N.createElement(He.a,null,z)};bt.defaultProps={size:"default"};var xt=bt,Mt=function(H){var z=function(be){var me=be.getPrefixCls,le=H.prefixCls,fe=H.className,Ne=H.active,lt=me("skeleton",le),rt=Object(st.a)(H,["prefixCls"]),ue=X()(lt,"".concat(lt,"-element"),Object(S.a)({},"".concat(lt,"-active"),Ne),fe);return N.createElement("div",{className:ue},N.createElement(ce,Object(v.a)({prefixCls:"".concat(lt,"-input")},rt)))};return N.createElement(He.a,null,z)};Mt.defaultProps={size:"default"};var De=Mt,ar="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",$t=function(H){var z=function(be){var me=be.getPrefixCls,le=H.prefixCls,fe=H.className,Ne=H.style,lt=me("skeleton",le),rt=X()(lt,"".concat(lt,"-element"),fe);return N.createElement("div",{className:rt},N.createElement("div",{className:X()("".concat(lt,"-image"),fe),style:Ne},N.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:"".concat(lt,"-image-svg")},N.createElement("path",{d:ar,className:"".concat(lt,"-image-path")}))))};return N.createElement(He.a,null,z)},Ht=$t;function vt(dt){return dt&&Object(Z.a)(dt)==="object"?dt:{}}function Ze(dt,H){return dt&&!H?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function Et(dt,H){return!dt&&H?{width:"38%"}:dt&&H?{width:"50%"}:{}}function Le(dt,H){var z={};return(!dt||!H)&&(z.width="61%"),!dt&&H?z.rows=3:z.rows=2,z}var at=function(H){var z=function(be){var me=be.getPrefixCls,le=be.direction,fe=H.prefixCls,Ne=H.loading,lt=H.className,rt=H.children,ue=H.avatar,ye=H.title,Ue=H.paragraph,ft=H.active,Oe=H.round,Ve=me("skeleton",fe);if(Ne||!("loading"in H)){var P,R=!!ue,J=!!ye,de=!!Ue,je;if(R){var We=Object(v.a)(Object(v.a)({prefixCls:"".concat(Ve,"-avatar")},Ze(J,de)),vt(ue));je=N.createElement("div",{className:"".concat(Ve,"-header")},N.createElement(ce,We))}var gt;if(J||de){var nt;if(J){var Nt=Object(v.a)(Object(v.a)({prefixCls:"".concat(Ve,"-title")},Et(R,de)),vt(ye));nt=N.createElement(K,Nt)}var Y;if(de){var Xe=Object(v.a)(Object(v.a)({prefixCls:"".concat(Ve,"-paragraph")},Le(R,J)),vt(Ue));Y=N.createElement($,Xe)}gt=N.createElement("div",{className:"".concat(Ve,"-content")},nt,Y)}var re=X()(Ve,(P={},Object(S.a)(P,"".concat(Ve,"-with-avatar"),R),Object(S.a)(P,"".concat(Ve,"-active"),ft),Object(S.a)(P,"".concat(Ve,"-rtl"),le==="rtl"),Object(S.a)(P,"".concat(Ve,"-round"),Oe),P),lt);return N.createElement("div",{className:re},je,gt)}return rt};return N.createElement(He.a,null,z)};at.defaultProps={avatar:!1,title:!0,paragraph:!0},at.Button=xt,at.Avatar=Me,at.Input=De,at.Image=Ht;var Wt=at,St=x.a=Wt},"0JQy":function(we,x){var a="\\ud800-\\udfff",S="\\u0300-\\u036f",v="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",N=S+v+Z,o="\\ufe0e\\ufe0f",X="["+a+"]",F="["+N+"]",K="\\ud83c[\\udffb-\\udfff]",q="(?:"+F+"|"+K+")",Ce="[^"+a+"]",$="(?:\\ud83c[\\udde6-\\uddff]){2}",He="[\\ud800-\\udbff][\\udc00-\\udfff]",Be="\\u200d",ce=q+"?",st="["+o+"]?",ut="(?:"+Be+"(?:"+[Ce,$,He].join("|")+")"+st+ce+")*",Me=st+ce+ut,bt="(?:"+[Ce+F+"?",F,$,He,X].join("|")+")",xt=RegExp(K+"(?="+K+")|"+bt+Me,"g");function Mt(De){return De.match(xt)||[]}we.exports=Mt},"0ZTe":function(we,x,a){var S=a("wy8a"),v=a("quyA"),Z=a("Em2t"),N=a("dt0z");function o(X){return function(F){F=N(F);var K=v(F)?Z(F):void 0,q=K?K[0]:F.charAt(0),Ce=K?S(K,1).join(""):F.slice(1);return q[X]()+Ce}}we.exports=o},"0eqD":function(we,x){},"0gSV":function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.tagged=void 0;var S=a("GXnB"),v=a("Ztfv");function Z(N,o){return function(X,F,K){var q=new S.Metadata(N,o);typeof K=="number"?v.tagParameter(X,F,K,q):v.tagProperty(X,F,q)}}x.tagged=Z},"0wsv":function(we,x,a){"use strict";a.d(x,"b",function(){return o}),a.d(x,"f",function(){return F}),a.d(x,"e",function(){return $}),a.d(x,"g",function(){return xt}),a.d(x,"a",function(){return Ht}),a.d(x,"c",function(){return Et}),a.d(x,"d",function(){return Le});var S=63710088e-1,v={centimeters:S*100,centimetres:S*100,degrees:S/111325,feet:S*3.28084,inches:S*39.37,kilometers:S/1e3,kilometres:S/1e3,meters:S,metres:S,miles:S/1609.344,millimeters:S*1e3,millimetres:S*1e3,nauticalmiles:S/1852,radians:1,yards:S/1.0936},Z={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/S,yards:1/1.0936},N={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function o(St,dt,H){H===void 0&&(H={});var z={type:"Feature"};return(H.id===0||H.id)&&(z.id=H.id),H.bbox&&(z.bbox=H.bbox),z.properties=dt||{},z.geometry=St,z}function X(St,dt,H){switch(H===void 0&&(H={}),St){case"Point":return F(dt).geometry;case"LineString":return $(dt).geometry;case"Polygon":return q(dt).geometry;case"MultiPoint":return st(dt).geometry;case"MultiLineString":return ce(dt).geometry;case"MultiPolygon":return ut(dt).geometry;default:throw new Error(St+" is invalid")}}function F(St,dt,H){if(H===void 0&&(H={}),!St)throw new Error("coordinates is required");if(!Array.isArray(St))throw new Error("coordinates must be an Array");if(St.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Et(St[0])||!Et(St[1]))throw new Error("coordinates must contain numbers");var z={type:"Point",coordinates:St};return o(z,dt,H)}function K(St,dt,H){return H===void 0&&(H={}),Be(St.map(function(z){return F(z,dt)}),H)}function q(St,dt,H){H===void 0&&(H={});for(var z=0,V=St;z<V.length;z++){var be=V[z];if(be.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var me=0;me<be[be.length-1].length;me++)if(be[be.length-1][me]!==be[0][me])throw new Error("First and last Position are not equivalent.")}var le={type:"Polygon",coordinates:St};return o(le,dt,H)}function Ce(St,dt,H){return H===void 0&&(H={}),Be(St.map(function(z){return q(z,dt)}),H)}function $(St,dt,H){if(H===void 0&&(H={}),St.length<2)throw new Error("coordinates must be an array of two or more positions");var z={type:"LineString",coordinates:St};return o(z,dt,H)}function He(St,dt,H){return H===void 0&&(H={}),Be(St.map(function(z){return $(z,dt)}),H)}function Be(St,dt){dt===void 0&&(dt={});var H={type:"FeatureCollection"};return dt.id&&(H.id=dt.id),dt.bbox&&(H.bbox=dt.bbox),H.features=St,H}function ce(St,dt,H){H===void 0&&(H={});var z={type:"MultiLineString",coordinates:St};return o(z,dt,H)}function st(St,dt,H){H===void 0&&(H={});var z={type:"MultiPoint",coordinates:St};return o(z,dt,H)}function ut(St,dt,H){H===void 0&&(H={});var z={type:"MultiPolygon",coordinates:St};return o(z,dt,H)}function Me(St,dt,H){H===void 0&&(H={});var z={type:"GeometryCollection",geometries:St};return o(z,dt,H)}function bt(St,dt){if(dt===void 0&&(dt=0),dt&&!(dt>=0))throw new Error("precision must be a positive number");var H=Math.pow(10,dt||0);return Math.round(St*H)/H}function xt(St,dt){dt===void 0&&(dt="kilometers");var H=v[dt];if(!H)throw new Error(dt+" units is invalid");return St*H}function Mt(St,dt){dt===void 0&&(dt="kilometers");var H=v[dt];if(!H)throw new Error(dt+" units is invalid");return St/H}function De(St,dt){return $t(Mt(St,dt))}function ar(St){var dt=St%360;return dt<0&&(dt+=360),dt}function $t(St){var dt=St%(2*Math.PI);return dt*180/Math.PI}function Ht(St){var dt=St%360;return dt*Math.PI/180}function vt(St,dt,H){if(dt===void 0&&(dt="kilometers"),H===void 0&&(H="kilometers"),!(St>=0))throw new Error("length must be a positive number");return xt(Mt(St,dt),H)}function Ze(St,dt,H){if(dt===void 0&&(dt="meters"),H===void 0&&(H="kilometers"),!(St>=0))throw new Error("area must be a positive number");var z=N[dt];if(!z)throw new Error("invalid original units");var V=N[H];if(!V)throw new Error("invalid final units");return St/z*V}function Et(St){return!isNaN(St)&&St!==null&&!Array.isArray(St)}function Le(St){return!!St&&St.constructor===Object}function at(St){if(!St)throw new Error("bbox is required");if(!Array.isArray(St))throw new Error("bbox must be an Array");if(St.length!==4&&St.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");St.forEach(function(dt){if(!Et(dt))throw new Error("bbox must only contain numbers")})}function Wt(St){if(!St)throw new Error("id is required");if(["string","number"].indexOf(typeof St)===-1)throw new Error("id must be a number or a string")}},"1+5i":function(we,x,a){var S=a("w/wX"),v=a("sEf8"),Z=a("mdPL"),N=Z&&Z.isSet,o=N?v(N):S;we.exports=o},"14J3":function(we,x,a){"use strict";var S=a("cIOH"),v=a.n(S),Z=a("1GLa")},"1ABj":function(we,x){function a(S,v){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}we.exports=a},"1XEM":function(we,x,a){we.exports={tagCloud:"antd-pro-pages-dashboard-monitor-components-charts-tag-cloud-index-tagCloud"}},"1gqn":function(we,x){we.exports=function(S){return S&&typeof S=="object"&&typeof S.copy=="function"&&typeof S.fill=="function"&&typeof S.readUInt8=="function"}},"1jvM":function(we,x){},2:function(we,x){},"2ajD":function(we,x){function a(S){return S!==S}we.exports=a},"3DfO":function(we,x){function a(S){return S==null}we.exports=a},"3L66":function(we,x,a){var S=a("MMmD"),v=a("ExA7");function Z(N){return v(N)&&S(N)}we.exports=Z},"3cYt":function(we,x){function a(S){return function(v){return S==null?void 0:S[v]}}we.exports=a},"406g":function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.BindingOnSyntax=void 0;var S=a("z4Hk"),v=function(){function Z(N){this._binding=N}return Z.prototype.onActivation=function(N){return this._binding.onActivation=N,new S.BindingWhenSyntax(this._binding)},Z}();x.BindingOnSyntax=v},"4U9+":function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.default=function(st){return(0,v.default)((0,K.default)(st)&&st.length>=1,"Must merge at least 1 JSON schema."),N.default.apply(void 0,[{}].concat(ce(st),[function(ut,Me,bt){if(!(0,X.default)(ut)){if(bt==="required")return(0,Ce.default)(ut.concat(Me));if((0,He.default)(ut)){if(!(0,He.default)(Me))throw new Error('Failed to merge schemas because "'+bt+'" has different values.');return}v.default.deepEqual(ut,Me,'Failed to merge schemas because "'+bt+'" has different values: '+JSON.stringify(ut)+" and "+JSON.stringify(Me)+".")}}]))};var S=a("9lTW"),v=Be(S),Z=a("qd8s"),N=Be(Z),o=a("3DfO"),X=Be(o),F=a("WFAs"),K=Be(F),q=a("w26f"),Ce=Be(q),$=a("zZPE"),He=Be($);function Be(st){return st&&st.__esModule?st:{default:st}}function ce(st){if(Array.isArray(st)){for(var ut=0,Me=Array(st.length);ut<st.length;ut++)Me[ut]=st[ut];return Me}else return Array.from(st)}we.exports=x.default},"4ZJM":function(we,x,a){(function(S,v){we.exports=v()})(this,function(){"use strict";var S,v,Z;function N(o,X){if(!S)S=X;else if(!v)v=X;else{var F="var sharedChunk = {}; ("+S+")(sharedChunk); ("+v+")(sharedChunk);",K={};S(K),Z=X(K),typeof window!="undefined"&&(Z.workerUrl=window.URL.createObjectURL(new Blob([F],{type:"text/javascript"})))}}return N(["exports"],function(o){"use strict";function X(e,t){return e(t={exports:{}},t.exports),t.exports}var F=K;function K(e,t,r,u){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(u-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=u,this.p2x=r,this.p2y=u}K.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},K.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},K.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},K.prototype.solveCurveX=function(e,t){var r,u,h,g,C;for(t===void 0&&(t=1e-6),h=e,C=0;C<8;C++){if(g=this.sampleCurveX(h)-e,Math.abs(g)<t)return h;var O=this.sampleCurveDerivativeX(h);if(Math.abs(O)<1e-6)break;h-=g/O}if((h=e)<(r=0))return r;if(h>(u=1))return u;for(;r<u;){if(g=this.sampleCurveX(h),Math.abs(g-e)<t)return h;e>g?r=h:u=h,h=.5*(u-r)+r}return h},K.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var q=Ce;function Ce(e,t){this.x=e,this.y=t}Ce.prototype={clone:function(){return new Ce(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,u=t.y-this.y;return r*r+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),u=Math.sin(t),h=u*this.x+r*this.y;return this.x=r*this.x-u*this.y,this.y=h,this},_rotateAround:function(t,r){var u=Math.cos(t),h=Math.sin(t),g=r.y+h*(this.x-r.x)+u*(this.y-r.y);return this.x=r.x+u*(this.x-r.x)-h*(this.y-r.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ce.convert=function(e){return e instanceof Ce?e:Array.isArray(e)?new Ce(e[0],e[1]):e};var $=typeof self!="undefined"?self:{},He=Math.pow(2,53)-1;function Be(e,t,r,u){var h=new F(e,t,r,u);return function(g){return h.solve(g)}}var ce=Be(.25,.1,.25,1);function st(e,t,r){return Math.min(r,Math.max(t,e))}function ut(e,t,r){var u=r-t,h=((e-t)%u+u)%u+t;return h===t?r:h}function Me(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,h=t;u<h.length;u+=1){var g=h[u];for(var C in g)e[C]=g[C]}return e}var bt=1;function xt(){return bt++}function Mt(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function De(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function ar(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function $t(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Ht(e,t,r){var u={};for(var h in e)u[h]=t.call(r||this,e[h],h,e);return u}function vt(e,t,r){var u={};for(var h in e)t.call(r||this,e[h],h,e)&&(u[h]=e[h]);return u}function Ze(e){return Array.isArray(e)?e.map(Ze):typeof e=="object"&&e?Ht(e,Ze):e}var Et={};function Le(e){Et[e]||(typeof console!="undefined"&&console.warn(e),Et[e]=!0)}function at(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function Wt(e){for(var t=0,r=0,u=e.length,h=u-1,g=void 0,C=void 0;r<u;h=r++)t+=((C=e[h]).x-(g=e[r]).x)*(g.y+C.y);return t}function St(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function dt(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(u,h,g,C){var O=g||C;return t[h]=!O||O.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var H=null;function z(e){if(H==null){var t=e.navigator?e.navigator.userAgent:null;H=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return H}function V(e){try{var t=$[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var be,me,le,fe,Ne=$.performance&&$.performance.now?$.performance.now.bind($.performance):Date.now.bind(Date),lt=$.requestAnimationFrame||$.mozRequestAnimationFrame||$.webkitRequestAnimationFrame||$.msRequestAnimationFrame,rt=$.cancelAnimationFrame||$.mozCancelAnimationFrame||$.webkitCancelAnimationFrame||$.msCancelAnimationFrame,ue={now:Ne,frame:function(t){var r=lt(t);return{cancel:function(){return rt(r)}}},getImageData:function(t,r){r===void 0&&(r=0);var u=$.document.createElement("canvas"),h=u.getContext("2d");if(!h)throw new Error("failed to create canvas 2d context");return u.width=t.width,u.height=t.height,h.drawImage(t,0,0,t.width,t.height),h.getImageData(-r,-r,t.width+2*r,t.height+2*r)},resolveURL:function(t){return be||(be=$.document.createElement("a")),be.href=t,be.href},hardwareConcurrency:$.navigator&&$.navigator.hardwareConcurrency||4,get devicePixelRatio(){return $.devicePixelRatio},get prefersReducedMotion(){return!!$.matchMedia&&(me==null&&(me=$.matchMedia("(prefers-reduced-motion: reduce)")),me.matches)}},ye={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ue={supported:!1,testSupport:function(t){!ft&&fe&&(Oe?Ve(t):le=t)}},ft=!1,Oe=!1;function Ve(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,fe),e.isContextLost())return;Ue.supported=!0}catch(r){}e.deleteTexture(t),ft=!0}$.document&&((fe=$.document.createElement("img")).onload=function(){le&&Ve(le),le=null,Oe=!0},fe.onerror=function(){ft=!0,le=null},fe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var P="01",R=function(t,r){this._transformRequestFn=t,this._customAccessToken=r,this._createSkuToken()};function J(e){return e.indexOf("mapbox:")===0}R.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",P,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},R.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},R.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},R.prototype.normalizeStyleURL=function(e,t){if(!J(e))return e;var r=gt(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeGlyphsURL=function(e,t){if(!J(e))return e;var r=gt(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeSourceURL=function(e,t){if(!J(e))return e;var r=gt(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeSpriteURL=function(e,t,r,u){var h=gt(e);return J(e)?(h.path="/styles/v1"+h.path+"/sprite"+t+r,this._makeAPIURL(h,this._customAccessToken||u)):(h.path+=""+t+r,nt(h))},R.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!J(e))return e;var r=gt(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(ue.devicePixelRatio>=2||t===512?"@2x":"")+(Ue.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var u=this._customAccessToken||function(h){for(var g=0,C=h;g<C.length;g+=1){var O=C[g].match(/^access_token=(.*)$/);if(O)return O[1]}return null}(r.params)||ye.ACCESS_TOKEN;return ye.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,u)},R.prototype.canonicalizeTileURL=function(e,t){var r=gt(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var u="mapbox://tiles/";u+=r.path.replace("/v4/","");var h=r.params;return t&&(h=h.filter(function(g){return!g.match(/^access_token=/)})),h.length&&(u+="?"+h.join("&")),u},R.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&J(t),u=[],h=0,g=e.tiles||[];h<g.length;h+=1){var C=g[h];je(C)?u.push(this.canonicalizeTileURL(C,r)):u.push(C)}return u},R.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",u=gt(ye.API_URL);if(e.protocol=u.protocol,e.authority=u.authority,e.protocol==="http"){var h=e.params.indexOf("secure");h>=0&&e.params.splice(h,1)}if(u.path!=="/"&&(e.path=""+u.path+e.path),!ye.REQUIRE_ACCESS_TOKEN)return nt(e);if(!(t=t||ye.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(g){return g.indexOf("access_token")===-1}),e.params.push("access_token="+t),nt(e)};var de=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function je(e){return de.test(e)}var We=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function gt(e){var t=e.match(We);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function nt(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Nt(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent($.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var Y=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Y.prototype.getStorageKey=function(e){var t,r=Nt(ye.ACCESS_TOKEN);return t=r&&r.u?$.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(u,h){return String.fromCharCode(Number("0x"+h))})):ye.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},Y.prototype.fetchEventData=function(){var e=V("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var u=$.localStorage.getItem(t);u&&(this.eventData=JSON.parse(u));var h=$.localStorage.getItem(r);h&&(this.anonId=h)}catch(g){Le("Unable to read from LocalStorage")}},Y.prototype.saveEventData=function(){var e=V("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{$.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&$.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(u){Le("Unable to write to LocalStorage")}},Y.prototype.processRequests=function(e){},Y.prototype.postEvent=function(e,t,r,u){var h=this;if(ye.EVENTS_URL){var g=gt(ye.EVENTS_URL);g.params.push("access_token="+(u||ye.ACCESS_TOKEN||""));var C={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.0",skuId:P,userId:this.anonId},O=t?Me(C,t):C,G={url:nt(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([O])};this.pendingRequest=Gn(G,function(Q){h.pendingRequest=null,r(Q),h.saveEventData(),h.processRequests(u)})}},Y.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Xe,re,Je=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,u,h,g){this.skuToken=h,(ye.EVENTS_URL&&g||ye.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(C){return J(C)||je(C)}))&&this.queueRequest({id:u,timestamp:Date.now()},g)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){var h=this.queue.shift(),g=h.id,C=h.timestamp;g&&this.success[g]||(this.anonId||this.fetchEventData(),De(this.anonId)||(this.anonId=Mt()),this.postEvent(C,{skuToken:this.skuToken},function(O){O||g&&(u.success[g]=!0)},r))}},t}(Y),Gt=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,u){ye.EVENTS_URL&&ye.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(h){return J(h)||je(h)})&&this.queueRequest(Date.now(),u)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var h=Nt(ye.ACCESS_TOKEN),g=h?h.u:ye.ACCESS_TOKEN,C=g!==this.eventData.tokenU;De(this.anonId)||(this.anonId=Mt(),C=!0);var O=this.queue.shift();if(this.eventData.lastSuccess){var G=new Date(this.eventData.lastSuccess),Q=new Date(O),ve=(O-this.eventData.lastSuccess)/864e5;C=C||ve>=1||ve<-1||G.getDate()!==Q.getDate()}else C=!0;if(!C)return this.processRequests();this.postEvent(O,{"enabled.telemetry":!1},function(Ae){Ae||(u.eventData.lastSuccess=O,u.eventData.tokenU=g)},r)}},t}(Y)),ur=Gt.postTurnstileEvent.bind(Gt),ct=new Je,ht=ct.postMapLoadEvent.bind(ct),Pt=500,pt=50;function Pe(){$.caches&&!Xe&&(Xe=$.caches.open("mapbox-tiles"))}function ot(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var $e,Vt=1/0;function dr(){return $e==null&&($e=$.OffscreenCanvas&&new $.OffscreenCanvas(1,1).getContext("2d")&&typeof $.createImageBitmap=="function"),$e}var Zr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Zr);var cr=function(e){function t(r,u,h){u===401&&je(h)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=u,this.url=h,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),Un=St()?function(){return self.worker&&self.worker.referrer}:function(){return($.location.protocol==="blob:"?$.parent:$).location.href},Sn,ni,fi=function(t,r){if(!(/^file:/.test(u=t.url)||/^file:/.test(Un())&&!/^\w+:/.test(u))){if($.fetch&&$.Request&&$.AbortController&&$.Request.prototype.hasOwnProperty("signal"))return function(h,g){var C,O=new $.AbortController,G=new $.Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:Un(),signal:O.signal}),Q=!1,ve=!1,Ae=(C=G.url).indexOf("sku=")>0&&je(C);h.type==="json"&&G.headers.set("Accept","application/json");var _e=function(Tt,Xt,Zt){if(!ve){if(Tt&&Tt.message!=="SecurityError"&&Le(Tt),Xt&&Zt)return it(Xt);var ir=Date.now();$.fetch(G).then(function(hr){if(hr.ok){var Er=Ae?hr.clone():null;return it(hr,Er,ir)}return g(new cr(hr.statusText,hr.status,h.url))}).catch(function(hr){hr.code!==20&&g(new Error(hr.message))})}},it=function(Tt,Xt,Zt){(h.type==="arrayBuffer"?Tt.arrayBuffer():h.type==="json"?Tt.json():Tt.text()).then(function(ir){ve||(Xt&&Zt&&function(hr,Er,kr){if(Pe(),Xe){var Nr={status:Er.status,statusText:Er.statusText,headers:new $.Headers};Er.headers.forEach(function(hn,Ln){return Nr.headers.set(Ln,hn)});var vn=dt(Er.headers.get("Cache-Control")||"");vn["no-store"]||(vn["max-age"]&&Nr.headers.set("Expires",new Date(kr+1e3*vn["max-age"]).toUTCString()),new Date(Nr.headers.get("Expires")).getTime()-kr<42e4||function(hn,Ln){if(re===void 0)try{new Response(new ReadableStream),re=!0}catch(qn){re=!1}re?Ln(hn.body):hn.blob().then(Ln)}(Er,function(hn){var Ln=new $.Response(hn,Nr);Pe(),Xe&&Xe.then(function(qn){return qn.put(ot(hr.url),Ln)}).catch(function(qn){return Le(qn.message)})}))}}(G,Xt,Zt),Q=!0,g(null,ir,Tt.headers.get("Cache-Control"),Tt.headers.get("Expires")))}).catch(function(ir){ve||g(new Error(ir.message))})};return Ae?function(_t,Tt){if(Pe(),!Xe)return Tt(null);var Xt=ot(_t.url);Xe.then(function(Zt){Zt.match(Xt).then(function(ir){var hr=function(Er){if(!Er)return!1;var kr=new Date(Er.headers.get("Expires")||0),Nr=dt(Er.headers.get("Cache-Control")||"");return kr>Date.now()&&!Nr["no-cache"]}(ir);Zt.delete(Xt),hr&&Zt.put(Xt,ir.clone()),Tt(null,ir,hr)}).catch(Tt)}).catch(Tt)}(G,_e):_e(null,null),{cancel:function(){ve=!0,Q||O.abort()}}}(t,r);if(St()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,r,void 0,!0)}var u;return function(h,g){var C=new $.XMLHttpRequest;for(var O in C.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(C.responseType="arraybuffer"),h.headers)C.setRequestHeader(O,h.headers[O]);return h.type==="json"&&(C.responseType="text",C.setRequestHeader("Accept","application/json")),C.withCredentials=h.credentials==="include",C.onerror=function(){g(new Error(C.statusText))},C.onload=function(){if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){var G=C.response;if(h.type==="json")try{G=JSON.parse(C.response)}catch(Q){return g(Q)}g(null,G,C.getResponseHeader("Cache-Control"),C.getResponseHeader("Expires"))}else g(new cr(C.statusText,C.status,h.url))},C.send(h.body),{cancel:function(){return C.abort()}}}(t,r)},Wn=function(t,r){return fi(Me(t,{type:"arrayBuffer"}),r)},Gn=function(t,r){return fi(Me(t,{method:"POST"}),r)},Ee="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Sn=[],ni=0;var pe=function e(t,r){if(Ue.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),ni>=ye.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:t,callback:r,cancelled:!1,cancel:function(){this.cancelled=!0}};return Sn.push(u),u}ni++;var h=!1,g=function(){if(!h)for(h=!0,ni--;Sn.length&&ni<ye.MAX_PARALLEL_IMAGE_REQUESTS;){var G=Sn.shift();G.cancelled||(G.cancel=e(G.requestParameters,G.callback).cancel)}},C=Wn(t,function(O,G,Q,ve){g(),O?r(O):G&&(dr()?function(Ae,_e){var it=new $.Blob([new Uint8Array(Ae)],{type:"image/png"});$.createImageBitmap(it).then(function(_t){_e(null,_t)}).catch(function(_t){_e(new Error("Could not load image because of "+_t.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(G,r):function(Ae,_e,it,_t){var Tt=new $.Image,Xt=$.URL;Tt.onload=function(){_e(null,Tt),Xt.revokeObjectURL(Tt.src),Tt.onload=null,Tt.src=Ee},Tt.onerror=function(){return _e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Zt=new $.Blob([new Uint8Array(Ae)],{type:"image/png"});Tt.cacheControl=it,Tt.expires=_t,Tt.src=Ae.byteLength?Xt.createObjectURL(Zt):Ee}(G,r,Q,ve))});return{cancel:function(){C.cancel(),g()}}};function W(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function ae(e,t,r){if(r&&r[e]){var u=r[e].indexOf(t);u!==-1&&r[e].splice(u,1)}}var Ie=function(t,r){r===void 0&&(r={}),Me(this,r),this.type=t},qe=function(e){function t(r,u){u===void 0&&(u={}),e.call(this,"error",Me({error:r},u))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ie),Ct=function(){};Ct.prototype.on=function(e,t){return this._listeners=this._listeners||{},W(e,t,this._listeners),this},Ct.prototype.off=function(e,t){return ae(e,t,this._listeners),ae(e,t,this._oneTimeListeners),this},Ct.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},W(e,t,this._oneTimeListeners),this},Ct.prototype.fire=function(e,t){typeof e=="string"&&(e=new Ie(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var u=0,h=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];u<h.length;u+=1)h[u].call(this,e);for(var g=0,C=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];g<C.length;g+=1){var O=C[g];ae(r,O,this._oneTimeListeners),O.call(this,e)}var G=this._eventedParent;G&&(Me(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),G.fire(e))}else e instanceof qe&&console.error(e.error);return this},Ct.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Ct.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var Re={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},mt=function(t,r,u,h){this.message=(t?t+": ":"")+u,h&&(this.identifier=h),r!=null&&r.__line__&&(this.line=r.__line__)};function Qt(e){var t=e.value;return t?[new mt(e.key,t,"constants have been deprecated as of v8")]:[]}function Br(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,h=t;u<h.length;u+=1){var g=h[u];for(var C in g)e[C]=g[C]}return e}function Ur(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function or(e){if(Array.isArray(e))return e.map(or);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=or(e[r]);return t}return Ur(e)}var Vr=function(e){function t(r,u){e.call(this,u),this.message=u,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),An=function(t,r){r===void 0&&(r=[]),this.parent=t,this.bindings={};for(var u=0,h=r;u<h.length;u+=1){var g=h[u];this.bindings[g[0]]=g[1]}};An.prototype.concat=function(e){return new An(this,e)},An.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},An.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var dn={kind:"null"},Cr={kind:"number"},Tn={kind:"string"},fn={kind:"boolean"},En={kind:"color"},Cn={kind:"object"},pn={kind:"value"},Lr={kind:"collator"},hi={kind:"formatted"},xi={kind:"resolvedImage"};function ki(e,t){return{kind:"array",itemType:e,N:t}}function _i(e){if(e.kind==="array"){var t=_i(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var eo=[dn,Cr,Tn,fn,En,hi,Cn,ki(pn),xi];function pi(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!pi(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,u=eo;r<u.length;r+=1)if(!pi(u[r],t))return null}}return"Expected "+_i(e)+" but found "+_i(t)+" instead."}function Ta(e,t){return t.some(function(r){return r.kind===e.kind})}function Di(e,t){return t.some(function(r){return r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e})}var bi=X(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(O){return(O=Math.round(O))<0?0:O>255?255:O}function h(O){return u(O[O.length-1]==="%"?parseFloat(O)/100*255:parseInt(O))}function g(O){return(G=O[O.length-1]==="%"?parseFloat(O)/100:parseFloat(O))<0?0:G>1?1:G;var G}function C(O,G,Q){return Q<0?Q+=1:Q>1&&(Q-=1),6*Q<1?O+(G-O)*Q*6:2*Q<1?G:3*Q<2?O+(G-O)*(2/3-Q)*6:O}try{t.parseCSSColor=function(O){var G,Q=O.replace(/ /g,"").toLowerCase();if(Q in r)return r[Q].slice();if(Q[0]==="#")return Q.length===4?(G=parseInt(Q.substr(1),16))>=0&&G<=4095?[(3840&G)>>4|(3840&G)>>8,240&G|(240&G)>>4,15&G|(15&G)<<4,1]:null:Q.length===7&&(G=parseInt(Q.substr(1),16))>=0&&G<=16777215?[(16711680&G)>>16,(65280&G)>>8,255&G,1]:null;var ve=Q.indexOf("("),Ae=Q.indexOf(")");if(ve!==-1&&Ae+1===Q.length){var _e=Q.substr(0,ve),it=Q.substr(ve+1,Ae-(ve+1)).split(","),_t=1;switch(_e){case"rgba":if(it.length!==4)return null;_t=g(it.pop());case"rgb":return it.length!==3?null:[h(it[0]),h(it[1]),h(it[2]),_t];case"hsla":if(it.length!==4)return null;_t=g(it.pop());case"hsl":if(it.length!==3)return null;var Tt=(parseFloat(it[0])%360+360)%360/360,Xt=g(it[1]),Zt=g(it[2]),ir=Zt<=.5?Zt*(Xt+1):Zt+Xt-Zt*Xt,hr=2*Zt-ir;return[u(255*C(hr,ir,Tt+1/3)),u(255*C(hr,ir,Tt)),u(255*C(hr,ir,Tt-1/3)),_t];default:return null}}return null}}catch(O){}}).parseCSSColor,ci=function(t,r,u,h){h===void 0&&(h=1),this.r=t,this.g=r,this.b=u,this.a=h};ci.parse=function(e){if(e){if(e instanceof ci)return e;if(typeof e=="string"){var t=bi(e);if(t)return new ci(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},ci.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],u=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+u+")"},ci.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},ci.black=new ci(0,0,0,1),ci.white=new ci(1,1,1,1),ci.transparent=new ci(0,0,0,0),ci.red=new ci(1,0,0,1);var ja=function(t,r,u){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};ja.prototype.compare=function(e,t){return this.collator.compare(e,t)},ja.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ps=function(t,r,u,h,g){this.text=t,this.image=r,this.scale=u,this.fontStack=h,this.textColor=g},to=function(t){this.sections=t};to.fromString=function(e){return new to([new ps(e,null,null,null,null)])},to.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},to.factory=function(e){return e instanceof to?e:to.fromString(e)},to.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},to.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];if(u.image)e.push(["image",u.image.name]);else{e.push(u.text);var h={};u.fontStack&&(h["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(h["font-scale"]=u.scale),u.textColor&&(h["text-color"]=["rgba"].concat(u.textColor.toArray())),e.push(h)}}return e};var lo=function(t){this.name=t.name,this.available=t.available};function Gu(e,t,r,u){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:"Invalid rgba value ["+[e,t,r,u].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof u=="number"?[e,t,r,u]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function qi(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof ci||e instanceof ja||e instanceof to||e instanceof lo)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!qi(r[t]))return!1;return!0}if(typeof e=="object"){for(var u in e)if(!qi(e[u]))return!1;return!0}return!1}function Oa(e){if(e===null)return dn;if(typeof e=="string")return Tn;if(typeof e=="boolean")return fn;if(typeof e=="number")return Cr;if(e instanceof ci)return En;if(e instanceof ja)return Lr;if(e instanceof to)return hi;if(e instanceof lo)return xi;if(Array.isArray(e)){for(var t,r=e.length,u=0,h=e;u<h.length;u+=1){var g=Oa(h[u]);if(t){if(t===g)continue;t=pn;break}t=g}return ki(t||pn,r)}return Cn}function is(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof ci||e instanceof to||e instanceof lo?e.toString():JSON.stringify(e)}lo.prototype.toString=function(){return this.name},lo.fromString=function(e){return e?new lo({name:e,available:!1}):null},lo.prototype.serialize=function(){return["image",this.name]};var ca=function(t,r){this.type=t,this.value=r};ca.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!qi(e[1]))return t.error("invalid value");var r=e[1],u=Oa(r),h=t.expectedType;return u.kind!=="array"||u.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(u=h),new ca(u,r)},ca.prototype.evaluate=function(){return this.value},ca.prototype.eachChild=function(){},ca.prototype.outputDefined=function(){return!0},ca.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ci?["rgba"].concat(this.value.toArray()):this.value instanceof to?this.value.serialize():this.value};var Ya=function(t){this.name="ExpressionEvaluationError",this.message=t};Ya.prototype.toJSON=function(){return this.message};var qo={string:Tn,number:Cr,boolean:fn,object:Cn},sa=function(t,r){this.type=t,this.args=r};sa.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,u=1,h=e[0];if(h==="array"){var g,C;if(e.length>2){var O=e[1];if(typeof O!="string"||!(O in qo)||O==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);g=qo[O],u++}else g=pn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);C=e[2],u++}r=ki(g,C)}else r=qo[h];for(var G=[];u<e.length;u++){var Q=t.parse(e[u],u,pn);if(!Q)return null;G.push(Q)}return new sa(r,G)},sa.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!pi(this.type,Oa(r)))return r;if(t===this.args.length-1)throw new Ya("Expected value to be of type "+_i(this.type)+", but found "+_i(Oa(r))+" instead.")}return null},sa.prototype.eachChild=function(e){this.args.forEach(e)},sa.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},sa.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var u=e.N;(typeof u=="number"||this.args.length>1)&&t.push(u)}}return t.concat(this.args.map(function(h){return h.serialize()}))};var yo=function(t){this.type=hi,this.sections=t};yo.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var u=[],h=!1,g=1;g<=e.length-1;++g){var C=e[g];if(h&&typeof C=="object"&&!Array.isArray(C)){h=!1;var O=null;if(C["font-scale"]&&!(O=t.parse(C["font-scale"],1,Cr)))return null;var G=null;if(C["text-font"]&&!(G=t.parse(C["text-font"],1,ki(Tn))))return null;var Q=null;if(C["text-color"]&&!(Q=t.parse(C["text-color"],1,En)))return null;var ve=u[u.length-1];ve.scale=O,ve.font=G,ve.textColor=Q}else{var Ae=t.parse(e[g],1,pn);if(!Ae)return null;var _e=Ae.type.kind;if(_e!=="string"&&_e!=="value"&&_e!=="null"&&_e!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,u.push({content:Ae,scale:null,font:null,textColor:null})}}return new yo(u)},yo.prototype.evaluate=function(e){return new to(this.sections.map(function(t){var r=t.content.evaluate(e);return Oa(r)===xi?new ps("",r,null,null,null):new ps(is(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},yo.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e(u.content),u.scale&&e(u.scale),u.font&&e(u.font),u.textColor&&e(u.textColor)}},yo.prototype.outputDefined=function(){return!1},yo.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e.push(u.content.serialize());var h={};u.scale&&(h["font-scale"]=u.scale.serialize()),u.font&&(h["text-font"]=u.font.serialize()),u.textColor&&(h["text-color"]=u.textColor.serialize()),e.push(h)}return e};var co=function(t){this.type=xi,this.input=t};co.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Tn);return r?new co(r):t.error("No image name provided.")},co.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=lo.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},co.prototype.eachChild=function(e){e(this.input)},co.prototype.outputDefined=function(){return!1},co.prototype.serialize=function(){return["image",this.input.serialize()]};var Tu={"to-boolean":fn,"to-color":En,"to-number":Cr,"to-string":Tn},as=function(t,r){this.type=t,this.args=r};as.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var u=Tu[r],h=[],g=1;g<e.length;g++){var C=t.parse(e[g],g,pn);if(!C)return null;h.push(C)}return new as(u,h)},as.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,r,u=0,h=this.args;u<h.length;u+=1){if(r=null,(t=h[u].evaluate(e))instanceof ci)return t;if(typeof t=="string"){var g=e.parseColor(t);if(g)return g}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Gu(t[0],t[1],t[2],t[3])))return new ci(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Ya(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var C=null,O=0,G=this.args;O<G.length;O+=1){if((C=G[O].evaluate(e))===null)return 0;var Q=Number(C);if(!isNaN(Q))return Q}throw new Ya("Could not convert "+JSON.stringify(C)+" to number.")}return this.type.kind==="formatted"?to.fromString(is(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?lo.fromString(is(this.args[0].evaluate(e))):is(this.args[0].evaluate(e))},as.prototype.eachChild=function(e){this.args.forEach(e)},as.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},as.prototype.serialize=function(){if(this.type.kind==="formatted")return new yo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new co(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var bl=["Unknown","Point","LineString","Polygon"],_s=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};_s.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},_s.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?bl[this.feature.type]:this.feature.type:null},_s.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},_s.prototype.canonicalID=function(){return this.canonical},_s.prototype.properties=function(){return this.feature&&this.feature.properties||{}},_s.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=ci.parse(e)),t};var Lo=function(t,r,u,h){this.name=t,this.type=r,this._evaluate=u,this.args=h};Lo.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Lo.prototype.eachChild=function(e){this.args.forEach(e)},Lo.prototype.outputDefined=function(){return!1},Lo.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Lo.parse=function(e,t){var r,u=e[0],h=Lo.definitions[u];if(!h)return t.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0);for(var g=Array.isArray(h)?h[0]:h.type,C=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,O=C.filter(function(Kn){var Fn=Kn[0];return!Array.isArray(Fn)||Fn.length===e.length-1}),G=null,Q=0,ve=O;Q<ve.length;Q+=1){var Ae=ve[Q],_e=Ae[0],it=Ae[1];G=new Js(t.registry,t.path,null,t.scope);for(var _t=[],Tt=!1,Xt=1;Xt<e.length;Xt++){var Zt=e[Xt],ir=Array.isArray(_e)?_e[Xt-1]:_e.type,hr=G.parse(Zt,1+_t.length,ir);if(!hr){Tt=!0;break}_t.push(hr)}if(!Tt)if(Array.isArray(_e)&&_e.length!==_t.length)G.error("Expected "+_e.length+" arguments, but found "+_t.length+" instead.");else{for(var Er=0;Er<_t.length;Er++){var kr=Array.isArray(_e)?_e[Er]:_e.type,Nr=_t[Er];G.concat(Er+1).checkSubtype(kr,Nr.type)}if(G.errors.length===0)return new Lo(u,g,it,_t)}}if(O.length===1)(r=t.errors).push.apply(r,G.errors);else{for(var vn=(O.length?O:C).map(function(Kn){var Fn;return Fn=Kn[0],Array.isArray(Fn)?"("+Fn.map(_i).join(", ")+")":"("+_i(Fn.type)+"...)"}).join(" | "),hn=[],Ln=1;Ln<e.length;Ln++){var qn=t.parse(e[Ln],1+hn.length);if(!qn)return null;hn.push(_i(qn.type))}t.error("Expected arguments of type "+vn+", but found ("+hn.join(", ")+") instead.")}return null},Lo.register=function(e,t){for(var r in Lo.definitions=t,t)e[r]=Lo};var kt=function(t,r,u){this.type=Lr,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=r};function ze(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function It(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function fr(e,t){var r=(180+e[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(r*h*8192),Math.round(u*h*8192)]}function nn(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function yn(e,t){for(var r,u,h,g,C,O,G,Q=!1,ve=0,Ae=t.length;ve<Ae;ve++)for(var _e=t[ve],it=0,_t=_e.length;it<_t-1;it++){if((g=(r=e)[0]-(u=_e[it])[0])*(G=r[1]-(h=_e[it+1])[1])-(O=r[0]-h[0])*(C=r[1]-u[1])==0&&g*O<=0&&C*G<=0)return!1;nn(e,_e[it],_e[it+1])&&(Q=!Q)}return Q}function Vn(e,t){for(var r=0;r<t.length;r++)if(yn(e,t[r]))return!0;return!1}function Ua(e,t,r,u){var h=u[0]-r[0],g=u[1]-r[1],C=(e[0]-r[0])*g-h*(e[1]-r[1]),O=(t[0]-r[0])*g-h*(t[1]-r[1]);return C>0&&O<0||C<0&&O>0}function xo(e,t,r){for(var u=0,h=r;u<h.length;u+=1)for(var g=h[u],C=0;C<g.length-1;++C)if((Ae=[(ve=g[C+1])[0]-(Q=g[C])[0],ve[1]-Q[1]])[0]*(_e=[(G=t)[0]-(O=e)[0],G[1]-O[1]])[1]-Ae[1]*_e[0]!=0&&Ua(O,G,Q,ve)&&Ua(Q,ve,O,G))return!0;var O,G,Q,ve,Ae,_e;return!1}function _o(e,t){for(var r=0;r<e.length;++r)if(!yn(e[r],t))return!1;for(var u=0;u<e.length-1;++u)if(xo(e[u],e[u+1],t))return!1;return!0}function Ro(e,t){for(var r=0;r<t.length;r++)if(_o(e,t[r]))return!0;return!1}function Hu(e,t,r){for(var u=[],h=0;h<e.length;h++){for(var g=[],C=0;C<e[h].length;C++){var O=fr(e[h][C],r);ze(t,O),g.push(O)}u.push(g)}return u}function zl(e,t,r){for(var u=[],h=0;h<e.length;h++){var g=Hu(e[h],t,r);u.push(g)}return u}function Ks(e,t,r,u){if(e[0]<r[0]||e[0]>r[2]){var h=.5*u,g=e[0]-r[0]>h?-u:r[0]-e[0]>h?u:0;g===0&&(g=e[0]-r[2]>h?-u:r[2]-e[0]>h?u:0),e[0]+=g}ze(t,e)}function nf(e,t,r,u){for(var h=8192*Math.pow(2,u.z),g=[8192*u.x,8192*u.y],C=[],O=0,G=e;O<G.length;O+=1)for(var Q=0,ve=G[O];Q<ve.length;Q+=1){var Ae=ve[Q],_e=[Ae.x+g[0],Ae.y+g[1]];Ks(_e,t,r,h),C.push(_e)}return C}function Nl(e,t,r,u){for(var h,g=8192*Math.pow(2,u.z),C=[8192*u.x,8192*u.y],O=[],G=0,Q=e;G<Q.length;G+=1){for(var ve=[],Ae=0,_e=Q[G];Ae<_e.length;Ae+=1){var it=_e[Ae],_t=[it.x+C[0],it.y+C[1]];ze(t,_t),ve.push(_t)}O.push(ve)}if(t[2]-t[0]<=g/2){(h=t)[0]=h[1]=1/0,h[2]=h[3]=-1/0;for(var Tt=0,Xt=O;Tt<Xt.length;Tt+=1)for(var Zt=0,ir=Xt[Tt];Zt<ir.length;Zt+=1)Ks(ir[Zt],t,r,g)}return O}kt.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var u=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,fn);if(!u)return null;var h=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,fn);if(!h)return null;var g=null;return r.locale&&!(g=t.parse(r.locale,1,Tn))?null:new kt(u,h,g)},kt.prototype.evaluate=function(e){return new ja(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},kt.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},kt.prototype.outputDefined=function(){return!1},kt.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var vs=function(t,r){this.type=fn,this.geojson=t,this.geometries=r};function fu(e){if(e instanceof Lo&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof vs)return!1;var t=!0;return e.eachChild(function(r){t&&!fu(r)&&(t=!1)}),t}function bo(e){if(e instanceof Lo&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!bo(r)&&(t=!1)}),t}function $s(e,t){if(e instanceof Lo&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(u){r&&!$s(u,t)&&(r=!1)}),r}vs.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(qi(e[1])){var r=e[1];if(r.type==="FeatureCollection")for(var u=0;u<r.features.length;++u){var h=r.features[u].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new vs(r,r.features[u].geometry)}else if(r.type==="Feature"){var g=r.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new vs(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new vs(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},vs.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],g=t.canonicalID();if(r.type==="Polygon"){var C=Hu(r.coordinates,h,g),O=nf(t.geometry(),u,h,g);if(!It(u,h))return!1;for(var G=0,Q=O;G<Q.length;G+=1)if(!yn(Q[G],C))return!1}if(r.type==="MultiPolygon"){var ve=zl(r.coordinates,h,g),Ae=nf(t.geometry(),u,h,g);if(!It(u,h))return!1;for(var _e=0,it=Ae;_e<it.length;_e+=1)if(!Vn(it[_e],ve))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],g=t.canonicalID();if(r.type==="Polygon"){var C=Hu(r.coordinates,h,g),O=Nl(t.geometry(),u,h,g);if(!It(u,h))return!1;for(var G=0,Q=O;G<Q.length;G+=1)if(!_o(Q[G],C))return!1}if(r.type==="MultiPolygon"){var ve=zl(r.coordinates,h,g),Ae=Nl(t.geometry(),u,h,g);if(!It(u,h))return!1;for(var _e=0,it=Ae;_e<it.length;_e+=1)if(!Ro(it[_e],ve))return!1}return!0}(e,this.geometries)}return!1},vs.prototype.eachChild=function(){},vs.prototype.outputDefined=function(){return!0},vs.prototype.serialize=function(){return["within",this.geojson]};var Zu=function(t,r){this.type=r.type,this.name=t,this.boundExpression=r};Zu.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new Zu(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Zu.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Zu.prototype.eachChild=function(){},Zu.prototype.outputDefined=function(){return!1},Zu.prototype.serialize=function(){return["var",this.name]};var Js=function(t,r,u,h,g){r===void 0&&(r=[]),h===void 0&&(h=new An),g===void 0&&(g=[]),this.registry=t,this.path=r,this.key=r.map(function(C){return"["+C+"]"}).join(""),this.scope=h,this.errors=g,this.expectedType=u};function Wu(e,t){for(var r,u=e.length-1,h=0,g=u,C=0;h<=g;)if((r=e[C=Math.floor((h+g)/2)])<=t){if(C===u||t<e[C+1])return C;h=C+1}else{if(!(r>t))throw new Ya("Input is not a number.");g=C-1}return 0}Js.prototype.parse=function(e,t,r,u,h){return h===void 0&&(h={}),t?this.concat(t,r,u)._parse(e,h):this._parse(e,h)},Js.prototype._parse=function(e,t){function r(Q,ve,Ae){return Ae==="assert"?new sa(ve,[Q]):Ae==="coerce"?new as(ve,[Q]):Q}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var u=e[0];if(typeof u!="string")return this.error("Expression name must be a string, but found "+typeof u+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var h=this.registry[u];if(h){var g=h.parse(e,this);if(!g)return null;if(this.expectedType){var C=this.expectedType,O=g.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||O.kind!=="value")if(C.kind!=="color"&&C.kind!=="formatted"&&C.kind!=="resolvedImage"||O.kind!=="value"&&O.kind!=="string"){if(this.checkSubtype(C,O))return null}else g=r(g,C,t.typeAnnotation||"coerce");else g=r(g,C,t.typeAnnotation||"assert")}if(!(g instanceof ca)&&g.type.kind!=="resolvedImage"&&function Q(ve){if(ve instanceof Zu)return Q(ve.boundExpression);if(ve instanceof Lo&&ve.name==="error"||ve instanceof kt||ve instanceof vs)return!1;var Ae=ve instanceof as||ve instanceof sa,_e=!0;return ve.eachChild(function(it){_e=Ae?_e&&Q(it):_e&&it instanceof ca}),!!_e&&fu(ve)&&$s(ve,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(g)){var G=new _s;try{g=new ca(g.type,g.evaluate(G))}catch(Q){return this.error(Q.message),null}}return g}return this.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Js.prototype.concat=function(e,t,r){var u=typeof e=="number"?this.path.concat(e):this.path,h=r?this.scope.concat(r):this.scope;return new Js(this.registry,u,t||null,h,this.errors)},Js.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var u=""+this.key+t.map(function(h){return"["+h+"]"}).join("");this.errors.push(new Vr(u,e))},Js.prototype.checkSubtype=function(e,t){var r=pi(e,t);return r&&this.error(r),r};var wa=function(t,r,u){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(var h=0,g=u;h<g.length;h+=1){var C=g[h],O=C[1];this.labels.push(C[0]),this.outputs.push(O)}};function Ka(e,t,r){return e*(1-r)+t*r}wa.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,Cr);if(!r)return null;var u=[],h=null;t.expectedType&&t.expectedType.kind!=="value"&&(h=t.expectedType);for(var g=1;g<e.length;g+=2){var C=g===1?-1/0:e[g],O=e[g+1],G=g,Q=g+1;if(typeof C!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(u.length&&u[u.length-1][0]>=C)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',G);var ve=t.parse(O,Q,h);if(!ve)return null;h=h||ve.type,u.push([C,ve])}return new wa(h,r,u)},wa.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var h=t.length;return u>=t[h-1]?r[h-1].evaluate(e):r[Wu(t,u)].evaluate(e)},wa.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},wa.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},wa.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var hu=Object.freeze({__proto__:null,number:Ka,color:function(t,r,u){return new ci(Ka(t.r,r.r,u),Ka(t.g,r.g,u),Ka(t.b,r.b,u),Ka(t.a,r.a,u))},array:function(t,r,u){return t.map(function(h,g){return Ka(h,r[g],u)})}}),Xu=6/29*3*(6/29),nc=Math.PI/180,Ot=180/Math.PI;function tr(e){return e>.008856451679035631?Math.pow(e,1/3):e/Xu+4/29}function Mr(e){return e>6/29?e*e*e:Xu*(e-4/29)}function Xn(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Wi(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function oa(e){var t=Wi(e.r),r=Wi(e.g),u=Wi(e.b),h=tr((.4124564*t+.3575761*r+.1804375*u)/.95047),g=tr((.2126729*t+.7151522*r+.072175*u)/1);return{l:116*g-16,a:500*(h-g),b:200*(g-tr((.0193339*t+.119192*r+.9503041*u)/1.08883)),alpha:e.a}}function Xa(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,u=isNaN(e.b)?t:t-e.b/200;return t=1*Mr(t),r=.95047*Mr(r),u=1.08883*Mr(u),new ci(Xn(3.2404542*r-1.5371385*t-.4985314*u),Xn(-.969266*r+1.8760108*t+.041556*u),Xn(.0556434*r-.2040259*t+1.0572252*u),e.alpha)}function zi(e,t,r){var u=t-e;return e+r*(u>180||u<-180?u-360*Math.round(u/360):u)}var La={forward:oa,reverse:Xa,interpolate:function(t,r,u){return{l:Ka(t.l,r.l,u),a:Ka(t.a,r.a,u),b:Ka(t.b,r.b,u),alpha:Ka(t.alpha,r.alpha,u)}}},Do={forward:function(t){var r=oa(t),u=r.l,h=r.a,g=r.b,C=Math.atan2(g,h)*Ot;return{h:C<0?C+360:C,c:Math.sqrt(h*h+g*g),l:u,alpha:t.a}},reverse:function(t){var r=t.h*nc,u=t.c;return Xa({l:t.l,a:Math.cos(r)*u,b:Math.sin(r)*u,alpha:t.alpha})},interpolate:function(t,r,u){return{h:zi(t.h,r.h,u),c:Ka(t.c,r.c,u),l:Ka(t.l,r.l,u),alpha:Ka(t.alpha,r.alpha,u)}}},ms=Object.freeze({__proto__:null,lab:La,hcl:Do}),Aa=function(t,r,u,h,g){this.type=t,this.operator=r,this.interpolation=u,this.input=h,this.labels=[],this.outputs=[];for(var C=0,O=g;C<O.length;C+=1){var G=O[C],Q=G[1];this.labels.push(G[0]),this.outputs.push(Q)}};function Sl(e,t,r,u){var h=u-r,g=e-r;return h===0?0:t===1?g/h:(Math.pow(t,g)-1)/(Math.pow(t,h)-1)}Aa.interpolationFactor=function(e,t,r,u){var h=0;if(e.name==="exponential")h=Sl(t,e.base,r,u);else if(e.name==="linear")h=Sl(t,1,r,u);else if(e.name==="cubic-bezier"){var g=e.controlPoints;h=new F(g[0],g[1],g[2],g[3]).solve(Sl(t,1,r,u))}return h},Aa.parse=function(e,t){var r=e[0],u=e[1],h=e[2],g=e.slice(3);if(!Array.isArray(u)||u.length===0)return t.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){var C=u[1];if(typeof C!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:C}}else{if(u[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(u[0]),1,0);var O=u.slice(1);if(O.length!==4||O.some(function(Xt){return typeof Xt!="number"||Xt<0||Xt>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:O}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(h=t.parse(h,2,Cr)))return null;var G=[],Q=null;r==="interpolate-hcl"||r==="interpolate-lab"?Q=En:t.expectedType&&t.expectedType.kind!=="value"&&(Q=t.expectedType);for(var ve=0;ve<g.length;ve+=2){var Ae=g[ve],_e=g[ve+1],it=ve+3,_t=ve+4;if(typeof Ae!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',it);if(G.length&&G[G.length-1][0]>=Ae)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',it);var Tt=t.parse(_e,_t,Q);if(!Tt)return null;Q=Q||Tt.type,G.push([Ae,Tt])}return Q.kind==="number"||Q.kind==="color"||Q.kind==="array"&&Q.itemType.kind==="number"&&typeof Q.N=="number"?new Aa(Q,r,u,h,G):t.error("Type "+_i(Q)+" is not interpolatable.")},Aa.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var h=t.length;if(u>=t[h-1])return r[h-1].evaluate(e);var g=Wu(t,u),C=Aa.interpolationFactor(this.interpolation,u,t[g],t[g+1]),O=r[g].evaluate(e),G=r[g+1].evaluate(e);return this.operator==="interpolate"?hu[this.type.kind.toLowerCase()](O,G,C):this.operator==="interpolate-hcl"?Do.reverse(Do.interpolate(Do.forward(O),Do.forward(G),C)):La.reverse(La.interpolate(La.forward(O),La.forward(G),C))},Aa.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Aa.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Aa.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var du=function(t,r){this.type=t,this.args=r};du.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,u=t.expectedType;u&&u.kind!=="value"&&(r=u);for(var h=[],g=0,C=e.slice(1);g<C.length;g+=1){var O=t.parse(C[g],1+h.length,r,void 0,{typeAnnotation:"omit"});if(!O)return null;r=r||O.type,h.push(O)}var G=u&&h.some(function(Q){return pi(u,Q.type)});return new du(G?pn:r,h)},du.prototype.evaluate=function(e){for(var t,r=null,u=0,h=0,g=this.args;h<g.length&&(u++,(r=g[h].evaluate(e))&&r instanceof lo&&!r.available&&(t||(t=r.name),r=null,u===this.args.length&&(r=t)),r===null);h+=1);return r},du.prototype.eachChild=function(e){this.args.forEach(e)},du.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},du.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var os=function(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r};os.prototype.evaluate=function(e){return this.result.evaluate(e)},os.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},os.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],u=1;u<e.length-1;u+=2){var h=e[u];if(typeof h!="string")return t.error("Expected string, but found "+typeof h+" instead.",u);if(/[^a-zA-Z0-9_]/.test(h))return t.error("Variable names must contain only alphanumeric characters or '_'.",u);var g=t.parse(e[u+1],u+1);if(!g)return null;r.push([h,g])}var C=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return C?new os(r,C):null},os.prototype.outputDefined=function(){return this.result.outputDefined()},os.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var u=r[t];e.push(u[0],u[1].serialize())}return e.push(this.result.serialize()),e};var Yu=function(t,r,u){this.type=t,this.index=r,this.input=u};Yu.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,Cr),u=t.parse(e[2],2,ki(t.expectedType||pn));return r&&u?new Yu(u.type.itemType,r,u):null},Yu.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Ya("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new Ya("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new Ya("Array index must be an integer, but found "+t+" instead.");return r[t]},Yu.prototype.eachChild=function(e){e(this.index),e(this.input)},Yu.prototype.outputDefined=function(){return!1},Yu.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Au=function(t,r){this.type=fn,this.needle=t,this.haystack=r};Au.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,pn),u=t.parse(e[2],2,pn);return r&&u?Ta(r.type,[fn,Tn,Cr,dn,pn])?new Au(r,u):t.error("Expected first argument to be of type boolean, string, number or null, but found "+_i(r.type)+" instead"):null},Au.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Di(t,["boolean","string","number","null"]))throw new Ya("Expected first argument to be of type boolean, string, number or null, but found "+_i(Oa(t))+" instead.");if(!Di(r,["string","array"]))throw new Ya("Expected second argument to be of type array or string, but found "+_i(Oa(r))+" instead.");return r.indexOf(t)>=0},Au.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},Au.prototype.outputDefined=function(){return!0},Au.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Ku=function(t,r,u){this.type=Cr,this.needle=t,this.haystack=r,this.fromIndex=u};Ku.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,pn),u=t.parse(e[2],2,pn);if(!r||!u)return null;if(!Ta(r.type,[fn,Tn,Cr,dn,pn]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+_i(r.type)+" instead");if(e.length===4){var h=t.parse(e[3],3,Cr);return h?new Ku(r,u,h):null}return new Ku(r,u)},Ku.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Di(t,["boolean","string","number","null"]))throw new Ya("Expected first argument to be of type boolean, string, number or null, but found "+_i(Oa(t))+" instead.");if(!Di(r,["string","array"]))throw new Ya("Expected second argument to be of type array or string, but found "+_i(Oa(r))+" instead.");if(this.fromIndex){var u=this.fromIndex.evaluate(e);return r.indexOf(t,u)}return r.indexOf(t)},Ku.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Ku.prototype.outputDefined=function(){return!1},Ku.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Cu=function(t,r,u,h,g,C){this.inputType=t,this.type=r,this.input=u,this.cases=h,this.outputs=g,this.otherwise=C};Cu.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,u;t.expectedType&&t.expectedType.kind!=="value"&&(u=t.expectedType);for(var h={},g=[],C=2;C<e.length-1;C+=2){var O=e[C],G=e[C+1];Array.isArray(O)||(O=[O]);var Q=t.concat(C);if(O.length===0)return Q.error("Expected at least one branch label.");for(var ve=0,Ae=O;ve<Ae.length;ve+=1){var _e=Ae[ve];if(typeof _e!="number"&&typeof _e!="string")return Q.error("Branch labels must be numbers or strings.");if(typeof _e=="number"&&Math.abs(_e)>Number.MAX_SAFE_INTEGER)return Q.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof _e=="number"&&Math.floor(_e)!==_e)return Q.error("Numeric branch labels must be integer values.");if(r){if(Q.checkSubtype(r,Oa(_e)))return null}else r=Oa(_e);if(h[String(_e)]!==void 0)return Q.error("Branch labels must be unique.");h[String(_e)]=g.length}var it=t.parse(G,C,u);if(!it)return null;u=u||it.type,g.push(it)}var _t=t.parse(e[1],1,pn);if(!_t)return null;var Tt=t.parse(e[e.length-1],e.length-1,u);return Tt?_t.type.kind!=="value"&&t.concat(1).checkSubtype(r,_t.type)?null:new Cu(r,u,_t,h,g,Tt):null},Cu.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Oa(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},Cu.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},Cu.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},Cu.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],u={},h=0,g=Object.keys(this.cases).sort();h<g.length;h+=1){var C=g[h];(Ae=u[this.cases[C]])===void 0?(u[this.cases[C]]=r.length,r.push([this.cases[C],[C]])):r[Ae][1].push(C)}for(var O=function(_t){return e.inputType.kind==="number"?Number(_t):_t},G=0,Q=r;G<Q.length;G+=1){var ve=Q[G],Ae=ve[0],_e=ve[1];t.push(_e.length===1?O(_e[0]):_e.map(O)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var ol=function(t,r,u){this.type=t,this.branches=r,this.otherwise=u};ol.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var u=[],h=1;h<e.length-1;h+=2){var g=t.parse(e[h],h,fn);if(!g)return null;var C=t.parse(e[h+1],h+1,r);if(!C)return null;u.push([g,C]),r=r||C.type}var O=t.parse(e[e.length-1],e.length-1,r);return O?new ol(r,u,O):null},ol.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],h=u[1];if(u[0].evaluate(e))return h.evaluate(e)}return this.otherwise.evaluate(e)},ol.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],h=u[1];e(u[0]),e(h)}e(this.otherwise)},ol.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},ol.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var pu=function(t,r,u,h){this.type=t,this.input=r,this.beginIndex=u,this.endIndex=h};function af(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Nf(e,t,r,u){return u.compare(t,r)===0}function ba(e,t,r){var u=e!=="=="&&e!=="!=";return function(){function h(g,C,O){this.type=fn,this.lhs=g,this.rhs=C,this.collator=O,this.hasUntypedArgument=g.type.kind==="value"||C.type.kind==="value"}return h.parse=function(g,C){if(g.length!==3&&g.length!==4)return C.error("Expected two or three arguments.");var O=g[0],G=C.parse(g[1],1,pn);if(!G)return null;if(!af(O,G.type))return C.concat(1).error('"'+O+`" comparisons are not supported for type '`+_i(G.type)+"'.");var Q=C.parse(g[2],2,pn);if(!Q)return null;if(!af(O,Q.type))return C.concat(2).error('"'+O+`" comparisons are not supported for type '`+_i(Q.type)+"'.");if(G.type.kind!==Q.type.kind&&G.type.kind!=="value"&&Q.type.kind!=="value")return C.error("Cannot compare types '"+_i(G.type)+"' and '"+_i(Q.type)+"'.");u&&(G.type.kind==="value"&&Q.type.kind!=="value"?G=new sa(Q.type,[G]):G.type.kind!=="value"&&Q.type.kind==="value"&&(Q=new sa(G.type,[Q])));var ve=null;if(g.length===4){if(G.type.kind!=="string"&&Q.type.kind!=="string"&&G.type.kind!=="value"&&Q.type.kind!=="value")return C.error("Cannot use collator to compare non-string types.");if(!(ve=C.parse(g[3],3,Lr)))return null}return new h(G,Q,ve)},h.prototype.evaluate=function(g){var C=this.lhs.evaluate(g),O=this.rhs.evaluate(g);if(u&&this.hasUntypedArgument){var G=Oa(C),Q=Oa(O);if(G.kind!==Q.kind||G.kind!=="string"&&G.kind!=="number")throw new Ya('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+G.kind+", "+Q.kind+") instead.")}if(this.collator&&!u&&this.hasUntypedArgument){var ve=Oa(C),Ae=Oa(O);if(ve.kind!=="string"||Ae.kind!=="string")return t(g,C,O)}return this.collator?r(g,C,O,this.collator.evaluate(g)):t(g,C,O)},h.prototype.eachChild=function(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)},h.prototype.outputDefined=function(){return!0},h.prototype.serialize=function(){var g=[e];return this.eachChild(function(C){g.push(C.serialize())}),g},h}()}pu.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,pn),u=t.parse(e[2],2,Cr);if(!r||!u)return null;if(!Ta(r.type,[ki(pn),Tn,pn]))return t.error("Expected first argument to be of type array or string, but found "+_i(r.type)+" instead");if(e.length===4){var h=t.parse(e[3],3,Cr);return h?new pu(r.type,r,u,h):null}return new pu(r.type,r,u)},pu.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Di(t,["string","array"]))throw new Ya("Expected first argument to be of type array or string, but found "+_i(Oa(t))+" instead.");if(this.endIndex){var u=this.endIndex.evaluate(e);return t.slice(r,u)}return t.slice(r)},pu.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},pu.prototype.outputDefined=function(){return!1},pu.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Nc=ba("==",function(e,t,r){return t===r},Nf),Fc=ba("!=",function(e,t,r){return t!==r},function(e,t,r,u){return!Nf(0,t,r,u)}),bf=ba("<",function(e,t,r){return t<r},function(e,t,r,u){return u.compare(t,r)<0}),Bc=ba(">",function(e,t,r){return t>r},function(e,t,r,u){return u.compare(t,r)>0}),Sf=ba("<=",function(e,t,r){return t<=r},function(e,t,r,u){return u.compare(t,r)<=0}),ro=ba(">=",function(e,t,r){return t>=r},function(e,t,r,u){return u.compare(t,r)>=0}),wu=function(t,r,u,h,g){this.type=Tn,this.number=t,this.locale=r,this.currency=u,this.minFractionDigits=h,this.maxFractionDigits=g};wu.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Cr);if(!r)return null;var u=e[2];if(typeof u!="object"||Array.isArray(u))return t.error("NumberFormat options argument must be an object.");var h=null;if(u.locale&&!(h=t.parse(u.locale,1,Tn)))return null;var g=null;if(u.currency&&!(g=t.parse(u.currency,1,Tn)))return null;var C=null;if(u["min-fraction-digits"]&&!(C=t.parse(u["min-fraction-digits"],1,Cr)))return null;var O=null;return u["max-fraction-digits"]&&!(O=t.parse(u["max-fraction-digits"],1,Cr))?null:new wu(r,h,g,C,O)},wu.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},wu.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},wu.prototype.outputDefined=function(){return!1},wu.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var El=function(t){this.type=Cr,this.input=t};El.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+_i(r.type)+" instead."):new El(r):null},El.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new Ya("Expected value to be of type string or array, but found "+_i(Oa(t))+" instead.")},El.prototype.eachChild=function(e){e(this.input)},El.prototype.outputDefined=function(){return!1},El.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var gs={"==":Nc,"!=":Fc,">":Bc,"<":bf,">=":ro,"<=":Sf,array:sa,at:Yu,boolean:sa,case:ol,coalesce:du,collator:kt,format:yo,image:co,in:Au,"index-of":Ku,interpolate:Aa,"interpolate-hcl":Aa,"interpolate-lab":Aa,length:El,let:os,literal:ca,match:Cu,number:sa,"number-format":wu,object:sa,slice:pu,step:wa,string:sa,"to-boolean":as,"to-color":as,"to-number":as,"to-string":as,var:Zu,within:vs};function kc(e,t){var r=t[0],u=t[1],h=t[2],g=t[3];r=r.evaluate(e),u=u.evaluate(e),h=h.evaluate(e);var C=g?g.evaluate(e):1,O=Gu(r,u,h,C);if(O)throw new Ya(O);return new ci(r/255*C,u/255*C,h/255*C,C)}function bc(e,t){return e in t}function Tl(e,t){var r=t[e];return r===void 0?null:r}function sl(e){return{type:e}}function $u(e){return{result:"success",value:e}}function Qs(e){return{result:"error",value:e}}function Pu(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function jc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Fl(e){return!!e.expression&&e.expression.interpolated}function Pa(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Uc(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Ef(e){return e}function Sc(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function Ec(e,t,r,u,h){return Sc(typeof r===h?u[r]:void 0,e.default,t.default)}function ic(e,t,r){if(Pa(r)!=="number")return Sc(e.default,t.default);var u=e.stops.length;if(u===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[u-1][0])return e.stops[u-1][1];var h=Wu(e.stops.map(function(g){return g[0]}),r);return e.stops[h][1]}function ul(e,t,r){var u=e.base!==void 0?e.base:1;if(Pa(r)!=="number")return Sc(e.default,t.default);var h=e.stops.length;if(h===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[h-1][0])return e.stops[h-1][1];var g=Wu(e.stops.map(function(Ae){return Ae[0]}),r),C=function(Ae,_e,it,_t){var Tt=_t-it,Xt=Ae-it;return Tt===0?0:_e===1?Xt/Tt:(Math.pow(_e,Xt)-1)/(Math.pow(_e,Tt)-1)}(r,u,e.stops[g][0],e.stops[g+1][0]),O=e.stops[g][1],G=e.stops[g+1][1],Q=hu[t.type]||Ef;if(e.colorSpace&&e.colorSpace!=="rgb"){var ve=ms[e.colorSpace];Q=function(_e,it){return ve.reverse(ve.interpolate(ve.forward(_e),ve.forward(it),C))}}return typeof O.evaluate=="function"?{evaluate:function(){for(var _e=[],it=arguments.length;it--;)_e[it]=arguments[it];var _t=O.evaluate.apply(void 0,_e),Tt=G.evaluate.apply(void 0,_e);if(_t!==void 0&&Tt!==void 0)return Q(_t,Tt,C)}}:Q(O,G,C)}function _u(e,t,r){return t.type==="color"?r=ci.parse(r):t.type==="formatted"?r=to.fromString(r.toString()):t.type==="resolvedImage"?r=lo.fromString(r.toString()):Pa(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),Sc(r,e.default,t.default)}Lo.register(gs,{error:[{kind:"error"},[Tn],function(e,t){throw new Ya(t[0].evaluate(e))}],typeof:[Tn,[pn],function(e,t){return _i(Oa(t[0].evaluate(e)))}],"to-rgba":[ki(Cr,4),[En],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[En,[Cr,Cr,Cr],kc],rgba:[En,[Cr,Cr,Cr,Cr],kc],has:{type:fn,overloads:[[[Tn],function(e,t){return bc(t[0].evaluate(e),e.properties())}],[[Tn,Cn],function(e,t){var r=t[1];return bc(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:pn,overloads:[[[Tn],function(e,t){return Tl(t[0].evaluate(e),e.properties())}],[[Tn,Cn],function(e,t){var r=t[1];return Tl(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[pn,[Tn],function(e,t){return Tl(t[0].evaluate(e),e.featureState||{})}],properties:[Cn,[],function(e){return e.properties()}],"geometry-type":[Tn,[],function(e){return e.geometryType()}],id:[pn,[],function(e){return e.id()}],zoom:[Cr,[],function(e){return e.globals.zoom}],"heatmap-density":[Cr,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Cr,[],function(e){return e.globals.lineProgress||0}],accumulated:[pn,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[Cr,sl(Cr),function(e,t){for(var r=0,u=0,h=t;u<h.length;u+=1)r+=h[u].evaluate(e);return r}],"*":[Cr,sl(Cr),function(e,t){for(var r=1,u=0,h=t;u<h.length;u+=1)r*=h[u].evaluate(e);return r}],"-":{type:Cr,overloads:[[[Cr,Cr],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[Cr],function(e,t){return-t[0].evaluate(e)}]]},"/":[Cr,[Cr,Cr],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[Cr,[Cr,Cr],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[Cr,[],function(){return Math.LN2}],pi:[Cr,[],function(){return Math.PI}],e:[Cr,[],function(){return Math.E}],"^":[Cr,[Cr,Cr],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[Cr,[Cr],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Cr,[Cr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Cr,[Cr],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Cr,[Cr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Cr,[Cr],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Cr,[Cr],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Cr,[Cr],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Cr,[Cr],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Cr,[Cr],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Cr,[Cr],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Cr,sl(Cr),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[Cr,sl(Cr),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[Cr,[Cr],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Cr,[Cr],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Cr,[Cr],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Cr,[Cr],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[fn,[Tn,pn],function(e,t){var r=t[0],u=t[1];return e.properties()[r.value]===u.value}],"filter-id-==":[fn,[pn],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[fn,[Tn],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[fn,[Tn,pn],function(e,t){var r=t[0],u=t[1],h=e.properties()[r.value],g=u.value;return typeof h==typeof g&&h<g}],"filter-id-<":[fn,[pn],function(e,t){var r=t[0],u=e.id(),h=r.value;return typeof u==typeof h&&u<h}],"filter->":[fn,[Tn,pn],function(e,t){var r=t[0],u=t[1],h=e.properties()[r.value],g=u.value;return typeof h==typeof g&&h>g}],"filter-id->":[fn,[pn],function(e,t){var r=t[0],u=e.id(),h=r.value;return typeof u==typeof h&&u>h}],"filter-<=":[fn,[Tn,pn],function(e,t){var r=t[0],u=t[1],h=e.properties()[r.value],g=u.value;return typeof h==typeof g&&h<=g}],"filter-id-<=":[fn,[pn],function(e,t){var r=t[0],u=e.id(),h=r.value;return typeof u==typeof h&&u<=h}],"filter->=":[fn,[Tn,pn],function(e,t){var r=t[0],u=t[1],h=e.properties()[r.value],g=u.value;return typeof h==typeof g&&h>=g}],"filter-id->=":[fn,[pn],function(e,t){var r=t[0],u=e.id(),h=r.value;return typeof u==typeof h&&u>=h}],"filter-has":[fn,[pn],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[fn,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[fn,[ki(Tn)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[fn,[ki(pn)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[fn,[Tn,ki(pn)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[fn,[Tn,ki(pn)],function(e,t){var r=t[0],u=t[1];return function(h,g,C,O){for(;C<=O;){var G=C+O>>1;if(g[G]===h)return!0;g[G]>h?O=G-1:C=G+1}return!1}(e.properties()[r.value],u.value,0,u.value.length-1)}],all:{type:fn,overloads:[[[fn,fn],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[sl(fn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(!u[r].evaluate(e))return!1;return!0}]]},any:{type:fn,overloads:[[[fn,fn],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[sl(fn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(u[r].evaluate(e))return!0;return!1}]]},"!":[fn,[fn],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[fn,[Tn],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[Tn,[Tn],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[Tn,[Tn],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[Tn,sl(pn),function(e,t){return t.map(function(r){return is(r.evaluate(e))}).join("")}],"resolved-locale":[Tn,[Lr],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Bl=function(t,r){this.expression=t,this._warningHistory={},this._evaluator=new _s,this._defaultValue=r?function(u){return u.type==="color"&&Uc(u.default)?new ci(0,0,0,0):u.type==="color"?ci.parse(u.default)||null:u.default===void 0?null:u.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null};function Vo(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in gs}function ac(e,t){var r=new Js(gs,[],t?function(h){var g={color:En,string:Tn,number:Cr,enum:Tn,boolean:fn,formatted:hi,resolvedImage:xi};return h.type==="array"?ki(g[h.value]||pn,h.length):g[h.type]}(t):void 0),u=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?$u(new Bl(u,t)):Qs(r.errors)}Bl.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,h,g){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=u,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)},Bl.prototype.evaluate=function(e,t,r,u,h,g){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=u,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=g||null;try{var C=this.expression.evaluate(this._evaluator);if(C==null||typeof C=="number"&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new Ya("Expected value to be one of "+Object.keys(this._enumValues).map(function(O){return JSON.stringify(O)}).join(", ")+", but found "+JSON.stringify(C)+" instead.");return C}catch(O){return this._warningHistory[O.message]||(this._warningHistory[O.message]=!0,typeof console!="undefined"&&console.warn(O.message)),this._defaultValue}};var kl=function(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!bo(r.expression)};kl.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,h,g){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,h,g)},kl.prototype.evaluate=function(e,t,r,u,h,g){return this._styleExpression.evaluate(e,t,r,u,h,g)};var Al=function(t,r,u,h){this.kind=t,this.zoomStops=u,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!bo(r.expression),this.interpolationType=h};function Tc(e,t){if((e=ac(e,t)).result==="error")return e;var r=e.value.expression,u=fu(r);if(!u&&!Pu(t))return Qs([new Vr("","data expressions not supported")]);var h=$s(r,["zoom"]);if(!h&&!jc(t))return Qs([new Vr("","zoom expressions not supported")]);var g=function C(O){var G=null;if(O instanceof os)G=C(O.result);else if(O instanceof du)for(var Q=0,ve=O.args;Q<ve.length&&!(G=C(ve[Q]));Q+=1);else(O instanceof wa||O instanceof Aa)&&O.input instanceof Lo&&O.input.name==="zoom"&&(G=O);return G instanceof Vr||O.eachChild(function(Ae){var _e=C(Ae);_e instanceof Vr?G=_e:!G&&_e?G=new Vr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):G&&_e&&G!==_e&&(G=new Vr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),G}(r);return g||h?g instanceof Vr?Qs([g]):g instanceof Aa&&!Fl(t)?Qs([new Vr("",'"interpolate" expressions cannot be used with this property')]):$u(g?new Al(u?"camera":"composite",e.value,g.labels,g instanceof Aa?g.interpolation:void 0):new kl(u?"constant":"source",e.value)):Qs([new Vr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Al.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,h,g){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,h,g)},Al.prototype.evaluate=function(e,t,r,u,h,g){return this._styleExpression.evaluate(e,t,r,u,h,g)},Al.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?Aa.interpolationFactor(this.interpolationType,e,t,r):0};var jl=function(t,r){this._parameters=t,this._specification=r,Br(this,function u(h,g){var C,O,G,Q=g.type==="color",ve=h.stops&&typeof h.stops[0][0]=="object",Ae=ve||!(ve||h.property!==void 0),_e=h.type||(Fl(g)?"exponential":"interval");if(Q&&((h=Br({},h)).stops&&(h.stops=h.stops.map(function(Kn){return[Kn[0],ci.parse(Kn[1])]})),h.default=ci.parse(h.default?h.default:g.default)),h.colorSpace&&h.colorSpace!=="rgb"&&!ms[h.colorSpace])throw new Error("Unknown color space: "+h.colorSpace);if(_e==="exponential")C=ul;else if(_e==="interval")C=ic;else if(_e==="categorical"){C=Ec,O=Object.create(null);for(var it=0,_t=h.stops;it<_t.length;it+=1){var Tt=_t[it];O[Tt[0]]=Tt[1]}G=typeof h.stops[0][0]}else{if(_e!=="identity")throw new Error('Unknown function type "'+_e+'"');C=_u}if(ve){for(var Xt={},Zt=[],ir=0;ir<h.stops.length;ir++){var hr=h.stops[ir],Er=hr[0].zoom;Xt[Er]===void 0&&(Xt[Er]={zoom:Er,type:h.type,property:h.property,default:h.default,stops:[]},Zt.push(Er)),Xt[Er].stops.push([hr[0].value,hr[1]])}for(var kr=[],Nr=0,vn=Zt;Nr<vn.length;Nr+=1){var hn=vn[Nr];kr.push([Xt[hn].zoom,u(Xt[hn],g)])}var Ln={name:"linear"};return{kind:"composite",interpolationType:Ln,interpolationFactor:Aa.interpolationFactor.bind(void 0,Ln),zoomStops:kr.map(function(Kn){return Kn[0]}),evaluate:function(Fn,wi){var li=Fn.zoom;return ul({stops:kr,base:h.base},g,li).evaluate(li,wi)}}}if(Ae){var qn=_e==="exponential"?{name:"exponential",base:h.base!==void 0?h.base:1}:null;return{kind:"camera",interpolationType:qn,interpolationFactor:Aa.interpolationFactor.bind(void 0,qn),zoomStops:h.stops.map(function(Kn){return Kn[0]}),evaluate:function(Fn){return C(h,g,Fn.zoom,O,G)}}}return{kind:"source",evaluate:function(Fn,wi){var li=wi&&wi.properties?wi.properties[h.property]:void 0;return li===void 0?Sc(h.default,g.default):C(h,g,li,O,G)}}}(this._parameters,this._specification))};function qs(e){var t=e.key,r=e.value,u=e.valueSpec||{},h=e.objectElementValidators||{},g=e.style,C=e.styleSpec,O=[],G=Pa(r);if(G!=="object")return[new mt(t,r,"object expected, "+G+" found")];for(var Q in r){var ve=Q.split(".")[0],Ae=u[ve]||u["*"],_e=void 0;if(h[ve])_e=h[ve];else if(u[ve])_e=ji;else if(h["*"])_e=h["*"];else{if(!u["*"]){O.push(new mt(t,r[Q],'unknown property "'+Q+'"'));continue}_e=ji}O=O.concat(_e({key:(t&&t+".")+Q,value:r[Q],valueSpec:Ae,style:g,styleSpec:C,object:r,objectKey:Q},r))}for(var it in u)h[it]||u[it].required&&u[it].default===void 0&&r[it]===void 0&&O.push(new mt(t,r,'missing required property "'+it+'"'));return O}function Tf(e){var t=e.value,r=e.valueSpec,u=e.style,h=e.styleSpec,g=e.key,C=e.arrayElementValidator||ji;if(Pa(t)!=="array")return[new mt(g,t,"array expected, "+Pa(t)+" found")];if(r.length&&t.length!==r.length)return[new mt(g,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new mt(g,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var O={type:r.value,values:r.values};h.$version<7&&(O.function=r.function),Pa(r.value)==="object"&&(O=r.value);for(var G=[],Q=0;Q<t.length;Q++)G=G.concat(C({array:t,arrayIndex:Q,value:t[Q],valueSpec:O,style:u,styleSpec:h,key:g+"["+Q+"]"}));return G}function Af(e){var t=e.key,r=e.value,u=e.valueSpec,h=Pa(r);return h==="number"&&r!=r&&(h="NaN"),h!=="number"?[new mt(t,r,"number expected, "+h+" found")]:"minimum"in u&&r<u.minimum?[new mt(t,r,r+" is less than the minimum value "+u.minimum)]:"maximum"in u&&r>u.maximum?[new mt(t,r,r+" is greater than the maximum value "+u.maximum)]:[]}function of(e){var t,r,u,h=e.valueSpec,g=Ur(e.value.type),C={},O=g!=="categorical"&&e.value.property===void 0,G=!O,Q=Pa(e.value.stops)==="array"&&Pa(e.value.stops[0])==="array"&&Pa(e.value.stops[0][0])==="object",ve=qs({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(_t){if(g==="identity")return[new mt(_t.key,_t.value,'identity function may not have a "stops" property')];var Tt=[],Xt=_t.value;return Tt=Tt.concat(Tf({key:_t.key,value:Xt,valueSpec:_t.valueSpec,style:_t.style,styleSpec:_t.styleSpec,arrayElementValidator:Ae})),Pa(Xt)==="array"&&Xt.length===0&&Tt.push(new mt(_t.key,Xt,"array must have at least one stop")),Tt},default:function(_t){return ji({key:_t.key,value:_t.value,valueSpec:h,style:_t.style,styleSpec:_t.styleSpec})}}});return g==="identity"&&O&&ve.push(new mt(e.key,e.value,'missing required property "property"')),g==="identity"||e.value.stops||ve.push(new mt(e.key,e.value,'missing required property "stops"')),g==="exponential"&&e.valueSpec.expression&&!Fl(e.valueSpec)&&ve.push(new mt(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(G&&!Pu(e.valueSpec)?ve.push(new mt(e.key,e.value,"property functions not supported")):O&&!jc(e.valueSpec)&&ve.push(new mt(e.key,e.value,"zoom functions not supported"))),g!=="categorical"&&!Q||e.value.property!==void 0||ve.push(new mt(e.key,e.value,'"property" property is required')),ve;function Ae(it){var _t=[],Tt=it.value,Xt=it.key;if(Pa(Tt)!=="array")return[new mt(Xt,Tt,"array expected, "+Pa(Tt)+" found")];if(Tt.length!==2)return[new mt(Xt,Tt,"array length 2 expected, length "+Tt.length+" found")];if(Q){if(Pa(Tt[0])!=="object")return[new mt(Xt,Tt,"object expected, "+Pa(Tt[0])+" found")];if(Tt[0].zoom===void 0)return[new mt(Xt,Tt,"object stop key must have zoom")];if(Tt[0].value===void 0)return[new mt(Xt,Tt,"object stop key must have value")];if(u&&u>Ur(Tt[0].zoom))return[new mt(Xt,Tt[0].zoom,"stop zoom values must appear in ascending order")];Ur(Tt[0].zoom)!==u&&(u=Ur(Tt[0].zoom),r=void 0,C={}),_t=_t.concat(qs({key:Xt+"[0]",value:Tt[0],valueSpec:{zoom:{}},style:it.style,styleSpec:it.styleSpec,objectElementValidators:{zoom:Af,value:_e}}))}else _t=_t.concat(_e({key:Xt+"[0]",value:Tt[0],valueSpec:{},style:it.style,styleSpec:it.styleSpec},Tt));return Vo(or(Tt[1]))?_t.concat([new mt(Xt+"[1]",Tt[1],"expressions are not allowed in function stops.")]):_t.concat(ji({key:Xt+"[1]",value:Tt[1],valueSpec:h,style:it.style,styleSpec:it.styleSpec}))}function _e(it,_t){var Tt=Pa(it.value),Xt=Ur(it.value),Zt=it.value!==null?it.value:_t;if(t){if(Tt!==t)return[new mt(it.key,Zt,Tt+" stop domain type must match previous stop domain type "+t)]}else t=Tt;if(Tt!=="number"&&Tt!=="string"&&Tt!=="boolean")return[new mt(it.key,Zt,"stop domain value must be a number, string, or boolean")];if(Tt!=="number"&&g!=="categorical"){var ir="number expected, "+Tt+" found";return Pu(h)&&g===void 0&&(ir+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new mt(it.key,Zt,ir)]}return g!=="categorical"||Tt!=="number"||isFinite(Xt)&&Math.floor(Xt)===Xt?g!=="categorical"&&Tt==="number"&&r!==void 0&&Xt<r?[new mt(it.key,Zt,"stop domain values must appear in ascending order")]:(r=Xt,g==="categorical"&&Xt in C?[new mt(it.key,Zt,"stop domain values must be unique")]:(C[Xt]=!0,[])):[new mt(it.key,Zt,"integer expected, found "+Xt)]}}function Cl(e){var t=(e.expressionContext==="property"?Tc:ac)(or(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(u){return new mt(""+e.key+u.key,e.value,u.message)});var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new mt(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!bo(r))return[new mt(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!bo(r))return[new mt(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!$s(r,["zoom","feature-state"]))return[new mt(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!fu(r))return[new mt(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function oc(e){var t=e.key,r=e.value,u=e.valueSpec,h=[];return Array.isArray(u.values)?u.values.indexOf(Ur(r))===-1&&h.push(new mt(t,r,"expected one of ["+u.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(u.values).indexOf(Ur(r))===-1&&h.push(new mt(t,r,"expected one of ["+Object.keys(u.values).join(", ")+"], "+JSON.stringify(r)+" found")),h}function ll(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var u=r[t];if(!ll(u)&&typeof u!="boolean")return!1}return!0;default:return!0}}jl.deserialize=function(e){return new jl(e._parameters,e._specification)},jl.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Ul={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ac(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};ll(e)||(e=Vl(e));var t=ac(e,Ul);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(u,h,g){return t.value.evaluate(u,h,{},g)},needGeometry:function r(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(var h=1;h<u.length;h++)if(r(u[h]))return!0;return!1}(e)}}function Cc(e,t){return e<t?-1:e>t?1:0}function Vl(e){if(!e)return!0;var t,r=e[0];return e.length<=1?r!=="any":r==="=="?So(e[1],e[2],"=="):r==="!="?sc(So(e[1],e[2],"==")):r==="<"||r===">"||r==="<="||r===">="?So(e[1],e[2],r):r==="any"?(t=e.slice(1),["any"].concat(t.map(Vl))):r==="all"?["all"].concat(e.slice(1).map(Vl)):r==="none"?["all"].concat(e.slice(1).map(Vl).map(sc)):r==="in"?Ff(e[1],e.slice(2)):r==="!in"?sc(Ff(e[1],e.slice(2))):r==="has"?Cf(e[1]):r==="!has"?sc(Cf(e[1])):r!=="within"||e}function So(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function Ff(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Cc)]]:["filter-in-small",e,["literal",t]]}}function Cf(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function sc(e){return["!",e]}function Vc(e){return ll(or(e.value))?Cl(Br({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var u=r.value,h=r.key;if(Pa(u)!=="array")return[new mt(h,u,"array expected, "+Pa(u)+" found")];var g,C=r.styleSpec,O=[];if(u.length<1)return[new mt(h,u,"filter array must have at least 1 element")];switch(O=O.concat(oc({key:h+"[0]",value:u[0],valueSpec:C.filter_operator,style:r.style,styleSpec:r.styleSpec})),Ur(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&Ur(u[1])==="$type"&&O.push(new mt(h,u,'"$type" cannot be use with operator "'+u[0]+'"'));case"==":case"!=":u.length!==3&&O.push(new mt(h,u,'filter array for operator "'+u[0]+'" must have 3 elements'));case"in":case"!in":u.length>=2&&(g=Pa(u[1]))!=="string"&&O.push(new mt(h+"[1]",u[1],"string expected, "+g+" found"));for(var G=2;G<u.length;G++)g=Pa(u[G]),Ur(u[1])==="$type"?O=O.concat(oc({key:h+"["+G+"]",value:u[G],valueSpec:C.geometry_type,style:r.style,styleSpec:r.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&O.push(new mt(h+"["+G+"]",u[G],"string, number, or boolean expected, "+g+" found"));break;case"any":case"all":case"none":for(var Q=1;Q<u.length;Q++)O=O.concat(t({key:h+"["+Q+"]",value:u[Q],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":g=Pa(u[1]),u.length!==2?O.push(new mt(h,u,'filter array for "'+u[0]+'" operator must have 2 elements')):g!=="string"&&O.push(new mt(h+"[1]",u[1],"string expected, "+g+" found"));break;case"within":g=Pa(u[1]),u.length!==2?O.push(new mt(h,u,'filter array for "'+u[0]+'" operator must have 2 elements')):g!=="object"&&O.push(new mt(h+"[1]",u[1],"object expected, "+g+" found"))}return O}(e)}function sf(e,t){var r=e.key,u=e.style,h=e.styleSpec,g=e.value,C=e.objectKey,O=h[t+"_"+e.layerType];if(!O)return[];var G=C.match(/^(.*)-transition$/);if(t==="paint"&&G&&O[G[1]]&&O[G[1]].transition)return ji({key:r,value:g,valueSpec:h.transition,style:u,styleSpec:h});var Q,ve=e.valueSpec||O[C];if(!ve)return[new mt(r,g,'unknown property "'+C+'"')];if(Pa(g)==="string"&&Pu(ve)&&!ve.tokens&&(Q=/^{([^}]+)}$/.exec(g)))return[new mt(r,g,'"'+C+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(Q[1])+" }`.")];var Ae=[];return e.layerType==="symbol"&&(C==="text-field"&&u&&!u.glyphs&&Ae.push(new mt(r,g,'use of "text-field" requires a style "glyphs" property')),C==="text-font"&&Uc(or(g))&&Ur(g.type)==="identity"&&Ae.push(new mt(r,g,'"text-font" does not support identity functions'))),Ae.concat(ji({key:e.key,value:g,valueSpec:ve,style:u,styleSpec:h,expressionContext:"property",propertyType:t,propertyKey:C}))}function uf(e){return sf(e,"paint")}function Gl(e){return sf(e,"layout")}function lf(e){var t=[],r=e.value,u=e.key,h=e.style,g=e.styleSpec;r.type||r.ref||t.push(new mt(u,r,'either "type" or "ref" is required'));var C,O=Ur(r.type),G=Ur(r.ref);if(r.id)for(var Q=Ur(r.id),ve=0;ve<e.arrayIndex;ve++){var Ae=h.layers[ve];Ur(Ae.id)===Q&&t.push(new mt(u,r.id,'duplicate layer id "'+r.id+'", previously used at line '+Ae.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(_t){_t in r&&t.push(new mt(u,r[_t],'"'+_t+'" is prohibited for ref layers'))}),h.layers.forEach(function(_t){Ur(_t.id)===G&&(C=_t)}),C?C.ref?t.push(new mt(u,r.ref,"ref cannot reference another ref layer")):O=Ur(C.type):t.push(new mt(u,r.ref,'ref layer "'+G+'" not found'));else if(O!=="background")if(r.source){var _e=h.sources&&h.sources[r.source],it=_e&&Ur(_e.type);_e?it==="vector"&&O==="raster"?t.push(new mt(u,r.source,'layer "'+r.id+'" requires a raster source')):it==="raster"&&O!=="raster"?t.push(new mt(u,r.source,'layer "'+r.id+'" requires a vector source')):it!=="vector"||r["source-layer"]?it==="raster-dem"&&O!=="hillshade"?t.push(new mt(u,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):O!=="line"||!r.paint||!r.paint["line-gradient"]||it==="geojson"&&_e.lineMetrics||t.push(new mt(u,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new mt(u,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new mt(u,r.source,'source "'+r.source+'" not found'))}else t.push(new mt(u,r,'missing required property "source"'));return t=t.concat(qs({key:u,value:r,valueSpec:g.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return ji({key:u+".type",value:r.type,valueSpec:g.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:Vc,layout:function(Tt){return qs({layer:r,key:Tt.key,value:Tt.value,style:Tt.style,styleSpec:Tt.styleSpec,objectElementValidators:{"*":function(Zt){return Gl(Br({layerType:O},Zt))}}})},paint:function(Tt){return qs({layer:r,key:Tt.key,value:Tt.value,style:Tt.style,styleSpec:Tt.styleSpec,objectElementValidators:{"*":function(Zt){return uf(Br({layerType:O},Zt))}}})}}}))}function Mu(e){var t=e.value,r=e.key,u=Pa(t);return u!=="string"?[new mt(r,t,"string expected, "+u+" found")]:[]}var Ra={promoteId:function(t){var r=t.key,u=t.value;if(Pa(u)==="string")return Mu({key:r,value:u});var h=[];for(var g in u)h.push.apply(h,Mu({key:r+"."+g,value:u[g]}));return h}};function eu(e){var t=e.value,r=e.key,u=e.styleSpec,h=e.style;if(!t.type)return[new mt(r,t,'"type" is required')];var g,C=Ur(t.type);switch(C){case"vector":case"raster":case"raster-dem":return qs({key:r,value:t,valueSpec:u["source_"+C.replace("-","_")],style:e.style,styleSpec:u,objectElementValidators:Ra});case"geojson":if(g=qs({key:r,value:t,valueSpec:u.source_geojson,style:h,styleSpec:u,objectElementValidators:Ra}),t.cluster)for(var O in t.clusterProperties){var G=t.clusterProperties[O],Q=G[0],ve=typeof Q=="string"?[Q,["accumulated"],["get",O]]:Q;g.push.apply(g,Cl({key:r+"."+O+".map",value:G[1],expressionContext:"cluster-map"})),g.push.apply(g,Cl({key:r+"."+O+".reduce",value:ve,expressionContext:"cluster-reduce"}))}return g;case"video":return qs({key:r,value:t,valueSpec:u.source_video,style:h,styleSpec:u});case"image":return qs({key:r,value:t,valueSpec:u.source_image,style:h,styleSpec:u});case"canvas":return[new mt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return oc({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,styleSpec:u})}}function Go(e){var t=e.value,r=e.styleSpec,u=r.light,h=e.style,g=[],C=Pa(t);if(t===void 0)return g;if(C!=="object")return g.concat([new mt("light",t,"object expected, "+C+" found")]);for(var O in t){var G=O.match(/^(.*)-transition$/);g=g.concat(G&&u[G[1]]&&u[G[1]].transition?ji({key:O,value:t[O],valueSpec:r.transition,style:h,styleSpec:r}):u[O]?ji({key:O,value:t[O],valueSpec:u[O],style:h,styleSpec:r}):[new mt(O,t[O],'unknown property "'+O+'"')])}return g}var Iu={"*":function(){return[]},array:Tf,boolean:function(t){var r=t.value,u=t.key,h=Pa(r);return h!=="boolean"?[new mt(u,r,"boolean expected, "+h+" found")]:[]},number:Af,color:function(t){var r=t.key,u=t.value,h=Pa(u);return h!=="string"?[new mt(r,u,"color expected, "+h+" found")]:bi(u)===null?[new mt(r,u,'color expected, "'+u+'" found')]:[]},constants:Qt,enum:oc,filter:Vc,function:of,layer:lf,object:qs,source:eu,light:Go,string:Mu,formatted:function(t){return Mu(t).length===0?[]:Cl(t)},resolvedImage:function(t){return Mu(t).length===0?[]:Cl(t)}};function ji(e){var t=e.value,r=e.valueSpec,u=e.styleSpec;return r.expression&&Uc(Ur(t))?of(e):r.expression&&Vo(or(t))?Cl(e):r.type&&Iu[r.type]?Iu[r.type](e):qs(Br({},e,{valueSpec:r.type?u[r.type]:r}))}function Da(e){var t=e.value,r=e.key,u=Mu(e);return u.length||(t.indexOf("{fontstack}")===-1&&u.push(new mt(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&u.push(new mt(r,t,'"glyphs" url must include a "{range}" token'))),u}function js(e,t){t===void 0&&(t=Re);var r=[];return r=r.concat(ji({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Da,"*":function(){return[]}}})),e.constants&&(r=r.concat(Qt({key:"constants",value:e.constants,style:e,styleSpec:t}))),tu(r)}function tu(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function Hl(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return tu(e.apply(this,t))}}js.source=Hl(eu),js.light=Hl(Go),js.layer=Hl(lf),js.filter=Hl(Vc),js.paintProperty=Hl(uf),js.layoutProperty=Hl(Gl);var uc=js,wf=uc.light,zo=uc.paintProperty,Zl=uc.layoutProperty;function ya(e,t){var r=!1;if(t&&t.length)for(var u=0,h=t;u<h.length;u+=1)e.fire(new qe(new Error(h[u].message))),r=!0;return r}var Ki=fo;function fo(e,t,r){var u=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var h=new Int32Array(this.arrayBuffer);e=h[0],this.d=(t=h[1])+2*(r=h[2]);for(var g=0;g<this.d*this.d;g++){var C=h[3+g],O=h[3+g+1];u.push(C===O?null:h.subarray(C,O))}var G=h[3+u.length+1];this.keys=h.subarray(h[3+u.length],G),this.bboxes=h.subarray(G),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var Q=0;Q<this.d*this.d;Q++)u.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var ve=r/t*e;this.min=-ve,this.max=e+ve}fo.prototype.insert=function(e,t,r,u,h){this._forEachCell(t,r,u,h,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(u),this.bboxes.push(h)},fo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},fo.prototype._insertCell=function(e,t,r,u,h,g){this.cells[h].push(g)},fo.prototype.query=function(e,t,r,u,h){var g=this.min,C=this.max;if(e<=g&&t<=g&&C<=r&&C<=u&&!h)return Array.prototype.slice.call(this.keys);var O=[];return this._forEachCell(e,t,r,u,this._queryCell,O,{},h),O},fo.prototype._queryCell=function(e,t,r,u,h,g,C,O){var G=this.cells[h];if(G!==null)for(var Q=this.keys,ve=this.bboxes,Ae=0;Ae<G.length;Ae++){var _e=G[Ae];if(C[_e]===void 0){var it=4*_e;(O?O(ve[it+0],ve[it+1],ve[it+2],ve[it+3]):e<=ve[it+2]&&t<=ve[it+3]&&r>=ve[it+0]&&u>=ve[it+1])?(C[_e]=!0,g.push(Q[_e])):C[_e]=!1}}},fo.prototype._forEachCell=function(e,t,r,u,h,g,C,O){for(var G=this._convertToCellCoord(e),Q=this._convertToCellCoord(t),ve=this._convertToCellCoord(r),Ae=this._convertToCellCoord(u),_e=G;_e<=ve;_e++)for(var it=Q;it<=Ae;it++){var _t=this.d*it+_e;if((!O||O(this._convertFromCellCoord(_e),this._convertFromCellCoord(it),this._convertFromCellCoord(_e+1),this._convertFromCellCoord(it+1)))&&h.call(this,e,t,r,u,_t,g,C,O))return}},fo.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},fo.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},fo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,u=0;u<this.cells.length;u++)r+=this.cells[u].length;var h=new Int32Array(t+r+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var g=t,C=0;C<e.length;C++){var O=e[C];h[3+C]=g,h.set(O,g),g+=O.length}return h[3+e.length]=g,h.set(this.keys,g),h[3+e.length+1]=g+=this.keys.length,h.set(this.bboxes,g),g+=this.bboxes.length,h.buffer};var ys=$.ImageData,wl=$.ImageBitmap,$a={};function Mn(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),$a[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var zs in Mn("Object",Object),Ki.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},Ki.deserialize=function(e){return new Ki(e.buffer)},Mn("Grid",Ki),Mn("Color",ci),Mn("Error",Error),Mn("ResolvedImage",lo),Mn("StylePropertyFunction",jl),Mn("StyleExpression",Bl,{omit:["_evaluator"]}),Mn("ZoomDependentExpression",Al),Mn("ZoomConstantExpression",kl),Mn("CompoundExpression",Lo,{omit:["_evaluate"]}),gs)gs[zs]._classRegistryKey||Mn("Expression_"+zs,gs[zs]);function wc(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function cl(e){return wl&&e instanceof wl}function vu(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(wc(e)||cl(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof ys)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var u=[],h=0,g=e;h<g.length;h+=1)u.push(vu(g[h],t));return u}if(typeof e=="object"){var C=e.constructor,O=C._classRegistryKey;if(!O)throw new Error("can't serialize object of unregistered class");var G=C.serialize?C.serialize(e,t):{};if(!C.serialize){for(var Q in e)if(e.hasOwnProperty(Q)&&!($a[O].omit.indexOf(Q)>=0)){var ve=e[Q];G[Q]=$a[O].shallow.indexOf(Q)>=0?ve:vu(ve,t)}e instanceof Error&&(G.message=e.message)}if(G.$name)throw new Error("$name property is reserved for worker serialization logic.");return O!=="Object"&&(G.$name=O),G}throw new Error("can't serialize object of type "+typeof e)}function Us(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||wc(e)||cl(e)||ArrayBuffer.isView(e)||e instanceof ys)return e;if(Array.isArray(e))return e.map(Us);if(typeof e=="object"){var t=e.$name||"Object",r=$a[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var u=Object.create(r.prototype),h=0,g=Object.keys(e);h<g.length;h+=1){var C=g[h];if(C!=="$name"){var O=e[C];u[C]=$a[t].shallow.indexOf(C)>=0?O:Us(O)}}return u}throw new Error("can't deserialize object of type "+typeof e)}var Ou=function(){this.first=!0};Ou.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var an={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Gc(e){for(var t=0,r=e;t<r.length;t+=1)if(lc(r[t].charCodeAt(0)))return!0;return!1}function lc(e){return!(e!==746&&e!==747&&(e<4352||!(an["Bopomofo Extended"](e)||an.Bopomofo(e)||an["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||an["CJK Compatibility Ideographs"](e)||an["CJK Compatibility"](e)||an["CJK Radicals Supplement"](e)||an["CJK Strokes"](e)||!(!an["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||an["CJK Unified Ideographs Extension A"](e)||an["CJK Unified Ideographs"](e)||an["Enclosed CJK Letters and Months"](e)||an["Hangul Compatibility Jamo"](e)||an["Hangul Jamo Extended-A"](e)||an["Hangul Jamo Extended-B"](e)||an["Hangul Jamo"](e)||an["Hangul Syllables"](e)||an.Hiragana(e)||an["Ideographic Description Characters"](e)||an.Kanbun(e)||an["Kangxi Radicals"](e)||an["Katakana Phonetic Extensions"](e)||an.Katakana(e)&&e!==12540||!(!an["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!an["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||an["Unified Canadian Aboriginal Syllabics"](e)||an["Unified Canadian Aboriginal Syllabics Extended"](e)||an["Vertical Forms"](e)||an["Yijing Hexagram Symbols"](e)||an["Yi Syllables"](e)||an["Yi Radicals"](e))))}function Wl(e){return!(lc(e)||function(t){return!!(an["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||an["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||an["Letterlike Symbols"](t)||an["Number Forms"](t)||an["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||an["Control Pictures"](t)&&t!==9251||an["Optical Character Recognition"](t)||an["Enclosed Alphanumerics"](t)||an["Geometric Shapes"](t)||an["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||an["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||an["CJK Symbols and Punctuation"](t)||an.Katakana(t)||an["Private Use Area"](t)||an["CJK Compatibility Forms"](t)||an["Small Form Variants"](t)||an["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function mu(e){return e>=1424&&e<=2303||an["Arabic Presentation Forms-A"](e)||an["Arabic Presentation Forms-B"](e)}function Gi(e,t){return!(!t&&mu(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||an.Khmer(e))}function cf(e){for(var t=0,r=e;t<r.length;t+=1)if(mu(r[t].charCodeAt(0)))return!0;return!1}var ff=null,Vs="unavailable",fl=null,Hc=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Vs="error"),ff&&ff(t)};function Xl(){Ns.fire(new Ie("pluginStateChange",{pluginStatus:Vs,pluginURL:fl}))}var Ns=new Ct,Ho=function(){return Vs},ss=function(){if(Vs!=="deferred"||!fl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Vs="loading",Xl(),fl&&Wn({url:fl},function(t){t?Hc(t):(Vs="loaded",Xl())})},us={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Vs==="loaded"||us.applyArabicShaping!=null},isLoading:function(){return Vs==="loading"},setState:function(t){Vs=t.pluginStatus,fl=t.pluginURL},isParsed:function(){return us.applyArabicShaping!=null&&us.processBidirectionalText!=null&&us.processStyledBidirectionalText!=null},getPluginURL:function(){return fl}},Ti=function(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ou,this.transition={})};Ti.prototype.isSupportedScript=function(e){return function(t,r){for(var u=0,h=t;u<h.length;u+=1)if(!Gi(h[u].charCodeAt(0),r))return!1;return!0}(e,us.isLoaded())},Ti.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Ti.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var Lu=function(t,r){this.property=t,this.value=r,this.expression=function(u,h){if(Uc(u))return new jl(u,h);if(Vo(u)){var g=Tc(u,h);if(g.result==="error")throw new Error(g.value.map(function(O){return O.key+": "+O.message}).join(", "));return g.value}var C=u;return typeof u=="string"&&h.type==="color"&&(C=ci.parse(u)),{kind:"constant",evaluate:function(){return C}}}(r===void 0?t.specification.default:r,t.specification)};Lu.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Lu.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var Zo=function(t){this.property=t,this.value=new Lu(t,void 0)};Zo.prototype.transitioned=function(e,t){return new Ru(this.property,this.value,t,Me({},e.transition,this.transition),e.now)},Zo.prototype.untransitioned=function(){return new Ru(this.property,this.value,null,{},0)};var ho=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};ho.prototype.getValue=function(e){return Ze(this._values[e].value.value)},ho.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Zo(this._values[e].property)),this._values[e].value=new Lu(this._values[e].property,t===null?void 0:Ze(t))},ho.prototype.getTransition=function(e){return Ze(this._values[e].transition)},ho.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Zo(this._values[e].property)),this._values[e].transition=Ze(t)||void 0},ho.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],h=this.getValue(u);h!==void 0&&(e[u]=h);var g=this.getTransition(u);g!==void 0&&(e[u+"-transition"]=g)}return e},ho.prototype.transitioned=function(e,t){for(var r=new Ju(this._properties),u=0,h=Object.keys(this._values);u<h.length;u+=1){var g=h[u];r._values[g]=this._values[g].transitioned(e,t._values[g])}return r},ho.prototype.untransitioned=function(){for(var e=new Ju(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t];e._values[u]=this._values[u].untransitioned()}return e};var Ru=function(t,r,u,h,g){this.property=t,this.value=r,this.begin=g+h.delay||0,this.end=this.begin+h.duration||0,t.specification.transition&&(h.delay||h.duration)&&(this.prior=u)};Ru.prototype.possiblyEvaluate=function(e,t,r){var u=e.now||0,h=this.value.possiblyEvaluate(e,t,r),g=this.prior;if(g){if(u>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(u<this.begin)return g.possiblyEvaluate(e,t,r);var C=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(e,t,r),h,function(O){if(O<=0)return 0;if(O>=1)return 1;var G=O*O,Q=G*O;return 4*(O<.5?Q:3*(O-G)+Q-.75)}(C))}return h};var Ju=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Ju.prototype.possiblyEvaluate=function(e,t,r){for(var u=new ru(this._properties),h=0,g=Object.keys(this._values);h<g.length;h+=1){var C=g[h];u._values[C]=this._values[C].possiblyEvaluate(e,t,r)}return u},Ju.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var gu=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};gu.prototype.getValue=function(e){return Ze(this._values[e].value)},gu.prototype.setValue=function(e,t){this._values[e]=new Lu(this._values[e].property,t===null?void 0:Ze(t))},gu.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],h=this.getValue(u);h!==void 0&&(e[u]=h)}return e},gu.prototype.possiblyEvaluate=function(e,t,r){for(var u=new ru(this._properties),h=0,g=Object.keys(this._values);h<g.length;h+=1){var C=g[h];u._values[C]=this._values[C].possiblyEvaluate(e,t,r)}return u};var Ms=function(t,r,u){this.property=t,this.value=r,this.parameters=u};Ms.prototype.isConstant=function(){return this.value.kind==="constant"},Ms.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Ms.prototype.evaluate=function(e,t,r,u){return this.property.evaluate(this.value,this.parameters,e,t,r,u)};var ru=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};ru.prototype.get=function(e){return this._values[e]};var Jn=function(t){this.specification=t};Jn.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},Jn.prototype.interpolate=function(e,t,r){var u=hu[this.specification.type];return u?u(e,t,r):e};var Bn=function(t,r){this.specification=t,this.overrides=r};Bn.prototype.possiblyEvaluate=function(e,t,r,u){return new Ms(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},r,u)}:e.expression,t)},Bn.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new Ms(this,{kind:"constant",value:void 0},e.parameters);var u=hu[this.specification.type];return u?new Ms(this,{kind:"constant",value:u(e.value.value,t.value.value,r)},e.parameters):e},Bn.prototype.evaluate=function(e,t,r,u,h,g){return e.kind==="constant"?e.value:e.evaluate(t,r,u,h,g)};var Pl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u,h,g){if(r.value===void 0)return new Ms(this,{kind:"constant",value:void 0},u);if(r.expression.kind==="constant"){var C=r.expression.evaluate(u,null,{},h,g),O=r.property.specification.type==="resolvedImage"&&typeof C!="string"?C.name:C,G=this._calculate(O,O,O,u);return new Ms(this,{kind:"constant",value:G},u)}if(r.expression.kind==="camera"){var Q=this._calculate(r.expression.evaluate({zoom:u.zoom-1}),r.expression.evaluate({zoom:u.zoom}),r.expression.evaluate({zoom:u.zoom+1}),u);return new Ms(this,{kind:"constant",value:Q},u)}return new Ms(this,r.expression,u)},t.prototype.evaluate=function(r,u,h,g,C,O){if(r.kind==="source"){var G=r.evaluate(u,h,g,C,O);return this._calculate(G,G,G,u)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(u.zoom)-1},h,g),r.evaluate({zoom:Math.floor(u.zoom)},h,g),r.evaluate({zoom:Math.floor(u.zoom)+1},h,g),u):r.value},t.prototype._calculate=function(r,u,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:r,to:u}:{from:h,to:u}},t.prototype.interpolate=function(r){return r},t}(Bn),xs=function(t){this.specification=t};xs.prototype.possiblyEvaluate=function(e,t,r,u){if(e.value!==void 0){if(e.expression.kind==="constant"){var h=e.expression.evaluate(t,null,{},r,u);return this._calculate(h,h,h,t)}return this._calculate(e.expression.evaluate(new Ti(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Ti(Math.floor(t.zoom),t)),e.expression.evaluate(new Ti(Math.floor(t.zoom+1),t)),t)}},xs.prototype._calculate=function(e,t,r,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},xs.prototype.interpolate=function(e){return e};var Wo=function(t){this.specification=t};Wo.prototype.possiblyEvaluate=function(e,t,r,u){return!!e.expression.evaluate(t,null,{},r,u)},Wo.prototype.interpolate=function(){return!1};var No=function(t){for(var r in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var u=t[r];u.specification.overridable&&this.overridableProperties.push(r);var h=this.defaultPropertyValues[r]=new Lu(u,void 0),g=this.defaultTransitionablePropertyValues[r]=new Zo(u);this.defaultTransitioningPropertyValues[r]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=h.possiblyEvaluate({})}};Mn("DataDrivenProperty",Bn),Mn("DataConstantProperty",Jn),Mn("CrossFadedDataDrivenProperty",Pl),Mn("CrossFadedProperty",xs),Mn("ColorRampProperty",Wo);var nu=function(e){function t(r,u){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),u.layout&&(this._unevaluatedLayout=new gu(u.layout)),u.paint)){for(var h in this._transitionablePaint=new ho(u.paint),r.paint)this.setPaintProperty(h,r.paint[h],{validate:!1});for(var g in r.layout)this.setLayoutProperty(g,r.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ru(u.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,u,h){h===void 0&&(h={}),u!=null&&this._validate(Zl,"layers."+this.id+".layout."+r,r,u,h)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,u):this.visibility=u)},t.prototype.getPaintProperty=function(r){return $t(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,u,h){if(h===void 0&&(h={}),u!=null&&this._validate(zo,"layers."+this.id+".paint."+r,r,u,h))return!1;if($t(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),u||void 0),!1;var g=this._transitionablePaint._values[r],C=g.property.specification["property-type"]==="cross-faded-data-driven",O=g.value.isDataDriven(),G=g.value;this._transitionablePaint.setValue(r,u),this._handleSpecialPaintPropertyUpdate(r);var Q=this._transitionablePaint._values[r].value;return Q.isDataDriven()||O||C||this._handleOverridablePaintPropertyUpdate(r,G,Q)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,h){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,u){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,u)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),vt(r,function(u,h){return!(u===void 0||h==="layout"&&!Object.keys(u).length||h==="paint"&&!Object.keys(u).length)})},t.prototype._validate=function(r,u,h,g,C){return C===void 0&&(C={}),(!C||C.validate!==!1)&&ya(this,r.call(uc,{key:u,layerType:this.type,objectKey:h,value:g,styleSpec:Re,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var u=this.paint.get(r);if(u instanceof Ms&&Pu(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1},t}(Ct),Du={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},cc=function(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},na=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function po(e,t){t===void 0&&(t=1);var r=0,u=0;return{members:e.map(function(h){var g=Du[h.type].BYTES_PER_ELEMENT,C=r=hl(r,Math.max(t,g)),O=h.components||1;return u=Math.max(u,g),r+=g*O,{name:h.name,type:h.type,components:O,offset:C}}),size:hl(r,Math.max(u,t)),alignment:t}}function hl(e,t){return Math.ceil(e/t)*t}na.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},na.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},na.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},na.prototype.clear=function(){this.length=0},na.prototype.resize=function(e){this.reserve(e),this.length=e},na.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},na.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var dl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var h=this.length;return this.resize(h+1),this.emplace(h,r,u)},t.prototype.emplace=function(r,u,h){var g=2*r;return this.int16[g+0]=u,this.int16[g+1]=h,r},t}(na);dl.prototype.bytesPerElement=4,Mn("StructArrayLayout2i4",dl);var fc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g){var C=this.length;return this.resize(C+1),this.emplace(C,r,u,h,g)},t.prototype.emplace=function(r,u,h,g,C){var O=4*r;return this.int16[O+0]=u,this.int16[O+1]=h,this.int16[O+2]=g,this.int16[O+3]=C,r},t}(na);fc.prototype.bytesPerElement=8,Mn("StructArrayLayout4i8",fc);var zu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,C,O){var G=this.length;return this.resize(G+1),this.emplace(G,r,u,h,g,C,O)},t.prototype.emplace=function(r,u,h,g,C,O,G){var Q=6*r;return this.int16[Q+0]=u,this.int16[Q+1]=h,this.int16[Q+2]=g,this.int16[Q+3]=C,this.int16[Q+4]=O,this.int16[Q+5]=G,r},t}(na);zu.prototype.bytesPerElement=12,Mn("StructArrayLayout2i4i12",zu);var Is=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,C,O){var G=this.length;return this.resize(G+1),this.emplace(G,r,u,h,g,C,O)},t.prototype.emplace=function(r,u,h,g,C,O,G){var Q=4*r,ve=8*r;return this.int16[Q+0]=u,this.int16[Q+1]=h,this.uint8[ve+4]=g,this.uint8[ve+5]=C,this.uint8[ve+6]=O,this.uint8[ve+7]=G,r},t}(na);Is.prototype.bytesPerElement=8,Mn("StructArrayLayout2i4ub8",Is);var Yl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var h=this.length;return this.resize(h+1),this.emplace(h,r,u)},t.prototype.emplace=function(r,u,h){var g=2*r;return this.float32[g+0]=u,this.float32[g+1]=h,r},t}(na);Yl.prototype.bytesPerElement=8,Mn("StructArrayLayout2f8",Yl);var Gs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,C,O,G,Q,ve,Ae){var _e=this.length;return this.resize(_e+1),this.emplace(_e,r,u,h,g,C,O,G,Q,ve,Ae)},t.prototype.emplace=function(r,u,h,g,C,O,G,Q,ve,Ae,_e){var it=10*r;return this.uint16[it+0]=u,this.uint16[it+1]=h,this.uint16[it+2]=g,this.uint16[it+3]=C,this.uint16[it+4]=O,this.uint16[it+5]=G,this.uint16[it+6]=Q,this.uint16[it+7]=ve,this.uint16[it+8]=Ae,this.uint16[it+9]=_e,r},t}(na);Gs.prototype.bytesPerElement=20,Mn("StructArrayLayout10ui20",Gs);var Pf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,C,O,G,Q,ve,Ae,_e,it){var _t=this.length;return this.resize(_t+1),this.emplace(_t,r,u,h,g,C,O,G,Q,ve,Ae,_e,it)},t.prototype.emplace=function(r,u,h,g,C,O,G,Q,ve,Ae,_e,it,_t){var Tt=12*r;return this.int16[Tt+0]=u,this.int16[Tt+1]=h,this.int16[Tt+2]=g,this.int16[Tt+3]=C,this.uint16[Tt+4]=O,this.uint16[Tt+5]=G,this.uint16[Tt+6]=Q,this.uint16[Tt+7]=ve,this.int16[Tt+8]=Ae,this.int16[Tt+9]=_e,this.int16[Tt+10]=it,this.int16[Tt+11]=_t,r},t}(na);Pf.prototype.bytesPerElement=24,Mn("StructArrayLayout4i4ui4i24",Pf);var Kl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,h)},t.prototype.emplace=function(r,u,h,g){var C=3*r;return this.float32[C+0]=u,this.float32[C+1]=h,this.float32[C+2]=g,r},t}(na);Kl.prototype.bytesPerElement=12,Mn("StructArrayLayout3f12",Kl);var Zc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint32[1*r+0]=u,r},t}(na);Zc.prototype.bytesPerElement=4,Mn("StructArrayLayout1ul4",Zc);var _f=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,C,O,G,Q,ve){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,r,u,h,g,C,O,G,Q,ve)},t.prototype.emplace=function(r,u,h,g,C,O,G,Q,ve,Ae){var _e=10*r,it=5*r;return this.int16[_e+0]=u,this.int16[_e+1]=h,this.int16[_e+2]=g,this.int16[_e+3]=C,this.int16[_e+4]=O,this.int16[_e+5]=G,this.uint32[it+3]=Q,this.uint16[_e+8]=ve,this.uint16[_e+9]=Ae,r},t}(na);_f.prototype.bytesPerElement=20,Mn("StructArrayLayout6i1ul2ui20",_f);var bs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,C,O){var G=this.length;return this.resize(G+1),this.emplace(G,r,u,h,g,C,O)},t.prototype.emplace=function(r,u,h,g,C,O,G){var Q=6*r;return this.int16[Q+0]=u,this.int16[Q+1]=h,this.int16[Q+2]=g,this.int16[Q+3]=C,this.int16[Q+4]=O,this.int16[Q+5]=G,r},t}(na);bs.prototype.bytesPerElement=12,Mn("StructArrayLayout2i2i2i12",bs);var Nu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,C){var O=this.length;return this.resize(O+1),this.emplace(O,r,u,h,g,C)},t.prototype.emplace=function(r,u,h,g,C,O){var G=4*r,Q=8*r;return this.float32[G+0]=u,this.float32[G+1]=h,this.float32[G+2]=g,this.int16[Q+6]=C,this.int16[Q+7]=O,r},t}(na);Nu.prototype.bytesPerElement=16,Mn("StructArrayLayout2f1f2i16",Nu);var Wc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g){var C=this.length;return this.resize(C+1),this.emplace(C,r,u,h,g)},t.prototype.emplace=function(r,u,h,g,C){var O=12*r,G=3*r;return this.uint8[O+0]=u,this.uint8[O+1]=h,this.float32[G+1]=g,this.float32[G+2]=C,r},t}(na);Wc.prototype.bytesPerElement=12,Mn("StructArrayLayout2ub2f12",Wc);var _l=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,h)},t.prototype.emplace=function(r,u,h,g){var C=3*r;return this.uint16[C+0]=u,this.uint16[C+1]=h,this.uint16[C+2]=g,r},t}(na);_l.prototype.bytesPerElement=6,Mn("StructArrayLayout3ui6",_l);var Ml=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,C,O,G,Q,ve,Ae,_e,it,_t,Tt,Xt,Zt,ir){var hr=this.length;return this.resize(hr+1),this.emplace(hr,r,u,h,g,C,O,G,Q,ve,Ae,_e,it,_t,Tt,Xt,Zt,ir)},t.prototype.emplace=function(r,u,h,g,C,O,G,Q,ve,Ae,_e,it,_t,Tt,Xt,Zt,ir,hr){var Er=24*r,kr=12*r,Nr=48*r;return this.int16[Er+0]=u,this.int16[Er+1]=h,this.uint16[Er+2]=g,this.uint16[Er+3]=C,this.uint32[kr+2]=O,this.uint32[kr+3]=G,this.uint32[kr+4]=Q,this.uint16[Er+10]=ve,this.uint16[Er+11]=Ae,this.uint16[Er+12]=_e,this.float32[kr+7]=it,this.float32[kr+8]=_t,this.uint8[Nr+36]=Tt,this.uint8[Nr+37]=Xt,this.uint8[Nr+38]=Zt,this.uint32[kr+10]=ir,this.int16[Er+22]=hr,r},t}(na);Ml.prototype.bytesPerElement=48,Mn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ml);var hc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g,C,O,G,Q,ve,Ae,_e,it,_t,Tt,Xt,Zt,ir,hr,Er,kr,Nr,vn,hn,Ln,qn,Kn,Fn,wi){var li=this.length;return this.resize(li+1),this.emplace(li,r,u,h,g,C,O,G,Q,ve,Ae,_e,it,_t,Tt,Xt,Zt,ir,hr,Er,kr,Nr,vn,hn,Ln,qn,Kn,Fn,wi)},t.prototype.emplace=function(r,u,h,g,C,O,G,Q,ve,Ae,_e,it,_t,Tt,Xt,Zt,ir,hr,Er,kr,Nr,vn,hn,Ln,qn,Kn,Fn,wi,li){var ti=34*r,aa=17*r;return this.int16[ti+0]=u,this.int16[ti+1]=h,this.int16[ti+2]=g,this.int16[ti+3]=C,this.int16[ti+4]=O,this.int16[ti+5]=G,this.int16[ti+6]=Q,this.int16[ti+7]=ve,this.uint16[ti+8]=Ae,this.uint16[ti+9]=_e,this.uint16[ti+10]=it,this.uint16[ti+11]=_t,this.uint16[ti+12]=Tt,this.uint16[ti+13]=Xt,this.uint16[ti+14]=Zt,this.uint16[ti+15]=ir,this.uint16[ti+16]=hr,this.uint16[ti+17]=Er,this.uint16[ti+18]=kr,this.uint16[ti+19]=Nr,this.uint16[ti+20]=vn,this.uint16[ti+21]=hn,this.uint16[ti+22]=Ln,this.uint32[aa+12]=qn,this.float32[aa+13]=Kn,this.float32[aa+14]=Fn,this.float32[aa+15]=wi,this.float32[aa+16]=li,r},t}(na);hc.prototype.bytesPerElement=68,Mn("StructArrayLayout8i15ui1ul4f68",hc);var Qu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.float32[1*r+0]=u,r},t}(na);Qu.prototype.bytesPerElement=4,Mn("StructArrayLayout1f4",Qu);var Fs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,h)},t.prototype.emplace=function(r,u,h,g){var C=3*r;return this.int16[C+0]=u,this.int16[C+1]=h,this.int16[C+2]=g,r},t}(na);Fs.prototype.bytesPerElement=6,Mn("StructArrayLayout3i6",Fs);var dc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h){var g=this.length;return this.resize(g+1),this.emplace(g,r,u,h)},t.prototype.emplace=function(r,u,h,g){var C=4*r;return this.uint32[2*r+0]=u,this.uint16[C+2]=h,this.uint16[C+3]=g,r},t}(na);dc.prototype.bytesPerElement=8,Mn("StructArrayLayout1ul2ui8",dc);var pl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var h=this.length;return this.resize(h+1),this.emplace(h,r,u)},t.prototype.emplace=function(r,u,h){var g=2*r;return this.uint16[g+0]=u,this.uint16[g+1]=h,r},t}(na);pl.prototype.bytesPerElement=4,Mn("StructArrayLayout2ui4",pl);var vl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint16[1*r+0]=u,r},t}(na);vl.prototype.bytesPerElement=2,Mn("StructArrayLayout1ui2",vl);var Il=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,h,g){var C=this.length;return this.resize(C+1),this.emplace(C,r,u,h,g)},t.prototype.emplace=function(r,u,h,g,C){var O=4*r;return this.float32[O+0]=u,this.float32[O+1]=h,this.float32[O+2]=g,this.float32[O+3]=C,r},t}(na);Il.prototype.bytesPerElement=16,Mn("StructArrayLayout4f16",Il);var s=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new q(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(cc);s.prototype.size=20;var i=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new s(this,r)},t}(_f);Mn("CollisionBoxArray",i);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(u){this._structArray.uint8[this._pos1+37]=u},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(u){this._structArray.uint8[this._pos1+38]=u},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+10]=u},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(cc);n.prototype.size=48;var l=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new n(this,r)},t}(Ml);Mn("PlacedSymbolArray",l);var y=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+12]=u},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(cc);y.prototype.size=68;var M=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new y(this,r)},t}(hc);Mn("SymbolInstanceArray",M);var L=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(Qu);Mn("GlyphOffsetArray",L);var B=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(Fs);Mn("SymbolLineVertexArray",B);var oe=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(cc);oe.prototype.size=8;var Te=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new oe(this,r)},t}(dc);Mn("FeatureIndexArray",Te);var Ge=po([{name:"a_pos",components:2,type:"Int16"}],4).members,Ke=function(t){t===void 0&&(t=[]),this.segments=t};function et(e,t){return 256*(e=st(Math.floor(e),0,255))+st(Math.floor(t),0,255)}Ke.prototype.prepareSegment=function(e,t,r,u){var h=this.segments[this.segments.length-1];return e>Ke.MAX_VERTEX_ARRAY_LENGTH&&Le("Max vertices per segment is "+Ke.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!h||h.vertexLength+e>Ke.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==u)&&(h={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},u!==void 0&&(h.sortKey=u),this.segments.push(h)),h},Ke.prototype.get=function(){return this.segments},Ke.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var u in r.vaos)r.vaos[u].destroy()}},Ke.simpleSegment=function(e,t,r,u){return new Ke([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:u,vaos:{},sortKey:0}])},Ke.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Mn("SegmentVector",Ke);var Ft=po([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Rt=X(function(e){e.exports=function(t,r){var u,h,g,C,O,G,Q,ve;for(h=t.length-(u=3&t.length),g=r,O=3432918353,G=461845907,ve=0;ve<h;)Q=255&t.charCodeAt(ve)|(255&t.charCodeAt(++ve))<<8|(255&t.charCodeAt(++ve))<<16|(255&t.charCodeAt(++ve))<<24,++ve,g=27492+(65535&(C=5*(65535&(g=(g^=Q=(65535&(Q=(Q=(65535&Q)*O+(((Q>>>16)*O&65535)<<16)&4294967295)<<15|Q>>>17))*G+(((Q>>>16)*G&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(Q=0,u){case 3:Q^=(255&t.charCodeAt(ve+2))<<16;case 2:Q^=(255&t.charCodeAt(ve+1))<<8;case 1:g^=Q=(65535&(Q=(Q=(65535&(Q^=255&t.charCodeAt(ve)))*O+(((Q>>>16)*O&65535)<<16)&4294967295)<<15|Q>>>17))*G+(((Q>>>16)*G&65535)<<16)&4294967295}return g^=t.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}}),Yt=X(function(e){e.exports=function(t,r){for(var u,h=t.length,g=r^h,C=0;h>=4;)u=1540483477*(65535&(u=255&t.charCodeAt(C)|(255&t.charCodeAt(++C))<<8|(255&t.charCodeAt(++C))<<16|(255&t.charCodeAt(++C))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),h-=4,++C;switch(h){case 3:g^=(255&t.charCodeAt(C+2))<<16;case 2:g^=(255&t.charCodeAt(C+1))<<8;case 1:g=1540483477*(65535&(g^=255&t.charCodeAt(C)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}}),zt=Rt,jt=Yt;zt.murmur3=Rt,zt.murmur2=jt;var rr=function(){this.ids=[],this.positions=[],this.indexed=!1};rr.prototype.add=function(e,t,r,u){this.ids.push(zr(e)),this.positions.push(t,r,u)},rr.prototype.getPositions=function(e){for(var t=zr(e),r=0,u=this.ids.length-1;r<u;){var h=r+u>>1;this.ids[h]>=t?u=h:r=h+1}for(var g=[];this.ids[r]===t;)g.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return g},rr.serialize=function(e,t){var r=new Float64Array(e.ids),u=new Uint32Array(e.positions);return function h(g,C,O,G){for(;O<G;){for(var Q=g[O+G>>1],ve=O-1,Ae=G+1;;){do ve++;while(g[ve]<Q);do Ae--;while(g[Ae]>Q);if(ve>=Ae)break;pr(g,ve,Ae),pr(C,3*ve,3*Ae),pr(C,3*ve+1,3*Ae+1),pr(C,3*ve+2,3*Ae+2)}Ae-O<G-Ae?(h(g,C,O,Ae),O=Ae+1):(h(g,C,Ae+1,G),G=Ae)}}(r,u,0,r.length-1),t&&t.push(r.buffer,u.buffer),{ids:r,positions:u}},rr.deserialize=function(e){var t=new rr;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var nr=Math.pow(2,53)-1;function zr(e){var t=+e;return!isNaN(t)&&t<=nr?t:zt(String(e))}function pr(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}Mn("FeaturePositionMap",rr);var Ar=function(t,r){this.gl=t.gl,this.location=r},wr=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(Ar),sn=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(Ar),$r=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(Ar),xn=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(Ar),In=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(Ar),ei=function(e){function t(r,u){e.call(this,r,u),this.current=ci.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(Ar),si=new Float32Array(16),Ii=function(e){function t(r,u){e.call(this,r,u),this.current=si}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var u=1;u<16;u++)if(r[u]!==this.current[u]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(Ar);function $i(e){return[et(255*e.r,255*e.g),et(255*e.b,255*e.a)]}var wn=function(t,r,u){this.value=t,this.uniformNames=r.map(function(h){return"u_"+h}),this.type=u};wn.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},wn.prototype.getBinding=function(e,t,r){return this.type==="color"?new ei(e,t):new sn(e,t)};var ui=function(t,r){this.uniformNames=r.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ui.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},ui.prototype.setUniform=function(e,t,r,u){var h=u==="u_pattern_to"?this.patternTo:u==="u_pattern_from"?this.patternFrom:u==="u_pixel_ratio_to"?this.pixelRatioTo:u==="u_pixel_ratio_from"?this.pixelRatioFrom:null;h&&e.set(h)},ui.prototype.getBinding=function(e,t,r){return r.substr(0,9)==="u_pattern"?new In(e,t):new sn(e,t)};var Si=function(t,r,u,h){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=r.map(function(g){return{name:"a_"+g,type:"Float32",components:u==="color"?2:1,offset:0}}),this.paintVertexArray=new h};Si.prototype.populatePaintArray=function(e,t,r,u,h){var g=this.paintVertexArray.length,C=this.expression.evaluate(new Ti(0),t,{},u,[],h);this.paintVertexArray.resize(e),this._setPaintValue(g,e,C)},Si.prototype.updatePaintArray=function(e,t,r,u){var h=this.expression.evaluate({zoom:0},r,u);this._setPaintValue(e,t,h)},Si.prototype._setPaintValue=function(e,t,r){if(this.type==="color")for(var u=$i(r),h=e;h<t;h++)this.paintVertexArray.emplace(h,u[0],u[1]);else{for(var g=e;g<t;g++)this.paintVertexArray.emplace(g,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},Si.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Si.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Hn=function(t,r,u,h,g,C){this.expression=t,this.uniformNames=r.map(function(O){return"u_"+O+"_t"}),this.type=u,this.useIntegerZoom=h,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=r.map(function(O){return{name:"a_"+O,type:"Float32",components:u==="color"?4:2,offset:0}}),this.paintVertexArray=new C};Hn.prototype.populatePaintArray=function(e,t,r,u,h){var g=this.expression.evaluate(new Ti(this.zoom),t,{},u,[],h),C=this.expression.evaluate(new Ti(this.zoom+1),t,{},u,[],h),O=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(O,e,g,C)},Hn.prototype.updatePaintArray=function(e,t,r,u){var h=this.expression.evaluate({zoom:this.zoom},r,u),g=this.expression.evaluate({zoom:this.zoom+1},r,u);this._setPaintValue(e,t,h,g)},Hn.prototype._setPaintValue=function(e,t,r,u){if(this.type==="color")for(var h=$i(r),g=$i(u),C=e;C<t;C++)this.paintVertexArray.emplace(C,h[0],h[1],g[0],g[1]);else{for(var O=e;O<t;O++)this.paintVertexArray.emplace(O,r,u);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(u))}},Hn.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Hn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Hn.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,u=st(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(u)},Hn.prototype.getBinding=function(e,t,r){return new sn(e,t)};var Ei=function(t,r,u,h,g,C){this.expression=t,this.type=r,this.useIntegerZoom=u,this.zoom=h,this.layerId=C,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g};Ei.prototype.populatePaintArray=function(e,t,r){var u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,t.patterns&&t.patterns[this.layerId],r)},Ei.prototype.updatePaintArray=function(e,t,r,u,h){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],h)},Ei.prototype._setPaintValues=function(e,t,r,u){if(u&&r){var h=u[r.min],g=u[r.mid],C=u[r.max];if(h&&g&&C)for(var O=e;O<t;O++)this.zoomInPaintVertexArray.emplace(O,g.tl[0],g.tl[1],g.br[0],g.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1],g.pixelRatio,h.pixelRatio),this.zoomOutPaintVertexArray.emplace(O,g.tl[0],g.tl[1],g.br[0],g.br[1],C.tl[0],C.tl[1],C.br[0],C.br[1],g.pixelRatio,C.pixelRatio)}},Ei.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Ft.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Ft.members,this.expression.isStateDependent))},Ei.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var ii=function(t,r,u){this.binders={},this._buffers=[];var h=[];for(var g in t.paint._values)if(u(g)){var C=t.paint.get(g);if(C instanceof Ms&&Pu(C.property.specification)){var O=Hi(g,t.type),G=C.value,Q=C.property.specification.type,ve=C.property.useIntegerZoom,Ae=C.property.specification["property-type"],_e=Ae==="cross-faded"||Ae==="cross-faded-data-driven";if(G.kind==="constant")this.binders[g]=_e?new ui(G.value,O):new wn(G.value,O,Q),h.push("/u_"+g);else if(G.kind==="source"||_e){var it=no(g,Q,"source");this.binders[g]=_e?new Ei(G,Q,ve,r,it,t.id):new Si(G,O,Q,it),h.push("/a_"+g)}else{var _t=no(g,Q,"composite");this.binders[g]=new Hn(G,O,Q,ve,r,_t),h.push("/z_"+g)}}}this.cacheKey=h.sort().join("")};ii.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Si||t instanceof Hn?t.maxValue:0},ii.prototype.populatePaintArrays=function(e,t,r,u,h){for(var g in this.binders){var C=this.binders[g];(C instanceof Si||C instanceof Hn||C instanceof Ei)&&C.populatePaintArray(e,t,r,u,h)}},ii.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var u=this.binders[r];u instanceof ui&&u.setConstantPatternPositions(e,t)}},ii.prototype.updatePaintArrays=function(e,t,r,u,h){var g=!1;for(var C in e)for(var O=0,G=t.getPositions(C);O<G.length;O+=1){var Q=G[O],ve=r.feature(Q.index);for(var Ae in this.binders){var _e=this.binders[Ae];if((_e instanceof Si||_e instanceof Hn||_e instanceof Ei)&&_e.expression.isStateDependent===!0){var it=u.paint.get(Ae);_e.expression=it.value,_e.updatePaintArray(Q.start,Q.end,ve,e[C],h),g=!0}}}return g},ii.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof wn||r instanceof ui)&&e.push.apply(e,r.uniformNames.map(function(u){return"#define HAS_UNIFORM_"+u}))}return e},ii.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Si||r instanceof Hn)for(var u=0;u<r.paintVertexAttributes.length;u++)e.push(r.paintVertexAttributes[u].name);else if(r instanceof Ei)for(var h=0;h<Ft.members.length;h++)e.push(Ft.members[h].name)}return e},ii.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof wn||r instanceof ui||r instanceof Hn)for(var u=0,h=r.uniformNames;u<h.length;u+=1)e.push(h[u])}return e},ii.prototype.getPaintVertexBuffers=function(){return this._buffers},ii.prototype.getUniforms=function(e,t){var r=[];for(var u in this.binders){var h=this.binders[u];if(h instanceof wn||h instanceof ui||h instanceof Hn)for(var g=0,C=h.uniformNames;g<C.length;g+=1){var O=C[g];if(t[O]){var G=h.getBinding(e,t[O],O);r.push({name:O,property:u,binding:G})}}}return r},ii.prototype.setUniforms=function(e,t,r,u){for(var h=0,g=t;h<g.length;h+=1){var C=g[h],O=C.name,G=C.property;this.binders[G].setUniform(C.binding,u,r.get(G),O)}},ii.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Ei){var u=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(r instanceof Si||r instanceof Hn)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},ii.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof Si||r instanceof Hn||r instanceof Ei)&&r.upload(e)}this.updatePaintBuffers()},ii.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Si||t instanceof Hn||t instanceof Ei)&&t.destroy()}};var Ni=function(t,r,u){u===void 0&&(u=function(){return!0}),this.programConfigurations={};for(var h=0,g=t;h<g.length;h+=1){var C=g[h];this.programConfigurations[C.id]=new ii(C,r,u)}this.needsUpload=!1,this._featureMap=new rr,this._bufferOffset=0};function Hi(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function no(e,t,r){var u={color:{source:Yl,composite:Il},number:{source:Qu,composite:Yl}},h=function(g){return{"line-pattern":{source:Gs,composite:Gs},"fill-pattern":{source:Gs,composite:Gs},"fill-extrusion-pattern":{source:Gs,composite:Gs}}[g]}(e);return h&&h[r]||u[t][r]}Ni.prototype.populatePaintArrays=function(e,t,r,u,h,g){for(var C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(e,t,u,h,g);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Ni.prototype.updatePaintArrays=function(e,t,r,u){for(var h=0,g=r;h<g.length;h+=1){var C=g[h];this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(e,this._featureMap,t,C,u)||this.needsUpload}},Ni.prototype.get=function(e){return this.programConfigurations[e]},Ni.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Ni.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},Mn("ConstantBinder",wn),Mn("CrossFadedConstantBinder",ui),Mn("SourceExpressionBinder",Si),Mn("CrossFadedCompositeBinder",Ei),Mn("CompositeExpressionBinder",Hn),Mn("ProgramConfiguration",ii,{omit:["_buffers"]}),Mn("ProgramConfigurationSet",Ni);var za=Math.pow(2,14)-1,Mo=-za-1;function _a(e){for(var t=8192/e.extent,r=e.loadGeometry(),u=0;u<r.length;u++)for(var h=r[u],g=0;g<h.length;g++){var C=h[g],O=Math.round(C.x*t),G=Math.round(C.y*t);C.x=st(O,Mo,za),C.y=st(G,Mo,za),(O<C.x||O>C.x+1||G<C.y||G>C.y+1)&&Le("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Ja(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?_a(e):[]}}function Os(e,t,r,u,h){e.emplaceBack(2*t+(u+1)/2,2*r+(h+1)/2)}var Ls=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new dl,this.indexArray=new _l,this.segments=new Ke,this.programConfigurations=new Ni(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function yu(e,t){for(var r=0;r<e.length;r++)if(iu(t,e[r]))return!0;for(var u=0;u<t.length;u++)if(iu(e,t[u]))return!0;return!!Bu(e,t)}function Fu(e,t,r){return!!iu(e,t)||!!qu(t,e,r)}function Ss(e,t){if(e.length===1)return ml(t,e[0]);for(var r=0;r<t.length;r++)for(var u=t[r],h=0;h<u.length;h++)if(iu(e,u[h]))return!0;for(var g=0;g<e.length;g++)if(ml(t,e[g]))return!0;for(var C=0;C<t.length;C++)if(Bu(e,t[C]))return!0;return!1}function Bs(e,t,r){if(e.length>1){if(Bu(e,t))return!0;for(var u=0;u<t.length;u++)if(qu(t[u],e,r))return!0}for(var h=0;h<e.length;h++)if(qu(e[h],t,r))return!0;return!1}function Bu(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var u=e[r],h=e[r+1],g=0;g<t.length-1;g++)if(xu(u,h,t[g],t[g+1]))return!0;return!1}function xu(e,t,r,u){return at(e,r,u)!==at(t,r,u)&&at(e,t,r)!==at(e,t,u)}function qu(e,t,r){var u=r*r;if(t.length===1)return e.distSqr(t[0])<u;for(var h=1;h<t.length;h++)if($l(e,t[h-1],t[h])<u)return!0;return!1}function $l(e,t,r){var u=t.distSqr(r);if(u===0)return e.distSqr(t);var h=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/u;return e.distSqr(h<0?t:h>1?r:r.sub(t)._mult(h)._add(t))}function ml(e,t){for(var r,u,h,g=!1,C=0;C<e.length;C++)for(var O=0,G=(r=e[C]).length-1;O<r.length;G=O++)(u=r[O]).y>t.y!=(h=r[G]).y>t.y&&t.x<(h.x-u.x)*(t.y-u.y)/(h.y-u.y)+u.x&&(g=!g);return g}function iu(e,t){for(var r=!1,u=0,h=e.length-1;u<e.length;h=u++){var g=e[u],C=e[h];g.y>t.y!=C.y>t.y&&t.x<(C.x-g.x)*(t.y-g.y)/(C.y-g.y)+g.x&&(r=!r)}return r}function pc(e,t,r){var u=r[0],h=r[2];if(e.x<u.x&&t.x<u.x||e.x>h.x&&t.x>h.x||e.y<u.y&&t.y<u.y||e.y>h.y&&t.y>h.y)return!1;var g=at(e,t,r[0]);return g!==at(e,t,r[1])||g!==at(e,t,r[2])||g!==at(e,t,r[3])}function bu(e,t,r){var u=t.paint.get(e).value;return u.kind==="constant"?u.value:r.programConfigurations.get(t.id).getMaxValue(e)}function Eo(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function gl(e,t,r,u,h){if(!t[0]&&!t[1])return e;var g=q.convert(t)._mult(h);r==="viewport"&&g._rotate(-u);for(var C=[],O=0;O<e.length;O++)C.push(e[O].sub(g));return C}Ls.prototype.populate=function(e,t,r){var u=this.layers[0],h=[],g=null;u.type==="circle"&&(g=u.layout.get("circle-sort-key"));for(var C=0,O=e;C<O.length;C+=1){var G=O[C],Q=G.feature,ve=G.id,Ae=G.index,_e=G.sourceLayerIndex,it=this.layers[0]._featureFilter.needGeometry,_t=Ja(Q,it);if(this.layers[0]._featureFilter.filter(new Ti(this.zoom),_t,r)){var Tt=g?g.evaluate(_t,{},r):void 0,Xt={id:ve,properties:Q.properties,type:Q.type,sourceLayerIndex:_e,index:Ae,geometry:it?_t.geometry:_a(Q),patterns:{},sortKey:Tt};h.push(Xt)}}g&&h.sort(function(hn,Ln){return hn.sortKey-Ln.sortKey});for(var Zt=0,ir=h;Zt<ir.length;Zt+=1){var hr=ir[Zt],Er=hr.geometry,kr=hr.index,Nr=hr.sourceLayerIndex,vn=e[kr].feature;this.addFeature(hr,Er,kr,r),t.featureIndex.insert(vn,Er,kr,Nr,this.index)}},Ls.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Ls.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ls.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ls.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ge),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ls.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ls.prototype.addFeature=function(e,t,r,u){for(var h=0,g=t;h<g.length;h+=1)for(var C=0,O=g[h];C<O.length;C+=1){var G=O[C],Q=G.x,ve=G.y;if(!(Q<0||Q>=8192||ve<0||ve>=8192)){var Ae=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),_e=Ae.vertexLength;Os(this.layoutVertexArray,Q,ve,-1,-1),Os(this.layoutVertexArray,Q,ve,1,-1),Os(this.layoutVertexArray,Q,ve,1,1),Os(this.layoutVertexArray,Q,ve,-1,1),this.indexArray.emplaceBack(_e,_e+1,_e+2),this.indexArray.emplaceBack(_e,_e+3,_e+2),Ae.vertexLength+=4,Ae.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},u)},Mn("CircleBucket",Ls,{omit:["layers"]});var Jl=new No({"circle-sort-key":new Bn(Re.layout_circle["circle-sort-key"])}),Rs={paint:new No({"circle-radius":new Bn(Re.paint_circle["circle-radius"]),"circle-color":new Bn(Re.paint_circle["circle-color"]),"circle-blur":new Bn(Re.paint_circle["circle-blur"]),"circle-opacity":new Bn(Re.paint_circle["circle-opacity"]),"circle-translate":new Jn(Re.paint_circle["circle-translate"]),"circle-translate-anchor":new Jn(Re.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Jn(Re.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Jn(Re.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Bn(Re.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Bn(Re.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Bn(Re.paint_circle["circle-stroke-opacity"])}),layout:Jl},To=typeof Float32Array!="undefined"?Float32Array:Array;function vo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function es(e,t,r){var u=t[0],h=t[1],g=t[2],C=t[3],O=t[4],G=t[5],Q=t[6],ve=t[7],Ae=t[8],_e=t[9],it=t[10],_t=t[11],Tt=t[12],Xt=t[13],Zt=t[14],ir=t[15],hr=r[0],Er=r[1],kr=r[2],Nr=r[3];return e[0]=hr*u+Er*O+kr*Ae+Nr*Tt,e[1]=hr*h+Er*G+kr*_e+Nr*Xt,e[2]=hr*g+Er*Q+kr*it+Nr*Zt,e[3]=hr*C+Er*ve+kr*_t+Nr*ir,e[4]=(hr=r[4])*u+(Er=r[5])*O+(kr=r[6])*Ae+(Nr=r[7])*Tt,e[5]=hr*h+Er*G+kr*_e+Nr*Xt,e[6]=hr*g+Er*Q+kr*it+Nr*Zt,e[7]=hr*C+Er*ve+kr*_t+Nr*ir,e[8]=(hr=r[8])*u+(Er=r[9])*O+(kr=r[10])*Ae+(Nr=r[11])*Tt,e[9]=hr*h+Er*G+kr*_e+Nr*Xt,e[10]=hr*g+Er*Q+kr*it+Nr*Zt,e[11]=hr*C+Er*ve+kr*_t+Nr*ir,e[12]=(hr=r[12])*u+(Er=r[13])*O+(kr=r[14])*Ae+(Nr=r[15])*Tt,e[13]=hr*h+Er*G+kr*_e+Nr*Xt,e[14]=hr*g+Er*Q+kr*it+Nr*Zt,e[15]=hr*C+Er*ve+kr*_t+Nr*ir,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var Ao,io=es;function ts(e,t,r){var u=t[0],h=t[1],g=t[2],C=t[3];return e[0]=r[0]*u+r[4]*h+r[8]*g+r[12]*C,e[1]=r[1]*u+r[5]*h+r[9]*g+r[13]*C,e[2]=r[2]*u+r[6]*h+r[10]*g+r[14]*C,e[3]=r[3]*u+r[7]*h+r[11]*g+r[15]*C,e}Ao=new To(3),To!=Float32Array&&(Ao[0]=0,Ao[1]=0,Ao[2]=0),function(){var e=new To(4);To!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var yl=(function(){var e=new To(2);To!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,Rs)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Ls(r)},t.prototype.queryRadius=function(r){var u=r;return bu("circle-radius",this,u)+bu("circle-stroke-width",this,u)+Eo(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,u,h,g,C,O,G,Q){for(var ve=gl(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),O.angle,G),Ae=this.paint.get("circle-radius").evaluate(u,h)+this.paint.get("circle-stroke-width").evaluate(u,h),_e=this.paint.get("circle-pitch-alignment")==="map",it=_e?ve:function(vn,hn){return vn.map(function(Ln){return Pc(Ln,hn)})}(ve,Q),_t=_e?Ae*G:Ae,Tt=0,Xt=g;Tt<Xt.length;Tt+=1)for(var Zt=0,ir=Xt[Tt];Zt<ir.length;Zt+=1){var hr=ir[Zt],Er=_e?hr:Pc(hr,Q),kr=_t,Nr=ts([],[hr.x,hr.y,0,1],Q);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?kr*=Nr[3]/O.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(kr*=O.cameraToCenterDistance/Nr[3]),Fu(it,Er,kr))return!0}return!1},t}(nu));function Pc(e,t){var r=ts([],[e.x,e.y,0,1],t);return new q(r[0]/r[3],r[1]/r[3])}var Xc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Ls);function el(e,t,r,u){var h=t.width,g=t.height;if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==h*g*r)throw new RangeError("mismatched image size")}else u=new Uint8Array(h*g*r);return e.width=h,e.height=g,e.data=u,e}function vc(e,t,r){var u=t.width,h=t.height;if(u!==e.width||h!==e.height){var g=el({},{width:u,height:h},r);Ol(e,g,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,u),height:Math.min(e.height,h)},r),e.width=u,e.height=h,e.data=g.data}}function Ol(e,t,r,u,h,g){if(h.width===0||h.height===0)return t;if(h.width>e.width||h.height>e.height||r.x>e.width-h.width||r.y>e.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||u.x>t.width-h.width||u.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");for(var C=e.data,O=t.data,G=0;G<h.height;G++)for(var Q=((r.y+G)*e.width+r.x)*g,ve=((u.y+G)*t.width+u.x)*g,Ae=0;Ae<h.width*g;Ae++)O[ve+Ae]=C[Q+Ae];return t}Mn("HeatmapBucket",Xc,{omit:["layers"]});var Hs=function(t,r){el(this,t,1,r)};Hs.prototype.resize=function(e){vc(this,e,1)},Hs.prototype.clone=function(){return new Hs({width:this.width,height:this.height},new Uint8Array(this.data))},Hs.copy=function(e,t,r,u,h){Ol(e,t,r,u,h,1)};var Fo=function(t,r){el(this,t,4,r)};Fo.prototype.resize=function(e){vc(this,e,4)},Fo.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Fo.prototype.clone=function(){return new Fo({width:this.width,height:this.height},new Uint8Array(this.data))},Fo.copy=function(e,t,r,u,h){Ol(e,t,r,u,h,4)},Mn("AlphaImage",Hs),Mn("RGBAImage",Fo);var Ql={paint:new No({"heatmap-radius":new Bn(Re.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Bn(Re.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Jn(Re.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Wo(Re.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Jn(Re.paint_heatmap["heatmap-opacity"])})};function Es(e){var t={},r=e.resolution||256,u=e.clips?e.clips.length:1,h=e.image||new Fo({width:r,height:u}),g=function(Tt,Xt,Zt){t[e.evaluationKey]=Zt;var ir=e.expression.evaluate(t);h.data[Tt+Xt+0]=Math.floor(255*ir.r/ir.a),h.data[Tt+Xt+1]=Math.floor(255*ir.g/ir.a),h.data[Tt+Xt+2]=Math.floor(255*ir.b/ir.a),h.data[Tt+Xt+3]=Math.floor(255*ir.a)};if(e.clips)for(var C=0,O=0;C<u;++C,O+=4*r)for(var G=0,Q=0;G<r;G++,Q+=4){var ve=G/(r-1),Ae=e.clips[C];g(O,Q,Ae.start*(1-ve)+Ae.end*ve)}else for(var _e=0,it=0;_e<r;_e++,it+=4)g(0,it,_e/(r-1));return h}var ql=function(e){function t(r){e.call(this,r,Ql),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Xc(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Es({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(nu),hf={paint:new No({"hillshade-illumination-direction":new Jn(Re.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Jn(Re.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Jn(Re.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Jn(Re.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Jn(Re.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Jn(Re.paint_hillshade["hillshade-accent-color"])})},Zf=function(e){function t(r){e.call(this,r,hf)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(nu),lh=po([{name:"a_pos",components:2,type:"Int16"}],4).members,xl=df,Mf=df;function df(e,t,r){r=r||2;var u,h,g,C,O,G,Q,ve=t&&t.length,Ae=ve?t[0]*r:e.length,_e=Bf(e,0,Ae,r,!0),it=[];if(!_e||_e.next===_e.prev)return it;if(ve&&(_e=function(Tt,Xt,Zt,ir){var hr,Er,kr,Nr=[];for(hr=0,Er=Xt.length;hr<Er;hr++)(kr=Bf(Tt,Xt[hr]*ir,hr<Er-1?Xt[hr+1]*ir:Tt.length,ir,!1))===kr.next&&(kr.steiner=!0),Nr.push(ch(kr));for(Nr.sort(Xf),hr=0;hr<Nr.length;hr++)Yf(Nr[hr],Zt),Zt=ku(Zt,Zt.next);return Zt}(e,t,_e,r)),e.length>80*r){u=g=e[0],h=C=e[1];for(var _t=r;_t<Ae;_t+=r)(O=e[_t])<u&&(u=O),(G=e[_t+1])<h&&(h=G),O>g&&(g=O),G>C&&(C=G);Q=(Q=Math.max(g-u,C-h))!==0?1/Q:0}return mc(_e,it,r,u,h,Q),it}function Bf(e,t,r,u,h){var g,C;if(h===$c(e,t,r,u)>0)for(g=t;g<r;g+=u)C=Rf(g,e[g],e[g+1],C);else for(g=r-u;g>=t;g-=u)C=Rf(g,e[g],e[g+1],C);return C&&tc(C,C.next)&&(Oc(C),C=C.next),C}function ku(e,t){if(!e)return e;t||(t=e);var r,u=e;do if(r=!1,u.steiner||!tc(u,u.next)&&mo(u.prev,u,u.next)!==0)u=u.next;else{if(Oc(u),(u=t=u.prev)===u.next)break;r=!0}while(r||u!==t);return t}function mc(e,t,r,u,h,g,C){if(e){!C&&g&&function(ve,Ae,_e,it){var _t=ve;do _t.z===null&&(_t.z=If(_t.x,_t.y,Ae,_e,it)),_t.prevZ=_t.prev,_t.nextZ=_t.next,_t=_t.next;while(_t!==ve);_t.prevZ.nextZ=null,_t.prevZ=null,function(Tt){var Xt,Zt,ir,hr,Er,kr,Nr,vn,hn=1;do{for(Zt=Tt,Tt=null,Er=null,kr=0;Zt;){for(kr++,ir=Zt,Nr=0,Xt=0;Xt<hn&&(Nr++,ir=ir.nextZ);Xt++);for(vn=hn;Nr>0||vn>0&&ir;)Nr!==0&&(vn===0||!ir||Zt.z<=ir.z)?(hr=Zt,Zt=Zt.nextZ,Nr--):(hr=ir,ir=ir.nextZ,vn--),Er?Er.nextZ=hr:Tt=hr,hr.prevZ=Er,Er=hr;Zt=ir}Er.nextZ=null,hn*=2}while(kr>1)}(_t)}(e,u,h,g);for(var O,G,Q=e;e.prev!==e.next;)if(O=e.prev,G=e.next,g?_c(e,u,h,g):Wf(e))t.push(O.i/r),t.push(e.i/r),t.push(G.i/r),Oc(e),e=G.next,Q=G.next;else if((e=G)===Q){C?C===1?mc(e=Mc(ku(e),t,r),t,r,u,h,g,2):C===2&&Ic(e,t,r,u,h,g):mc(ku(e),t,r,u,h,g,1);break}}}function Wf(e){var t=e.prev,r=e,u=e.next;if(mo(t,r,u)>=0)return!1;for(var h=e.next.next;h!==e.prev;){if(ec(t.x,t.y,r.x,r.y,u.x,u.y,h.x,h.y)&&mo(h.prev,h,h.next)>=0)return!1;h=h.next}return!0}function _c(e,t,r,u){var h=e.prev,g=e,C=e.next;if(mo(h,g,C)>=0)return!1;for(var O=h.x>g.x?h.x>C.x?h.x:C.x:g.x>C.x?g.x:C.x,G=h.y>g.y?h.y>C.y?h.y:C.y:g.y>C.y?g.y:C.y,Q=If(h.x<g.x?h.x<C.x?h.x:C.x:g.x<C.x?g.x:C.x,h.y<g.y?h.y<C.y?h.y:C.y:g.y<C.y?g.y:C.y,t,r,u),ve=If(O,G,t,r,u),Ae=e.prevZ,_e=e.nextZ;Ae&&Ae.z>=Q&&_e&&_e.z<=ve;){if(Ae!==e.prev&&Ae!==e.next&&ec(h.x,h.y,g.x,g.y,C.x,C.y,Ae.x,Ae.y)&&mo(Ae.prev,Ae,Ae.next)>=0||(Ae=Ae.prevZ,_e!==e.prev&&_e!==e.next&&ec(h.x,h.y,g.x,g.y,C.x,C.y,_e.x,_e.y)&&mo(_e.prev,_e,_e.next)>=0))return!1;_e=_e.nextZ}for(;Ae&&Ae.z>=Q;){if(Ae!==e.prev&&Ae!==e.next&&ec(h.x,h.y,g.x,g.y,C.x,C.y,Ae.x,Ae.y)&&mo(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.prevZ}for(;_e&&_e.z<=ve;){if(_e!==e.prev&&_e!==e.next&&ec(h.x,h.y,g.x,g.y,C.x,C.y,_e.x,_e.y)&&mo(_e.prev,_e,_e.next)>=0)return!1;_e=_e.nextZ}return!0}function Mc(e,t,r){var u=e;do{var h=u.prev,g=u.next.next;!tc(h,g)&&Of(h,u,u.next,g)&&Ll(h,g)&&Ll(g,h)&&(t.push(h.i/r),t.push(u.i/r),t.push(g.i/r),Oc(u),Oc(u.next),u=e=g),u=u.next}while(u!==e);return ku(u)}function Ic(e,t,r,u,h,g){var C=e;do{for(var O=C.next.next;O!==C.prev;){if(C.i!==O.i&&Yc(C,O)){var G=Lf(C,O);return C=ku(C,C.next),G=ku(G,G.next),mc(C,t,r,u,h,g),void mc(G,t,r,u,h,g)}O=O.next}C=C.next}while(C!==e)}function Xf(e,t){return e.x-t.x}function Yf(e,t){if(t=function(u,h){var g,C=h,O=u.x,G=u.y,Q=-1/0;do{if(G<=C.y&&G>=C.next.y&&C.next.y!==C.y){var ve=C.x+(G-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(ve<=O&&ve>Q){if(Q=ve,ve===O){if(G===C.y)return C;if(G===C.next.y)return C.next}g=C.x<C.next.x?C:C.next}}C=C.next}while(C!==h);if(!g)return null;if(O===Q)return g;var Ae,_e=g,it=g.x,_t=g.y,Tt=1/0;C=g;do O>=C.x&&C.x>=it&&O!==C.x&&ec(G<_t?O:Q,G,it,_t,G<_t?Q:O,G,C.x,C.y)&&(Ae=Math.abs(G-C.y)/(O-C.x),Ll(C,u)&&(Ae<Tt||Ae===Tt&&(C.x>g.x||C.x===g.x&&Kf(g,C)))&&(g=C,Tt=Ae)),C=C.next;while(C!==_e);return g}(e,t)){var r=Lf(t,e);ku(t,t.next),ku(r,r.next)}}function Kf(e,t){return mo(e.prev,e,t.prev)<0&&mo(t.next,e,e.next)<0}function If(e,t,r,u,h){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*h)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*h)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ch(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function ec(e,t,r,u,h,g,C,O){return(h-C)*(t-O)-(e-C)*(g-O)>=0&&(e-C)*(u-O)-(r-C)*(t-O)>=0&&(r-C)*(g-O)-(h-C)*(u-O)>=0}function Yc(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,u){var h=r;do{if(h.i!==r.i&&h.next.i!==r.i&&h.i!==u.i&&h.next.i!==u.i&&Of(h,h.next,r,u))return!0;h=h.next}while(h!==r);return!1}(e,t)&&(Ll(e,t)&&Ll(t,e)&&function(r,u){var h=r,g=!1,C=(r.x+u.x)/2,O=(r.y+u.y)/2;do h.y>O!=h.next.y>O&&h.next.y!==h.y&&C<(h.next.x-h.x)*(O-h.y)/(h.next.y-h.y)+h.x&&(g=!g),h=h.next;while(h!==r);return g}(e,t)&&(mo(e.prev,e,t.prev)||mo(e,t.prev,t))||tc(e,t)&&mo(e.prev,e,e.next)>0&&mo(t.prev,t,t.next)>0)}function mo(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function tc(e,t){return e.x===t.x&&e.y===t.y}function Of(e,t,r,u){var h=au(mo(e,t,r)),g=au(mo(e,t,u)),C=au(mo(r,u,e)),O=au(mo(r,u,t));return h!==g&&C!==O||!(h!==0||!Kc(e,r,t))||!(g!==0||!Kc(e,u,t))||!(C!==0||!Kc(r,e,u))||!(O!==0||!Kc(r,t,u))}function Kc(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function au(e){return e>0?1:e<0?-1:0}function Ll(e,t){return mo(e.prev,e,e.next)<0?mo(e,t,e.next)>=0&&mo(e,e.prev,t)>=0:mo(e,t,e.prev)<0||mo(e,e.next,t)<0}function Lf(e,t){var r=new pf(e.i,e.x,e.y),u=new pf(t.i,t.x,t.y),h=e.next,g=t.prev;return e.next=t,t.prev=e,r.next=h,h.prev=r,u.next=r,r.prev=u,g.next=u,u.prev=g,u}function Rf(e,t,r,u){var h=new pf(e,t,r);return u?(h.next=u.next,h.prev=u,u.next.prev=h,u.next=h):(h.prev=h,h.next=h),h}function Oc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function pf(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function $c(e,t,r,u){for(var h=0,g=t,C=r-u;g<r;g+=u)h+=(e[C]-e[g])*(e[g+1]+e[C+1]),C=g;return h}function Rl(e,t,r,u,h){(function g(C,O,G,Q,ve){for(;Q>G;){if(Q-G>600){var Ae=Q-G+1,_e=O-G+1,it=Math.log(Ae),_t=.5*Math.exp(2*it/3),Tt=.5*Math.sqrt(it*_t*(Ae-_t)/Ae)*(_e-Ae/2<0?-1:1);g(C,O,Math.max(G,Math.floor(O-_e*_t/Ae+Tt)),Math.min(Q,Math.floor(O+(Ae-_e)*_t/Ae+Tt)),ve)}var Xt=C[O],Zt=G,ir=Q;for(ee(C,G,O),ve(C[Q],Xt)>0&&ee(C,G,Q);Zt<ir;){for(ee(C,Zt,ir),Zt++,ir--;ve(C[Zt],Xt)<0;)Zt++;for(;ve(C[ir],Xt)>0;)ir--}ve(C[G],Xt)===0?ee(C,G,ir):ee(C,++ir,Q),ir<=O&&(G=ir+1),O<=ir&&(Q=ir-1)}})(e,t,r||0,u||e.length-1,h||ie)}function ee(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}function ie(e,t){return e<t?-1:e>t?1:0}function D(e,t){var r=e.length;if(r<=1)return[e];for(var u,h,g=[],C=0;C<r;C++){var O=Wt(e[C]);O!==0&&(e[C].area=Math.abs(O),h===void 0&&(h=O<0),h===O<0?(u&&g.push(u),u=[e[C]]):u.push(e[C]))}if(u&&g.push(u),t>1)for(var G=0;G<g.length;G++)g[G].length<=t||(Rl(g[G],t,1,g[G].length-1,U),g[G]=g[G].slice(0,t));return g}function U(e,t){return t.area-e.area}function Se(e,t,r){for(var u=r.patternDependencies,h=!1,g=0,C=t;g<C.length;g+=1){var O=C[g].paint.get(e+"-pattern");O.isConstant()||(h=!0);var G=O.constantOr(null);G&&(h=!0,u[G.to]=!0,u[G.from]=!0)}return h}function tt(e,t,r,u,h){for(var g=h.patternDependencies,C=0,O=t;C<O.length;C+=1){var G=O[C],Q=G.paint.get(e+"-pattern").value;if(Q.kind!=="constant"){var ve=Q.evaluate({zoom:u-1},r,{},h.availableImages),Ae=Q.evaluate({zoom:u},r,{},h.availableImages),_e=Q.evaluate({zoom:u+1},r,{},h.availableImages);Ae=Ae&&Ae.name?Ae.name:Ae,_e=_e&&_e.name?_e.name:_e,g[ve=ve&&ve.name?ve.name:ve]=!0,g[Ae]=!0,g[_e]=!0,r.patterns[G.id]={min:ve,mid:Ae,max:_e}}}return r}df.deviation=function(e,t,r,u){var h=t&&t.length,g=Math.abs($c(e,0,h?t[0]*r:e.length,r));if(h)for(var C=0,O=t.length;C<O;C++)g-=Math.abs($c(e,t[C]*r,C<O-1?t[C+1]*r:e.length,r));var G=0;for(C=0;C<u.length;C+=3){var Q=u[C]*r,ve=u[C+1]*r,Ae=u[C+2]*r;G+=Math.abs((e[Q]-e[Ae])*(e[ve+1]-e[Q+1])-(e[Q]-e[ve])*(e[Ae+1]-e[Q+1]))}return g===0&&G===0?0:Math.abs((G-g)/g)},df.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},u=0,h=0;h<e.length;h++){for(var g=0;g<e[h].length;g++)for(var C=0;C<t;C++)r.vertices.push(e[h][g][C]);h>0&&r.holes.push(u+=e[h-1].length)}return r},xl.default=Mf;var Ut=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new dl,this.indexArray=new _l,this.indexArray2=new pl,this.programConfigurations=new Ni(t.layers,t.zoom),this.segments=new Ke,this.segments2=new Ke,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Ut.prototype.populate=function(e,t,r){this.hasPattern=Se("fill",this.layers,t);for(var u=this.layers[0].layout.get("fill-sort-key"),h=[],g=0,C=e;g<C.length;g+=1){var O=C[g],G=O.feature,Q=O.id,ve=O.index,Ae=O.sourceLayerIndex,_e=this.layers[0]._featureFilter.needGeometry,it=Ja(G,_e);if(this.layers[0]._featureFilter.filter(new Ti(this.zoom),it,r)){var _t=u?u.evaluate(it,{},r,t.availableImages):void 0,Tt={id:Q,properties:G.properties,type:G.type,sourceLayerIndex:Ae,index:ve,geometry:_e?it.geometry:_a(G),patterns:{},sortKey:_t};h.push(Tt)}}u&&h.sort(function(vn,hn){return vn.sortKey-hn.sortKey});for(var Xt=0,Zt=h;Xt<Zt.length;Xt+=1){var ir=Zt[Xt],hr=ir.geometry,Er=ir.index,kr=ir.sourceLayerIndex;if(this.hasPattern){var Nr=tt("fill",this.layers,ir,this.zoom,t);this.patternFeatures.push(Nr)}else this.addFeature(ir,hr,Er,r,{});t.featureIndex.insert(e[Er].feature,hr,Er,kr,this.index)}},Ut.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Ut.prototype.addFeatures=function(e,t,r){for(var u=0,h=this.patternFeatures;u<h.length;u+=1){var g=h[u];this.addFeature(g,g.geometry,g.index,t,r)}},Ut.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ut.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ut.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,lh),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Ut.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ut.prototype.addFeature=function(e,t,r,u,h){for(var g=0,C=D(t,500);g<C.length;g+=1){for(var O=C[g],G=0,Q=0,ve=O;Q<ve.length;Q+=1)G+=ve[Q].length;for(var Ae=this.segments.prepareSegment(G,this.layoutVertexArray,this.indexArray),_e=Ae.vertexLength,it=[],_t=[],Tt=0,Xt=O;Tt<Xt.length;Tt+=1){var Zt=Xt[Tt];if(Zt.length!==0){Zt!==O[0]&&_t.push(it.length/2);var ir=this.segments2.prepareSegment(Zt.length,this.layoutVertexArray,this.indexArray2),hr=ir.vertexLength;this.layoutVertexArray.emplaceBack(Zt[0].x,Zt[0].y),this.indexArray2.emplaceBack(hr+Zt.length-1,hr),it.push(Zt[0].x),it.push(Zt[0].y);for(var Er=1;Er<Zt.length;Er++)this.layoutVertexArray.emplaceBack(Zt[Er].x,Zt[Er].y),this.indexArray2.emplaceBack(hr+Er-1,hr+Er),it.push(Zt[Er].x),it.push(Zt[Er].y);ir.vertexLength+=Zt.length,ir.primitiveLength+=Zt.length}}for(var kr=xl(it,_t),Nr=0;Nr<kr.length;Nr+=3)this.indexArray.emplaceBack(_e+kr[Nr],_e+kr[Nr+1],_e+kr[Nr+2]);Ae.vertexLength+=G,Ae.primitiveLength+=kr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,h,u)},Mn("FillBucket",Ut,{omit:["layers","patternFeatures"]});var qt=new No({"fill-sort-key":new Bn(Re.layout_fill["fill-sort-key"])}),er={paint:new No({"fill-antialias":new Jn(Re.paint_fill["fill-antialias"]),"fill-opacity":new Bn(Re.paint_fill["fill-opacity"]),"fill-color":new Bn(Re.paint_fill["fill-color"]),"fill-outline-color":new Bn(Re.paint_fill["fill-outline-color"]),"fill-translate":new Jn(Re.paint_fill["fill-translate"]),"fill-translate-anchor":new Jn(Re.paint_fill["fill-translate-anchor"]),"fill-pattern":new Pl(Re.paint_fill["fill-pattern"])}),layout:qt},_r=function(e){function t(r){e.call(this,r,er)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u);var h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new Ut(r)},t.prototype.queryRadius=function(){return Eo(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,u,h,g,C,O,G){return Ss(gl(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),O.angle,G),g)},t.prototype.isTileClipped=function(){return!0},t}(nu),en=po([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Rn=$n;function $n(e,t,r,u,h){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=u,this._values=h,e.readFields(ri,this,t)}function ri(e,t,r){e==1?t.id=r.readVarint():e==2?function(u,h){for(var g=u.readVarint()+u.pos;u.pos<g;){var C=h._keys[u.readVarint()],O=h._values[u.readVarint()];h.properties[C]=O}}(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function Mi(e){for(var t,r,u=0,h=0,g=e.length,C=g-1;h<g;C=h++)u+=((r=e[C]).x-(t=e[h]).x)*(t.y+r.y);return u}$n.types=["Unknown","Point","LineString","Polygon"],$n.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,u=1,h=0,g=0,C=0,O=[];e.pos<r;){if(h<=0){var G=e.readVarint();u=7&G,h=G>>3}if(h--,u===1||u===2)g+=e.readSVarint(),C+=e.readSVarint(),u===1&&(t&&O.push(t),t=[]),t.push(new q(g,C));else{if(u!==7)throw new Error("unknown command "+u);t&&t.push(t[0].clone())}}return t&&O.push(t),O},$n.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,u=0,h=0,g=0,C=1/0,O=-1/0,G=1/0,Q=-1/0;e.pos<t;){if(u<=0){var ve=e.readVarint();r=7&ve,u=ve>>3}if(u--,r===1||r===2)(h+=e.readSVarint())<C&&(C=h),h>O&&(O=h),(g+=e.readSVarint())<G&&(G=g),g>Q&&(Q=g);else if(r!==7)throw new Error("unknown command "+r)}return[C,G,O,Q]},$n.prototype.toGeoJSON=function(e,t,r){var u,h,g=this.extent*Math.pow(2,r),C=this.extent*e,O=this.extent*t,G=this.loadGeometry(),Q=$n.types[this.type];function ve(it){for(var _t=0;_t<it.length;_t++){var Tt=it[_t];it[_t]=[360*(Tt.x+C)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(Tt.y+O)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var Ae=[];for(u=0;u<G.length;u++)Ae[u]=G[u][0];ve(G=Ae);break;case 2:for(u=0;u<G.length;u++)ve(G[u]);break;case 3:for(G=function(it){var _t=it.length;if(_t<=1)return[it];for(var Tt,Xt,Zt=[],ir=0;ir<_t;ir++){var hr=Mi(it[ir]);hr!==0&&(Xt===void 0&&(Xt=hr<0),Xt===hr<0?(Tt&&Zt.push(Tt),Tt=[it[ir]]):Tt.push(it[ir]))}return Tt&&Zt.push(Tt),Zt}(G),u=0;u<G.length;u++)for(h=0;h<G[u].length;h++)ve(G[u][h])}G.length===1?G=G[0]:Q="Multi"+Q;var _e={type:"Feature",geometry:{type:Q,coordinates:G},properties:this.properties};return"id"in this&&(_e.id=this.id),_e};var Ri=fa;function fa(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(ua,this,t),this.length=this._features.length}function ua(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(function(u){for(var h=null,g=u.readVarint()+u.pos;u.pos<g;){var C=u.readVarint()>>3;h=C===1?u.readString():C===2?u.readFloat():C===3?u.readDouble():C===4?u.readVarint64():C===5?u.readVarint():C===6?u.readSVarint():C===7?u.readBoolean():null}return h}(r))}function Na(e,t,r){if(e===3){var u=new Ri(r,r.readVarint()+r.pos);u.length&&(t[u.name]=u)}}fa.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Rn(this._pbf,t,this.extent,this._keys,this._values)};var go={VectorTile:function(t,r){this.layers=t.readFields(Na,{},r)},VectorTileFeature:Rn,VectorTileLayer:Ri},ao=go.VectorTileFeature.types,Va=Math.pow(2,13);function Co(e,t,r,u,h,g,C,O){e.emplaceBack(t,r,2*Math.floor(u*Va)+C,h*Va*2,g*Va*2,Math.round(O))}var Xi=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new zu,this.indexArray=new _l,this.programConfigurations=new Ni(t.layers,t.zoom),this.segments=new Ke,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function Qa(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Xi.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=Se("fill-extrusion",this.layers,t);for(var u=0,h=e;u<h.length;u+=1){var g=h[u],C=g.feature,O=g.id,G=g.index,Q=g.sourceLayerIndex,ve=this.layers[0]._featureFilter.needGeometry,Ae=Ja(C,ve);if(this.layers[0]._featureFilter.filter(new Ti(this.zoom),Ae,r)){var _e={id:O,sourceLayerIndex:Q,index:G,geometry:ve?Ae.geometry:_a(C),properties:C.properties,type:C.type,patterns:{}};this.hasPattern?this.features.push(tt("fill-extrusion",this.layers,_e,this.zoom,t)):this.addFeature(_e,_e.geometry,G,r,{}),t.featureIndex.insert(C,_e.geometry,G,Q,this.index,!0)}}},Xi.prototype.addFeatures=function(e,t,r){for(var u=0,h=this.features;u<h.length;u+=1){var g=h[u];this.addFeature(g,g.geometry,g.index,t,r)}},Xi.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Xi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Xi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Xi.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,en),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Xi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Xi.prototype.addFeature=function(e,t,r,u,h){for(var g=0,C=D(t,500);g<C.length;g+=1){for(var O=C[g],G=0,Q=0,ve=O;Q<ve.length;Q+=1)G+=ve[Q].length;for(var Ae=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),_e=0,it=O;_e<it.length;_e+=1){var _t=it[_e];if(_t.length!==0&&!((aa=_t).every(function(Vi){return Vi.x<0})||aa.every(function(Vi){return Vi.x>8192})||aa.every(function(Vi){return Vi.y<0})||aa.every(function(Vi){return Vi.y>8192})))for(var Tt=0,Xt=0;Xt<_t.length;Xt++){var Zt=_t[Xt];if(Xt>=1){var ir=_t[Xt-1];if(!Qa(Zt,ir)){Ae.vertexLength+4>Ke.MAX_VERTEX_ARRAY_LENGTH&&(Ae=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var hr=Zt.sub(ir)._perp()._unit(),Er=ir.dist(Zt);Tt+Er>32768&&(Tt=0),Co(this.layoutVertexArray,Zt.x,Zt.y,hr.x,hr.y,0,0,Tt),Co(this.layoutVertexArray,Zt.x,Zt.y,hr.x,hr.y,0,1,Tt),Co(this.layoutVertexArray,ir.x,ir.y,hr.x,hr.y,0,0,Tt+=Er),Co(this.layoutVertexArray,ir.x,ir.y,hr.x,hr.y,0,1,Tt);var kr=Ae.vertexLength;this.indexArray.emplaceBack(kr,kr+2,kr+1),this.indexArray.emplaceBack(kr+1,kr+2,kr+3),Ae.vertexLength+=4,Ae.primitiveLength+=2}}}}if(Ae.vertexLength+G>Ke.MAX_VERTEX_ARRAY_LENGTH&&(Ae=this.segments.prepareSegment(G,this.layoutVertexArray,this.indexArray)),ao[e.type]==="Polygon"){for(var Nr=[],vn=[],hn=Ae.vertexLength,Ln=0,qn=O;Ln<qn.length;Ln+=1){var Kn=qn[Ln];if(Kn.length!==0){Kn!==O[0]&&vn.push(Nr.length/2);for(var Fn=0;Fn<Kn.length;Fn++){var wi=Kn[Fn];Co(this.layoutVertexArray,wi.x,wi.y,0,0,1,1,0),Nr.push(wi.x),Nr.push(wi.y)}}}for(var li=xl(Nr,vn),ti=0;ti<li.length;ti+=3)this.indexArray.emplaceBack(hn+li[ti],hn+li[ti+2],hn+li[ti+1]);Ae.primitiveLength+=li.length/3,Ae.vertexLength+=G}}var aa;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,h,u)},Mn("FillExtrusionBucket",Xi,{omit:["layers","features"]});var ls={paint:new No({"fill-extrusion-opacity":new Jn(Re["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Bn(Re["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Jn(Re["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Jn(Re["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Pl(Re["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Bn(Re["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Bn(Re["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Jn(Re["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Sa=function(e){function t(r){e.call(this,r,ls)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Xi(r)},t.prototype.queryRadius=function(){return Eo(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,u,h,g,C,O,G,Q){var ve=gl(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),O.angle,G),Ae=this.paint.get("fill-extrusion-height").evaluate(u,h),_e=this.paint.get("fill-extrusion-base").evaluate(u,h),it=function(Tt,Xt,Zt,ir){for(var hr=[],Er=0,kr=Tt;Er<kr.length;Er+=1){var Nr=kr[Er],vn=[Nr.x,Nr.y,0,1];ts(vn,vn,Xt),hr.push(new q(vn[0]/vn[3],vn[1]/vn[3]))}return hr}(ve,Q),_t=function(Tt,Xt,Zt,ir){for(var hr=[],Er=[],kr=ir[8]*Xt,Nr=ir[9]*Xt,vn=ir[10]*Xt,hn=ir[11]*Xt,Ln=ir[8]*Zt,qn=ir[9]*Zt,Kn=ir[10]*Zt,Fn=ir[11]*Zt,wi=0,li=Tt;wi<li.length;wi+=1){for(var ti=[],aa=[],Vi=0,Za=li[wi];Vi<Za.length;Vi+=1){var yi=Za[Vi],ha=yi.x,Ko=yi.y,Ca=ir[0]*ha+ir[4]*Ko+ir[12],$o=ir[1]*ha+ir[5]*Ko+ir[13],Jo=ir[2]*ha+ir[6]*Ko+ir[14],hs=ir[3]*ha+ir[7]*Ko+ir[15],Su=Jo+vn,ds=hs+hn,il=Ca+Ln,uu=$o+qn,al=Jo+Kn,lu=hs+Fn,Xs=new q((Ca+kr)/ds,($o+Nr)/ds);Xs.z=Su/ds,ti.push(Xs);var cu=new q(il/lu,uu/lu);cu.z=al/lu,aa.push(cu)}hr.push(ti),Er.push(aa)}return[hr,Er]}(g,_e,Ae,Q);return function(Tt,Xt,Zt){var ir=1/0;Ss(Zt,Xt)&&(ir=gi(Zt,Xt[0]));for(var hr=0;hr<Xt.length;hr++)for(var Er=Xt[hr],kr=Tt[hr],Nr=0;Nr<Er.length-1;Nr++){var vn=Er[Nr],hn=[vn,Er[Nr+1],kr[Nr+1],kr[Nr],vn];yu(Zt,hn)&&(ir=Math.min(ir,gi(Zt,hn)))}return ir!==1/0&&ir}(_t[0],_t[1],it)},t}(nu);function Ma(e,t){return e.x*t.x+e.y*t.y}function gi(e,t){if(e.length===1){for(var r,u=0,h=t[u++];!r||h.equals(r);)if(!(r=t[u++]))return 1/0;for(;u<t.length;u++){var g=t[u],C=e[0],O=r.sub(h),G=g.sub(h),Q=C.sub(h),ve=Ma(O,O),Ae=Ma(O,G),_e=Ma(G,G),it=Ma(Q,O),_t=Ma(Q,G),Tt=ve*_e-Ae*Ae,Xt=(_e*it-Ae*_t)/Tt,Zt=(ve*_t-Ae*it)/Tt,ir=h.z*(1-Xt-Zt)+r.z*Xt+g.z*Zt;if(isFinite(ir))return ir}return 1/0}for(var hr=1/0,Er=0,kr=t;Er<kr.length;Er+=1)hr=Math.min(hr,kr[Er].z);return hr}var Bo=po([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,gc=po([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,$f=go.VectorTileFeature.types,vh=Math.cos(Math.PI/180*37.5),Jf=Math.pow(2,14)/.5,ju=function(t){var r=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){r.gradients[u.id]={}}),this.layoutVertexArray=new Is,this.layoutVertexArray2=new Yl,this.indexArray=new _l,this.programConfigurations=new Ni(t.layers,t.zoom),this.segments=new Ke,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};ju.prototype.populate=function(e,t,r){this.hasPattern=Se("line",this.layers,t);for(var u=this.layers[0].layout.get("line-sort-key"),h=[],g=0,C=e;g<C.length;g+=1){var O=C[g],G=O.feature,Q=O.id,ve=O.index,Ae=O.sourceLayerIndex,_e=this.layers[0]._featureFilter.needGeometry,it=Ja(G,_e);if(this.layers[0]._featureFilter.filter(new Ti(this.zoom),it,r)){var _t=u?u.evaluate(it,{},r):void 0,Tt={id:Q,properties:G.properties,type:G.type,sourceLayerIndex:Ae,index:ve,geometry:_e?it.geometry:_a(G),patterns:{},sortKey:_t};h.push(Tt)}}u&&h.sort(function(vn,hn){return vn.sortKey-hn.sortKey});for(var Xt=0,Zt=h;Xt<Zt.length;Xt+=1){var ir=Zt[Xt],hr=ir.geometry,Er=ir.index,kr=ir.sourceLayerIndex;if(this.hasPattern){var Nr=tt("line",this.layers,ir,this.zoom,t);this.patternFeatures.push(Nr)}else this.addFeature(ir,hr,Er,r,{});t.featureIndex.insert(e[Er].feature,hr,Er,kr,this.index)}},ju.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},ju.prototype.addFeatures=function(e,t,r){for(var u=0,h=this.patternFeatures;u<h.length;u+=1){var g=h[u];this.addFeature(g,g.geometry,g.index,t,r)}},ju.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ju.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ju.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,gc)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Bo),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},ju.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ju.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},ju.prototype.addFeature=function(e,t,r,u,h){var g=this.layers[0].layout,C=g.get("line-join").evaluate(e,{}),O=g.get("line-cap"),G=g.get("line-miter-limit"),Q=g.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var ve=0,Ae=t;ve<Ae.length;ve+=1)this.addLine(Ae[ve],e,C,O,G,Q);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,h,u)},ju.prototype.addLine=function(e,t,r,u,h,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var C=0;C<e.length-1;C++)this.totalDistance+=e[C].dist(e[C+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var O=$f[t.type]==="Polygon",G=e.length;G>=2&&e[G-1].equals(e[G-2]);)G--;for(var Q=0;Q<G-1&&e[Q].equals(e[Q+1]);)Q++;if(!(G<(O?3:2))){r==="bevel"&&(h=1.05);var ve,Ae=this.overscaling<=16?122880/(512*this.overscaling):0,_e=this.segments.prepareSegment(10*G,this.layoutVertexArray,this.indexArray),it=void 0,_t=void 0,Tt=void 0,Xt=void 0;this.e1=this.e2=-1,O&&(Xt=e[Q].sub(ve=e[G-2])._unit()._perp());for(var Zt=Q;Zt<G;Zt++)if(!(_t=Zt===G-1?O?e[Q+1]:void 0:e[Zt+1])||!e[Zt].equals(_t)){Xt&&(Tt=Xt),ve&&(it=ve),ve=e[Zt],Xt=_t?_t.sub(ve)._unit()._perp():Tt;var ir=(Tt=Tt||Xt).add(Xt);ir.x===0&&ir.y===0||ir._unit();var hr=Tt.x*Xt.x+Tt.y*Xt.y,Er=ir.x*Xt.x+ir.y*Xt.y,kr=Er!==0?1/Er:1/0,Nr=2*Math.sqrt(2-2*Er),vn=Er<vh&&it&&_t,hn=Tt.x*Xt.y-Tt.y*Xt.x>0;if(vn&&Zt>Q){var Ln=ve.dist(it);if(Ln>2*Ae){var qn=ve.sub(ve.sub(it)._mult(Ae/Ln)._round());this.updateDistance(it,qn),this.addCurrentVertex(qn,Tt,0,0,_e),it=qn}}var Kn=it&&_t,Fn=Kn?r:O?"butt":u;if(Kn&&Fn==="round"&&(kr<g?Fn="miter":kr<=2&&(Fn="fakeround")),Fn==="miter"&&kr>h&&(Fn="bevel"),Fn==="bevel"&&(kr>2&&(Fn="flipbevel"),kr<h&&(Fn="miter")),it&&this.updateDistance(it,ve),Fn==="miter")ir._mult(kr),this.addCurrentVertex(ve,ir,0,0,_e);else if(Fn==="flipbevel"){if(kr>100)ir=Xt.mult(-1);else{var wi=kr*Tt.add(Xt).mag()/Tt.sub(Xt).mag();ir._perp()._mult(wi*(hn?-1:1))}this.addCurrentVertex(ve,ir,0,0,_e),this.addCurrentVertex(ve,ir.mult(-1),0,0,_e)}else if(Fn==="bevel"||Fn==="fakeround"){var li=-Math.sqrt(kr*kr-1),ti=hn?li:0,aa=hn?0:li;if(it&&this.addCurrentVertex(ve,Tt,ti,aa,_e),Fn==="fakeround")for(var Vi=Math.round(180*Nr/Math.PI/20),Za=1;Za<Vi;Za++){var yi=Za/Vi;if(yi!==.5){var ha=yi-.5;yi+=yi*ha*(yi-1)*((1.0904+hr*(hr*(3.55645-1.43519*hr)-3.2452))*ha*ha+(.848013+hr*(.215638*hr-1.06021)))}var Ko=Xt.sub(Tt)._mult(yi)._add(Tt)._unit()._mult(hn?-1:1);this.addHalfVertex(ve,Ko.x,Ko.y,!1,hn,0,_e)}_t&&this.addCurrentVertex(ve,Xt,-ti,-aa,_e)}else if(Fn==="butt")this.addCurrentVertex(ve,ir,0,0,_e);else if(Fn==="square"){var Ca=it?1:-1;this.addCurrentVertex(ve,ir,Ca,Ca,_e)}else Fn==="round"&&(it&&(this.addCurrentVertex(ve,Tt,0,0,_e),this.addCurrentVertex(ve,Tt,1,1,_e,!0)),_t&&(this.addCurrentVertex(ve,Xt,-1,-1,_e,!0),this.addCurrentVertex(ve,Xt,0,0,_e)));if(vn&&Zt<G-1){var $o=ve.dist(_t);if($o>2*Ae){var Jo=ve.add(_t.sub(ve)._mult(Ae/$o)._round());this.updateDistance(ve,Jo),this.addCurrentVertex(Jo,Xt,0,0,_e),ve=Jo}}}}},ju.prototype.addCurrentVertex=function(e,t,r,u,h,g){g===void 0&&(g=!1);var C=t.y*u-t.x,O=-t.y-t.x*u;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,g,!1,r,h),this.addHalfVertex(e,C,O,g,!0,-u,h),this.distance>Jf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,u,h,g))},ju.prototype.addHalfVertex=function(e,t,r,u,h,g,C){var O=.5*(this.lineClips?this.scaledDistance*(Jf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(u?1:0),(e.y<<1)+(h?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(g===0?0:g<0?-1:1)|(63&O)<<2,O>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var G=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,G),C.primitiveLength++),h?this.e2=G:this.e1=G},ju.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},ju.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},Mn("LineBucket",ju,{omit:["layers","patternFeatures"]});var Qf=new No({"line-cap":new Jn(Re.layout_line["line-cap"]),"line-join":new Bn(Re.layout_line["line-join"]),"line-miter-limit":new Jn(Re.layout_line["line-miter-limit"]),"line-round-limit":new Jn(Re.layout_line["line-round-limit"]),"line-sort-key":new Bn(Re.layout_line["line-sort-key"])}),vf={paint:new No({"line-opacity":new Bn(Re.paint_line["line-opacity"]),"line-color":new Bn(Re.paint_line["line-color"]),"line-translate":new Jn(Re.paint_line["line-translate"]),"line-translate-anchor":new Jn(Re.paint_line["line-translate-anchor"]),"line-width":new Bn(Re.paint_line["line-width"]),"line-gap-width":new Bn(Re.paint_line["line-gap-width"]),"line-offset":new Bn(Re.paint_line["line-offset"]),"line-blur":new Bn(Re.paint_line["line-blur"]),"line-dasharray":new xs(Re.paint_line["line-dasharray"]),"line-pattern":new Pl(Re.paint_line["line-pattern"]),"line-gradient":new Wo(Re.paint_line["line-gradient"])}),layout:Qf},qf=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u){return u=new Ti(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),e.prototype.possiblyEvaluate.call(this,r,u)},t.prototype.evaluate=function(r,u,h,g){return u=Me({},u,{zoom:Math.floor(u.zoom)}),e.prototype.evaluate.call(this,r,u,h,g)},t}(Bn))(vf.paint.properties["line-width"].specification);qf.useIntegerZoom=!0;var Ph=function(e){function t(r){e.call(this,r,vf),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof wa,this.gradientVersion=(this.gradientVersion+1)%He)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u),this.paint._values["line-floorwidth"]=qf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new ju(r)},t.prototype.queryRadius=function(r){var u=r,h=mh(bu("line-width",this,u),bu("line-gap-width",this,u)),g=bu("line-offset",this,u);return h/2+Math.abs(g)+Eo(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,u,h,g,C,O,G){var Q=gl(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),O.angle,G),ve=G/2*mh(this.paint.get("line-width").evaluate(u,h),this.paint.get("line-gap-width").evaluate(u,h)),Ae=this.paint.get("line-offset").evaluate(u,h);return Ae&&(g=function(_e,it){for(var _t=[],Tt=new q(0,0),Xt=0;Xt<_e.length;Xt++){for(var Zt=_e[Xt],ir=[],hr=0;hr<Zt.length;hr++){var Er=Zt[hr],kr=Zt[hr+1],Nr=hr===0?Tt:Er.sub(Zt[hr-1])._unit()._perp(),vn=hr===Zt.length-1?Tt:kr.sub(Er)._unit()._perp(),hn=Nr._add(vn)._unit();hn._mult(1/(hn.x*vn.x+hn.y*vn.y)),ir.push(hn._mult(it)._add(Er))}_t.push(ir)}return _t}(g,Ae*G)),function(_e,it,_t){for(var Tt=0;Tt<it.length;Tt++){var Xt=it[Tt];if(_e.length>=3){for(var Zt=0;Zt<Xt.length;Zt++)if(iu(_e,Xt[Zt]))return!0}if(Bs(_e,Xt,_t))return!0}return!1}(Q,g,ve)},t.prototype.isTileClipped=function(){return!0},t}(nu);function mh(e,t){return t>0?t+2*e:e}var Df=po([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),fh=po([{name:"a_projected_pos",components:3,type:"Float32"}],4),eh=(po([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),po([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),gh=(po([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),po([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),jh=po([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function kf(e,t,r){return e.sections.forEach(function(u){u.text=function(h,g,C){var O=g.layout.get("text-transform").evaluate(C,{});return O==="uppercase"?h=h.toLocaleUpperCase():O==="lowercase"&&(h=h.toLocaleLowerCase()),us.applyArabicShaping&&(h=us.applyArabicShaping(h)),h}(u.text,t,r)}),e}po([{name:"triangle",components:3,type:"Uint16"}]),po([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),po([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),po([{type:"Float32",name:"offsetX"}]),po([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var jf={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},_h=function(t,r,u,h,g){var C,O,G=8*g-h-1,Q=(1<<G)-1,ve=Q>>1,Ae=-7,_e=u?g-1:0,it=u?-1:1,_t=t[r+_e];for(_e+=it,C=_t&(1<<-Ae)-1,_t>>=-Ae,Ae+=G;Ae>0;C=256*C+t[r+_e],_e+=it,Ae-=8);for(O=C&(1<<-Ae)-1,C>>=-Ae,Ae+=h;Ae>0;O=256*O+t[r+_e],_e+=it,Ae-=8);if(C===0)C=1-ve;else{if(C===Q)return O?NaN:1/0*(_t?-1:1);O+=Math.pow(2,h),C-=ve}return(_t?-1:1)*O*Math.pow(2,C-h)},xe=function(t,r,u,h,g,C){var O,G,Q,ve=8*C-g-1,Ae=(1<<ve)-1,_e=Ae>>1,it=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,_t=h?0:C-1,Tt=h?1:-1,Xt=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(G=isNaN(r)?1:0,O=Ae):(O=Math.floor(Math.log(r)/Math.LN2),r*(Q=Math.pow(2,-O))<1&&(O--,Q*=2),(r+=O+_e>=1?it/Q:it*Math.pow(2,1-_e))*Q>=2&&(O++,Q/=2),O+_e>=Ae?(G=0,O=Ae):O+_e>=1?(G=(r*Q-1)*Math.pow(2,g),O+=_e):(G=r*Math.pow(2,_e-1)*Math.pow(2,g),O=0));g>=8;t[u+_t]=255&G,_t+=Tt,G/=256,g-=8);for(O=O<<g|G,ve+=g;ve>0;t[u+_t]=255&O,_t+=Tt,O/=256,ve-=8);t[u+_t-Tt]|=128*Xt},Fe=At;function At(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}At.Varint=0,At.Fixed64=1,At.Bytes=2,At.Fixed32=5;var xr=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Rr(e){return e.type===At.Bytes?e.readVarint()+e.pos:e.pos+1}function Pr(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function br(e,t,r){var u=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(u);for(var h=r.pos-1;h>=e;h--)r.buf[h+u]=r.buf[h]}function Yr(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function tn(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function on(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function rn(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function cn(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function Pn(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function mn(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function un(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function Sr(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function gr(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Kr(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function On(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Dr(e,t,r){e===1&&r.readMessage(Qn,t)}function Qn(e,t,r){if(e===3){var u=r.readMessage(qr,{}),h=u.width,g=u.height,C=u.left,O=u.top,G=u.advance;t.push({id:u.id,bitmap:new Hs({width:h+6,height:g+6},u.bitmap),metrics:{width:h,height:g,left:C,top:O,advance:G}})}}function qr(e,t,r){e===1?t.id=r.readVarint():e===2?t.bitmap=r.readBytes():e===3?t.width=r.readVarint():e===4?t.height=r.readVarint():e===5?t.left=r.readSVarint():e===6?t.top=r.readSVarint():e===7&&(t.advance=r.readVarint())}function Gr(e){for(var t=0,r=0,u=0,h=e;u<h.length;u+=1){var g=h[u];t+=g.w*g.h,r=Math.max(r,g.w)}e.sort(function(Tt,Xt){return Xt.h-Tt.h});for(var C=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],O=0,G=0,Q=0,ve=e;Q<ve.length;Q+=1)for(var Ae=ve[Q],_e=C.length-1;_e>=0;_e--){var it=C[_e];if(!(Ae.w>it.w||Ae.h>it.h)){if(Ae.x=it.x,Ae.y=it.y,G=Math.max(G,Ae.y+Ae.h),O=Math.max(O,Ae.x+Ae.w),Ae.w===it.w&&Ae.h===it.h){var _t=C.pop();_e<C.length&&(C[_e]=_t)}else Ae.h===it.h?(it.x+=Ae.w,it.w-=Ae.w):Ae.w===it.w?(it.y+=Ae.h,it.h-=Ae.h):(C.push({x:it.x+Ae.w,y:it.y,w:it.w-Ae.w,h:Ae.h}),it.y+=Ae.h,it.h-=Ae.h);break}}return{w:O,h:G,fill:t/(O*G)||0}}At.prototype={destroy:function(){this.buf=null},readFields:function(t,r,u){for(u=u||this.length;this.pos<u;){var h=this.readVarint(),g=h>>3,C=this.pos;this.type=7&h,t(g,r,this),this.pos===C&&this.skip(h)}return r},readMessage:function(t,r){return this.readFields(t,r,this.readVarint()+this.pos)},readFixed32:function(){var t=gr(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=On(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=gr(this.buf,this.pos)+4294967296*gr(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=gr(this.buf,this.pos)+4294967296*On(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=_h(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=_h(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var r,u,h=this.buf;return r=127&(u=h[this.pos++]),u<128?r:(r|=(127&(u=h[this.pos++]))<<7,u<128?r:(r|=(127&(u=h[this.pos++]))<<14,u<128?r:(r|=(127&(u=h[this.pos++]))<<21,u<128?r:function(g,C,O){var G,Q,ve=O.buf;if(G=(112&(Q=ve[O.pos++]))>>4,Q<128||(G|=(127&(Q=ve[O.pos++]))<<3,Q<128)||(G|=(127&(Q=ve[O.pos++]))<<10,Q<128)||(G|=(127&(Q=ve[O.pos++]))<<17,Q<128)||(G|=(127&(Q=ve[O.pos++]))<<24,Q<128)||(G|=(1&(Q=ve[O.pos++]))<<31,Q<128))return Pr(g,G,C);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(u=h[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=12&&xr?function(u,h,g){return xr.decode(u.subarray(h,g))}(this.buf,r,t):function(u,h,g){for(var C="",O=h;O<g;){var G,Q,ve,Ae=u[O],_e=null,it=Ae>239?4:Ae>223?3:Ae>191?2:1;if(O+it>g)break;it===1?Ae<128&&(_e=Ae):it===2?(192&(G=u[O+1]))==128&&(_e=(31&Ae)<<6|63&G)<=127&&(_e=null):it===3?(Q=u[O+2],(192&(G=u[O+1]))==128&&(192&Q)==128&&((_e=(15&Ae)<<12|(63&G)<<6|63&Q)<=2047||_e>=55296&&_e<=57343)&&(_e=null)):it===4&&(Q=u[O+2],ve=u[O+3],(192&(G=u[O+1]))==128&&(192&Q)==128&&(192&ve)==128&&((_e=(15&Ae)<<18|(63&G)<<12|(63&Q)<<6|63&ve)<=65535||_e>=1114112)&&(_e=null)),_e===null?(_e=65533,it=1):_e>65535&&(_e-=65536,C+=String.fromCharCode(_e>>>10&1023|55296),_e=56320|1023&_e),C+=String.fromCharCode(_e),O+=it}return C}(this.buf,r,t)},readBytes:function(){var t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);return this.pos=t,r},readPackedVarint:function(t,r){if(this.type!==At.Bytes)return t.push(this.readVarint(r));var u=Rr(this);for(t=t||[];this.pos<u;)t.push(this.readVarint(r));return t},readPackedSVarint:function(t){if(this.type!==At.Bytes)return t.push(this.readSVarint());var r=Rr(this);for(t=t||[];this.pos<r;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==At.Bytes)return t.push(this.readBoolean());var r=Rr(this);for(t=t||[];this.pos<r;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==At.Bytes)return t.push(this.readFloat());var r=Rr(this);for(t=t||[];this.pos<r;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==At.Bytes)return t.push(this.readDouble());var r=Rr(this);for(t=t||[];this.pos<r;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==At.Bytes)return t.push(this.readFixed32());var r=Rr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==At.Bytes)return t.push(this.readSFixed32());var r=Rr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==At.Bytes)return t.push(this.readFixed64());var r=Rr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==At.Bytes)return t.push(this.readSFixed64());var r=Rr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed64());return t},skip:function(t){var r=7&t;if(r===At.Varint)for(;this.buf[this.pos++]>127;);else if(r===At.Bytes)this.pos=this.readVarint()+this.pos;else if(r===At.Fixed32)this.pos+=4;else{if(r!==At.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(t,r){this.writeVarint(t<<3|r)},realloc:function(t){for(var r=this.length||16;r<this.pos+t;)r*=2;if(r!==this.length){var u=new Uint8Array(r);u.set(this.buf),this.buf=u,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Kr(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Kr(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Kr(this.buf,-1&t,this.pos),Kr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Kr(this.buf,-1&t,this.pos),Kr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(r,u){var h,g;if(r>=0?(h=r%4294967296|0,g=r/4294967296|0):(g=~(-r/4294967296),4294967295^(h=~(-r%4294967296))?h=h+1|0:(h=0,g=g+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(C,O,G){G.buf[G.pos++]=127&C|128,C>>>=7,G.buf[G.pos++]=127&C|128,C>>>=7,G.buf[G.pos++]=127&C|128,C>>>=7,G.buf[G.pos++]=127&C|128,G.buf[G.pos]=127&(C>>>=7)}(h,0,u),function(C,O){var G=(7&C)<<4;O.buf[O.pos++]|=G|((C>>>=3)?128:0),C&&(O.buf[O.pos++]=127&C|((C>>>=7)?128:0),C&&(O.buf[O.pos++]=127&C|((C>>>=7)?128:0),C&&(O.buf[O.pos++]=127&C|((C>>>=7)?128:0),C&&(O.buf[O.pos++]=127&C|((C>>>=7)?128:0),C&&(O.buf[O.pos++]=127&C)))))}(g,u)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var r=this.pos;this.pos=function(h,g,C){for(var O,G,Q=0;Q<g.length;Q++){if((O=g.charCodeAt(Q))>55295&&O<57344){if(!G){O>56319||Q+1===g.length?(h[C++]=239,h[C++]=191,h[C++]=189):G=O;continue}if(O<56320){h[C++]=239,h[C++]=191,h[C++]=189,G=O;continue}O=G-55296<<10|O-56320|65536,G=null}else G&&(h[C++]=239,h[C++]=191,h[C++]=189,G=null);O<128?h[C++]=O:(O<2048?h[C++]=O>>6|192:(O<65536?h[C++]=O>>12|224:(h[C++]=O>>18|240,h[C++]=O>>12&63|128),h[C++]=O>>6&63|128),h[C++]=63&O|128)}return C}(this.buf,t,this.pos);var u=this.pos-r;u>=128&&br(r,u,this),this.pos=r-1,this.writeVarint(u),this.pos+=u},writeFloat:function(t){this.realloc(4),xe(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),xe(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var r=t.length;this.writeVarint(r),this.realloc(r);for(var u=0;u<r;u++)this.buf[this.pos++]=t[u]},writeRawMessage:function(t,r){this.pos++;var u=this.pos;t(r,this);var h=this.pos-u;h>=128&&br(u,h,this),this.pos=u-1,this.writeVarint(h),this.pos+=h},writeMessage:function(t,r,u){this.writeTag(t,At.Bytes),this.writeRawMessage(r,u)},writePackedVarint:function(t,r){r.length&&this.writeMessage(t,Yr,r)},writePackedSVarint:function(t,r){r.length&&this.writeMessage(t,tn,r)},writePackedBoolean:function(t,r){r.length&&this.writeMessage(t,cn,r)},writePackedFloat:function(t,r){r.length&&this.writeMessage(t,on,r)},writePackedDouble:function(t,r){r.length&&this.writeMessage(t,rn,r)},writePackedFixed32:function(t,r){r.length&&this.writeMessage(t,Pn,r)},writePackedSFixed32:function(t,r){r.length&&this.writeMessage(t,mn,r)},writePackedFixed64:function(t,r){r.length&&this.writeMessage(t,un,r)},writePackedSFixed64:function(t,r){r.length&&this.writeMessage(t,Sr,r)},writeBytesField:function(t,r){this.writeTag(t,At.Bytes),this.writeBytes(r)},writeFixed32Field:function(t,r){this.writeTag(t,At.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(t,r){this.writeTag(t,At.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(t,r){this.writeTag(t,At.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(t,r){this.writeTag(t,At.Fixed64),this.writeSFixed64(r)},writeVarintField:function(t,r){this.writeTag(t,At.Varint),this.writeVarint(r)},writeSVarintField:function(t,r){this.writeTag(t,At.Varint),this.writeSVarint(r)},writeStringField:function(t,r){this.writeTag(t,At.Bytes),this.writeString(r)},writeFloatField:function(t,r){this.writeTag(t,At.Fixed32),this.writeFloat(r)},writeDoubleField:function(t,r){this.writeTag(t,At.Fixed64),this.writeDouble(r)},writeBooleanField:function(t,r){this.writeVarintField(t,Boolean(r))}};var Hr=function(t,r){var u=r.pixelRatio,h=r.version,g=r.stretchX,C=r.stretchY,O=r.content;this.paddedRect=t,this.pixelRatio=u,this.stretchX=g,this.stretchY=C,this.content=O,this.version=h},Qr={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Qr.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Qr.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Qr.tlbr.get=function(){return this.tl.concat(this.br)},Qr.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Hr.prototype,Qr);var Yn=function(t,r){var u={},h={};this.haveRenderCallbacks=[];var g=[];this.addImages(t,u,g),this.addImages(r,h,g);var C=Gr(g),O=new Fo({width:C.w||1,height:C.h||1});for(var G in t){var Q=t[G],ve=u[G].paddedRect;Fo.copy(Q.data,O,{x:0,y:0},{x:ve.x+1,y:ve.y+1},Q.data)}for(var Ae in r){var _e=r[Ae],it=h[Ae].paddedRect,_t=it.x+1,Tt=it.y+1,Xt=_e.data.width,Zt=_e.data.height;Fo.copy(_e.data,O,{x:0,y:0},{x:_t,y:Tt},_e.data),Fo.copy(_e.data,O,{x:0,y:Zt-1},{x:_t,y:Tt-1},{width:Xt,height:1}),Fo.copy(_e.data,O,{x:0,y:0},{x:_t,y:Tt+Zt},{width:Xt,height:1}),Fo.copy(_e.data,O,{x:Xt-1,y:0},{x:_t-1,y:Tt},{width:1,height:Zt}),Fo.copy(_e.data,O,{x:0,y:0},{x:_t+Xt,y:Tt},{width:1,height:Zt})}this.image=O,this.iconPositions=u,this.patternPositions=h};Yn.prototype.addImages=function(e,t,r){for(var u in e){var h=e[u],g={x:0,y:0,w:h.data.width+2,h:h.data.height+2};r.push(g),t[u]=new Hr(g,h),h.hasRenderCallback&&this.haveRenderCallbacks.push(u)}},Yn.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},Yn.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var u=e.tl;r.update(t.data,void 0,{x:u[0],y:u[1]})}},Mn("ImagePosition",Hr),Mn("ImageAtlas",Yn);var ai={horizontal:1,vertical:2,horizontalOnly:3},ln=function(){this.scale=1,this.fontStack="",this.imageName=null};ln.forText=function(e,t){var r=new ln;return r.scale=e||1,r.fontStack=t,r},ln.forImage=function(e){var t=new ln;return t.imageName=e,t};var Wr=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function jr(e,t,r,u,h,g,C,O,G,Q,ve,Ae,_e,it,_t,Tt){var Xt,Zt=Wr.fromFeature(e,h);Ae===ai.vertical&&Zt.verticalizePunctuation();var ir=us.processBidirectionalText,hr=us.processStyledBidirectionalText;if(ir&&Zt.sections.length===1){Xt=[];for(var Er=0,kr=ir(Zt.toString(),ma(Zt,Q,g,t,u,it,_t));Er<kr.length;Er+=1){var Nr=kr[Er],vn=new Wr;vn.text=Nr,vn.sections=Zt.sections;for(var hn=0;hn<Nr.length;hn++)vn.sectionIndex.push(0);Xt.push(vn)}}else if(hr){Xt=[];for(var Ln=0,qn=hr(Zt.text,Zt.sectionIndex,ma(Zt,Q,g,t,u,it,_t));Ln<qn.length;Ln+=1){var Kn=qn[Ln],Fn=new Wr;Fn.text=Kn[0],Fn.sectionIndex=Kn[1],Fn.sections=Zt.sections,Xt.push(Fn)}}else Xt=function(ti,aa){for(var Vi=[],Za=ti.text,yi=0,ha=0,Ko=aa;ha<Ko.length;ha+=1){var Ca=Ko[ha];Vi.push(ti.substring(yi,Ca)),yi=Ca}return yi<Za.length&&Vi.push(ti.substring(yi,Za.length)),Vi}(Zt,ma(Zt,Q,g,t,u,it,_t));var wi=[],li={positionedLines:wi,text:Zt.toString(),top:ve[1],bottom:ve[1],left:ve[0],right:ve[0],writingMode:Ae,iconsInText:!1,verticalizable:!1};return function(ti,aa,Vi,Za,yi,ha,Ko,Ca,$o,Jo,hs,Su){for(var ds=0,il=-17,uu=0,al=0,lu=Ca==="right"?1:Ca==="left"?0:.5,Xs=0,cu=0,Ea=yi;cu<Ea.length;cu+=1){var da=Ea[cu];da.trim();var oo=da.getMaxScale(),Po=24*(oo-1),Eu={positionedGlyphs:[],lineOffset:0};ti.positionedLines[Xs]=Eu;var Io=Eu.positionedGlyphs,Qo=0;if(da.length()){for(var Uu=0;Uu<da.length();Uu++){var xa=da.getSection(Uu),ih=da.getSectionIndex(Uu),Qc=da.getCharCode(Uu),yf=0,xc=null,Vu=null,Vf=null,Gf=24,ah=!($o===ai.horizontal||!hs&&!lc(Qc)||hs&&(vi[Qc]||(xh=Qc,an.Arabic(xh)||an["Arabic Supplement"](xh)||an["Arabic Extended-A"](xh)||an["Arabic Presentation Forms-A"](xh)||an["Arabic Presentation Forms-B"](xh))));if(xa.imageName){var Ih=Za[xa.imageName];if(!Ih)continue;Vf=xa.imageName,ti.iconsInText=ti.iconsInText||!0,Vu=Ih.paddedRect;var zf=Ih.displaySize;xa.scale=24*xa.scale/Su,yf=Po+(24-zf[1]*xa.scale),Gf=(xc={width:zf[0],height:zf[1],left:1,top:-3,advance:ah?zf[1]:zf[0]}).advance;var Oh=ah?zf[0]*xa.scale-24*oo:zf[1]*xa.scale-24*oo;Oh>0&&Oh>Qo&&(Qo=Oh)}else{var oh=Vi[xa.fontStack],yh=oh&&oh[Qc];if(yh&&yh.rect)Vu=yh.rect,xc=yh.metrics;else{var Yh=aa[xa.fontStack],Uh=Yh&&Yh[Qc];if(!Uh)continue;xc=Uh.metrics}yf=24*(oo-xa.scale)}ah?(ti.verticalizable=!0,Io.push({glyph:Qc,imageName:Vf,x:ds,y:il+yf,vertical:ah,scale:xa.scale,fontStack:xa.fontStack,sectionIndex:ih,metrics:xc,rect:Vu}),ds+=Gf*xa.scale+Jo):(Io.push({glyph:Qc,imageName:Vf,x:ds,y:il+yf,vertical:ah,scale:xa.scale,fontStack:xa.fontStack,sectionIndex:ih,metrics:xc,rect:Vu}),ds+=xc.advance*xa.scale+Jo)}Io.length!==0&&(uu=Math.max(ds-Jo,uu),Ts(Io,0,Io.length-1,lu,Qo)),ds=0;var Kh=ha*oo+Qo;Eu.lineOffset=Math.max(Qo,Po),il+=Kh,al=Math.max(Kh,al),++Xs}else il+=ha,++Xs}var xh,Lh=il- -17,$h=Xo(Ko),bh=$h.horizontalAlign,sh=$h.verticalAlign;(function(hh,Jh,Vh,Sh,Gh,Rh,Eh,Hh,Zh){var Dh,zh=(Jh-Vh)*Gh;Dh=Rh!==Eh?-Hh*Sh- -17:(-Sh*Zh+.5)*Eh;for(var Th=0,Nh=hh;Th<Nh.length;Th+=1)for(var Ah=0,Hf=Nh[Th].positionedGlyphs;Ah<Hf.length;Ah+=1){var Fh=Hf[Ah];Fh.x+=zh,Fh.y+=Dh}})(ti.positionedLines,lu,bh,sh,uu,al,ha,Lh,yi.length),ti.top+=-sh*Lh,ti.bottom=ti.top+Lh,ti.left+=-bh*uu,ti.right=ti.left+uu}(li,t,r,u,Xt,C,O,G,Ae,Q,_e,Tt),!function(ti){for(var aa=0,Vi=ti;aa<Vi.length;aa+=1)if(Vi[aa].positionedGlyphs.length!==0)return!1;return!0}(wi)&&li}Wr.fromFeature=function(e,t){for(var r=new Wr,u=0;u<e.sections.length;u++){var h=e.sections[u];h.image?r.addImageSection(h):r.addTextSection(h,t)}return r},Wr.prototype.length=function(){return this.text.length},Wr.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Wr.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Wr.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Wr.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var u=e.charCodeAt(r+1)||null,h=e.charCodeAt(r-1)||null;t+=u&&Wl(u)&&!jf[e[r+1]]||h&&Wl(h)&&!jf[e[r-1]]||!jf[e[r]]?e[r]:jf[e[r]]}return t}(this.text)},Wr.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&vi[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,u=this.text.length-1;u>=0&&u>=e&&vi[this.text.charCodeAt(u)];u--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},Wr.prototype.substring=function(e,t){var r=new Wr;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},Wr.prototype.toString=function(){return this.text},Wr.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},Wr.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(ln.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,u=0;u<e.text.length;++u)this.sectionIndex.push(r)},Wr.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(ln.forImage(t)),this.sectionIndex.push(this.sections.length-1)):Le("Reached maximum number of images 6401")}else Le("Can't add FormattedSection with an empty image.")},Wr.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var vi={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},di={};function Nn(e,t,r,u,h,g){if(t.imageName){var C=u[t.imageName];return C?C.displaySize[0]*t.scale*24/g+h:0}var O=r[t.fontStack],G=O&&O[e];return G?G.metrics.advance*t.scale+h:0}function ea(e,t,r,u){var h=Math.pow(e-t,2);return u?e<t?h/2:2*h:h+Math.abs(r)*r}function Ai(e,t,r){var u=0;return e===10&&(u-=1e4),r&&(u+=150),e!==40&&e!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function Ji(e,t,r,u,h,g){for(var C=null,O=ea(t,r,h,g),G=0,Q=u;G<Q.length;G+=1){var ve=Q[G],Ae=ea(t-ve.x,r,h,g)+ve.badness;Ae<=O&&(C=ve,O=Ae)}return{index:e,x:t,priorBreak:C,badness:O}}function ma(e,t,r,u,h,g,C){if(g!=="point")return[];if(!e)return[];for(var O,G=[],Q=function(Xt,Zt,ir,hr,Er,kr){for(var Nr=0,vn=0;vn<Xt.length();vn++){var hn=Xt.getSection(vn);Nr+=Nn(Xt.getCharCode(vn),hn,hr,Er,Zt,kr)}return Nr/Math.max(1,Math.ceil(Nr/ir))}(e,t,r,u,h,C),ve=e.text.indexOf("\u200B")>=0,Ae=0,_e=0;_e<e.length();_e++){var it=e.getSection(_e),_t=e.getCharCode(_e);if(vi[_t]||(Ae+=Nn(_t,it,u,h,t,C)),_e<e.length()-1){var Tt=!((O=_t)<11904||!(an["Bopomofo Extended"](O)||an.Bopomofo(O)||an["CJK Compatibility Forms"](O)||an["CJK Compatibility Ideographs"](O)||an["CJK Compatibility"](O)||an["CJK Radicals Supplement"](O)||an["CJK Strokes"](O)||an["CJK Symbols and Punctuation"](O)||an["CJK Unified Ideographs Extension A"](O)||an["CJK Unified Ideographs"](O)||an["Enclosed CJK Letters and Months"](O)||an["Halfwidth and Fullwidth Forms"](O)||an.Hiragana(O)||an["Ideographic Description Characters"](O)||an["Kangxi Radicals"](O)||an["Katakana Phonetic Extensions"](O)||an.Katakana(O)||an["Vertical Forms"](O)||an["Yi Radicals"](O)||an["Yi Syllables"](O)));(di[_t]||Tt||it.imageName)&&G.push(Ji(_e+1,Ae,Q,G,Ai(_t,e.getCharCode(_e+1),Tt&&ve),!1))}}return function Xt(Zt){return Zt?Xt(Zt.priorBreak).concat(Zt.index):[]}(Ji(e.length(),Ae,Q,G,0,!0))}function Xo(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Ts(e,t,r,u,h){if(u||h)for(var g=e[r],C=(e[r].x+g.metrics.advance*g.scale)*u,O=t;O<=r;O++)e[O].x-=C,e[O].y+=h}function ta(e,t,r,u,h,g){var C,O=e.image;if(O.content){var G=O.content,Q=O.pixelRatio||1;C=[G[0]/Q,G[1]/Q,O.displaySize[0]-G[2]/Q,O.displaySize[1]-G[3]/Q]}var ve,Ae,_e,it,_t=t.left*g,Tt=t.right*g;r==="width"||r==="both"?(it=h[0]+_t-u[3],Ae=h[0]+Tt+u[1]):Ae=(it=h[0]+(_t+Tt-O.displaySize[0])/2)+O.displaySize[0];var Xt=t.top*g,Zt=t.bottom*g;return r==="height"||r==="both"?(ve=h[1]+Xt-u[0],_e=h[1]+Zt+u[2]):_e=(ve=h[1]+(Xt+Zt-O.displaySize[1])/2)+O.displaySize[1],{image:O,top:ve,right:Ae,bottom:_e,left:it,collisionPadding:C}}di[10]=!0,di[32]=!0,di[38]=!0,di[40]=!0,di[41]=!0,di[43]=!0,di[45]=!0,di[47]=!0,di[173]=!0,di[183]=!0,di[8203]=!0,di[8208]=!0,di[8211]=!0,di[8231]=!0;var wo=function(e){function t(r,u,h,g){e.call(this,r,u),this.angle=h,g!==void 0&&(this.segment=g)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(q);function Fa(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Ti(e+1))};if(r.kind==="source")return{kind:"source"};for(var u=r.zoomStops,h=r.interpolationType,g=0;g<u.length&&u[g]<=e;)g++;for(var C=g=Math.max(0,g-1);C<u.length&&u[C]<e+1;)C++;C=Math.min(u.length-1,C);var O=u[g],G=u[C];return r.kind==="composite"?{kind:"composite",minZoom:O,maxZoom:G,interpolationType:h}:{kind:"camera",minZoom:O,maxZoom:G,minSize:r.evaluate(new Ti(O)),maxSize:r.evaluate(new Ti(G)),interpolationType:h}}function As(e,t,r){var u=t.uSize,h=r.lowerSize;return e.kind==="source"?h/128:e.kind==="composite"?Ka(h/128,r.upperSize/128,t.uSizeT):u}function rs(e,t){var r=0,u=0;if(e.kind==="constant")u=e.layoutSize;else if(e.kind!=="source"){var h=e.interpolationType,g=h?st(Aa.interpolationFactor(h,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?u=Ka(e.minSize,e.maxSize,g):r=g}return{uSizeT:r,uSize:u}}Mn("Anchor",wo);var ko=Object.freeze({__proto__:null,getSizeData:Fa,evaluateSizeForFeature:As,evaluateSizeForZoom:rs,SIZE_PACK_FACTOR:128});function cs(e,t,r,u,h){if(t.segment===void 0)return!0;for(var g=t,C=t.segment+1,O=0;O>-r/2;){if(--C<0)return!1;O-=e[C].dist(g),g=e[C]}O+=e[C].dist(e[C+1]),C++;for(var G=[],Q=0;O<r/2;){var ve=e[C],Ae=e[C+1];if(!Ae)return!1;var _e=e[C-1].angleTo(ve)-ve.angleTo(Ae);for(_e=Math.abs((_e+3*Math.PI)%(2*Math.PI)-Math.PI),G.push({distance:O,angleDelta:_e}),Q+=_e;O-G[0].distance>u;)Q-=G.shift().angleDelta;if(Q>h)return!1;C++,O+=ve.dist(Ae)}return!0}function Zs(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Yo(e,t,r){return e?.6*t*r:0}function oi(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function ou(e,t,r,u,h,g){for(var C=Yo(r,h,g),O=oi(r,u)*g,G=0,Q=Zs(e)/2,ve=0;ve<e.length-1;ve++){var Ae=e[ve],_e=e[ve+1],it=Ae.dist(_e);if(G+it>Q){var _t=(Q-G)/it,Tt=Ka(Ae.x,_e.x,_t),Xt=Ka(Ae.y,_e.y,_t),Zt=new wo(Tt,Xt,_e.angleTo(Ae),ve);return Zt._round(),!C||cs(e,Zt,O,C,t)?Zt:void 0}G+=it}}function Ba(e,t,r,u,h,g,C,O,G){var Q=Yo(u,g,C),ve=oi(u,h),Ae=ve*C,_e=e[0].x===0||e[0].x===G||e[0].y===0||e[0].y===G;return t-Ae<t/4&&(t=Ae+t/4),function it(_t,Tt,Xt,Zt,ir,hr,Er,kr,Nr){for(var vn=hr/2,hn=Zs(_t),Ln=0,qn=Tt-Xt,Kn=[],Fn=0;Fn<_t.length-1;Fn++){for(var wi=_t[Fn],li=_t[Fn+1],ti=wi.dist(li),aa=li.angleTo(wi);qn+Xt<Ln+ti;){var Vi=((qn+=Xt)-Ln)/ti,Za=Ka(wi.x,li.x,Vi),yi=Ka(wi.y,li.y,Vi);if(Za>=0&&Za<Nr&&yi>=0&&yi<Nr&&qn-vn>=0&&qn+vn<=hn){var ha=new wo(Za,yi,aa,Fn);ha._round(),Zt&&!cs(_t,ha,hr,Zt,ir)||Kn.push(ha)}}Ln+=ti}return kr||Kn.length||Er||(Kn=it(_t,Ln/2,Xt,Zt,ir,hr,Er,!0,Nr)),Kn}(e,_e?t/2*O%t:(ve/2+2*g)*C*O%t,t,Q,r,Ae,_e,!1,G)}function _n(e,t,r,u,h){for(var g=[],C=0;C<e.length;C++)for(var O=e[C],G=void 0,Q=0;Q<O.length-1;Q++){var ve=O[Q],Ae=O[Q+1];ve.x<t&&Ae.x<t||(ve.x<t?ve=new q(t,ve.y+(t-ve.x)/(Ae.x-ve.x)*(Ae.y-ve.y))._round():Ae.x<t&&(Ae=new q(t,ve.y+(t-ve.x)/(Ae.x-ve.x)*(Ae.y-ve.y))._round()),ve.y<r&&Ae.y<r||(ve.y<r?ve=new q(ve.x+(r-ve.y)/(Ae.y-ve.y)*(Ae.x-ve.x),r)._round():Ae.y<r&&(Ae=new q(ve.x+(r-ve.y)/(Ae.y-ve.y)*(Ae.x-ve.x),r)._round()),ve.x>=u&&Ae.x>=u||(ve.x>=u?ve=new q(u,ve.y+(u-ve.x)/(Ae.x-ve.x)*(Ae.y-ve.y))._round():Ae.x>=u&&(Ae=new q(u,ve.y+(u-ve.x)/(Ae.x-ve.x)*(Ae.y-ve.y))._round()),ve.y>=h&&Ae.y>=h||(ve.y>=h?ve=new q(ve.x+(h-ve.y)/(Ae.y-ve.y)*(Ae.x-ve.x),h)._round():Ae.y>=h&&(Ae=new q(ve.x+(h-ve.y)/(Ae.y-ve.y)*(Ae.x-ve.x),h)._round()),G&&ve.equals(G[G.length-1])||g.push(G=[ve]),G.push(Ae)))))}return g}function Fi(e,t,r,u){var h=[],g=e.image,C=g.pixelRatio,O=g.paddedRect.w-2,G=g.paddedRect.h-2,Q=e.right-e.left,ve=e.bottom-e.top,Ae=g.stretchX||[[0,O]],_e=g.stretchY||[[0,G]],it=function(yi,ha){return yi+ha[1]-ha[0]},_t=Ae.reduce(it,0),Tt=_e.reduce(it,0),Xt=O-_t,Zt=G-Tt,ir=0,hr=_t,Er=0,kr=Tt,Nr=0,vn=Xt,hn=0,Ln=Zt;if(g.content&&u){var qn=g.content;ir=Qi(Ae,0,qn[0]),Er=Qi(_e,0,qn[1]),hr=Qi(Ae,qn[0],qn[2]),kr=Qi(_e,qn[1],qn[3]),Nr=qn[0]-ir,hn=qn[1]-Er,vn=qn[2]-qn[0]-hr,Ln=qn[3]-qn[1]-kr}var Kn=function(yi,ha,Ko,Ca){var $o=Ws(yi.stretch-ir,hr,Q,e.left),Jo=Lc(yi.fixed-Nr,vn,yi.stretch,_t),hs=Ws(ha.stretch-Er,kr,ve,e.top),Su=Lc(ha.fixed-hn,Ln,ha.stretch,Tt),ds=Ws(Ko.stretch-ir,hr,Q,e.left),il=Lc(Ko.fixed-Nr,vn,Ko.stretch,_t),uu=Ws(Ca.stretch-Er,kr,ve,e.top),al=Lc(Ca.fixed-hn,Ln,Ca.stretch,Tt),lu=new q($o,hs),Xs=new q(ds,hs),cu=new q(ds,uu),Ea=new q($o,uu),da=new q(Jo/C,Su/C),oo=new q(il/C,al/C),Po=t*Math.PI/180;if(Po){var Eu=Math.sin(Po),Io=Math.cos(Po),Qo=[Io,-Eu,Eu,Io];lu._matMult(Qo),Xs._matMult(Qo),Ea._matMult(Qo),cu._matMult(Qo)}var Uu=yi.stretch+yi.fixed,xa=ha.stretch+ha.fixed;return{tl:lu,tr:Xs,bl:Ea,br:cu,tex:{x:g.paddedRect.x+1+Uu,y:g.paddedRect.y+1+xa,w:Ko.stretch+Ko.fixed-Uu,h:Ca.stretch+Ca.fixed-xa},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:da,pixelOffsetBR:oo,minFontScaleX:vn/C/Q,minFontScaleY:Ln/C/ve,isSDF:r}};if(u&&(g.stretchX||g.stretchY))for(var Fn=fs(Ae,Xt,_t),wi=fs(_e,Zt,Tt),li=0;li<Fn.length-1;li++)for(var ti=Fn[li],aa=Fn[li+1],Vi=0;Vi<wi.length-1;Vi++)h.push(Kn(ti,wi[Vi],aa,wi[Vi+1]));else h.push(Kn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:O+1},{fixed:0,stretch:G+1}));return h}function Qi(e,t,r){for(var u=0,h=0,g=e;h<g.length;h+=1){var C=g[h];u+=Math.max(t,Math.min(r,C[1]))-Math.max(t,Math.min(r,C[0]))}return u}function fs(e,t,r){for(var u=[{fixed:-1,stretch:0}],h=0,g=e;h<g.length;h+=1){var C=g[h],O=C[0],G=C[1],Q=u[u.length-1];u.push({fixed:O-Q.stretch,stretch:Q.stretch}),u.push({fixed:O-Q.stretch,stretch:Q.stretch+(G-O)})}return u.push({fixed:t+1,stretch:r}),u}function Ws(e,t,r,u){return e/t*r+u}function Lc(e,t,r,u){return e-t*r/u}var wt=function(t,r,u,h,g,C,O,G,Q,ve){if(this.boxStartIndex=t.length,Q){var Ae=C.top,_e=C.bottom,it=C.collisionPadding;it&&(Ae-=it[1],_e+=it[3]);var _t=_e-Ae;_t>0&&(_t=Math.max(10,_t),this.circleDiameter=_t)}else{var Tt=C.top*O-G,Xt=C.bottom*O+G,Zt=C.left*O-G,ir=C.right*O+G,hr=C.collisionPadding;if(hr&&(Zt-=hr[0]*O,Tt-=hr[1]*O,ir+=hr[2]*O,Xt+=hr[3]*O),ve){var Er=new q(Zt,Tt),kr=new q(ir,Tt),Nr=new q(Zt,Xt),vn=new q(ir,Xt),hn=ve*Math.PI/180;Er._rotate(hn),kr._rotate(hn),Nr._rotate(hn),vn._rotate(hn),Zt=Math.min(Er.x,kr.x,Nr.x,vn.x),ir=Math.max(Er.x,kr.x,Nr.x,vn.x),Tt=Math.min(Er.y,kr.y,Nr.y,vn.y),Xt=Math.max(Er.y,kr.y,Nr.y,vn.y)}t.emplaceBack(r.x,r.y,Zt,Tt,ir,Xt,u,h,g)}this.boxEndIndex=t.length},Tr=function(t,r){if(t===void 0&&(t=[]),r===void 0&&(r=vr),this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function vr(e,t){return e<t?-1:e>t?1:0}function Dn(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!1);for(var u=1/0,h=1/0,g=-1/0,C=-1/0,O=e[0],G=0;G<O.length;G++){var Q=O[G];(!G||Q.x<u)&&(u=Q.x),(!G||Q.y<h)&&(h=Q.y),(!G||Q.x>g)&&(g=Q.x),(!G||Q.y>C)&&(C=Q.y)}var ve=Math.min(g-u,C-h),Ae=ve/2,_e=new Tr([],Ui);if(ve===0)return new q(u,h);for(var it=u;it<g;it+=ve)for(var _t=h;_t<C;_t+=ve)_e.push(new yt(it+Ae,_t+Ae,Ae,e));for(var Tt=function(ir){for(var hr=0,Er=0,kr=0,Nr=ir[0],vn=0,hn=Nr.length,Ln=hn-1;vn<hn;Ln=vn++){var qn=Nr[vn],Kn=Nr[Ln],Fn=qn.x*Kn.y-Kn.x*qn.y;Er+=(qn.x+Kn.x)*Fn,kr+=(qn.y+Kn.y)*Fn,hr+=3*Fn}return new yt(Er/hr,kr/hr,0,ir)}(e),Xt=_e.length;_e.length;){var Zt=_e.pop();(Zt.d>Tt.d||!Tt.d)&&(Tt=Zt,r&&console.log("found best %d after %d probes",Math.round(1e4*Zt.d)/1e4,Xt)),Zt.max-Tt.d<=t||(_e.push(new yt(Zt.p.x-(Ae=Zt.h/2),Zt.p.y-Ae,Ae,e)),_e.push(new yt(Zt.p.x+Ae,Zt.p.y-Ae,Ae,e)),_e.push(new yt(Zt.p.x-Ae,Zt.p.y+Ae,Ae,e)),_e.push(new yt(Zt.p.x+Ae,Zt.p.y+Ae,Ae,e)),Xt+=4)}return r&&(console.log("num probes: "+Xt),console.log("best distance: "+Tt.d)),Tt.p}function Ui(e,t){return t.max-e.max}function yt(e,t,r,u){this.p=new q(e,t),this.h=r,this.d=function(h,g){for(var C=!1,O=1/0,G=0;G<g.length;G++)for(var Q=g[G],ve=0,Ae=Q.length,_e=Ae-1;ve<Ae;_e=ve++){var it=Q[ve],_t=Q[_e];it.y>h.y!=_t.y>h.y&&h.x<(_t.x-it.x)*(h.y-it.y)/(_t.y-it.y)+it.x&&(C=!C),O=Math.min(O,$l(h,it,_t))}return(C?1:-1)*Math.sqrt(O)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}Tr.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},Tr.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},Tr.prototype.peek=function(){return this.data[0]},Tr.prototype._up=function(e){for(var t=this.data,r=this.compare,u=t[e];e>0;){var h=e-1>>1,g=t[h];if(r(u,g)>=0)break;t[e]=g,e=h}t[e]=u},Tr.prototype._down=function(e){for(var t=this.data,r=this.compare,u=this.length>>1,h=t[e];e<u;){var g=1+(e<<1),C=t[g],O=g+1;if(O<this.length&&r(t[O],C)<0&&(g=O,C=t[O]),r(C,h)>=0)break;t[e]=C,e=g}t[e]=h};var Qe=Number.POSITIVE_INFINITY;function Kt(e,t){return t[1]!==Qe?function(r,u,h){var g=0,C=0;switch(u=Math.abs(u),h=Math.abs(h),r){case"top-right":case"top-left":case"top":C=h-7;break;case"bottom-right":case"bottom-left":case"bottom":C=7-h}switch(r){case"top-right":case"bottom-right":case"right":g=-u;break;case"top-left":case"bottom-left":case"left":g=u}return[g,C]}(e,t[0],t[1]):function(r,u){var h=0,g=0;u<0&&(u=0);var C=u/Math.sqrt(2);switch(r){case"top-right":case"top-left":g=C-7;break;case"bottom-right":case"bottom-left":g=7-C;break;case"bottom":g=7-u;break;case"top":g=u-7}switch(r){case"top-right":case"bottom-right":h=-C;break;case"top-left":case"bottom-left":h=C;break;case"left":h=u;break;case"right":h=-u}return[h,g]}(e,t[0])}function sr(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function lr(e,t,r,u,h,g,C,O,G,Q,ve,Ae,_e,it,_t){var Tt=function(Er,kr,Nr,vn,hn,Ln,qn,Kn){for(var Fn=vn.layout.get("text-rotate").evaluate(Ln,{})*Math.PI/180,wi=[],li=0,ti=kr.positionedLines;li<ti.length;li+=1)for(var aa=ti[li],Vi=0,Za=aa.positionedGlyphs;Vi<Za.length;Vi+=1){var yi=Za[Vi];if(yi.rect){var ha=yi.rect||{},Ko=4,Ca=!0,$o=1,Jo=0,hs=(hn||Kn)&&yi.vertical,Su=yi.metrics.advance*yi.scale/2;if(Kn&&kr.verticalizable&&(Jo=aa.lineOffset/2-(yi.imageName?-(24-yi.metrics.width*yi.scale)/2:24*(yi.scale-1))),yi.imageName){var ds=qn[yi.imageName];Ca=ds.sdf,Ko=1/($o=ds.pixelRatio)}var il=hn?[yi.x+Su,yi.y]:[0,0],uu=hn?[0,0]:[yi.x+Su+Nr[0],yi.y+Nr[1]-Jo],al=[0,0];hs&&(al=uu,uu=[0,0]);var lu=(yi.metrics.left-Ko)*yi.scale-Su+uu[0],Xs=(-yi.metrics.top-Ko)*yi.scale+uu[1],cu=lu+ha.w*yi.scale/$o,Ea=Xs+ha.h*yi.scale/$o,da=new q(lu,Xs),oo=new q(cu,Xs),Po=new q(lu,Ea),Eu=new q(cu,Ea);if(hs){var Io=new q(-Su,Su- -17),Qo=-Math.PI/2,Uu=12-Su,xa=new q(22-Uu,-(yi.imageName?Uu:0)),ih=new(Function.prototype.bind.apply(q,[null].concat(al)));da._rotateAround(Qo,Io)._add(xa)._add(ih),oo._rotateAround(Qo,Io)._add(xa)._add(ih),Po._rotateAround(Qo,Io)._add(xa)._add(ih),Eu._rotateAround(Qo,Io)._add(xa)._add(ih)}if(Fn){var Qc=Math.sin(Fn),yf=Math.cos(Fn),xc=[yf,-Qc,Qc,yf];da._matMult(xc),oo._matMult(xc),Po._matMult(xc),Eu._matMult(xc)}var Vu=new q(0,0),Vf=new q(0,0);wi.push({tl:da,tr:oo,bl:Po,br:Eu,tex:ha,writingMode:kr.writingMode,glyphOffset:il,sectionIndex:yi.sectionIndex,isSDF:Ca,pixelOffsetTL:Vu,pixelOffsetBR:Vf,minFontScaleX:0,minFontScaleY:0})}}return wi}(0,r,O,h,g,C,u,e.allowVerticalPlacement),Xt=e.textSizeData,Zt=null;Xt.kind==="source"?(Zt=[128*h.layout.get("text-size").evaluate(C,{})])[0]>32640&&Le(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Xt.kind==="composite"&&((Zt=[128*it.compositeTextSizes[0].evaluate(C,{},_t),128*it.compositeTextSizes[1].evaluate(C,{},_t)])[0]>32640||Zt[1]>32640)&&Le(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,Tt,Zt,O,g,C,Q,t,G.lineStartIndex,G.lineLength,_e,_t);for(var ir=0,hr=ve;ir<hr.length;ir+=1)Ae[hr[ir]]=e.text.placedSymbolArray.length-1;return 4*Tt.length}function b(e){for(var t in e)return e[t];return null}function p(e,t,r,u){var h=e.compareText;if(t in h){for(var g=h[t],C=g.length-1;C>=0;C--)if(u.dist(g[C])<r)return!0}else h[t]=[];return h[t].push(u),!1}var c=go.VectorTileFeature.types,f=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function m(e,t,r,u,h,g,C,O,G,Q,ve,Ae,_e){var it=O?Math.min(32640,Math.round(O[0])):0,_t=O?Math.min(32640,Math.round(O[1])):0;e.emplaceBack(t,r,Math.round(32*u),Math.round(32*h),g,C,(it<<1)+(G?1:0),_t,16*Q,16*ve,256*Ae,256*_e)}function _(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function k(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(cf(r[t].text))return!0;return!1}var te=function(t){this.layoutVertexArray=new Pf,this.indexArray=new _l,this.programConfigurations=t,this.segments=new Ke,this.dynamicLayoutVertexArray=new Kl,this.opacityVertexArray=new Zc,this.placedSymbolArray=new l};te.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},te.prototype.upload=function(e,t,r,u){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Df.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,fh.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,f,!0),this.opacityVertexBuffer.itemSize=1),(r||u)&&this.programConfigurations.upload(e))},te.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Mn("SymbolBuffers",te);var se=function(t,r,u){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new u,this.segments=new Ke,this.collisionVertexArray=new Wc};se.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,eh.members,!0)},se.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Mn("CollisionBuffers",se);var he=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(C){return C.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=vo([]),this.placementViewportMatrix=vo([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Fa(this.zoom,r["text-size"]),this.iconSizeData=Fa(this.zoom,r["icon-size"]);var u=this.layers[0].layout,h=u.get("symbol-sort-key"),g=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(function(C){return ai[C]})),this.stateDependentLayerIds=this.layers.filter(function(C){return C.isStateDependent()}).map(function(C){return C.id}),this.sourceID=t.sourceID};he.prototype.createArrays=function(){this.text=new te(new Ni(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new te(new Ni(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new L,this.lineVertexArray=new B,this.symbolInstances=new M},he.prototype.calculateGlyphDependencies=function(e,t,r,u,h){for(var g=0;g<e.length;g++)if(t[e.charCodeAt(g)]=!0,(r||u)&&h){var C=jf[e.charAt(g)];C&&(t[C.charCodeAt(0)]=!0)}},he.prototype.populate=function(e,t,r){var u=this.layers[0],h=u.layout,g=h.get("text-font"),C=h.get("text-field"),O=h.get("icon-image"),G=(C.value.kind!=="constant"||C.value.value instanceof to&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),Q=O.value.kind!=="constant"||!!O.value.value||Object.keys(O.parameters).length>0,ve=h.get("symbol-sort-key");if(this.features=[],G||Q){for(var Ae=t.iconDependencies,_e=t.glyphDependencies,it=t.availableImages,_t=new Ti(this.zoom),Tt=0,Xt=e;Tt<Xt.length;Tt+=1){var Zt=Xt[Tt],ir=Zt.feature,hr=Zt.id,Er=Zt.index,kr=Zt.sourceLayerIndex,Nr=u._featureFilter.needGeometry,vn=Ja(ir,Nr);if(u._featureFilter.filter(_t,vn,r)){Nr||(vn.geometry=_a(ir));var hn=void 0;if(G){var Ln=u.getValueAndResolveTokens("text-field",vn,r,it),qn=to.factory(Ln);k(qn)&&(this.hasRTLText=!0),(!this.hasRTLText||Ho()==="unavailable"||this.hasRTLText&&us.isParsed())&&(hn=kf(qn,u,vn))}var Kn=void 0;if(Q){var Fn=u.getValueAndResolveTokens("icon-image",vn,r,it);Kn=Fn instanceof lo?Fn:lo.fromString(Fn)}if(hn||Kn){var wi=this.sortFeaturesByKey?ve.evaluate(vn,{},r):void 0;if(this.features.push({id:hr,text:hn,icon:Kn,index:Er,sourceLayerIndex:kr,geometry:vn.geometry,properties:ir.properties,type:c[ir.type],sortKey:wi}),Kn&&(Ae[Kn.name]=!0),hn){var li=g.evaluate(vn,{},r).join(","),ti=h.get("text-rotation-alignment")==="map"&&h.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ai.vertical)>=0;for(var aa=0,Vi=hn.sections;aa<Vi.length;aa+=1){var Za=Vi[aa];if(Za.image)Ae[Za.image.name]=!0;else{var yi=Gc(hn.toString()),ha=Za.fontStack||li,Ko=_e[ha]=_e[ha]||{};this.calculateGlyphDependencies(Za.text,Ko,ti,this.allowVerticalPlacement,yi)}}}}}}h.get("symbol-placement")==="line"&&(this.features=function(Ca){var $o={},Jo={},hs=[],Su=0;function ds(Io){hs.push(Ca[Io]),Su++}function il(Io,Qo,Uu){var xa=Jo[Io];return delete Jo[Io],Jo[Qo]=xa,hs[xa].geometry[0].pop(),hs[xa].geometry[0]=hs[xa].geometry[0].concat(Uu[0]),xa}function uu(Io,Qo,Uu){var xa=$o[Qo];return delete $o[Qo],$o[Io]=xa,hs[xa].geometry[0].shift(),hs[xa].geometry[0]=Uu[0].concat(hs[xa].geometry[0]),xa}function al(Io,Qo,Uu){var xa=Uu?Qo[0][Qo[0].length-1]:Qo[0][0];return Io+":"+xa.x+":"+xa.y}for(var lu=0;lu<Ca.length;lu++){var Xs=Ca[lu],cu=Xs.geometry,Ea=Xs.text?Xs.text.toString():null;if(Ea){var da=al(Ea,cu),oo=al(Ea,cu,!0);if(da in Jo&&oo in $o&&Jo[da]!==$o[oo]){var Po=uu(da,oo,cu),Eu=il(da,oo,hs[Po].geometry);delete $o[da],delete Jo[oo],Jo[al(Ea,hs[Eu].geometry,!0)]=Eu,hs[Po].geometry=null}else da in Jo?il(da,oo,cu):oo in $o?uu(da,oo,cu):(ds(lu),$o[da]=Su-1,Jo[oo]=Su-1)}else ds(lu)}return hs.filter(function(Io){return Io.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ca,$o){return Ca.sortKey-$o.sortKey})}},he.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},he.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},he.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},he.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},he.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},he.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},he.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var u=e.dist(t[e.segment+1]),h=e.dist(t[e.segment]),g={},C=e.segment+1;C<t.length;C++)g[C]={x:t[C].x,y:t[C].y,tileUnitDistanceFromAnchor:u},C<t.length-1&&(u+=t[C+1].dist(t[C]));for(var O=e.segment||0;O>=0;O--)g[O]={x:t[O].x,y:t[O].y,tileUnitDistanceFromAnchor:h},O>0&&(h+=t[O-1].dist(t[O]));for(var G=0;G<t.length;G++){var Q=g[G];this.lineVertexArray.emplaceBack(Q.x,Q.y,Q.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},he.prototype.addSymbols=function(e,t,r,u,h,g,C,O,G,Q,ve,Ae){for(var _e=e.indexArray,it=e.layoutVertexArray,_t=e.segments.prepareSegment(4*t.length,it,_e,this.canOverlap?g.sortKey:void 0),Tt=this.glyphOffsetArray.length,Xt=_t.vertexLength,Zt=this.allowVerticalPlacement&&C===ai.vertical?Math.PI/2:0,ir=g.text&&g.text.sections,hr=0;hr<t.length;hr++){var Er=t[hr],kr=Er.tl,Nr=Er.tr,vn=Er.bl,hn=Er.br,Ln=Er.tex,qn=Er.pixelOffsetTL,Kn=Er.pixelOffsetBR,Fn=Er.minFontScaleX,wi=Er.minFontScaleY,li=Er.glyphOffset,ti=Er.isSDF,aa=Er.sectionIndex,Vi=_t.vertexLength,Za=li[1];m(it,O.x,O.y,kr.x,Za+kr.y,Ln.x,Ln.y,r,ti,qn.x,qn.y,Fn,wi),m(it,O.x,O.y,Nr.x,Za+Nr.y,Ln.x+Ln.w,Ln.y,r,ti,Kn.x,qn.y,Fn,wi),m(it,O.x,O.y,vn.x,Za+vn.y,Ln.x,Ln.y+Ln.h,r,ti,qn.x,Kn.y,Fn,wi),m(it,O.x,O.y,hn.x,Za+hn.y,Ln.x+Ln.w,Ln.y+Ln.h,r,ti,Kn.x,Kn.y,Fn,wi),_(e.dynamicLayoutVertexArray,O,Zt),_e.emplaceBack(Vi,Vi+1,Vi+2),_e.emplaceBack(Vi+1,Vi+2,Vi+3),_t.vertexLength+=4,_t.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(li[0]),hr!==t.length-1&&aa===t[hr+1].sectionIndex||e.programConfigurations.populatePaintArrays(it.length,g,g.index,{},Ae,ir&&ir[aa])}e.placedSymbolArray.emplaceBack(O.x,O.y,Tt,this.glyphOffsetArray.length-Tt,Xt,G,Q,O.segment,r?r[0]:0,r?r[1]:0,u[0],u[1],C,0,!1,0,ve)},he.prototype._addCollisionDebugVertex=function(e,t,r,u,h,g){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,u,h,Math.round(g.x),Math.round(g.y))},he.prototype.addCollisionDebugVertices=function(e,t,r,u,h,g,C){var O=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),G=O.vertexLength,Q=h.layoutVertexArray,ve=h.collisionVertexArray,Ae=C.anchorX,_e=C.anchorY;this._addCollisionDebugVertex(Q,ve,g,Ae,_e,new q(e,t)),this._addCollisionDebugVertex(Q,ve,g,Ae,_e,new q(r,t)),this._addCollisionDebugVertex(Q,ve,g,Ae,_e,new q(r,u)),this._addCollisionDebugVertex(Q,ve,g,Ae,_e,new q(e,u)),O.vertexLength+=4;var it=h.indexArray;it.emplaceBack(G,G+1),it.emplaceBack(G+1,G+2),it.emplaceBack(G+2,G+3),it.emplaceBack(G+3,G),O.primitiveLength+=4},he.prototype.addDebugCollisionBoxes=function(e,t,r,u){for(var h=e;h<t;h++){var g=this.collisionBoxArray.get(h);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,u?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,r)}},he.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new se(bs,gh.members,pl),this.iconCollisionBox=new se(bs,gh.members,pl);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},he.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,u,h,g,C,O,G){for(var Q={},ve=t;ve<r;ve++){var Ae=e.get(ve);Q.textBox={x1:Ae.x1,y1:Ae.y1,x2:Ae.x2,y2:Ae.y2,anchorPointX:Ae.anchorPointX,anchorPointY:Ae.anchorPointY},Q.textFeatureIndex=Ae.featureIndex;break}for(var _e=u;_e<h;_e++){var it=e.get(_e);Q.verticalTextBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},Q.verticalTextFeatureIndex=it.featureIndex;break}for(var _t=g;_t<C;_t++){var Tt=e.get(_t);Q.iconBox={x1:Tt.x1,y1:Tt.y1,x2:Tt.x2,y2:Tt.y2,anchorPointX:Tt.anchorPointX,anchorPointY:Tt.anchorPointY},Q.iconFeatureIndex=Tt.featureIndex;break}for(var Xt=O;Xt<G;Xt++){var Zt=e.get(Xt);Q.verticalIconBox={x1:Zt.x1,y1:Zt.y1,x2:Zt.x2,y2:Zt.y2,anchorPointX:Zt.anchorPointX,anchorPointY:Zt.anchorPointY},Q.verticalIconFeatureIndex=Zt.featureIndex;break}return Q},he.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},he.prototype.hasTextData=function(){return this.text.segments.get().length>0},he.prototype.hasIconData=function(){return this.icon.segments.get().length>0},he.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},he.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},he.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},he.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),u=r.vertexStartIndex+4*r.numGlyphs,h=r.vertexStartIndex;h<u;h+=4)e.indexArray.emplaceBack(h,h+1,h+2),e.indexArray.emplaceBack(h+1,h+2,h+3)},he.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),u=[],h=[],g=[],C=0;C<this.symbolInstances.length;++C){g.push(C);var O=this.symbolInstances.get(C);u.push(0|Math.round(t*O.anchorX+r*O.anchorY)),h.push(O.featureIndex)}return g.sort(function(G,Q){return u[G]-u[Q]||h[Q]-h[G]}),g},he.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},he.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,u=this.symbolInstanceIndexes;r<u.length;r+=1){var h=this.symbolInstances.get(u[r]);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach(function(g,C,O){g>=0&&O.indexOf(g)===C&&t.addIndicesForPlacedSymbol(t.text,g)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Mn("SymbolBucket",he,{omit:["layers","collisionBoxArray","features","compareText"]}),he.MAX_GLYPHS=65535,he.addDynamicAttributes=_;var Ye=new No({"symbol-placement":new Jn(Re.layout_symbol["symbol-placement"]),"symbol-spacing":new Jn(Re.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Jn(Re.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Bn(Re.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Jn(Re.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Jn(Re.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Jn(Re.layout_symbol["icon-ignore-placement"]),"icon-optional":new Jn(Re.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Jn(Re.layout_symbol["icon-rotation-alignment"]),"icon-size":new Bn(Re.layout_symbol["icon-size"]),"icon-text-fit":new Jn(Re.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Jn(Re.layout_symbol["icon-text-fit-padding"]),"icon-image":new Bn(Re.layout_symbol["icon-image"]),"icon-rotate":new Bn(Re.layout_symbol["icon-rotate"]),"icon-padding":new Jn(Re.layout_symbol["icon-padding"]),"icon-keep-upright":new Jn(Re.layout_symbol["icon-keep-upright"]),"icon-offset":new Bn(Re.layout_symbol["icon-offset"]),"icon-anchor":new Bn(Re.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Jn(Re.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Jn(Re.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Jn(Re.layout_symbol["text-rotation-alignment"]),"text-field":new Bn(Re.layout_symbol["text-field"]),"text-font":new Bn(Re.layout_symbol["text-font"]),"text-size":new Bn(Re.layout_symbol["text-size"]),"text-max-width":new Bn(Re.layout_symbol["text-max-width"]),"text-line-height":new Jn(Re.layout_symbol["text-line-height"]),"text-letter-spacing":new Bn(Re.layout_symbol["text-letter-spacing"]),"text-justify":new Bn(Re.layout_symbol["text-justify"]),"text-radial-offset":new Bn(Re.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Jn(Re.layout_symbol["text-variable-anchor"]),"text-anchor":new Bn(Re.layout_symbol["text-anchor"]),"text-max-angle":new Jn(Re.layout_symbol["text-max-angle"]),"text-writing-mode":new Jn(Re.layout_symbol["text-writing-mode"]),"text-rotate":new Bn(Re.layout_symbol["text-rotate"]),"text-padding":new Jn(Re.layout_symbol["text-padding"]),"text-keep-upright":new Jn(Re.layout_symbol["text-keep-upright"]),"text-transform":new Bn(Re.layout_symbol["text-transform"]),"text-offset":new Bn(Re.layout_symbol["text-offset"]),"text-allow-overlap":new Jn(Re.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Jn(Re.layout_symbol["text-ignore-placement"]),"text-optional":new Jn(Re.layout_symbol["text-optional"])}),Lt={paint:new No({"icon-opacity":new Bn(Re.paint_symbol["icon-opacity"]),"icon-color":new Bn(Re.paint_symbol["icon-color"]),"icon-halo-color":new Bn(Re.paint_symbol["icon-halo-color"]),"icon-halo-width":new Bn(Re.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Bn(Re.paint_symbol["icon-halo-blur"]),"icon-translate":new Jn(Re.paint_symbol["icon-translate"]),"icon-translate-anchor":new Jn(Re.paint_symbol["icon-translate-anchor"]),"text-opacity":new Bn(Re.paint_symbol["text-opacity"]),"text-color":new Bn(Re.paint_symbol["text-color"],{runtimeType:En,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new Bn(Re.paint_symbol["text-halo-color"]),"text-halo-width":new Bn(Re.paint_symbol["text-halo-width"]),"text-halo-blur":new Bn(Re.paint_symbol["text-halo-blur"]),"text-translate":new Jn(Re.paint_symbol["text-translate"]),"text-translate-anchor":new Jn(Re.paint_symbol["text-translate-anchor"])}),layout:Ye},Bt=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:dn,this.defaultValue=t};Bt.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},Bt.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},Bt.prototype.outputDefined=function(){return!1},Bt.prototype.serialize=function(){return null},Mn("FormatSectionOverride",Bt,{omit:["defaultValue"]});var mr=function(e){function t(r){e.call(this,r,Lt)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){if(e.prototype.recalculate.call(this,r,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var h=this.layout.get("text-writing-mode");if(h){for(var g=[],C=0,O=h;C<O.length;C+=1){var G=O[C];g.indexOf(G)<0&&g.push(G)}this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,u,h,g){var C=this.layout.get(r).evaluate(u,{},h,g),O=this._unevaluatedLayout._values[r];return O.isDataDriven()||Vo(O.value)||!C?C:function(G,Q){return Q.replace(/{([^{}]+)}/g,function(ve,Ae){return Ae in G?String(G[Ae]):""})}(u.properties,C)},t.prototype.createBucket=function(r){return new he(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,u=Lt.paint.overridableProperties;r<u.length;r+=1){var h=u[r];if(t.hasPaintOverride(this.layout,h)){var g,C=this.paint.get(h),O=new Bt(C),G=new Bl(O,C.property.specification);g=C.value.kind==="constant"||C.value.kind==="source"?new kl("source",G):new Al("composite",G,C.value.zoomStops,C.value._interpolationType),this.paint._values[h]=new Ms(C.property,g,C.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,h){return!(!this.layout||u.isDataDriven()||h.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,u){var h=r.get("text-field"),g=Lt.paint.properties[u],C=!1,O=function(Ae){for(var _e=0,it=Ae;_e<it.length;_e+=1)if(g.overrides&&g.overrides.hasOverride(it[_e]))return void(C=!0)};if(h.value.kind==="constant"&&h.value.value instanceof to)O(h.value.value.sections);else if(h.value.kind==="source"){var G=function ve(Ae){C||(Ae instanceof ca&&Oa(Ae.value)===hi?O(Ae.value.sections):Ae instanceof yo?O(Ae.sections):Ae.eachChild(ve))},Q=h.value;Q._styleExpression&&G(Q._styleExpression.expression)}return C},t}(nu),yr={paint:new No({"background-color":new Jn(Re.paint_background["background-color"]),"background-pattern":new xs(Re.paint_background["background-pattern"]),"background-opacity":new Jn(Re.paint_background["background-opacity"])})},Ir=function(e){function t(r){e.call(this,r,yr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(nu),Xr={paint:new No({"raster-opacity":new Jn(Re.paint_raster["raster-opacity"]),"raster-hue-rotate":new Jn(Re.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Jn(Re.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Jn(Re.paint_raster["raster-brightness-max"]),"raster-saturation":new Jn(Re.paint_raster["raster-saturation"]),"raster-contrast":new Jn(Re.paint_raster["raster-contrast"]),"raster-resampling":new Jn(Re.paint_raster["raster-resampling"]),"raster-fade-duration":new Jn(Re.paint_raster["raster-fade-duration"])})},Jr=function(e){function t(r){e.call(this,r,Xr)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(nu),jn=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(nu),Zn={circle:yl,heatmap:ql,hillshade:Zf,fill:_r,"fill-extrusion":Sa,line:Ph,symbol:mr,background:Ir,raster:Jr},Ci=$.HTMLImageElement,mi=$.HTMLCanvasElement,la=$.HTMLVideoElement,Bi=$.ImageData,Yi=$.ImageBitmap,Ia=function(t,r,u,h){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(r,h)};Ia.prototype.update=function(e,t,r){var u=e.width,h=e.height,g=!(this.size&&this.size[0]===u&&this.size[1]===h||r),C=this.context,O=C.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),O.bindTexture(O.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===O.RGBA&&(!t||t.premultiply!==!1)),g)this.size=[u,h],e instanceof Ci||e instanceof mi||e instanceof la||e instanceof Bi||Yi&&e instanceof Yi?O.texImage2D(O.TEXTURE_2D,0,this.format,this.format,O.UNSIGNED_BYTE,e):O.texImage2D(O.TEXTURE_2D,0,this.format,u,h,0,this.format,O.UNSIGNED_BYTE,e.data);else{var G=r||{x:0,y:0},Q=G.x,ve=G.y;e instanceof Ci||e instanceof mi||e instanceof la||e instanceof Bi||Yi&&e instanceof Yi?O.texSubImage2D(O.TEXTURE_2D,0,Q,ve,O.RGBA,O.UNSIGNED_BYTE,e):O.texSubImage2D(O.TEXTURE_2D,0,Q,ve,u,h,O.RGBA,O.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&O.generateMipmap(O.TEXTURE_2D)},Ia.prototype.bind=function(e,t,r){var u=this.context.gl;u.bindTexture(u.TEXTURE_2D,this.texture),r!==u.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=u.LINEAR),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,t),this.wrap=t)},Ia.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Ia.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ka=function(t){var r=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){r._triggered=!1,r._callback()})};ka.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},ka.prototype.remove=function(){delete this._channel,this._callback=function(){}};var jo=function(t,r,u){this.target=t,this.parent=r,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},ar(["receive","process"],this),this.invoker=new ka(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=St()?t:$};function Dl(e,t,r){var u=2*Math.PI*6378137/256/Math.pow(2,r);return[e*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}jo.prototype.send=function(e,t,r,u,h){var g=this;h===void 0&&(h=!1);var C=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[C]=r);var O=z(this.globalScope)?void 0:[];return this.target.postMessage({id:C,type:e,hasCallback:!!r,targetMapId:u,mustQueue:h,sourceMapId:this.mapId,data:vu(t,O)},O),{cancel:function(){r&&delete g.callbacks[C],g.target.postMessage({id:C,type:"<cancel>",targetMapId:u,sourceMapId:g.mapId})}}},jo.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];var u=this.cancelCallbacks[r];delete this.cancelCallbacks[r],u&&u()}else St()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},jo.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},jo.prototype.processTask=function(e,t){var r=this;if(t.type==="<response>"){var u=this.callbacks[e];delete this.callbacks[e],u&&(t.error?u(Us(t.error)):u(null,Us(t.data)))}else{var h=!1,g=z(this.globalScope)?void 0:[],C=t.hasCallback?function(ve,Ae){h=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:ve?vu(ve):null,data:vu(Ae,g)},g)}:function(ve){h=!0},O=null,G=Us(t.data);if(this.parent[t.type])O=this.parent[t.type](t.sourceMapId,G,C);else if(this.parent.getWorkerSource){var Q=t.type.split(".");O=this.parent.getWorkerSource(t.sourceMapId,Q[0],G.source)[Q[1]](G,C)}else C(new Error("Could not find function "+t.type));!h&&O&&O.cancel&&(this.cancelCallbacks[e]=O.cancel)}},jo.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Ha=function(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Ha.prototype.setNorthEast=function(e){return this._ne=e instanceof ia?new ia(e.lng,e.lat):ia.convert(e),this},Ha.prototype.setSouthWest=function(e){return this._sw=e instanceof ia?new ia(e.lng,e.lat):ia.convert(e),this},Ha.prototype.extend=function(e){var t,r,u=this._sw,h=this._ne;if(e instanceof ia)t=e,r=e;else{if(!(e instanceof Ha))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ha.convert(e)):this.extend(ia.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return u||h?(u.lng=Math.min(t.lng,u.lng),u.lat=Math.min(t.lat,u.lat),h.lng=Math.max(r.lng,h.lng),h.lat=Math.max(r.lat,h.lat)):(this._sw=new ia(t.lng,t.lat),this._ne=new ia(r.lng,r.lat)),this},Ha.prototype.getCenter=function(){return new ia((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Ha.prototype.getSouthWest=function(){return this._sw},Ha.prototype.getNorthEast=function(){return this._ne},Ha.prototype.getNorthWest=function(){return new ia(this.getWest(),this.getNorth())},Ha.prototype.getSouthEast=function(){return new ia(this.getEast(),this.getSouth())},Ha.prototype.getWest=function(){return this._sw.lng},Ha.prototype.getSouth=function(){return this._sw.lat},Ha.prototype.getEast=function(){return this._ne.lng},Ha.prototype.getNorth=function(){return this._ne.lat},Ha.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Ha.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Ha.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Ha.prototype.contains=function(e){var t=ia.convert(e),r=t.lng,u=t.lat,h=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&h},Ha.convert=function(e){return!e||e instanceof Ha?e:new Ha(e)};var ia=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid LngLat object: ("+t+", "+r+")");if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};ia.prototype.wrap=function(){return new ia(ut(this.lng,-180,180),this.lat)},ia.prototype.toArray=function(){return[this.lng,this.lat]},ia.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},ia.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,u=e.lat*t,h=Math.sin(r)*Math.sin(u)+Math.cos(r)*Math.cos(u)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(h,1))},ia.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new Ha(new ia(this.lng-r,this.lat-t),new ia(this.lng+r,this.lat+t))},ia.convert=function(e){if(e instanceof ia)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new ia(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new ia(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var rc=2*Math.PI*63710088e-1;function Uf(e){return rc*Math.cos(e*Math.PI/180)}function Jc(e){return(180+e)/360}function mf(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function tl(e,t){return e/Uf(t)}function gf(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var rl=function(t,r,u){u===void 0&&(u=0),this.x=+t,this.y=+r,this.z=+u};rl.fromLngLat=function(e,t){t===void 0&&(t=0);var r=ia.convert(e);return new rl(Jc(r.lng),mf(r.lat),tl(t,r.lat))},rl.prototype.toLngLat=function(){return new ia(360*this.x-180,gf(this.y))},rl.prototype.toAltitude=function(){return this.z*Uf(gf(this.y))},rl.prototype.meterInMercatorCoordinateUnits=function(){return 1/rc*(e=gf(this.y),1/Math.cos(e*Math.PI/180));var e};var su=function(t,r,u){this.z=t,this.x=r,this.y=u,this.key=qa(0,t,t,r,u)};su.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},su.prototype.url=function(e,t){var r,u,h,g,C,O=(u=this.y,h=this.z,g=Dl(256*(r=this.x),256*(u=Math.pow(2,h)-u-1),h),C=Dl(256*(r+1),256*(u+1),h),g[0]+","+g[1]+","+C[0]+","+C[1]),G=function(Q,ve,Ae){for(var _e,it="",_t=Q;_t>0;_t--)it+=(ve&(_e=1<<_t-1)?1:0)+(Ae&_e?2:0);return it}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",G).replace("{bbox-epsg-3857}",O)},su.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new q(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},su.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Rc=function(t,r){this.wrap=t,this.canonical=r,this.key=qa(t,r.z,r.z,r.x,r.y)},Uo=function(t,r,u,h,g){this.overscaledZ=t,this.wrap=r,this.canonical=new su(u,+h,+g),this.key=qa(r,t,u,h,g)};function qa(e,t,r,u,h){(e*=2)<0&&(e=-1*e-1);var g=1<<r;return(g*g*e+g*h+u).toString(36)+r.toString(36)+t.toString(36)}Uo.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Uo.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Uo(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Uo(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Uo.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?qa(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):qa(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},Uo.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Uo.prototype.children=function(e){if(this.overscaledZ>=e)return[new Uo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,u=2*this.canonical.y;return[new Uo(t,this.wrap,t,r,u),new Uo(t,this.wrap,t,r+1,u),new Uo(t,this.wrap,t,r,u+1),new Uo(t,this.wrap,t,r+1,u+1)]},Uo.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Uo.prototype.wrapped=function(){return new Uo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Uo.prototype.unwrapTo=function(e){return new Uo(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Uo.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Uo.prototype.toUnwrapped=function(){return new Rc(this.wrap,this.canonical)},Uo.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Uo.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new rl(e.x-this.wrap,e.y))},Mn("CanonicalTileID",su),Mn("OverscaledTileID",Uo,{omit:["posMatrix"]});var ks=function(t,r,u){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return Le('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=r.height;var h=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=u||"mapbox";for(var g=0;g<h;g++)this.data[this._idx(-1,g)]=this.data[this._idx(0,g)],this.data[this._idx(h,g)]=this.data[this._idx(h-1,g)],this.data[this._idx(g,-1)]=this.data[this._idx(g,0)],this.data[this._idx(g,h)]=this.data[this._idx(g,h-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(h,-1)]=this.data[this._idx(h-1,0)],this.data[this._idx(-1,h)]=this.data[this._idx(0,h-1)],this.data[this._idx(h,h)]=this.data[this._idx(h-1,h-1)]};ks.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),u=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[u],r[u+1],r[u+2])},ks.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},ks.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},ks.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},ks.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},ks.prototype.getPixels=function(){return new Fo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},ks.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var u=t*this.dim,h=t*this.dim+this.dim,g=r*this.dim,C=r*this.dim+this.dim;switch(t){case-1:u=h-1;break;case 1:h=u+1}switch(r){case-1:g=C-1;break;case 1:C=g+1}for(var O=-t*this.dim,G=-r*this.dim,Q=g;Q<C;Q++)for(var ve=u;ve<h;ve++)this.data[this._idx(ve,Q)]=e.data[this._idx(ve+O,Q+G)]},Mn("DEMData",ks);var th=function(t){this._stringToNumber={},this._numberToString=[];for(var r=0;r<t.length;r++){var u=t[r];this._stringToNumber[u]=r,this._numberToString[r]=u}};th.prototype.encode=function(e){return this._stringToNumber[e]},th.prototype.decode=function(e){return this._numberToString[e]};var rh=function(t,r,u,h,g){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=u,t._y=h,this.properties=t.properties,this.id=g},Mh={geometry:{configurable:!0}};Mh.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Mh.geometry.set=function(e){this._geometry=e},rh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(rh.prototype,Mh);var nl=function(){this.state={},this.stateChanges={},this.deletedStates={}};nl.prototype.updateState=function(e,t,r){var u=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},Me(this.stateChanges[e][u],r),this.deletedStates[e]===null)for(var h in this.deletedStates[e]={},this.state[e])h!==u&&(this.deletedStates[e][h]=null);else if(this.deletedStates[e]&&this.deletedStates[e][u]===null)for(var g in this.deletedStates[e][u]={},this.state[e][u])r[g]||(this.deletedStates[e][u][g]=null);else for(var C in r)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][C]===null&&delete this.deletedStates[e][u][C]},nl.prototype.removeFeatureState=function(e,t,r){if(this.deletedStates[e]!==null){var u=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(r in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][r]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}},nl.prototype.getState=function(e,t){var r=String(t),u=Me({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var h=this.deletedStates[e][t];if(h===null)return{};for(var g in h)delete u[g]}return u},nl.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},nl.prototype.coalesceChanges=function(e,t){var r={};for(var u in this.stateChanges){this.state[u]=this.state[u]||{};var h={};for(var g in this.stateChanges[u])this.state[u][g]||(this.state[u][g]={}),Me(this.state[u][g],this.stateChanges[u][g]),h[g]=this.state[u][g];r[u]=h}for(var C in this.deletedStates){this.state[C]=this.state[C]||{};var O={};if(this.deletedStates[C]===null)for(var G in this.state[C])O[G]={},this.state[C][G]={};else for(var Q in this.deletedStates[C]){if(this.deletedStates[C][Q]===null)this.state[C][Q]={};else for(var ve=0,Ae=Object.keys(this.deletedStates[C][Q]);ve<Ae.length;ve+=1)delete this.state[C][Q][Ae[ve]];O[Q]=this.state[C][Q]}r[C]=r[C]||{},Me(r[C],O)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var _e in e)e[_e].setFeatureState(r,t)};var yc=function(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Ki(8192,16,0),this.grid3D=new Ki(8192,16,0),this.featureIndexArray=new Te,this.promoteId=r};function Xh(e,t,r,u,h){return Ht(e,function(g,C){var O=t instanceof ru?t.get(C):null;return O&&O.evaluate?O.evaluate(r,u,h):O})}function rd(e){for(var t=1/0,r=1/0,u=-1/0,h=-1/0,g=0,C=e;g<C.length;g+=1){var O=C[g];t=Math.min(t,O.x),r=Math.min(r,O.y),u=Math.max(u,O.x),h=Math.max(h,O.y)}return{minX:t,minY:r,maxX:u,maxY:h}}function ld(e,t){return t-e}yc.prototype.insert=function(e,t,r,u,h,g){var C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,u,h);for(var O=g?this.grid3D:this.grid,G=0;G<t.length;G++){for(var Q=t[G],ve=[1/0,1/0,-1/0,-1/0],Ae=0;Ae<Q.length;Ae++){var _e=Q[Ae];ve[0]=Math.min(ve[0],_e.x),ve[1]=Math.min(ve[1],_e.y),ve[2]=Math.max(ve[2],_e.x),ve[3]=Math.max(ve[3],_e.y)}ve[0]<8192&&ve[1]<8192&&ve[2]>=0&&ve[3]>=0&&O.insert(C,ve[0],ve[1],ve[2],ve[3])}},yc.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new go.VectorTile(new Fe(this.rawTileData)).layers,this.sourceLayerCoder=new th(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},yc.prototype.query=function(e,t,r,u){var h=this;this.loadVTLayers();for(var g=e.params||{},C=8192/e.tileSize/e.scale,O=Ac(g.filter),G=e.queryGeometry,Q=e.queryPadding*C,ve=rd(G),Ae=this.grid.query(ve.minX-Q,ve.minY-Q,ve.maxX+Q,ve.maxY+Q),_e=rd(e.cameraQueryGeometry),it=this.grid3D.query(_e.minX-Q,_e.minY-Q,_e.maxX+Q,_e.maxY+Q,function(Er,kr,Nr,vn){return function(hn,Ln,qn,Kn,Fn){for(var wi=0,li=hn;wi<li.length;wi+=1){var ti=li[wi];if(Ln<=ti.x&&qn<=ti.y&&Kn>=ti.x&&Fn>=ti.y)return!0}var aa=[new q(Ln,qn),new q(Ln,Fn),new q(Kn,Fn),new q(Kn,qn)];if(hn.length>2){for(var Vi=0,Za=aa;Vi<Za.length;Vi+=1)if(iu(hn,Za[Vi]))return!0}for(var yi=0;yi<hn.length-1;yi++)if(pc(hn[yi],hn[yi+1],aa))return!0;return!1}(e.cameraQueryGeometry,Er-Q,kr-Q,Nr+Q,vn+Q)}),_t=0,Tt=it;_t<Tt.length;_t+=1)Ae.push(Tt[_t]);Ae.sort(ld);for(var Xt,Zt={},ir=function(kr){var Nr=Ae[kr];if(Nr!==Xt){Xt=Nr;var vn=h.featureIndexArray.get(Nr),hn=null;h.loadMatchingFeature(Zt,vn.bucketIndex,vn.sourceLayerIndex,vn.featureIndex,O,g.layers,g.availableImages,t,r,u,function(Ln,qn,Kn){return hn||(hn=_a(Ln)),qn.queryIntersectsFeature(G,Ln,Kn,hn,h.z,e.transform,C,e.pixelPosMatrix)})}},hr=0;hr<Ae.length;hr++)ir(hr);return Zt},yc.prototype.loadMatchingFeature=function(e,t,r,u,h,g,C,O,G,Q,ve){var Ae=this.bucketLayerIDs[t];if(!g||function(hn,Ln){for(var qn=0;qn<hn.length;qn++)if(Ln.indexOf(hn[qn])>=0)return!0;return!1}(g,Ae)){var _e=this.sourceLayerCoder.decode(r),it=this.vtLayers[_e].feature(u);if(h.needGeometry){var _t=Ja(it,!0);if(!h.filter(new Ti(this.tileID.overscaledZ),_t,this.tileID.canonical))return}else if(!h.filter(new Ti(this.tileID.overscaledZ),it))return;for(var Tt=this.getId(it,_e),Xt=0;Xt<Ae.length;Xt++){var Zt=Ae[Xt];if(!(g&&g.indexOf(Zt)<0)){var ir=O[Zt];if(ir){var hr={};Tt!==void 0&&Q&&(hr=Q.getState(ir.sourceLayer||"_geojsonTileLayer",Tt));var Er=Me({},G[Zt]);Er.paint=Xh(Er.paint,ir.paint,it,hr,C),Er.layout=Xh(Er.layout,ir.layout,it,hr,C);var kr=!ve||ve(it,ir,hr);if(kr){var Nr=new rh(it,this.z,this.x,this.y,Tt);Nr.layer=Er;var vn=e[Zt];vn===void 0&&(vn=e[Zt]=[]),vn.push({featureIndex:u,feature:Nr,intersectionZ:kr})}}}}}},yc.prototype.lookupSymbolFeatures=function(e,t,r,u,h,g,C,O){var G={};this.loadVTLayers();for(var Q=Ac(h),ve=0,Ae=e;ve<Ae.length;ve+=1)this.loadMatchingFeature(G,r,u,Ae[ve],Q,g,C,O,t);return G},yc.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var u=0,h=r[t];u<h.length;u+=1)if(e===h[u])return!0;return!1},yc.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&typeof(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(r=Number(r)),r},Mn("FeatureIndex",yc,{omit:["rawTileData","sourceLayerCoder"]});var Cs=function(t,r){this.tileID=t,this.uid=xt(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Cs.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<ue.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Cs.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Cs.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var u in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(Q,ve){var Ae={};if(!ve)return Ae;for(var _e=function(){var Xt=_t[it],Zt=Xt.layerIds.map(function(Er){return ve.getLayer(Er)}).filter(Boolean);if(Zt.length!==0){Xt.layers=Zt,Xt.stateDependentLayerIds&&(Xt.stateDependentLayers=Xt.stateDependentLayerIds.map(function(Er){return Zt.filter(function(kr){return kr.id===Er})[0]}));for(var ir=0,hr=Zt;ir<hr.length;ir+=1)Ae[hr[ir].id]=Xt}},it=0,_t=Q;it<_t.length;it+=1)_e();return Ae}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var h=this.buckets[u];if(h instanceof he){if(this.hasSymbolBuckets=!0,!r)break;h.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var g in this.buckets){var C=this.buckets[g];if(C instanceof he&&C.hasRTLText){this.hasRTLText=!0,us.isLoading()||us.isLoaded()||Ho()!=="deferred"||ss();break}}for(var O in this.queryPadding=0,this.buckets){var G=this.buckets[O];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(O).queryRadius(G))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new i},Cs.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Cs.prototype.getBucket=function(e){return this.buckets[e.id]},Cs.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var u=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ia(e,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ia(e,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)},Cs.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Cs.prototype.queryRenderedFeatures=function(e,t,r,u,h,g,C,O,G,Q){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:h,scale:g,tileSize:this.tileSize,pixelPosMatrix:Q,transform:O,params:C,queryPadding:this.queryPadding*G},e,t,r):{}},Cs.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var u=r.loadVTLayers(),h=t?t.sourceLayer:"",g=u._geojsonTileLayer||u[h];if(g)for(var C=Ac(t&&t.filter),O=this.tileID.canonical,G=O.z,Q=O.x,ve=O.y,Ae={z:G,x:Q,y:ve},_e=0;_e<g.length;_e++){var it=g.feature(_e);if(C.needGeometry){var _t=Ja(it,!0);if(!C.filter(new Ti(this.tileID.overscaledZ),_t,this.tileID.canonical))continue}else if(!C.filter(new Ti(this.tileID.overscaledZ),it))continue;var Tt=r.getId(it,h),Xt=new rh(it,G,Q,ve,Tt);Xt.tile=Ae,e.push(Xt)}}},Cs.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Cs.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Cs.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=dt(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var u=Date.now(),h=!1;if(this.expirationTime>u)h=!1;else if(t)if(this.expirationTime<t)h=!0;else{var g=this.expirationTime-t;g?this.expirationTime=u+Math.max(g,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Cs.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Cs.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var u in this.buckets)if(t.style.hasLayer(u)){var h=this.buckets[u],g=h.layers[0].sourceLayer||"_geojsonTileLayer",C=r[g],O=e[g];if(C&&O&&Object.keys(O).length!==0){h.update(O,C,this.imageAtlas&&this.imageAtlas.patternPositions||{});var G=t&&t.style&&t.style.getLayer(u);G&&(this.queryPadding=Math.max(this.queryPadding,G.queryRadius(h)))}}}},Cs.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Cs.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ue.now()},Cs.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Cs.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=ue.now()+e},Cs.prototype.setDependencies=function(e,t){for(var r={},u=0,h=t;u<h.length;u+=1)r[h[u]]=!0;this.dependencies[e]=r},Cs.prototype.hasDependency=function(e,t){for(var r=0,u=e;r<u.length;r+=1){var h=this.dependencies[u[r]];if(h){for(var g=0,C=t;g<C.length;g+=1)if(h[C[g]])return!0}}return!1};var nh=$.performance,cd=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},nh.mark(this._marks.start)};cd.prototype.finish=function(){nh.mark(this._marks.end);var e=nh.getEntriesByName(this._marks.measure);return e.length===0&&(nh.measure(this._marks.measure,this._marks.start,this._marks.end),e=nh.getEntriesByName(this._marks.measure),nh.clearMarks(this._marks.start),nh.clearMarks(this._marks.end),nh.clearMeasures(this._marks.measure)),e},o.Actor=jo,o.AlphaImage=Hs,o.CanonicalTileID=su,o.CollisionBoxArray=i,o.Color=ci,o.DEMData=ks,o.DataConstantProperty=Jn,o.DictionaryCoder=th,o.EXTENT=8192,o.ErrorEvent=qe,o.EvaluationParameters=Ti,o.Event=Ie,o.Evented=Ct,o.FeatureIndex=yc,o.FillBucket=Ut,o.FillExtrusionBucket=Xi,o.ImageAtlas=Yn,o.ImagePosition=Hr,o.LineBucket=ju,o.LngLat=ia,o.LngLatBounds=Ha,o.MercatorCoordinate=rl,o.ONE_EM=24,o.OverscaledTileID=Uo,o.Point=q,o.Point$1=q,o.Properties=No,o.Protobuf=Fe,o.RGBAImage=Fo,o.RequestManager=R,o.RequestPerformance=cd,o.ResourceType=Zr,o.SegmentVector=Ke,o.SourceFeatureState=nl,o.StructArrayLayout1ui2=vl,o.StructArrayLayout2f1f2i16=Nu,o.StructArrayLayout2i4=dl,o.StructArrayLayout3ui6=_l,o.StructArrayLayout4i8=fc,o.SymbolBucket=he,o.Texture=Ia,o.Tile=Cs,o.Transitionable=ho,o.Uniform1f=sn,o.Uniform1i=wr,o.Uniform2f=$r,o.Uniform3f=xn,o.Uniform4f=In,o.UniformColor=ei,o.UniformMatrix4f=Ii,o.UnwrappedTileID=Rc,o.ValidationError=mt,o.WritingMode=ai,o.ZoomHistory=Ou,o.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},o.addDynamicAttributes=_,o.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var u=e.length,h=new Array(e.length),g=null;e.forEach(function(C,O){t(C,function(G,Q){G&&(g=G),h[O]=Q,--u==0&&r(g,h)})})},o.bezier=Be,o.bindAll=ar,o.browser=ue,o.cacheEntryPossiblyAdded=function(e){++Vt>pt&&(e.getActor().send("enforceCacheSizeLimit",Pt),Vt=0)},o.clamp=st,o.clearTileCache=function(e){var t=$.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},o.clipLine=_n,o.clone=function(e){var t=new To(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},o.clone$1=Ze,o.clone$2=function(e){var t=new To(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.collisionCircleLayout=jh,o.config=ye,o.create=function(){var e=new To(16);return To!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},o.create$1=function(){var e=new To(9);return To!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},o.create$2=function(){var e=new To(4);return To!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},o.createCommonjsModule=X,o.createExpression=ac,o.createLayout=po,o.createStyleLayer=function(e){return e.type==="custom"?new jn(e):new Zn[e.type](e)},o.cross=function(e,t,r){var u=t[0],h=t[1],g=t[2],C=r[0],O=r[1],G=r[2];return e[0]=h*G-g*O,e[1]=g*C-u*G,e[2]=u*O-h*C,e},o.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var u=0;u<t.length;u++)if(!e(t[u],r[u]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(var h in t)if(!e(t[h],r[h]))return!1;return!0}return t===r},o.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},o.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},o.ease=ce,o.emitValidationErrors=ya,o.endsWith=$t,o.enforceCacheSizeLimit=function(e){Pe(),Xe&&Xe.then(function(t){t.keys().then(function(r){for(var u=0;u<r.length-e;u++)t.delete(r[u])})})},o.evaluateSizeForFeature=As,o.evaluateSizeForZoom=rs,o.evaluateVariableOffset=Kt,o.evented=Ns,o.extend=Me,o.featureFilter=Ac,o.filterObject=vt,o.fromRotation=function(e,t){var r=Math.sin(t),u=Math.cos(t);return e[0]=u,e[1]=r,e[2]=0,e[3]=-r,e[4]=u,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},o.getAnchorAlignment=Xo,o.getAnchorJustification=sr,o.getArrayBuffer=Wn,o.getImage=pe,o.getJSON=function(e,t){return fi(Me(e,{type:"json"}),t)},o.getRTLTextPluginStatus=Ho,o.getReferrer=Un,o.getVideo=function(e,t){var r,u,h=$.document.createElement("video");h.muted=!0,h.onloadstart=function(){t(null,h)};for(var g=0;g<e.length;g++){var C=$.document.createElement("source");r=e[g],u=void 0,(u=$.document.createElement("a")).href=r,(u.protocol!==$.document.location.protocol||u.host!==$.document.location.host)&&(h.crossOrigin="Anonymous"),C.src=e[g],h.appendChild(C)}return{cancel:function(){}}},o.identity=vo,o.invert=function(e,t){var r=t[0],u=t[1],h=t[2],g=t[3],C=t[4],O=t[5],G=t[6],Q=t[7],ve=t[8],Ae=t[9],_e=t[10],it=t[11],_t=t[12],Tt=t[13],Xt=t[14],Zt=t[15],ir=r*O-u*C,hr=r*G-h*C,Er=r*Q-g*C,kr=u*G-h*O,Nr=u*Q-g*O,vn=h*Q-g*G,hn=ve*Tt-Ae*_t,Ln=ve*Xt-_e*_t,qn=ve*Zt-it*_t,Kn=Ae*Xt-_e*Tt,Fn=Ae*Zt-it*Tt,wi=_e*Zt-it*Xt,li=ir*wi-hr*Fn+Er*Kn+kr*qn-Nr*Ln+vn*hn;return li?(e[0]=(O*wi-G*Fn+Q*Kn)*(li=1/li),e[1]=(h*Fn-u*wi-g*Kn)*li,e[2]=(Tt*vn-Xt*Nr+Zt*kr)*li,e[3]=(_e*Nr-Ae*vn-it*kr)*li,e[4]=(G*qn-C*wi-Q*Ln)*li,e[5]=(r*wi-h*qn+g*Ln)*li,e[6]=(Xt*Er-_t*vn-Zt*hr)*li,e[7]=(ve*vn-_e*Er+it*hr)*li,e[8]=(C*Fn-O*qn+Q*hn)*li,e[9]=(u*qn-r*Fn-g*hn)*li,e[10]=(_t*Nr-Tt*Er+Zt*ir)*li,e[11]=(Ae*Er-ve*Nr-it*ir)*li,e[12]=(O*Ln-C*Kn-G*hn)*li,e[13]=(r*Kn-u*Ln+h*hn)*li,e[14]=(Tt*hr-_t*kr-Xt*ir)*li,e[15]=(ve*kr-Ae*hr+_e*ir)*li,e):null},o.isChar=an,o.isMapboxURL=J,o.keysDifference=function(e,t){var r=[];for(var u in e)u in t||r.push(u);return r},o.makeRequest=fi,o.mapObject=Ht,o.mercatorXfromLng=Jc,o.mercatorYfromLat=mf,o.mercatorZfromAltitude=tl,o.mul=io,o.multiply=es,o.mvt=go,o.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},o.normalize=function(e,t){var r=t[0],u=t[1],h=t[2],g=r*r+u*u+h*h;return g>0&&(g=1/Math.sqrt(g)),e[0]=t[0]*g,e[1]=t[1]*g,e[2]=t[2]*g,e},o.number=Ka,o.offscreenCanvasSupported=dr,o.ortho=function(e,t,r,u,h,g,C){var O=1/(t-r),G=1/(u-h),Q=1/(g-C);return e[0]=-2*O,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*G,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*Q,e[11]=0,e[12]=(t+r)*O,e[13]=(h+u)*G,e[14]=(C+g)*Q,e[15]=1,e},o.parseGlyphPBF=function(e){return new Fe(e).readFields(Dr,[])},o.pbf=Fe,o.performSymbolLayout=function(e,t,r,u,h,g,C){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var O=e.layers[0].layout,G=e.layers[0]._unevaluatedLayout._values,Q={};if(e.textSizeData.kind==="composite"){var ve=e.textSizeData,Ae=ve.maxZoom;Q.compositeTextSizes=[G["text-size"].possiblyEvaluate(new Ti(ve.minZoom),C),G["text-size"].possiblyEvaluate(new Ti(Ae),C)]}if(e.iconSizeData.kind==="composite"){var _e=e.iconSizeData,it=_e.maxZoom;Q.compositeIconSizes=[G["icon-size"].possiblyEvaluate(new Ti(_e.minZoom),C),G["icon-size"].possiblyEvaluate(new Ti(it),C)]}Q.layoutTextSize=G["text-size"].possiblyEvaluate(new Ti(e.zoom+1),C),Q.layoutIconSize=G["icon-size"].possiblyEvaluate(new Ti(e.zoom+1),C),Q.textMaxSize=G["text-size"].possiblyEvaluate(new Ti(18));for(var _t=24*O.get("text-line-height"),Tt=O.get("text-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point",Xt=O.get("text-keep-upright"),Zt=O.get("text-size"),ir=function(){var Nr=Er[hr],vn=O.get("text-font").evaluate(Nr,{},C).join(","),hn=Zt.evaluate(Nr,{},C),Ln=Q.layoutTextSize.evaluate(Nr,{},C),qn=Q.layoutIconSize.evaluate(Nr,{},C),Kn={horizontal:{},vertical:void 0},Fn=Nr.text,wi=[0,0];if(Fn){var li=Fn.toString(),ti=24*O.get("text-letter-spacing").evaluate(Nr,{},C),aa=function(Ea){for(var da=0,oo=Ea;da<oo.length;da+=1)if(Po=oo[da].charCodeAt(0),an.Arabic(Po)||an["Arabic Supplement"](Po)||an["Arabic Extended-A"](Po)||an["Arabic Presentation Forms-A"](Po)||an["Arabic Presentation Forms-B"](Po))return!1;var Po;return!0}(li)?ti:0,Vi=O.get("text-anchor").evaluate(Nr,{},C),Za=O.get("text-variable-anchor");if(!Za){var yi=O.get("text-radial-offset").evaluate(Nr,{},C);wi=yi?Kt(Vi,[24*yi,Qe]):O.get("text-offset").evaluate(Nr,{},C).map(function(Ea){return 24*Ea})}var ha=Tt?"center":O.get("text-justify").evaluate(Nr,{},C),Ko=O.get("symbol-placement"),Ca=Ko==="point"?24*O.get("text-max-width").evaluate(Nr,{},C):0,$o=function(){e.allowVerticalPlacement&&Gc(li)&&(Kn.vertical=jr(Fn,t,r,h,vn,Ca,_t,Vi,"left",aa,wi,ai.vertical,!0,Ko,Ln,hn))};if(!Tt&&Za){for(var Jo=ha==="auto"?Za.map(function(Ea){return sr(Ea)}):[ha],hs=!1,Su=0;Su<Jo.length;Su++){var ds=Jo[Su];if(!Kn.horizontal[ds])if(hs)Kn.horizontal[ds]=Kn.horizontal[0];else{var il=jr(Fn,t,r,h,vn,Ca,_t,"center",ds,aa,wi,ai.horizontal,!1,Ko,Ln,hn);il&&(Kn.horizontal[ds]=il,hs=il.positionedLines.length===1)}}$o()}else{ha==="auto"&&(ha=sr(Vi));var uu=jr(Fn,t,r,h,vn,Ca,_t,Vi,ha,aa,wi,ai.horizontal,!1,Ko,Ln,hn);uu&&(Kn.horizontal[ha]=uu),$o(),Gc(li)&&Tt&&Xt&&(Kn.vertical=jr(Fn,t,r,h,vn,Ca,_t,Vi,ha,aa,wi,ai.vertical,!1,Ko,Ln,hn))}}var al=void 0,lu=!1;if(Nr.icon&&Nr.icon.name){var Xs=u[Nr.icon.name];Xs&&(al=function(Ea,da,oo){var Po=Xo(oo),Eu=da[0]-Ea.displaySize[0]*Po.horizontalAlign,Io=da[1]-Ea.displaySize[1]*Po.verticalAlign;return{image:Ea,top:Io,bottom:Io+Ea.displaySize[1],left:Eu,right:Eu+Ea.displaySize[0]}}(h[Nr.icon.name],O.get("icon-offset").evaluate(Nr,{},C),O.get("icon-anchor").evaluate(Nr,{},C)),lu=Xs.sdf,e.sdfIcons===void 0?e.sdfIcons=Xs.sdf:e.sdfIcons!==Xs.sdf&&Le("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Xs.pixelRatio!==e.pixelRatio||O.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var cu=b(Kn.horizontal)||Kn.vertical;e.iconsInText=!!cu&&cu.iconsInText,(cu||al)&&function(Ea,da,oo,Po,Eu,Io,Qo,Uu,xa,ih,Qc){var yf=Io.textMaxSize.evaluate(da,{});yf===void 0&&(yf=Qo);var xc,Vu=Ea.layers[0].layout,Vf=Vu.get("icon-offset").evaluate(da,{},Qc),Gf=b(oo.horizontal),ah=Qo/24,Ih=Ea.tilePixelRatio*ah,zf=Ea.tilePixelRatio*yf/24,Oh=Ea.tilePixelRatio*Uu,oh=Ea.tilePixelRatio*Vu.get("symbol-spacing"),yh=Vu.get("text-padding")*Ea.tilePixelRatio,Yh=Vu.get("icon-padding")*Ea.tilePixelRatio,Uh=Vu.get("text-max-angle")/180*Math.PI,Kh=Vu.get("text-rotation-alignment")==="map"&&Vu.get("symbol-placement")!=="point",xh=Vu.get("icon-rotation-alignment")==="map"&&Vu.get("symbol-placement")!=="point",Lh=Vu.get("symbol-placement"),$h=oh/2,bh=Vu.get("icon-text-fit");Po&&bh!=="none"&&(Ea.allowVerticalPlacement&&oo.vertical&&(xc=ta(Po,oo.vertical,bh,Vu.get("icon-text-fit-padding"),Vf,ah)),Gf&&(Po=ta(Po,Gf,bh,Vu.get("icon-text-fit-padding"),Vf,ah)));var sh=function(fd,Bh){Bh.x<0||Bh.x>=8192||Bh.y<0||Bh.y>=8192||function(ws,qc,hd,uh,od,d,A,T,E,w,I,j,ne,ge,ke,Dt,Jt,Or,Fr,bn,gn,kn,Pi,Oi,Ga){var pa,va,so,Li,uo,Oo=ws.addToLineVertexArray(qc,hd),Ys=0,ra=0,Ds=0,ns=0,xf=-1,kh=-1,Dc={},Ch=zt(""),dh=0,ef=0;if(T._unevaluatedLayout.getValue("text-radial-offset")===void 0?(dh=(pa=T.layout.get("text-offset").evaluate(gn,{},Oi).map(function(Td){return 24*Td}))[0],ef=pa[1]):(dh=24*T.layout.get("text-radial-offset").evaluate(gn,{},Oi),ef=Qe),ws.allowVerticalPlacement&&uh.vertical){var dd=T.layout.get("text-rotate").evaluate(gn,{},Oi)+90;Li=new wt(E,qc,w,I,j,uh.vertical,ne,ge,ke,dd),A&&(uo=new wt(E,qc,w,I,j,A,Jt,Or,ke,dd))}if(od){var sd=T.layout.get("icon-rotate").evaluate(gn,{}),pd=T.layout.get("icon-text-fit")!=="none",vd=Fi(od,sd,Pi,pd),ud=A?Fi(A,sd,Pi,pd):void 0;so=new wt(E,qc,w,I,j,od,Jt,Or,!1,sd),Ys=4*vd.length;var md=ws.iconSizeData,Wh=null;md.kind==="source"?(Wh=[128*T.layout.get("icon-size").evaluate(gn,{})])[0]>32640&&Le(ws.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):md.kind==="composite"&&((Wh=[128*kn.compositeIconSizes[0].evaluate(gn,{},Oi),128*kn.compositeIconSizes[1].evaluate(gn,{},Oi)])[0]>32640||Wh[1]>32640)&&Le(ws.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),ws.addSymbols(ws.icon,vd,Wh,bn,Fr,gn,!1,qc,Oo.lineStartIndex,Oo.lineLength,-1,Oi),xf=ws.icon.placedSymbolArray.length-1,ud&&(ra=4*ud.length,ws.addSymbols(ws.icon,ud,Wh,bn,Fr,gn,ai.vertical,qc,Oo.lineStartIndex,Oo.lineLength,-1,Oi),kh=ws.icon.placedSymbolArray.length-1)}for(var gd in uh.horizontal){var td=uh.horizontal[gd];if(!va){Ch=zt(td.text);var Zi=T.layout.get("text-rotate").evaluate(gn,{},Oi);va=new wt(E,qc,w,I,j,td,ne,ge,ke,Zi)}var Wa=td.positionedLines.length===1;if(Ds+=lr(ws,qc,td,d,T,ke,gn,Dt,Oo,uh.vertical?ai.horizontal:ai.horizontalOnly,Wa?Object.keys(uh.horizontal):[gd],Dc,xf,kn,Oi),Wa)break}uh.vertical&&(ns+=lr(ws,qc,uh.vertical,d,T,ke,gn,Dt,Oo,ai.vertical,["vertical"],Dc,kh,kn,Oi));var ga=va?va.boxStartIndex:ws.collisionBoxArray.length,zn=va?va.boxEndIndex:ws.collisionBoxArray.length,zc=Li?Li.boxStartIndex:ws.collisionBoxArray.length,Ps=Li?Li.boxEndIndex:ws.collisionBoxArray.length,tf=so?so.boxStartIndex:ws.collisionBoxArray.length,rf=so?so.boxEndIndex:ws.collisionBoxArray.length,wh=uo?uo.boxStartIndex:ws.collisionBoxArray.length,yd=uo?uo.boxEndIndex:ws.collisionBoxArray.length,ph=-1,xd=function(bd,Ad){return bd&&bd.circleDiameter?Math.max(bd.circleDiameter,Ad):Ad};ph=xd(va,ph),ph=xd(Li,ph),ph=xd(so,ph);var Ed=(ph=xd(uo,ph))>-1?1:0;Ed&&(ph*=Ga/24),ws.glyphOffsetArray.length>=he.MAX_GLYPHS&&Le("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),gn.sortKey!==void 0&&ws.addToSortKeyRanges(ws.symbolInstances.length,gn.sortKey),ws.symbolInstances.emplaceBack(qc.x,qc.y,Dc.right>=0?Dc.right:-1,Dc.center>=0?Dc.center:-1,Dc.left>=0?Dc.left:-1,Dc.vertical||-1,xf,kh,Ch,ga,zn,zc,Ps,tf,rf,wh,yd,w,Ds,ns,Ys,ra,Ed,0,ne,dh,ef,ph)}(Ea,Bh,fd,oo,Po,Eu,xc,Ea.layers[0],Ea.collisionBoxArray,da.index,da.sourceLayerIndex,Ea.index,Ih,yh,Kh,xa,Oh,Yh,xh,Vf,da,Io,ih,Qc,Qo)};if(Lh==="line")for(var hh=0,Jh=_n(da.geometry,0,0,8192,8192);hh<Jh.length;hh+=1)for(var Vh=Jh[hh],Sh=0,Gh=Ba(Vh,oh,Uh,oo.vertical||Gf,Po,24,zf,Ea.overscaling,8192);Sh<Gh.length;Sh+=1){var Rh=Gh[Sh];Gf&&p(Ea,Gf.text,$h,Rh)||sh(Vh,Rh)}else if(Lh==="line-center")for(var Eh=0,Hh=da.geometry;Eh<Hh.length;Eh+=1){var Zh=Hh[Eh];if(Zh.length>1){var Dh=ou(Zh,Uh,oo.vertical||Gf,Po,24,zf);Dh&&sh(Zh,Dh)}}else if(da.type==="Polygon")for(var zh=0,Th=D(da.geometry,0);zh<Th.length;zh+=1){var Nh=Th[zh],Ah=Dn(Nh,16);sh(Nh[0],new wo(Ah.x,Ah.y,0))}else if(da.type==="LineString")for(var Hf=0,Fh=da.geometry;Hf<Fh.length;Hf+=1){var Qh=Fh[Hf];sh(Qh,new wo(Qh[0].x,Qh[0].y,0))}else if(da.type==="Point")for(var qh=0,nd=da.geometry;qh<nd.length;qh+=1)for(var id=0,ad=nd[qh];id<ad.length;id+=1){var ed=ad[id];sh([ed],new wo(ed.x,ed.y,0))}}(e,Nr,Kn,al,u,Q,Ln,qn,wi,lu,C)},hr=0,Er=e.features;hr<Er.length;hr+=1)ir();g&&e.generateCollisionDebugBuffers()},o.perspective=function(e,t,r,u,h){var g,C=1/Math.tan(t/2);return e[0]=C/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=C,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,h!=null&&h!==1/0?(e[10]=(h+u)*(g=1/(u-h)),e[14]=2*h*u*g):(e[10]=-1,e[14]=-2*u),e},o.pick=function(e,t){for(var r={},u=0;u<t.length;u++){var h=t[u];h in e&&(r[h]=e[h])}return r},o.plugin=us,o.polygonIntersectsPolygon=yu,o.postMapLoadEvent=ht,o.postTurnstileEvent=ur,o.potpack=Gr,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=Mn,o.registerForPluginStateChange=function(e){return e({pluginStatus:Vs,pluginURL:fl}),Ns.on("pluginStateChange",e),e},o.renderColorRamp=Es,o.rotate=function(e,t,r){var u=t[0],h=t[1],g=t[2],C=t[3],O=Math.sin(r),G=Math.cos(r);return e[0]=u*G+g*O,e[1]=h*G+C*O,e[2]=u*-O+g*G,e[3]=h*-O+C*G,e},o.rotateX=function(e,t,r){var u=Math.sin(r),h=Math.cos(r),g=t[4],C=t[5],O=t[6],G=t[7],Q=t[8],ve=t[9],Ae=t[10],_e=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=g*h+Q*u,e[5]=C*h+ve*u,e[6]=O*h+Ae*u,e[7]=G*h+_e*u,e[8]=Q*h-g*u,e[9]=ve*h-C*u,e[10]=Ae*h-O*u,e[11]=_e*h-G*u,e},o.rotateZ=function(e,t,r){var u=Math.sin(r),h=Math.cos(r),g=t[0],C=t[1],O=t[2],G=t[3],Q=t[4],ve=t[5],Ae=t[6],_e=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=g*h+Q*u,e[1]=C*h+ve*u,e[2]=O*h+Ae*u,e[3]=G*h+_e*u,e[4]=Q*h-g*u,e[5]=ve*h-C*u,e[6]=Ae*h-O*u,e[7]=_e*h-G*u,e},o.scale=function(e,t,r){var u=r[0],h=r[1],g=r[2];return e[0]=t[0]*u,e[1]=t[1]*u,e[2]=t[2]*u,e[3]=t[3]*u,e[4]=t[4]*h,e[5]=t[5]*h,e[6]=t[6]*h,e[7]=t[7]*h,e[8]=t[8]*g,e[9]=t[9]*g,e[10]=t[10]*g,e[11]=t[11]*g,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},o.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},o.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},o.setCacheLimits=function(e,t){Pt=e,pt=t},o.setRTLTextPlugin=function(e,t,r){if(r===void 0&&(r=!1),Vs==="deferred"||Vs==="loading"||Vs==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");fl=ue.resolveURL(e),Vs="deferred",ff=t,Xl(),r||ss()},o.sphericalToCartesian=function(e){var t=e[0],r=e[1],u=e[2];return r+=90,r*=Math.PI/180,u*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(u),y:t*Math.sin(r)*Math.sin(u),z:t*Math.cos(u)}},o.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},o.styleSpec=Re,o.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},o.symbolSize=ko,o.transformMat3=function(e,t,r){var u=t[0],h=t[1],g=t[2];return e[0]=u*r[0]+h*r[3]+g*r[6],e[1]=u*r[1]+h*r[4]+g*r[7],e[2]=u*r[2]+h*r[5]+g*r[8],e},o.transformMat4=ts,o.translate=function(e,t,r){var u,h,g,C,O,G,Q,ve,Ae,_e,it,_t,Tt=r[0],Xt=r[1],Zt=r[2];return t===e?(e[12]=t[0]*Tt+t[4]*Xt+t[8]*Zt+t[12],e[13]=t[1]*Tt+t[5]*Xt+t[9]*Zt+t[13],e[14]=t[2]*Tt+t[6]*Xt+t[10]*Zt+t[14],e[15]=t[3]*Tt+t[7]*Xt+t[11]*Zt+t[15]):(h=t[1],g=t[2],C=t[3],O=t[4],G=t[5],Q=t[6],ve=t[7],Ae=t[8],_e=t[9],it=t[10],_t=t[11],e[0]=u=t[0],e[1]=h,e[2]=g,e[3]=C,e[4]=O,e[5]=G,e[6]=Q,e[7]=ve,e[8]=Ae,e[9]=_e,e[10]=it,e[11]=_t,e[12]=u*Tt+O*Xt+Ae*Zt+t[12],e[13]=h*Tt+G*Xt+_e*Zt+t[13],e[14]=g*Tt+Q*Xt+it*Zt+t[14],e[15]=C*Tt+ve*Xt+_t*Zt+t[15]),e},o.triggerPluginCompletionEvent=Hc,o.uniqueId=xt,o.validateCustomStyleLayer=function(e){var t=[],r=e.id;return r===void 0&&t.push({message:"layers."+r+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},o.validateLight=wf,o.validateStyle=uc,o.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},o.vectorTile=go,o.version="1.13.0",o.warnOnce=Le,o.webpSupported=Ue,o.window=$,o.wrap=ut}),N(["./shared"],function(o){"use strict";function X(Ee){var pe=typeof Ee;if(pe==="number"||pe==="boolean"||pe==="string"||Ee==null)return JSON.stringify(Ee);if(Array.isArray(Ee)){for(var W="[",ae=0,Ie=Ee;ae<Ie.length;ae+=1)W+=X(Ie[ae])+",";return W+"]"}for(var qe=Object.keys(Ee).sort(),Ct="{",Re=0;Re<qe.length;Re++)Ct+=JSON.stringify(qe[Re])+":"+X(Ee[qe[Re]])+",";return Ct+"}"}function F(Ee){for(var pe="",W=0,ae=o.refProperties;W<ae.length;W+=1)pe+="/"+X(Ee[ae[W]]);return pe}var K=function(pe){this.keyCache={},pe&&this.replace(pe)};K.prototype.replace=function(Ee){this._layerConfigs={},this._layers={},this.update(Ee,[])},K.prototype.update=function(Ee,pe){for(var W=this,ae=0,Ie=Ee;ae<Ie.length;ae+=1){var qe=Ie[ae];this._layerConfigs[qe.id]=qe;var Ct=this._layers[qe.id]=o.createStyleLayer(qe);Ct._featureFilter=o.featureFilter(Ct.filter),this.keyCache[qe.id]&&delete this.keyCache[qe.id]}for(var Re=0,mt=pe;Re<mt.length;Re+=1){var Qt=mt[Re];delete this.keyCache[Qt],delete this._layerConfigs[Qt],delete this._layers[Qt]}this.familiesBySource={};for(var Br=0,Ur=function(fn,En){for(var Cn={},pn=0;pn<fn.length;pn++){var Lr=En&&En[fn[pn].id]||F(fn[pn]);En&&(En[fn[pn].id]=Lr);var hi=Cn[Lr];hi||(hi=Cn[Lr]=[]),hi.push(fn[pn])}var xi=[];for(var ki in Cn)xi.push(Cn[ki]);return xi}(o.values(this._layerConfigs),this.keyCache);Br<Ur.length;Br+=1){var or=Ur[Br].map(function(fn){return W._layers[fn.id]}),Vr=or[0];if(Vr.visibility!=="none"){var An=Vr.source||"",dn=this.familiesBySource[An];dn||(dn=this.familiesBySource[An]={});var Cr=Vr.sourceLayer||"_geojsonTileLayer",Tn=dn[Cr];Tn||(Tn=dn[Cr]=[]),Tn.push(or)}}};var q=function(pe){var W={},ae=[];for(var Ie in pe){var qe=pe[Ie],Ct=W[Ie]={};for(var Re in qe){var mt=qe[+Re];if(mt&&mt.bitmap.width!==0&&mt.bitmap.height!==0){var Qt={x:0,y:0,w:mt.bitmap.width+2,h:mt.bitmap.height+2};ae.push(Qt),Ct[Re]={rect:Qt,metrics:mt.metrics}}}}var Br=o.potpack(ae),Ur=new o.AlphaImage({width:Br.w||1,height:Br.h||1});for(var or in pe){var Vr=pe[or];for(var An in Vr){var dn=Vr[+An];if(dn&&dn.bitmap.width!==0&&dn.bitmap.height!==0){var Cr=W[or][An].rect;o.AlphaImage.copy(dn.bitmap,Ur,{x:0,y:0},{x:Cr.x+1,y:Cr.y+1},dn.bitmap)}}}this.image=Ur,this.positions=W};o.register("GlyphAtlas",q);var Ce=function(pe){this.tileID=new o.OverscaledTileID(pe.tileID.overscaledZ,pe.tileID.wrap,pe.tileID.canonical.z,pe.tileID.canonical.x,pe.tileID.canonical.y),this.uid=pe.uid,this.zoom=pe.zoom,this.pixelRatio=pe.pixelRatio,this.tileSize=pe.tileSize,this.source=pe.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=pe.showCollisionBoxes,this.collectResourceTiming=!!pe.collectResourceTiming,this.returnDependencies=!!pe.returnDependencies,this.promoteId=pe.promoteId};function $(Ee,pe,W){for(var ae=new o.EvaluationParameters(pe),Ie=0,qe=Ee;Ie<qe.length;Ie+=1)qe[Ie].recalculate(ae,W)}function He(Ee,pe){var W=o.getArrayBuffer(Ee.request,function(ae,Ie,qe,Ct){ae?pe(ae):Ie&&pe(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(Ie)),rawData:Ie,cacheControl:qe,expires:Ct})});return function(){W.cancel(),pe()}}Ce.prototype.parse=function(Ee,pe,W,ae,Ie){var qe=this;this.status="parsing",this.data=Ee,this.collisionBoxArray=new o.CollisionBoxArray;var Ct=new o.DictionaryCoder(Object.keys(Ee.layers).sort()),Re=new o.FeatureIndex(this.tileID,this.promoteId);Re.bucketLayerIDs=[];var mt,Qt,Br,Ur,or={},Vr={featureIndex:Re,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:W},An=pe.familiesBySource[this.source];for(var dn in An){var Cr=Ee.layers[dn];if(Cr){Cr.version===1&&o.warnOnce('Vector tile source "'+this.source+'" layer "'+dn+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Tn=Ct.encode(dn),fn=[],En=0;En<Cr.length;En++){var Cn=Cr.feature(En),pn=Re.getId(Cn,dn);fn.push({feature:Cn,id:pn,index:En,sourceLayerIndex:Tn})}for(var Lr=0,hi=An[dn];Lr<hi.length;Lr+=1){var xi=hi[Lr],ki=xi[0];ki.minzoom&&this.zoom<Math.floor(ki.minzoom)||ki.maxzoom&&this.zoom>=ki.maxzoom||ki.visibility!=="none"&&($(xi,this.zoom,W),(or[ki.id]=ki.createBucket({index:Re.bucketLayerIDs.length,layers:xi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Tn,sourceID:this.source})).populate(fn,Vr,this.tileID.canonical),Re.bucketLayerIDs.push(xi.map(function(Di){return Di.id})))}}}var _i=o.mapObject(Vr.glyphDependencies,function(Di){return Object.keys(Di).map(Number)});Object.keys(_i).length?ae.send("getGlyphs",{uid:this.uid,stacks:_i},function(Di,bi){mt||(mt=Di,Qt=bi,Ta.call(qe))}):Qt={};var eo=Object.keys(Vr.iconDependencies);eo.length?ae.send("getImages",{icons:eo,source:this.source,tileID:this.tileID,type:"icons"},function(Di,bi){mt||(mt=Di,Br=bi,Ta.call(qe))}):Br={};var pi=Object.keys(Vr.patternDependencies);function Ta(){if(mt)return Ie(mt);if(Qt&&Br&&Ur){var Di=new q(Qt),bi=new o.ImageAtlas(Br,Ur);for(var ci in or){var ja=or[ci];ja instanceof o.SymbolBucket?($(ja.layers,this.zoom,W),o.performSymbolLayout(ja,Qt,Di.positions,Br,bi.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):ja.hasPattern&&(ja instanceof o.LineBucket||ja instanceof o.FillBucket||ja instanceof o.FillExtrusionBucket)&&($(ja.layers,this.zoom,W),ja.addFeatures(Vr,this.tileID.canonical,bi.patternPositions))}this.status="done",Ie(null,{buckets:o.values(or).filter(function(ps){return!ps.isEmpty()}),featureIndex:Re,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Di.image,imageAtlas:bi,glyphMap:this.returnDependencies?Qt:null,iconMap:this.returnDependencies?Br:null,glyphPositions:this.returnDependencies?Di.positions:null})}}pi.length?ae.send("getImages",{icons:pi,source:this.source,tileID:this.tileID,type:"patterns"},function(Di,bi){mt||(mt=Di,Ur=bi,Ta.call(qe))}):Ur={},Ta.call(this)};var Be=function(pe,W,ae,Ie){this.actor=pe,this.layerIndex=W,this.availableImages=ae,this.loadVectorData=Ie||He,this.loading={},this.loaded={}};Be.prototype.loadTile=function(Ee,pe){var W=this,ae=Ee.uid;this.loading||(this.loading={});var Ie=!!(Ee&&Ee.request&&Ee.request.collectResourceTiming)&&new o.RequestPerformance(Ee.request),qe=this.loading[ae]=new Ce(Ee);qe.abort=this.loadVectorData(Ee,function(Ct,Re){if(delete W.loading[ae],Ct||!Re)return qe.status="done",W.loaded[ae]=qe,pe(Ct);var mt=Re.rawData,Qt={};Re.expires&&(Qt.expires=Re.expires),Re.cacheControl&&(Qt.cacheControl=Re.cacheControl);var Br={};if(Ie){var Ur=Ie.finish();Ur&&(Br.resourceTiming=JSON.parse(JSON.stringify(Ur)))}qe.vectorTile=Re.vectorTile,qe.parse(Re.vectorTile,W.layerIndex,W.availableImages,W.actor,function(or,Vr){if(or||!Vr)return pe(or);pe(null,o.extend({rawTileData:mt.slice(0)},Vr,Qt,Br))}),W.loaded=W.loaded||{},W.loaded[ae]=qe})},Be.prototype.reloadTile=function(Ee,pe){var W=this,ae=this.loaded,Ie=Ee.uid,qe=this;if(ae&&ae[Ie]){var Ct=ae[Ie];Ct.showCollisionBoxes=Ee.showCollisionBoxes;var Re=function(Qt,Br){var Ur=Ct.reloadCallback;Ur&&(delete Ct.reloadCallback,Ct.parse(Ct.vectorTile,qe.layerIndex,W.availableImages,qe.actor,Ur)),pe(Qt,Br)};Ct.status==="parsing"?Ct.reloadCallback=Re:Ct.status==="done"&&(Ct.vectorTile?Ct.parse(Ct.vectorTile,this.layerIndex,this.availableImages,this.actor,Re):Re())}},Be.prototype.abortTile=function(Ee,pe){var W=this.loading,ae=Ee.uid;W&&W[ae]&&W[ae].abort&&(W[ae].abort(),delete W[ae]),pe()},Be.prototype.removeTile=function(Ee,pe){var W=this.loaded,ae=Ee.uid;W&&W[ae]&&delete W[ae],pe()};var ce=o.window.ImageBitmap,st=function(){this.loaded={}};function ut(Ee,pe){if(Ee.length!==0){Me(Ee[0],pe);for(var W=1;W<Ee.length;W++)Me(Ee[W],!pe)}}function Me(Ee,pe){for(var W=0,ae=0,Ie=Ee.length,qe=Ie-1;ae<Ie;qe=ae++)W+=(Ee[ae][0]-Ee[qe][0])*(Ee[qe][1]+Ee[ae][1]);W>=0!=!!pe&&Ee.reverse()}st.prototype.loadTile=function(Ee,pe){var W=Ee.uid,ae=Ee.encoding,Ie=Ee.rawImageData,qe=ce&&Ie instanceof ce?this.getImageData(Ie):Ie,Ct=new o.DEMData(W,qe,ae);this.loaded=this.loaded||{},this.loaded[W]=Ct,pe(null,Ct)},st.prototype.getImageData=function(Ee){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Ee.width,Ee.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Ee.width,this.offscreenCanvas.height=Ee.height,this.offscreenCanvasContext.drawImage(Ee,0,0,Ee.width,Ee.height);var pe=this.offscreenCanvasContext.getImageData(-1,-1,Ee.width+2,Ee.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:pe.width,height:pe.height},pe.data)},st.prototype.removeTile=function(Ee){var pe=this.loaded,W=Ee.uid;pe&&pe[W]&&delete pe[W]};var bt=o.vectorTile.VectorTileFeature.prototype.toGeoJSON,xt=function(pe){this._feature=pe,this.extent=o.EXTENT,this.type=pe.type,this.properties=pe.tags,"id"in pe&&!isNaN(pe.id)&&(this.id=parseInt(pe.id,10))};xt.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Ee=[],pe=0,W=this._feature.geometry;pe<W.length;pe+=1){var ae=W[pe];Ee.push([new o.Point$1(ae[0],ae[1])])}return Ee}for(var Ie=[],qe=0,Ct=this._feature.geometry;qe<Ct.length;qe+=1){for(var Re=[],mt=0,Qt=Ct[qe];mt<Qt.length;mt+=1){var Br=Qt[mt];Re.push(new o.Point$1(Br[0],Br[1]))}Ie.push(Re)}return Ie},xt.prototype.toGeoJSON=function(Ee,pe,W){return bt.call(this,Ee,pe,W)};var Mt=function(pe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=pe.length,this._features=pe};Mt.prototype.feature=function(Ee){return new xt(this._features[Ee])};var De=o.vectorTile.VectorTileFeature,ar=$t;function $t(Ee,pe){this.options=pe||{},this.features=Ee,this.length=Ee.length}function Ht(Ee,pe){this.id=typeof Ee.id=="number"?Ee.id:void 0,this.type=Ee.type,this.rawGeometry=Ee.type===1?[Ee.geometry]:Ee.geometry,this.properties=Ee.tags,this.extent=pe||4096}$t.prototype.feature=function(Ee){return new Ht(this.features[Ee],this.options.extent)},Ht.prototype.loadGeometry=function(){var Ee=this.rawGeometry;this.geometry=[];for(var pe=0;pe<Ee.length;pe++){for(var W=Ee[pe],ae=[],Ie=0;Ie<W.length;Ie++)ae.push(new o.Point$1(W[Ie][0],W[Ie][1]));this.geometry.push(ae)}return this.geometry},Ht.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ee=this.geometry,pe=1/0,W=-1/0,ae=1/0,Ie=-1/0,qe=0;qe<Ee.length;qe++)for(var Ct=Ee[qe],Re=0;Re<Ct.length;Re++){var mt=Ct[Re];pe=Math.min(pe,mt.x),W=Math.max(W,mt.x),ae=Math.min(ae,mt.y),Ie=Math.max(Ie,mt.y)}return[pe,ae,W,Ie]},Ht.prototype.toGeoJSON=De.prototype.toGeoJSON;var vt=Et,Ze=ar;function Et(Ee){var pe=new o.pbf;return function(W,ae){for(var Ie in W.layers)ae.writeMessage(3,Le,W.layers[Ie])}(Ee,pe),pe.finish()}function Le(Ee,pe){var W;pe.writeVarintField(15,Ee.version||1),pe.writeStringField(1,Ee.name||""),pe.writeVarintField(5,Ee.extent||4096);var ae={keys:[],values:[],keycache:{},valuecache:{}};for(W=0;W<Ee.length;W++)ae.feature=Ee.feature(W),pe.writeMessage(2,at,ae);var Ie=ae.keys;for(W=0;W<Ie.length;W++)pe.writeStringField(3,Ie[W]);var qe=ae.values;for(W=0;W<qe.length;W++)pe.writeMessage(4,z,qe[W])}function at(Ee,pe){var W=Ee.feature;W.id!==void 0&&pe.writeVarintField(1,W.id),pe.writeMessage(2,Wt,Ee),pe.writeVarintField(3,W.type),pe.writeMessage(4,H,W)}function Wt(Ee,pe){var W=Ee.feature,ae=Ee.keys,Ie=Ee.values,qe=Ee.keycache,Ct=Ee.valuecache;for(var Re in W.properties){var mt=qe[Re];mt===void 0&&(ae.push(Re),qe[Re]=mt=ae.length-1),pe.writeVarint(mt);var Qt=W.properties[Re],Br=typeof Qt;Br!=="string"&&Br!=="boolean"&&Br!=="number"&&(Qt=JSON.stringify(Qt));var Ur=Br+":"+Qt,or=Ct[Ur];or===void 0&&(Ie.push(Qt),Ct[Ur]=or=Ie.length-1),pe.writeVarint(or)}}function St(Ee,pe){return(pe<<3)+(7&Ee)}function dt(Ee){return Ee<<1^Ee>>31}function H(Ee,pe){for(var W=Ee.loadGeometry(),ae=Ee.type,Ie=0,qe=0,Ct=W.length,Re=0;Re<Ct;Re++){var mt=W[Re],Qt=1;ae===1&&(Qt=mt.length),pe.writeVarint(St(1,Qt));for(var Br=ae===3?mt.length-1:mt.length,Ur=0;Ur<Br;Ur++){Ur===1&&ae!==1&&pe.writeVarint(St(2,Br-1));var or=mt[Ur].x-Ie,Vr=mt[Ur].y-qe;pe.writeVarint(dt(or)),pe.writeVarint(dt(Vr)),Ie+=or,qe+=Vr}ae===3&&pe.writeVarint(St(7,1))}}function z(Ee,pe){var W=typeof Ee;W==="string"?pe.writeStringField(1,Ee):W==="boolean"?pe.writeBooleanField(7,Ee):W==="number"&&(Ee%1!=0?pe.writeDoubleField(3,Ee):Ee<0?pe.writeSVarintField(6,Ee):pe.writeVarintField(5,Ee))}function V(Ee,pe,W,ae){be(Ee,W,ae),be(pe,2*W,2*ae),be(pe,2*W+1,2*ae+1)}function be(Ee,pe,W){var ae=Ee[pe];Ee[pe]=Ee[W],Ee[W]=ae}function me(Ee,pe,W,ae){var Ie=Ee-W,qe=pe-ae;return Ie*Ie+qe*qe}vt.fromVectorTileJs=Et,vt.fromGeojsonVt=function(Ee,pe){pe=pe||{};var W={};for(var ae in Ee)W[ae]=new ar(Ee[ae].features,pe),W[ae].name=ae,W[ae].version=pe.version,W[ae].extent=pe.extent;return Et({layers:W})},vt.GeoJSONWrapper=Ze;var le=function(pe){return pe[0]},fe=function(pe){return pe[1]},Ne=function(pe,W,ae,Ie,qe){W===void 0&&(W=le),ae===void 0&&(ae=fe),Ie===void 0&&(Ie=64),qe===void 0&&(qe=Float64Array),this.nodeSize=Ie,this.points=pe;for(var Ct=pe.length<65536?Uint16Array:Uint32Array,Re=this.ids=new Ct(pe.length),mt=this.coords=new qe(2*pe.length),Qt=0;Qt<pe.length;Qt++)Re[Qt]=Qt,mt[2*Qt]=W(pe[Qt]),mt[2*Qt+1]=ae(pe[Qt]);(function Br(Ur,or,Vr,An,dn,Cr){if(!(dn-An<=Vr)){var Tn=An+dn>>1;(function fn(En,Cn,pn,Lr,hi,xi){for(;hi>Lr;){if(hi-Lr>600){var ki=hi-Lr+1,_i=pn-Lr+1,eo=Math.log(ki),pi=.5*Math.exp(2*eo/3),Ta=.5*Math.sqrt(eo*pi*(ki-pi)/ki)*(_i-ki/2<0?-1:1);fn(En,Cn,pn,Math.max(Lr,Math.floor(pn-_i*pi/ki+Ta)),Math.min(hi,Math.floor(pn+(ki-_i)*pi/ki+Ta)),xi)}var Di=Cn[2*pn+xi],bi=Lr,ci=hi;for(V(En,Cn,Lr,pn),Cn[2*hi+xi]>Di&&V(En,Cn,Lr,hi);bi<ci;){for(V(En,Cn,bi,ci),bi++,ci--;Cn[2*bi+xi]<Di;)bi++;for(;Cn[2*ci+xi]>Di;)ci--}Cn[2*Lr+xi]===Di?V(En,Cn,Lr,ci):V(En,Cn,++ci,hi),ci<=pn&&(Lr=ci+1),pn<=ci&&(hi=ci-1)}})(Ur,or,Tn,An,dn,Cr%2),Br(Ur,or,Vr,An,Tn-1,Cr+1),Br(Ur,or,Vr,Tn+1,dn,Cr+1)}})(Re,mt,Ie,0,Re.length-1,0)};Ne.prototype.range=function(Ee,pe,W,ae){return function(Ie,qe,Ct,Re,mt,Qt,Br){for(var Ur,or,Vr=[0,Ie.length-1,0],An=[];Vr.length;){var dn=Vr.pop(),Cr=Vr.pop(),Tn=Vr.pop();if(Cr-Tn<=Br)for(var fn=Tn;fn<=Cr;fn++)or=qe[2*fn+1],(Ur=qe[2*fn])>=Ct&&Ur<=mt&&or>=Re&&or<=Qt&&An.push(Ie[fn]);else{var En=Math.floor((Tn+Cr)/2);or=qe[2*En+1],(Ur=qe[2*En])>=Ct&&Ur<=mt&&or>=Re&&or<=Qt&&An.push(Ie[En]);var Cn=(dn+1)%2;(dn===0?Ct<=Ur:Re<=or)&&(Vr.push(Tn),Vr.push(En-1),Vr.push(Cn)),(dn===0?mt>=Ur:Qt>=or)&&(Vr.push(En+1),Vr.push(Cr),Vr.push(Cn))}}return An}(this.ids,this.coords,Ee,pe,W,ae,this.nodeSize)},Ne.prototype.within=function(Ee,pe,W){return function(ae,Ie,qe,Ct,Re,mt){for(var Qt=[0,ae.length-1,0],Br=[],Ur=Re*Re;Qt.length;){var or=Qt.pop(),Vr=Qt.pop(),An=Qt.pop();if(Vr-An<=mt)for(var dn=An;dn<=Vr;dn++)me(Ie[2*dn],Ie[2*dn+1],qe,Ct)<=Ur&&Br.push(ae[dn]);else{var Cr=Math.floor((An+Vr)/2),Tn=Ie[2*Cr],fn=Ie[2*Cr+1];me(Tn,fn,qe,Ct)<=Ur&&Br.push(ae[Cr]);var En=(or+1)%2;(or===0?qe-Re<=Tn:Ct-Re<=fn)&&(Qt.push(An),Qt.push(Cr-1),Qt.push(En)),(or===0?qe+Re>=Tn:Ct+Re>=fn)&&(Qt.push(Cr+1),Qt.push(Vr),Qt.push(En))}}return Br}(this.ids,this.coords,Ee,pe,W,this.nodeSize)};var lt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(pe){return pe}},rt=function(pe){this.options=P(Object.create(lt),pe),this.trees=new Array(this.options.maxZoom+1)};function ue(Ee,pe,W,ae,Ie){return{x:Ee,y:pe,zoom:1/0,id:W,parentId:-1,numPoints:ae,properties:Ie}}function ye(Ee,pe){var W=Ee.geometry.coordinates,ae=W[1];return{x:Oe(W[0]),y:Ve(ae),zoom:1/0,index:pe,parentId:-1}}function Ue(Ee){return{type:"Feature",id:Ee.id,properties:ft(Ee),geometry:{type:"Point",coordinates:[(ae=Ee.x,360*(ae-.5)),(pe=Ee.y,W=(180-360*pe)*Math.PI/180,360*Math.atan(Math.exp(W))/Math.PI-90)]}};var pe,W,ae}function ft(Ee){var pe=Ee.numPoints,W=pe>=1e4?Math.round(pe/1e3)+"k":pe>=1e3?Math.round(pe/100)/10+"k":pe;return P(P({},Ee.properties),{cluster:!0,cluster_id:Ee.id,point_count:pe,point_count_abbreviated:W})}function Oe(Ee){return Ee/360+.5}function Ve(Ee){var pe=Math.sin(Ee*Math.PI/180),W=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return W<0?0:W>1?1:W}function P(Ee,pe){for(var W in pe)Ee[W]=pe[W];return Ee}function R(Ee){return Ee.x}function J(Ee){return Ee.y}function de(Ee,pe,W,ae,Ie,qe){var Ct=Ie-W,Re=qe-ae;if(Ct!==0||Re!==0){var mt=((Ee-W)*Ct+(pe-ae)*Re)/(Ct*Ct+Re*Re);mt>1?(W=Ie,ae=qe):mt>0&&(W+=Ct*mt,ae+=Re*mt)}return(Ct=Ee-W)*Ct+(Re=pe-ae)*Re}function je(Ee,pe,W,ae){var Ie={id:Ee===void 0?null:Ee,type:pe,geometry:W,tags:ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(qe){var Ct=qe.geometry,Re=qe.type;if(Re==="Point"||Re==="MultiPoint"||Re==="LineString")We(qe,Ct);else if(Re==="Polygon"||Re==="MultiLineString")for(var mt=0;mt<Ct.length;mt++)We(qe,Ct[mt]);else if(Re==="MultiPolygon")for(mt=0;mt<Ct.length;mt++)for(var Qt=0;Qt<Ct[mt].length;Qt++)We(qe,Ct[mt][Qt])}(Ie),Ie}function We(Ee,pe){for(var W=0;W<pe.length;W+=3)Ee.minX=Math.min(Ee.minX,pe[W]),Ee.minY=Math.min(Ee.minY,pe[W+1]),Ee.maxX=Math.max(Ee.maxX,pe[W]),Ee.maxY=Math.max(Ee.maxY,pe[W+1])}function gt(Ee,pe,W,ae){if(pe.geometry){var Ie=pe.geometry.coordinates,qe=pe.geometry.type,Ct=Math.pow(W.tolerance/((1<<W.maxZoom)*W.extent),2),Re=[],mt=pe.id;if(W.promoteId?mt=pe.properties[W.promoteId]:W.generateId&&(mt=ae||0),qe==="Point")nt(Ie,Re);else if(qe==="MultiPoint")for(var Qt=0;Qt<Ie.length;Qt++)nt(Ie[Qt],Re);else if(qe==="LineString")Nt(Ie,Re,Ct,!1);else if(qe==="MultiLineString"){if(W.lineMetrics){for(Qt=0;Qt<Ie.length;Qt++)Nt(Ie[Qt],Re=[],Ct,!1),Ee.push(je(mt,"LineString",Re,pe.properties));return}Y(Ie,Re,Ct,!1)}else if(qe==="Polygon")Y(Ie,Re,Ct,!0);else{if(qe!=="MultiPolygon"){if(qe==="GeometryCollection"){for(Qt=0;Qt<pe.geometry.geometries.length;Qt++)gt(Ee,{id:mt,geometry:pe.geometry.geometries[Qt],properties:pe.properties},W,ae);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Qt=0;Qt<Ie.length;Qt++){var Br=[];Y(Ie[Qt],Br,Ct,!0),Re.push(Br)}}Ee.push(je(mt,qe,Re,pe.properties))}}function nt(Ee,pe){pe.push(Xe(Ee[0])),pe.push(re(Ee[1])),pe.push(0)}function Nt(Ee,pe,W,ae){for(var Ie,qe,Ct=0,Re=0;Re<Ee.length;Re++){var mt=Xe(Ee[Re][0]),Qt=re(Ee[Re][1]);pe.push(mt),pe.push(Qt),pe.push(0),Re>0&&(Ct+=ae?(Ie*Qt-mt*qe)/2:Math.sqrt(Math.pow(mt-Ie,2)+Math.pow(Qt-qe,2))),Ie=mt,qe=Qt}var Br=pe.length-3;pe[2]=1,function Ur(or,Vr,An,dn){for(var Cr,Tn=dn,fn=An-Vr>>1,En=An-Vr,Cn=or[Vr],pn=or[Vr+1],Lr=or[An],hi=or[An+1],xi=Vr+3;xi<An;xi+=3){var ki=de(or[xi],or[xi+1],Cn,pn,Lr,hi);if(ki>Tn)Cr=xi,Tn=ki;else if(ki===Tn){var _i=Math.abs(xi-fn);_i<En&&(Cr=xi,En=_i)}}Tn>dn&&(Cr-Vr>3&&Ur(or,Vr,Cr,dn),or[Cr+2]=Tn,An-Cr>3&&Ur(or,Cr,An,dn))}(pe,0,Br,W),pe[Br+2]=1,pe.size=Math.abs(Ct),pe.start=0,pe.end=pe.size}function Y(Ee,pe,W,ae){for(var Ie=0;Ie<Ee.length;Ie++){var qe=[];Nt(Ee[Ie],qe,W,ae),pe.push(qe)}}function Xe(Ee){return Ee/360+.5}function re(Ee){var pe=Math.sin(Ee*Math.PI/180),W=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return W<0?0:W>1?1:W}function Je(Ee,pe,W,ae,Ie,qe,Ct,Re){if(ae/=pe,qe>=(W/=pe)&&Ct<ae)return Ee;if(Ct<W||qe>=ae)return null;for(var mt=[],Qt=0;Qt<Ee.length;Qt++){var Br=Ee[Qt],Ur=Br.geometry,or=Br.type,Vr=Ie===0?Br.minX:Br.minY,An=Ie===0?Br.maxX:Br.maxY;if(Vr>=W&&An<ae)mt.push(Br);else if(!(An<W||Vr>=ae)){var dn=[];if(or==="Point"||or==="MultiPoint")Gt(Ur,dn,W,ae,Ie);else if(or==="LineString")ur(Ur,dn,W,ae,Ie,!1,Re.lineMetrics);else if(or==="MultiLineString")ht(Ur,dn,W,ae,Ie,!1);else if(or==="Polygon")ht(Ur,dn,W,ae,Ie,!0);else if(or==="MultiPolygon")for(var Cr=0;Cr<Ur.length;Cr++){var Tn=[];ht(Ur[Cr],Tn,W,ae,Ie,!0),Tn.length&&dn.push(Tn)}if(dn.length){if(Re.lineMetrics&&or==="LineString"){for(Cr=0;Cr<dn.length;Cr++)mt.push(je(Br.id,or,dn[Cr],Br.tags));continue}or!=="LineString"&&or!=="MultiLineString"||(dn.length===1?(or="LineString",dn=dn[0]):or="MultiLineString"),or!=="Point"&&or!=="MultiPoint"||(or=dn.length===3?"Point":"MultiPoint"),mt.push(je(Br.id,or,dn,Br.tags))}}}return mt.length?mt:null}function Gt(Ee,pe,W,ae,Ie){for(var qe=0;qe<Ee.length;qe+=3){var Ct=Ee[qe+Ie];Ct>=W&&Ct<=ae&&(pe.push(Ee[qe]),pe.push(Ee[qe+1]),pe.push(Ee[qe+2]))}}function ur(Ee,pe,W,ae,Ie,qe,Ct){for(var Re,mt,Qt=ct(Ee),Br=Ie===0?pt:Pe,Ur=Ee.start,or=0;or<Ee.length-3;or+=3){var Vr=Ee[or],An=Ee[or+1],dn=Ee[or+2],Cr=Ee[or+3],Tn=Ee[or+4],fn=Ie===0?Vr:An,En=Ie===0?Cr:Tn,Cn=!1;Ct&&(Re=Math.sqrt(Math.pow(Vr-Cr,2)+Math.pow(An-Tn,2))),fn<W?En>W&&(mt=Br(Qt,Vr,An,Cr,Tn,W),Ct&&(Qt.start=Ur+Re*mt)):fn>ae?En<ae&&(mt=Br(Qt,Vr,An,Cr,Tn,ae),Ct&&(Qt.start=Ur+Re*mt)):Pt(Qt,Vr,An,dn),En<W&&fn>=W&&(mt=Br(Qt,Vr,An,Cr,Tn,W),Cn=!0),En>ae&&fn<=ae&&(mt=Br(Qt,Vr,An,Cr,Tn,ae),Cn=!0),!qe&&Cn&&(Ct&&(Qt.end=Ur+Re*mt),pe.push(Qt),Qt=ct(Ee)),Ct&&(Ur+=Re)}var pn=Ee.length-3;Vr=Ee[pn],An=Ee[pn+1],dn=Ee[pn+2],(fn=Ie===0?Vr:An)>=W&&fn<=ae&&Pt(Qt,Vr,An,dn),pn=Qt.length-3,qe&&pn>=3&&(Qt[pn]!==Qt[0]||Qt[pn+1]!==Qt[1])&&Pt(Qt,Qt[0],Qt[1],Qt[2]),Qt.length&&pe.push(Qt)}function ct(Ee){var pe=[];return pe.size=Ee.size,pe.start=Ee.start,pe.end=Ee.end,pe}function ht(Ee,pe,W,ae,Ie,qe){for(var Ct=0;Ct<Ee.length;Ct++)ur(Ee[Ct],pe,W,ae,Ie,qe,!1)}function Pt(Ee,pe,W,ae){Ee.push(pe),Ee.push(W),Ee.push(ae)}function pt(Ee,pe,W,ae,Ie,qe){var Ct=(qe-pe)/(ae-pe);return Ee.push(qe),Ee.push(W+(Ie-W)*Ct),Ee.push(1),Ct}function Pe(Ee,pe,W,ae,Ie,qe){var Ct=(qe-W)/(Ie-W);return Ee.push(pe+(ae-pe)*Ct),Ee.push(qe),Ee.push(1),Ct}function ot(Ee,pe){for(var W=[],ae=0;ae<Ee.length;ae++){var Ie,qe=Ee[ae],Ct=qe.type;if(Ct==="Point"||Ct==="MultiPoint"||Ct==="LineString")Ie=$e(qe.geometry,pe);else if(Ct==="MultiLineString"||Ct==="Polygon"){Ie=[];for(var Re=0;Re<qe.geometry.length;Re++)Ie.push($e(qe.geometry[Re],pe))}else if(Ct==="MultiPolygon")for(Ie=[],Re=0;Re<qe.geometry.length;Re++){for(var mt=[],Qt=0;Qt<qe.geometry[Re].length;Qt++)mt.push($e(qe.geometry[Re][Qt],pe));Ie.push(mt)}W.push(je(qe.id,Ct,Ie,qe.tags))}return W}function $e(Ee,pe){var W=[];W.size=Ee.size,Ee.start!==void 0&&(W.start=Ee.start,W.end=Ee.end);for(var ae=0;ae<Ee.length;ae+=3)W.push(Ee[ae]+pe,Ee[ae+1],Ee[ae+2]);return W}function Vt(Ee,pe){if(Ee.transformed)return Ee;var W,ae,Ie,qe=1<<Ee.z,Ct=Ee.x,Re=Ee.y;for(W=0;W<Ee.features.length;W++){var mt=Ee.features[W],Qt=mt.geometry,Br=mt.type;if(mt.geometry=[],Br===1)for(ae=0;ae<Qt.length;ae+=2)mt.geometry.push(dr(Qt[ae],Qt[ae+1],pe,qe,Ct,Re));else for(ae=0;ae<Qt.length;ae++){var Ur=[];for(Ie=0;Ie<Qt[ae].length;Ie+=2)Ur.push(dr(Qt[ae][Ie],Qt[ae][Ie+1],pe,qe,Ct,Re));mt.geometry.push(Ur)}}return Ee.transformed=!0,Ee}function dr(Ee,pe,W,ae,Ie,qe){return[Math.round(W*(Ee*ae-Ie)),Math.round(W*(pe*ae-qe))]}function Zr(Ee,pe,W,ae,Ie){for(var qe=pe===Ie.maxZoom?0:Ie.tolerance/((1<<pe)*Ie.extent),Ct={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:W,y:ae,z:pe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Re=0;Re<Ee.length;Re++){Ct.numFeatures++,cr(Ct,Ee[Re],qe,Ie);var mt=Ee[Re].minX,Qt=Ee[Re].minY,Br=Ee[Re].maxX,Ur=Ee[Re].maxY;mt<Ct.minX&&(Ct.minX=mt),Qt<Ct.minY&&(Ct.minY=Qt),Br>Ct.maxX&&(Ct.maxX=Br),Ur>Ct.maxY&&(Ct.maxY=Ur)}return Ct}function cr(Ee,pe,W,ae){var Ie=pe.geometry,qe=pe.type,Ct=[];if(qe==="Point"||qe==="MultiPoint")for(var Re=0;Re<Ie.length;Re+=3)Ct.push(Ie[Re]),Ct.push(Ie[Re+1]),Ee.numPoints++,Ee.numSimplified++;else if(qe==="LineString")Un(Ct,Ie,Ee,W,!1,!1);else if(qe==="MultiLineString"||qe==="Polygon")for(Re=0;Re<Ie.length;Re++)Un(Ct,Ie[Re],Ee,W,qe==="Polygon",Re===0);else if(qe==="MultiPolygon")for(var mt=0;mt<Ie.length;mt++){var Qt=Ie[mt];for(Re=0;Re<Qt.length;Re++)Un(Ct,Qt[Re],Ee,W,!0,Re===0)}if(Ct.length){var Br=pe.tags||null;if(qe==="LineString"&&ae.lineMetrics){for(var Ur in Br={},pe.tags)Br[Ur]=pe.tags[Ur];Br.mapbox_clip_start=Ie.start/Ie.size,Br.mapbox_clip_end=Ie.end/Ie.size}var or={geometry:Ct,type:qe==="Polygon"||qe==="MultiPolygon"?3:qe==="LineString"||qe==="MultiLineString"?2:1,tags:Br};pe.id!==null&&(or.id=pe.id),Ee.features.push(or)}}function Un(Ee,pe,W,ae,Ie,qe){var Ct=ae*ae;if(ae>0&&pe.size<(Ie?Ct:ae))W.numPoints+=pe.length/3;else{for(var Re=[],mt=0;mt<pe.length;mt+=3)(ae===0||pe[mt+2]>Ct)&&(W.numSimplified++,Re.push(pe[mt]),Re.push(pe[mt+1])),W.numPoints++;Ie&&function(Qt,Br){for(var Ur=0,or=0,Vr=Qt.length,An=Vr-2;or<Vr;An=or,or+=2)Ur+=(Qt[or]-Qt[An])*(Qt[or+1]+Qt[An+1]);if(Ur>0===Br)for(or=0,Vr=Qt.length;or<Vr/2;or+=2){var dn=Qt[or],Cr=Qt[or+1];Qt[or]=Qt[Vr-2-or],Qt[or+1]=Qt[Vr-1-or],Qt[Vr-2-or]=dn,Qt[Vr-1-or]=Cr}}(Re,qe),Ee.push(Re)}}function Sn(Ee,pe){var W=(pe=this.options=function(Ie,qe){for(var Ct in qe)Ie[Ct]=qe[Ct];return Ie}(Object.create(this.options),pe)).debug;if(W&&console.time("preprocess data"),pe.maxZoom<0||pe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(pe.promoteId&&pe.generateId)throw new Error("promoteId and generateId cannot be used together.");var ae=function(Ie,qe){var Ct=[];if(Ie.type==="FeatureCollection")for(var Re=0;Re<Ie.features.length;Re++)gt(Ct,Ie.features[Re],qe,Re);else gt(Ct,Ie.type==="Feature"?Ie:{geometry:Ie},qe);return Ct}(Ee,pe);this.tiles={},this.tileCoords=[],W&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",pe.indexMaxZoom,pe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ae=function(Ie,qe){var Ct=qe.buffer/qe.extent,Re=Ie,mt=Je(Ie,1,-1-Ct,Ct,0,-1,2,qe),Qt=Je(Ie,1,1-Ct,2+Ct,0,-1,2,qe);return(mt||Qt)&&(Re=Je(Ie,1,-Ct,1+Ct,0,-1,2,qe)||[],mt&&(Re=ot(mt,1).concat(Re)),Qt&&(Re=Re.concat(ot(Qt,-1)))),Re}(ae,pe)).length&&this.splitTile(ae,0,0,0),W&&(ae.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ni(Ee,pe,W){return 32*((1<<Ee)*W+pe)+Ee}function fi(Ee,pe){var W=Ee.tileID.canonical;if(!this._geoJSONIndex)return pe(null,null);var ae=this._geoJSONIndex.getTile(W.z,W.x,W.y);if(!ae)return pe(null,null);var Ie=new Mt(ae.features),qe=vt(Ie);qe.byteOffset===0&&qe.byteLength===qe.buffer.byteLength||(qe=new Uint8Array(qe)),pe(null,{vectorTile:Ie,rawData:qe.buffer})}rt.prototype.load=function(Ee){var pe=this.options,W=pe.log,ae=pe.minZoom,Ie=pe.maxZoom,qe=pe.nodeSize;W&&console.time("total time");var Ct="prepare "+Ee.length+" points";W&&console.time(Ct),this.points=Ee;for(var Re=[],mt=0;mt<Ee.length;mt++)Ee[mt].geometry&&Re.push(ye(Ee[mt],mt));this.trees[Ie+1]=new Ne(Re,R,J,qe,Float32Array),W&&console.timeEnd(Ct);for(var Qt=Ie;Qt>=ae;Qt--){var Br=+Date.now();Re=this._cluster(Re,Qt),this.trees[Qt]=new Ne(Re,R,J,qe,Float32Array),W&&console.log("z%d: %d clusters in %dms",Qt,Re.length,+Date.now()-Br)}return W&&console.timeEnd("total time"),this},rt.prototype.getClusters=function(Ee,pe){var W=((Ee[0]+180)%360+360)%360-180,ae=Math.max(-90,Math.min(90,Ee[1])),Ie=Ee[2]===180?180:((Ee[2]+180)%360+360)%360-180,qe=Math.max(-90,Math.min(90,Ee[3]));if(Ee[2]-Ee[0]>=360)W=-180,Ie=180;else if(W>Ie){var Ct=this.getClusters([W,ae,180,qe],pe),Re=this.getClusters([-180,ae,Ie,qe],pe);return Ct.concat(Re)}for(var mt=this.trees[this._limitZoom(pe)],Qt=[],Br=0,Ur=mt.range(Oe(W),Ve(qe),Oe(Ie),Ve(ae));Br<Ur.length;Br+=1){var or=mt.points[Ur[Br]];Qt.push(or.numPoints?Ue(or):this.points[or.index])}return Qt},rt.prototype.getChildren=function(Ee){var pe=this._getOriginId(Ee),W=this._getOriginZoom(Ee),ae="No cluster with the specified id.",Ie=this.trees[W];if(!Ie)throw new Error(ae);var qe=Ie.points[pe];if(!qe)throw new Error(ae);for(var Ct=this.options.radius/(this.options.extent*Math.pow(2,W-1)),Re=[],mt=0,Qt=Ie.within(qe.x,qe.y,Ct);mt<Qt.length;mt+=1){var Br=Ie.points[Qt[mt]];Br.parentId===Ee&&Re.push(Br.numPoints?Ue(Br):this.points[Br.index])}if(Re.length===0)throw new Error(ae);return Re},rt.prototype.getLeaves=function(Ee,pe,W){var ae=[];return this._appendLeaves(ae,Ee,pe=pe||10,W=W||0,0),ae},rt.prototype.getTile=function(Ee,pe,W){var ae=this.trees[this._limitZoom(Ee)],Ie=Math.pow(2,Ee),qe=this.options,Ct=qe.radius/qe.extent,Re=(W-Ct)/Ie,mt=(W+1+Ct)/Ie,Qt={features:[]};return this._addTileFeatures(ae.range((pe-Ct)/Ie,Re,(pe+1+Ct)/Ie,mt),ae.points,pe,W,Ie,Qt),pe===0&&this._addTileFeatures(ae.range(1-Ct/Ie,Re,1,mt),ae.points,Ie,W,Ie,Qt),pe===Ie-1&&this._addTileFeatures(ae.range(0,Re,Ct/Ie,mt),ae.points,-1,W,Ie,Qt),Qt.features.length?Qt:null},rt.prototype.getClusterExpansionZoom=function(Ee){for(var pe=this._getOriginZoom(Ee)-1;pe<=this.options.maxZoom;){var W=this.getChildren(Ee);if(pe++,W.length!==1)break;Ee=W[0].properties.cluster_id}return pe},rt.prototype._appendLeaves=function(Ee,pe,W,ae,Ie){for(var qe=0,Ct=this.getChildren(pe);qe<Ct.length;qe+=1){var Re=Ct[qe],mt=Re.properties;if(mt&&mt.cluster?Ie+mt.point_count<=ae?Ie+=mt.point_count:Ie=this._appendLeaves(Ee,mt.cluster_id,W,ae,Ie):Ie<ae?Ie++:Ee.push(Re),Ee.length===W)break}return Ie},rt.prototype._addTileFeatures=function(Ee,pe,W,ae,Ie,qe){for(var Ct=0,Re=Ee;Ct<Re.length;Ct+=1){var mt=pe[Re[Ct]],Qt=mt.numPoints,Br={type:1,geometry:[[Math.round(this.options.extent*(mt.x*Ie-W)),Math.round(this.options.extent*(mt.y*Ie-ae))]],tags:Qt?ft(mt):this.points[mt.index].properties},Ur=void 0;Qt?Ur=mt.id:this.options.generateId?Ur=mt.index:this.points[mt.index].id&&(Ur=this.points[mt.index].id),Ur!==void 0&&(Br.id=Ur),qe.features.push(Br)}},rt.prototype._limitZoom=function(Ee){return Math.max(this.options.minZoom,Math.min(+Ee,this.options.maxZoom+1))},rt.prototype._cluster=function(Ee,pe){for(var W=[],ae=this.options,Ie=ae.reduce,qe=ae.minPoints,Ct=ae.radius/(ae.extent*Math.pow(2,pe)),Re=0;Re<Ee.length;Re++){var mt=Ee[Re];if(!(mt.zoom<=pe)){mt.zoom=pe;for(var Qt=this.trees[pe+1],Br=Qt.within(mt.x,mt.y,Ct),Ur=mt.numPoints||1,or=Ur,Vr=0,An=Br;Vr<An.length;Vr+=1){var dn=Qt.points[An[Vr]];dn.zoom>pe&&(or+=dn.numPoints||1)}if(or>=qe){for(var Cr=mt.x*Ur,Tn=mt.y*Ur,fn=Ie&&Ur>1?this._map(mt,!0):null,En=(Re<<5)+(pe+1)+this.points.length,Cn=0,pn=Br;Cn<pn.length;Cn+=1){var Lr=Qt.points[pn[Cn]];if(!(Lr.zoom<=pe)){Lr.zoom=pe;var hi=Lr.numPoints||1;Cr+=Lr.x*hi,Tn+=Lr.y*hi,Lr.parentId=En,Ie&&(fn||(fn=this._map(mt,!0)),Ie(fn,this._map(Lr)))}}mt.parentId=En,W.push(ue(Cr/or,Tn/or,En,or,fn))}else if(W.push(mt),or>1)for(var xi=0,ki=Br;xi<ki.length;xi+=1){var _i=Qt.points[ki[xi]];_i.zoom<=pe||(_i.zoom=pe,W.push(_i))}}}return W},rt.prototype._getOriginId=function(Ee){return Ee-this.points.length>>5},rt.prototype._getOriginZoom=function(Ee){return(Ee-this.points.length)%32},rt.prototype._map=function(Ee,pe){if(Ee.numPoints)return pe?P({},Ee.properties):Ee.properties;var W=this.points[Ee.index].properties,ae=this.options.map(W);return pe&&ae===W?P({},ae):ae},Sn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Sn.prototype.splitTile=function(Ee,pe,W,ae,Ie,qe,Ct){for(var Re=[Ee,pe,W,ae],mt=this.options,Qt=mt.debug;Re.length;){ae=Re.pop(),W=Re.pop(),pe=Re.pop(),Ee=Re.pop();var Br=1<<pe,Ur=ni(pe,W,ae),or=this.tiles[Ur];if(!or&&(Qt>1&&console.time("creation"),or=this.tiles[Ur]=Zr(Ee,pe,W,ae,mt),this.tileCoords.push({z:pe,x:W,y:ae}),Qt)){Qt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",pe,W,ae,or.numFeatures,or.numPoints,or.numSimplified),console.timeEnd("creation"));var Vr="z"+pe;this.stats[Vr]=(this.stats[Vr]||0)+1,this.total++}if(or.source=Ee,Ie){if(pe===mt.maxZoom||pe===Ie)continue;var An=1<<Ie-pe;if(W!==Math.floor(qe/An)||ae!==Math.floor(Ct/An))continue}else if(pe===mt.indexMaxZoom||or.numPoints<=mt.indexMaxPoints)continue;if(or.source=null,Ee.length!==0){Qt>1&&console.time("clipping");var dn,Cr,Tn,fn,En,Cn,pn=.5*mt.buffer/mt.extent,Lr=.5-pn,hi=.5+pn,xi=1+pn;dn=Cr=Tn=fn=null,En=Je(Ee,Br,W-pn,W+hi,0,or.minX,or.maxX,mt),Cn=Je(Ee,Br,W+Lr,W+xi,0,or.minX,or.maxX,mt),Ee=null,En&&(dn=Je(En,Br,ae-pn,ae+hi,1,or.minY,or.maxY,mt),Cr=Je(En,Br,ae+Lr,ae+xi,1,or.minY,or.maxY,mt),En=null),Cn&&(Tn=Je(Cn,Br,ae-pn,ae+hi,1,or.minY,or.maxY,mt),fn=Je(Cn,Br,ae+Lr,ae+xi,1,or.minY,or.maxY,mt),Cn=null),Qt>1&&console.timeEnd("clipping"),Re.push(dn||[],pe+1,2*W,2*ae),Re.push(Cr||[],pe+1,2*W,2*ae+1),Re.push(Tn||[],pe+1,2*W+1,2*ae),Re.push(fn||[],pe+1,2*W+1,2*ae+1)}}},Sn.prototype.getTile=function(Ee,pe,W){var ae=this.options,Ie=ae.extent,qe=ae.debug;if(Ee<0||Ee>24)return null;var Ct=1<<Ee,Re=ni(Ee,pe=(pe%Ct+Ct)%Ct,W);if(this.tiles[Re])return Vt(this.tiles[Re],Ie);qe>1&&console.log("drilling down to z%d-%d-%d",Ee,pe,W);for(var mt,Qt=Ee,Br=pe,Ur=W;!mt&&Qt>0;)Qt--,Br=Math.floor(Br/2),Ur=Math.floor(Ur/2),mt=this.tiles[ni(Qt,Br,Ur)];return mt&&mt.source?(qe>1&&console.log("found parent tile z%d-%d-%d",Qt,Br,Ur),qe>1&&console.time("drilling down"),this.splitTile(mt.source,Qt,Br,Ur,Ee,pe,W),qe>1&&console.timeEnd("drilling down"),this.tiles[Re]?Vt(this.tiles[Re],Ie):null):null};var Wn=function(Ee){function pe(W,ae,Ie,qe){Ee.call(this,W,ae,Ie,fi),qe&&(this.loadGeoJSON=qe)}return Ee&&(pe.__proto__=Ee),(pe.prototype=Object.create(Ee&&Ee.prototype)).constructor=pe,pe.prototype.loadData=function(W,ae){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=ae,this._pendingLoadDataParams=W,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},pe.prototype._loadData=function(){var W=this;if(this._pendingCallback&&this._pendingLoadDataParams){var ae=this._pendingCallback,Ie=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var qe=!!(Ie&&Ie.request&&Ie.request.collectResourceTiming)&&new o.RequestPerformance(Ie.request);this.loadGeoJSON(Ie,function(Ct,Re){if(Ct||!Re)return ae(Ct);if(typeof Re!="object")return ae(new Error("Input data given to '"+Ie.source+"' is not a valid GeoJSON object."));(function or(Vr,An){var dn,Cr=Vr&&Vr.type;if(Cr==="FeatureCollection")for(dn=0;dn<Vr.features.length;dn++)or(Vr.features[dn],An);else if(Cr==="GeometryCollection")for(dn=0;dn<Vr.geometries.length;dn++)or(Vr.geometries[dn],An);else if(Cr==="Feature")or(Vr.geometry,An);else if(Cr==="Polygon")ut(Vr.coordinates,An);else if(Cr==="MultiPolygon")for(dn=0;dn<Vr.coordinates.length;dn++)ut(Vr.coordinates[dn],An);return Vr})(Re,!0);try{if(Ie.filter){var mt=o.createExpression(Ie.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(mt.result==="error")throw new Error(mt.value.map(function(or){return or.key+": "+or.message}).join(", "));var Qt=Re.features.filter(function(or){return mt.value.evaluate({zoom:0},or)});Re={type:"FeatureCollection",features:Qt}}W._geoJSONIndex=Ie.cluster?new rt(function(or){var Vr=or.superclusterOptions,An=or.clusterProperties;if(!An||!Vr)return Vr;for(var dn={},Cr={},Tn={accumulated:null,zoom:0},fn={properties:null},En=Object.keys(An),Cn=0,pn=En;Cn<pn.length;Cn+=1){var Lr=pn[Cn],hi=An[Lr],xi=hi[0],ki=o.createExpression(hi[1]),_i=o.createExpression(typeof xi=="string"?[xi,["accumulated"],["get",Lr]]:xi);dn[Lr]=ki.value,Cr[Lr]=_i.value}return Vr.map=function(eo){fn.properties=eo;for(var pi={},Ta=0,Di=En;Ta<Di.length;Ta+=1){var bi=Di[Ta];pi[bi]=dn[bi].evaluate(Tn,fn)}return pi},Vr.reduce=function(eo,pi){fn.properties=pi;for(var Ta=0,Di=En;Ta<Di.length;Ta+=1){var bi=Di[Ta];Tn.accumulated=eo[bi],eo[bi]=Cr[bi].evaluate(Tn,fn)}},Vr}(Ie)).load(Re.features):function(or,Vr){return new Sn(or,Vr)}(Re,Ie.geojsonVtOptions)}catch(or){return ae(or)}W.loaded={};var Br={};if(qe){var Ur=qe.finish();Ur&&(Br.resourceTiming={},Br.resourceTiming[Ie.source]=JSON.parse(JSON.stringify(Ur)))}ae(null,Br)})}},pe.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},pe.prototype.reloadTile=function(W,ae){var Ie=this.loaded;return Ie&&Ie[W.uid]?Ee.prototype.reloadTile.call(this,W,ae):this.loadTile(W,ae)},pe.prototype.loadGeoJSON=function(W,ae){if(W.request)o.getJSON(W.request,ae);else{if(typeof W.data!="string")return ae(new Error("Input data given to '"+W.source+"' is not a valid GeoJSON object."));try{return ae(null,JSON.parse(W.data))}catch(Ie){return ae(new Error("Input data given to '"+W.source+"' is not a valid GeoJSON object."))}}},pe.prototype.removeSource=function(W,ae){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ae()},pe.prototype.getClusterExpansionZoom=function(W,ae){try{ae(null,this._geoJSONIndex.getClusterExpansionZoom(W.clusterId))}catch(Ie){ae(Ie)}},pe.prototype.getClusterChildren=function(W,ae){try{ae(null,this._geoJSONIndex.getChildren(W.clusterId))}catch(Ie){ae(Ie)}},pe.prototype.getClusterLeaves=function(W,ae){try{ae(null,this._geoJSONIndex.getLeaves(W.clusterId,W.limit,W.offset))}catch(Ie){ae(Ie)}},pe}(Be),Gn=function(pe){var W=this;this.self=pe,this.actor=new o.Actor(pe,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Be,geojson:Wn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(ae,Ie){if(W.workerSourceTypes[ae])throw new Error('Worker source with name "'+ae+'" already registered.');W.workerSourceTypes[ae]=Ie},this.self.registerRTLTextPlugin=function(ae){if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=ae.applyArabicShaping,o.plugin.processBidirectionalText=ae.processBidirectionalText,o.plugin.processStyledBidirectionalText=ae.processStyledBidirectionalText}};return Gn.prototype.setReferrer=function(Ee,pe){this.referrer=pe},Gn.prototype.setImages=function(Ee,pe,W){for(var ae in this.availableImages[Ee]=pe,this.workerSources[Ee]){var Ie=this.workerSources[Ee][ae];for(var qe in Ie)Ie[qe].availableImages=pe}W()},Gn.prototype.setLayers=function(Ee,pe,W){this.getLayerIndex(Ee).replace(pe),W()},Gn.prototype.updateLayers=function(Ee,pe,W){this.getLayerIndex(Ee).update(pe.layers,pe.removedIds),W()},Gn.prototype.loadTile=function(Ee,pe,W){this.getWorkerSource(Ee,pe.type,pe.source).loadTile(pe,W)},Gn.prototype.loadDEMTile=function(Ee,pe,W){this.getDEMWorkerSource(Ee,pe.source).loadTile(pe,W)},Gn.prototype.reloadTile=function(Ee,pe,W){this.getWorkerSource(Ee,pe.type,pe.source).reloadTile(pe,W)},Gn.prototype.abortTile=function(Ee,pe,W){this.getWorkerSource(Ee,pe.type,pe.source).abortTile(pe,W)},Gn.prototype.removeTile=function(Ee,pe,W){this.getWorkerSource(Ee,pe.type,pe.source).removeTile(pe,W)},Gn.prototype.removeDEMTile=function(Ee,pe){this.getDEMWorkerSource(Ee,pe.source).removeTile(pe)},Gn.prototype.removeSource=function(Ee,pe,W){if(this.workerSources[Ee]&&this.workerSources[Ee][pe.type]&&this.workerSources[Ee][pe.type][pe.source]){var ae=this.workerSources[Ee][pe.type][pe.source];delete this.workerSources[Ee][pe.type][pe.source],ae.removeSource!==void 0?ae.removeSource(pe,W):W()}},Gn.prototype.loadWorkerSource=function(Ee,pe,W){try{this.self.importScripts(pe.url),W()}catch(ae){W(ae.toString())}},Gn.prototype.syncRTLPluginState=function(Ee,pe,W){try{o.plugin.setState(pe);var ae=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&ae!=null){this.self.importScripts(ae);var Ie=o.plugin.isParsed();W(Ie?void 0:new Error("RTL Text Plugin failed to import scripts from "+ae),Ie)}}catch(qe){W(qe.toString())}},Gn.prototype.getAvailableImages=function(Ee){var pe=this.availableImages[Ee];return pe||(pe=[]),pe},Gn.prototype.getLayerIndex=function(Ee){var pe=this.layerIndexes[Ee];return pe||(pe=this.layerIndexes[Ee]=new K),pe},Gn.prototype.getWorkerSource=function(Ee,pe,W){var ae=this;return this.workerSources[Ee]||(this.workerSources[Ee]={}),this.workerSources[Ee][pe]||(this.workerSources[Ee][pe]={}),this.workerSources[Ee][pe][W]||(this.workerSources[Ee][pe][W]=new this.workerSourceTypes[pe]({send:function(qe,Ct,Re){ae.actor.send(qe,Ct,Re,Ee)}},this.getLayerIndex(Ee),this.getAvailableImages(Ee))),this.workerSources[Ee][pe][W]},Gn.prototype.getDEMWorkerSource=function(Ee,pe){return this.demWorkerSources[Ee]||(this.demWorkerSources[Ee]={}),this.demWorkerSources[Ee][pe]||(this.demWorkerSources[Ee][pe]=new st),this.demWorkerSources[Ee][pe]},Gn.prototype.enforceCacheSizeLimit=function(Ee,pe){o.enforceCacheSizeLimit(pe)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Gn(self)),Gn}),N(["./shared"],function(o){"use strict";var X=o.createCommonjsModule(function(s){function i(y){return!n(y)}function n(y){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var L,B,oe=new Blob([""],{type:"text/javascript"}),Te=URL.createObjectURL(oe);try{B=new Worker(Te),L=!0}catch(Ge){L=!1}return B&&B.terminate(),URL.revokeObjectURL(Te),L}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var L=document.createElement("canvas");L.width=L.height=1;var B=L.getContext("2d");if(!B)return!1;var oe=B.getImageData(0,0,1,1);return oe&&oe.width===L.width}()?(l[M=y&&y.failIfMajorPerformanceCaveat]===void 0&&(l[M]=function(L){var B=function(Te){var Ge=document.createElement("canvas"),Ke=Object.create(i.webGLContextAttributes);return Ke.failIfMajorPerformanceCaveat=Te,Ge.probablySupportsContext?Ge.probablySupportsContext("webgl",Ke)||Ge.probablySupportsContext("experimental-webgl",Ke):Ge.supportsContext?Ge.supportsContext("webgl",Ke)||Ge.supportsContext("experimental-webgl",Ke):Ge.getContext("webgl",Ke)||Ge.getContext("experimental-webgl",Ke)}(L);if(!B)return!1;var oe=B.createShader(B.VERTEX_SHADER);return!(!oe||B.isContextLost())&&(B.shaderSource(oe,"void main() {}"),B.compileShader(oe),B.getShaderParameter(oe,B.COMPILE_STATUS)===!0)}(M)),l[M]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var M}s.exports?s.exports=i:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=i,window.mapboxgl.notSupportedReason=n);var l={};i.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),F={create:function(i,n,l){var y=o.window.document.createElement(i);return n!==void 0&&(y.className=n),l&&l.appendChild(y),y},createNS:function(i,n){return o.window.document.createElementNS(i,n)}},K=o.window.document&&o.window.document.documentElement.style;function q(s){if(!K)return s[0];for(var i=0;i<s.length;i++)if(s[i]in K)return s[i];return s[0]}var Ce,$=q(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);F.disableDrag=function(){K&&$&&(Ce=K[$],K[$]="none")},F.enableDrag=function(){K&&$&&(K[$]=Ce)};var He=q(["transform","WebkitTransform"]);F.setTransform=function(s,i){s.style[He]=i};var Be=!1;try{var ce=Object.defineProperty({},"passive",{get:function(){Be=!0}});o.window.addEventListener("test",ce,ce),o.window.removeEventListener("test",ce,ce)}catch(s){Be=!1}F.addEventListener=function(s,i,n,l){l===void 0&&(l={}),s.addEventListener(i,n,"passive"in l&&Be?l:l.capture)},F.removeEventListener=function(s,i,n,l){l===void 0&&(l={}),s.removeEventListener(i,n,"passive"in l&&Be?l:l.capture)};var st=function s(i){i.preventDefault(),i.stopPropagation(),o.window.removeEventListener("click",s,!0)};function ut(s){var i=s.userImage;return!!(i&&i.render&&i.render())&&(s.data.replace(new Uint8Array(i.data.buffer)),!0)}F.suppressClick=function(){o.window.addEventListener("click",st,!0),o.window.setTimeout(function(){o.window.removeEventListener("click",st,!0)},0)},F.mousePos=function(s,i){var n=s.getBoundingClientRect();return new o.Point(i.clientX-n.left-s.clientLeft,i.clientY-n.top-s.clientTop)},F.touchPos=function(s,i){for(var n=s.getBoundingClientRect(),l=[],y=0;y<i.length;y++)l.push(new o.Point(i[y].clientX-n.left-s.clientLeft,i[y].clientY-n.top-s.clientTop));return l},F.mouseButton=function(s){return o.window.InstallTrigger!==void 0&&s.button===2&&s.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:s.button},F.remove=function(s){s.parentNode&&s.parentNode.removeChild(s)};var Me=function(s){function i(){s.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.isLoaded=function(){return this.loaded},i.prototype.setLoaded=function(n){if(this.loaded!==n&&(this.loaded=n,n)){for(var l=0,y=this.requestors;l<y.length;l+=1){var M=y[l];this._notify(M.ids,M.callback)}this.requestors=[]}},i.prototype.getImage=function(n){return this.images[n]},i.prototype.addImage=function(n,l){this._validate(n,l)&&(this.images[n]=l)},i.prototype._validate=function(n,l){var y=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new o.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchX" value'))),y=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new o.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchY" value'))),y=!1),this._validateContent(l.content,l)||(this.fire(new o.ErrorEvent(new Error('Image "'+n+'" has invalid "content" value'))),y=!1),y},i.prototype._validateStretch=function(n,l){if(!n)return!0;for(var y=0,M=0,L=n;M<L.length;M+=1){var B=L[M];if(B[0]<y||B[1]<B[0]||l<B[1])return!1;y=B[1]}return!0},i.prototype._validateContent=function(n,l){return!(n&&(n.length!==4||n[0]<0||l.data.width<n[0]||n[1]<0||l.data.height<n[1]||n[2]<0||l.data.width<n[2]||n[3]<0||l.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))},i.prototype.updateImage=function(n,l){l.version=this.images[n].version+1,this.images[n]=l,this.updatedImages[n]=!0},i.prototype.removeImage=function(n){var l=this.images[n];delete this.images[n],delete this.patterns[n],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()},i.prototype.listImages=function(){return Object.keys(this.images)},i.prototype.getImages=function(n,l){var y=!0;if(!this.isLoaded())for(var M=0,L=n;M<L.length;M+=1)this.images[L[M]]||(y=!1);this.isLoaded()||y?this._notify(n,l):this.requestors.push({ids:n,callback:l})},i.prototype._notify=function(n,l){for(var y={},M=0,L=n;M<L.length;M+=1){var B=L[M];this.images[B]||this.fire(new o.Event("styleimagemissing",{id:B}));var oe=this.images[B];oe?y[B]={data:oe.data.clone(),pixelRatio:oe.pixelRatio,sdf:oe.sdf,version:oe.version,stretchX:oe.stretchX,stretchY:oe.stretchY,content:oe.content,hasRenderCallback:Boolean(oe.userImage&&oe.userImage.render)}:o.warnOnce('Image "'+B+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}l(null,y)},i.prototype.getPixelSize=function(){var n=this.atlasImage;return{width:n.width,height:n.height}},i.prototype.getPattern=function(n){var l=this.patterns[n],y=this.getImage(n);if(!y)return null;if(l&&l.position.version===y.version)return l.position;if(l)l.position.version=y.version;else{var M={w:y.data.width+2,h:y.data.height+2,x:0,y:0},L=new o.ImagePosition(M,y);this.patterns[n]={bin:M,position:L}}return this._updatePatternAtlas(),this.patterns[n].position},i.prototype.bind=function(n){var l=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(n,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)},i.prototype._updatePatternAtlas=function(){var n=[];for(var l in this.patterns)n.push(this.patterns[l].bin);var y=o.potpack(n),M=y.w,L=y.h,B=this.atlasImage;for(var oe in B.resize({width:M||1,height:L||1}),this.patterns){var Te=this.patterns[oe].bin,Ge=Te.x+1,Ke=Te.y+1,et=this.images[oe].data,Ft=et.width,Rt=et.height;o.RGBAImage.copy(et,B,{x:0,y:0},{x:Ge,y:Ke},{width:Ft,height:Rt}),o.RGBAImage.copy(et,B,{x:0,y:Rt-1},{x:Ge,y:Ke-1},{width:Ft,height:1}),o.RGBAImage.copy(et,B,{x:0,y:0},{x:Ge,y:Ke+Rt},{width:Ft,height:1}),o.RGBAImage.copy(et,B,{x:Ft-1,y:0},{x:Ge-1,y:Ke},{width:1,height:Rt}),o.RGBAImage.copy(et,B,{x:0,y:0},{x:Ge+Ft,y:Ke},{width:1,height:Rt})}this.dirty=!0},i.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},i.prototype.dispatchRenderCallbacks=function(n){for(var l=0,y=n;l<y.length;l+=1){var M=y[l];if(!this.callbackDispatchedThisFrame[M]){this.callbackDispatchedThisFrame[M]=!0;var L=this.images[M];ut(L)&&this.updateImage(M,L)}}},i}(o.Evented),bt=De,xt=De,Mt=1e20;function De(s,i,n,l,y,M){this.fontSize=s||24,this.buffer=i===void 0?3:i,this.cutoff=l||.25,this.fontFamily=y||"sans-serif",this.fontWeight=M||"normal",this.radius=n||8;var L=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=L,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(L*L),this.gridInner=new Float64Array(L*L),this.f=new Float64Array(L),this.d=new Float64Array(L),this.z=new Float64Array(L+1),this.v=new Int16Array(L),this.middle=Math.round(L/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function ar(s,i,n,l,y,M,L){for(var B=0;B<i;B++){for(var oe=0;oe<n;oe++)l[oe]=s[oe*i+B];for($t(l,y,M,L,n),oe=0;oe<n;oe++)s[oe*i+B]=y[oe]}for(oe=0;oe<n;oe++){for(B=0;B<i;B++)l[B]=s[oe*i+B];for($t(l,y,M,L,i),B=0;B<i;B++)s[oe*i+B]=Math.sqrt(y[B])}}function $t(s,i,n,l,y){n[0]=0,l[0]=-Mt,l[1]=+Mt;for(var M=1,L=0;M<y;M++){for(var B=(s[M]+M*M-(s[n[L]]+n[L]*n[L]))/(2*M-2*n[L]);B<=l[L];)L--,B=(s[M]+M*M-(s[n[L]]+n[L]*n[L]))/(2*M-2*n[L]);n[++L]=M,l[L]=B,l[L+1]=+Mt}for(M=0,L=0;M<y;M++){for(;l[L+1]<M;)L++;i[M]=(M-n[L])*(M-n[L])+s[n[L]]}}De.prototype.draw=function(s){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(s,this.buffer,this.middle);for(var i=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),l=0;l<this.size*this.size;l++){var y=i.data[4*l+3]/255;this.gridOuter[l]=y===1?0:y===0?Mt:Math.pow(Math.max(0,.5-y),2),this.gridInner[l]=y===1?Mt:y===0?0:Math.pow(Math.max(0,y-.5),2)}for(ar(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),ar(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),l=0;l<this.size*this.size;l++)n[l]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[l]-this.gridInner[l])/this.radius+this.cutoff))));return n},bt.default=xt;var Ht=function(i,n){this.requestManager=i,this.localIdeographFontFamily=n,this.entries={}};Ht.prototype.setURL=function(s){this.url=s},Ht.prototype.getGlyphs=function(s,i){var n=this,l=[];for(var y in s)for(var M=0,L=s[y];M<L.length;M+=1)l.push({stack:y,id:L[M]});o.asyncAll(l,function(B,oe){var Te=B.stack,Ge=B.id,Ke=n.entries[Te];Ke||(Ke=n.entries[Te]={glyphs:{},requests:{},ranges:{}});var et=Ke.glyphs[Ge];if(et===void 0){if(et=n._tinySDF(Ke,Te,Ge))return Ke.glyphs[Ge]=et,void oe(null,{stack:Te,id:Ge,glyph:et});var Ft=Math.floor(Ge/256);if(256*Ft>65535)oe(new Error("glyphs > 65535 not supported"));else if(Ke.ranges[Ft])oe(null,{stack:Te,id:Ge,glyph:et});else{var Rt=Ke.requests[Ft];Rt||(Rt=Ke.requests[Ft]=[],Ht.loadGlyphRange(Te,Ft,n.url,n.requestManager,function(Yt,zt){if(zt){for(var jt in zt)n._doesCharSupportLocalGlyph(+jt)||(Ke.glyphs[+jt]=zt[+jt]);Ke.ranges[Ft]=!0}for(var rr=0,nr=Rt;rr<nr.length;rr+=1)(0,nr[rr])(Yt,zt);delete Ke.requests[Ft]})),Rt.push(function(Yt,zt){Yt?oe(Yt):zt&&oe(null,{stack:Te,id:Ge,glyph:zt[Ge]||null})})}}else oe(null,{stack:Te,id:Ge,glyph:et})},function(B,oe){if(B)i(B);else if(oe){for(var Te={},Ge=0,Ke=oe;Ge<Ke.length;Ge+=1){var et=Ke[Ge],Ft=et.stack,Rt=et.id,Yt=et.glyph;(Te[Ft]||(Te[Ft]={}))[Rt]=Yt&&{id:Yt.id,bitmap:Yt.bitmap.clone(),metrics:Yt.metrics}}i(null,Te)}})},Ht.prototype._doesCharSupportLocalGlyph=function(s){return!!this.localIdeographFontFamily&&(o.isChar["CJK Unified Ideographs"](s)||o.isChar["Hangul Syllables"](s)||o.isChar.Hiragana(s)||o.isChar.Katakana(s))},Ht.prototype._tinySDF=function(s,i,n){var l=this.localIdeographFontFamily;if(l&&this._doesCharSupportLocalGlyph(n)){var y=s.tinySDF;if(!y){var M="400";/bold/i.test(i)?M="900":/medium/i.test(i)?M="500":/light/i.test(i)&&(M="200"),y=s.tinySDF=new Ht.TinySDF(24,3,8,.25,l,M)}return{id:n,bitmap:new o.AlphaImage({width:30,height:30},y.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ht.loadGlyphRange=function(s,i,n,l,y){var M=256*i,L=M+255,B=l.transformRequest(l.normalizeGlyphsURL(n).replace("{fontstack}",s).replace("{range}",M+"-"+L),o.ResourceType.Glyphs);o.getArrayBuffer(B,function(oe,Te){if(oe)y(oe);else if(Te){for(var Ge={},Ke=0,et=o.parseGlyphPBF(Te);Ke<et.length;Ke+=1){var Ft=et[Ke];Ge[Ft.id]=Ft}y(null,Ge)}})},Ht.TinySDF=bt;var vt=function(){this.specification=o.styleSpec.light.position};vt.prototype.possiblyEvaluate=function(s,i){return o.sphericalToCartesian(s.expression.evaluate(i))},vt.prototype.interpolate=function(s,i,n){return{x:o.number(s.x,i.x,n),y:o.number(s.y,i.y,n),z:o.number(s.z,i.z,n)}};var Ze=new o.Properties({anchor:new o.DataConstantProperty(o.styleSpec.light.anchor),position:new vt,color:new o.DataConstantProperty(o.styleSpec.light.color),intensity:new o.DataConstantProperty(o.styleSpec.light.intensity)}),Et=function(s){function i(n){s.call(this),this._transitionable=new o.Transitionable(Ze),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getLight=function(){return this._transitionable.serialize()},i.prototype.setLight=function(n,l){if(l===void 0&&(l={}),!this._validate(o.validateLight,n,l))for(var y in n){var M=n[y];o.endsWith(y,"-transition")?this._transitionable.setTransition(y.slice(0,-"-transition".length),M):this._transitionable.setValue(y,M)}},i.prototype.updateTransitions=function(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)},i.prototype.hasTransition=function(){return this._transitioning.hasTransition()},i.prototype.recalculate=function(n){this.properties=this._transitioning.possiblyEvaluate(n)},i.prototype._validate=function(n,l,y){return(!y||y.validate!==!1)&&o.emitValidationErrors(this,n.call(o.validateStyle,o.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:o.styleSpec})))},i}(o.Evented),Le=function(i,n){this.width=i,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Le.prototype.getDash=function(s,i){var n=s.join(",")+String(i);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(s,i)),this.dashEntry[n]},Le.prototype.getDashRanges=function(s,i,n){var l=[],y=s.length%2==1?-s[s.length-1]*n:0,M=s[0]*n,L=!0;l.push({left:y,right:M,isDash:L,zeroLength:s[0]===0});for(var B=s[0],oe=1;oe<s.length;oe++){var Te=s[oe];l.push({left:y=B*n,right:M=(B+=Te)*n,isDash:L=!L,zeroLength:Te===0})}return l},Le.prototype.addRoundDash=function(s,i,n){for(var l=i/2,y=-n;y<=n;y++)for(var M=this.width*(this.nextRow+n+y),L=0,B=s[L],oe=0;oe<this.width;oe++){oe/B.right>1&&(B=s[++L]);var Te=Math.abs(oe-B.left),Ge=Math.abs(oe-B.right),Ke=Math.min(Te,Ge),et=void 0,Ft=y/n*(l+1);if(B.isDash){var Rt=l-Math.abs(Ft);et=Math.sqrt(Ke*Ke+Rt*Rt)}else et=l-Math.sqrt(Ke*Ke+Ft*Ft);this.data[M+oe]=Math.max(0,Math.min(255,et+128))}},Le.prototype.addRegularDash=function(s){for(var i=s.length-1;i>=0;--i){var n=s[i],l=s[i+1];n.zeroLength?s.splice(i,1):l&&l.isDash===n.isDash&&(l.left=n.left,s.splice(i,1))}var y=s[0],M=s[s.length-1];y.isDash===M.isDash&&(y.left=M.left-this.width,M.right=y.right+this.width);for(var L=this.width*this.nextRow,B=0,oe=s[B],Te=0;Te<this.width;Te++){Te/oe.right>1&&(oe=s[++B]);var Ge=Math.abs(Te-oe.left),Ke=Math.abs(Te-oe.right),et=Math.min(Ge,Ke);this.data[L+Te]=Math.max(0,Math.min(255,(oe.isDash?et:-et)+128))}},Le.prototype.addDash=function(s,i){var n=i?7:0,l=2*n+1;if(this.nextRow+l>this.height)return o.warnOnce("LineAtlas out of space"),null;for(var y=0,M=0;M<s.length;M++)y+=s[M];if(y!==0){var L=this.width/y,B=this.getDashRanges(s,this.width,L);i?this.addRoundDash(B,L,n):this.addRegularDash(B)}var oe={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:y};return this.nextRow+=l,this.dirty=!0,oe},Le.prototype.bind=function(s){var i=s.gl;this.texture?(i.bindTexture(i.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,i.texSubImage2D(i.TEXTURE_2D,0,0,0,this.width,this.height,i.ALPHA,i.UNSIGNED_BYTE,this.data))):(this.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.ALPHA,this.width,this.height,0,i.ALPHA,i.UNSIGNED_BYTE,this.data))};var at=function s(i,n){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=o.uniqueId();for(var l=this.workerPool.acquire(this.id),y=0;y<l.length;y++){var M=new s.Actor(l[y],n,this.id);M.name="Worker "+y,this.actors.push(M)}};function Wt(s,i,n){var l=function(M,L){if(M)return n(M);if(L){var B=o.pick(o.extend(L,s),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);L.vector_layers&&(B.vectorLayers=L.vector_layers,B.vectorLayerIds=B.vectorLayers.map(function(oe){return oe.id})),B.tiles=i.canonicalizeTileset(B,s.url),n(null,B)}};return s.url?o.getJSON(i.transformRequest(i.normalizeSourceURL(s.url),o.ResourceType.Source),l):o.browser.frame(function(){return l(null,s)})}at.prototype.broadcast=function(s,i,n){o.asyncAll(this.actors,function(l,y){l.send(s,i,y)},n=n||function(){})},at.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},at.prototype.remove=function(){this.actors.forEach(function(s){s.remove()}),this.actors=[],this.workerPool.release(this.id)},at.Actor=o.Actor;var St=function(i,n,l){this.bounds=o.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=n||0,this.maxzoom=l||24};St.prototype.validateBounds=function(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]},St.prototype.contains=function(s){var i=Math.pow(2,s.z),n=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*i),l=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*i),y=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*i),M=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*i);return s.x>=n&&s.x<y&&s.y>=l&&s.y<M};var dt=function(s){function i(n,l,y,M){if(s.call(this),this.id=n,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(l,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(M)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Wt(this._options,this.map._requestManager,function(l,y){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new o.ErrorEvent(l)):y&&(o.extend(n,y),y.bounds&&(n.tileBounds=new St(y.bounds,n.minzoom,n.maxzoom)),o.postTurnstileEvent(y.tiles,n.map._requestManager._customAccessToken),o.postMapLoadEvent(y.tiles,n.map._getMapId(),n.map._requestManager._skuToken,n.map._requestManager._customAccessToken),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},i.prototype.loaded=function(){return this._loaded},i.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},i.prototype.onAdd=function(n){this.map=n,this.load()},i.prototype.setSourceProperty=function(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},i.prototype.setTiles=function(n){var l=this;return this.setSourceProperty(function(){l._options.tiles=n}),this},i.prototype.setUrl=function(n){var l=this;return this.setSourceProperty(function(){l.url=n,l._options.url=n}),this},i.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},i.prototype.serialize=function(){return o.extend({},this._options)},i.prototype.loadTile=function(n,l){var y=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),M={request:this.map._requestManager.transformRequest(y,o.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function L(B,oe){return delete n.request,n.aborted?l(null):B&&B.status!==404?l(B):(oe&&oe.resourceTiming&&(n.resourceTiming=oe.resourceTiming),this.map._refreshExpiredTiles&&oe&&n.setExpiryData(oe),n.loadVectorData(oe,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),l(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}M.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=l:n.request=n.actor.send("reloadTile",M,L.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",M,L.bind(this)))},i.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)},i.prototype.unloadTile=function(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)},i.prototype.hasTransition=function(){return!1},i}(o.Evented),H=function(s){function i(n,l,y,M){s.call(this),this.id=n,this.dispatcher=y,this.setEventedParent(M),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},l),o.extend(this,o.pick(l,["url","scheme","tileSize"]))}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Wt(this._options,this.map._requestManager,function(l,y){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new o.ErrorEvent(l)):y&&(o.extend(n,y),y.bounds&&(n.tileBounds=new St(y.bounds,n.minzoom,n.maxzoom)),o.postTurnstileEvent(y.tiles),o.postMapLoadEvent(y.tiles,n.map._getMapId(),n.map._requestManager._skuToken),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},i.prototype.loaded=function(){return this._loaded},i.prototype.onAdd=function(n){this.map=n,this.load()},i.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},i.prototype.serialize=function(){return o.extend({},this._options)},i.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},i.prototype.loadTile=function(n,l){var y=this,M=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=o.getImage(this.map._requestManager.transformRequest(M,o.ResourceType.Tile),function(L,B){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(L)n.state="errored",l(L);else if(B){y.map._refreshExpiredTiles&&n.setExpiryData(B),delete B.cacheControl,delete B.expires;var oe=y.map.painter.context,Te=oe.gl;n.texture=y.map.painter.getTileTexture(B.width),n.texture?n.texture.update(B,{useMipmap:!0}):(n.texture=new o.Texture(oe,B,Te.RGBA,{useMipmap:!0}),n.texture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE,Te.LINEAR_MIPMAP_NEAREST),oe.extTextureFilterAnisotropic&&Te.texParameterf(Te.TEXTURE_2D,oe.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,oe.extTextureFilterAnisotropicMax)),n.state="loaded",o.cacheEntryPossiblyAdded(y.dispatcher),l(null)}})},i.prototype.abortTile=function(n,l){n.request&&(n.request.cancel(),delete n.request),l()},i.prototype.unloadTile=function(n,l){n.texture&&this.map.painter.saveTileTexture(n.texture),l()},i.prototype.hasTransition=function(){return!1},i}(o.Evented),z=function(s){function i(n,l,y,M){s.call(this,n,l,y,M),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},i.prototype.loadTile=function(n,l){var y=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function M(L,B){L&&(n.state="errored",l(L)),B&&(n.dem=B,n.needsHillshadePrepare=!0,n.state="loaded",l(null))}n.request=o.getImage(this.map._requestManager.transformRequest(y,o.ResourceType.Tile),function(L,B){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(L)n.state="errored",l(L);else if(B){this.map._refreshExpiredTiles&&n.setExpiryData(B),delete B.cacheControl,delete B.expires;var oe=o.window.ImageBitmap&&B instanceof o.window.ImageBitmap&&o.offscreenCanvasSupported()?B:o.browser.getImageData(B,1),Te={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:oe,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",Te,M.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},i.prototype._getNeighboringTiles=function(n){var l=n.canonical,y=Math.pow(2,l.z),M=(l.x-1+y)%y,L=l.x===0?n.wrap-1:n.wrap,B=(l.x+1+y)%y,oe=l.x+1===y?n.wrap+1:n.wrap,Te={};return Te[new o.OverscaledTileID(n.overscaledZ,L,l.z,M,l.y).key]={backfilled:!1},Te[new o.OverscaledTileID(n.overscaledZ,oe,l.z,B,l.y).key]={backfilled:!1},l.y>0&&(Te[new o.OverscaledTileID(n.overscaledZ,L,l.z,M,l.y-1).key]={backfilled:!1},Te[new o.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},Te[new o.OverscaledTileID(n.overscaledZ,oe,l.z,B,l.y-1).key]={backfilled:!1}),l.y+1<y&&(Te[new o.OverscaledTileID(n.overscaledZ,L,l.z,M,l.y+1).key]={backfilled:!1},Te[new o.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},Te[new o.OverscaledTileID(n.overscaledZ,oe,l.z,B,l.y+1).key]={backfilled:!1}),Te},i.prototype.unloadTile=function(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})},i}(H),V=function(s){function i(n,l,y,M){s.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=y.getActor(),this.setEventedParent(M),this._data=l.data,this._options=o.extend({},l),this._collectResourceTiming=l.collectResourceTiming,this._resourceTiming=[],l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;var L=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*L,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*L,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?Math.min(l.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:o.EXTENT,radius:(l.clusterRadius||50)*L,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.load=function(){var n=this;this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(l){if(l)n.fire(new o.ErrorEvent(l));else{var y={dataType:"source",sourceDataType:"metadata"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(y.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new o.Event("data",y))}})},i.prototype.onAdd=function(n){this.map=n,this.load()},i.prototype.setData=function(n){var l=this;return this._data=n,this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(y){if(y)l.fire(new o.ErrorEvent(y));else{var M={dataType:"source",sourceDataType:"content"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(M.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new o.Event("data",M))}}),this},i.prototype.getClusterExpansionZoom=function(n,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},l),this},i.prototype.getClusterChildren=function(n,l){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},l),this},i.prototype.getClusterLeaves=function(n,l,y,M){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:l,offset:y},M),this},i.prototype._updateWorkerData=function(n){var l=this;this._loaded=!1;var y=o.extend({},this.workerOptions),M=this._data;typeof M=="string"?(y.request=this.map._requestManager.transformRequest(o.browser.resolveURL(M),o.ResourceType.Source),y.request.collectResourceTiming=this._collectResourceTiming):y.data=JSON.stringify(M),this.actor.send(this.type+".loadData",y,function(L,B){l._removed||B&&B.abandoned||(l._loaded=!0,B&&B.resourceTiming&&B.resourceTiming[l.id]&&(l._resourceTiming=B.resourceTiming[l.id].slice(0)),l.actor.send(l.type+".coalesce",{source:y.source},null),n(L))})},i.prototype.loaded=function(){return this._loaded},i.prototype.loadTile=function(n,l){var y=this,M=n.actor?"reloadTile":"loadTile";n.actor=this.actor,n.request=this.actor.send(M,{type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(L,B){return delete n.request,n.unloadVectorData(),n.aborted?l(null):L?l(L):(n.loadVectorData(B,y.map.painter,M==="reloadTile"),l(null))})},i.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0},i.prototype.unloadTile=function(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})},i.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},i.prototype.serialize=function(){return o.extend({},this._options,{type:this.type,data:this._data})},i.prototype.hasTransition=function(){return!1},i}(o.Evented),be=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),me=function(s){function i(n,l,y,M){s.call(this),this.id=n,this.dispatcher=y,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(M),this.options=l}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.load=function(n,l){var y=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),function(M,L){y._loaded=!0,M?y.fire(new o.ErrorEvent(M)):L&&(y.image=L,n&&(y.coordinates=n),l&&l(),y._finishLoading())})},i.prototype.loaded=function(){return this._loaded},i.prototype.updateImage=function(n){var l=this;return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,function(){l.texture=null}),this):this},i.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))},i.prototype.onAdd=function(n){this.map=n,this.load()},i.prototype.setCoordinates=function(n){var l=this;this.coordinates=n;var y=n.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(L){for(var B=1/0,oe=1/0,Te=-1/0,Ge=-1/0,Ke=0,et=L;Ke<et.length;Ke+=1){var Ft=et[Ke];B=Math.min(B,Ft.x),oe=Math.min(oe,Ft.y),Te=Math.max(Te,Ft.x),Ge=Math.max(Ge,Ft.y)}var Rt=Math.max(Te-B,Ge-oe),Yt=Math.max(0,Math.floor(-Math.log(Rt)/Math.LN2)),zt=Math.pow(2,Yt);return new o.CanonicalTileID(Yt,Math.floor((B+Te)/2*zt),Math.floor((oe+Ge)/2*zt))}(y),this.minzoom=this.maxzoom=this.tileID.z;var M=y.map(function(L){return l.tileID.getTilePoint(L)._round()});return this._boundsArray=new o.StructArrayLayout4i8,this._boundsArray.emplaceBack(M[0].x,M[0].y,0,0),this._boundsArray.emplaceBack(M[1].x,M[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(M[3].x,M[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(M[2].x,M[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this},i.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var n=this.map.painter.context,l=n.gl;for(var y in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,be.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new o.Texture(n,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var M=this.tiles[y];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture)}}},i.prototype.loadTile=function(n,l){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},l(null)):(n.state="errored",l(null))},i.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},i.prototype.hasTransition=function(){return!1},i}(o.Evented),le=function(s){function i(n,l,y,M){s.call(this,n,l,y,M),this.roundZoom=!0,this.type="video",this.options=l}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.load=function(){var n=this;this._loaded=!1;var l=this.options;this.urls=[];for(var y=0,M=l.urls;y<M.length;y+=1)this.urls.push(this.map._requestManager.transformRequest(M[y],o.ResourceType.Source).url);o.getVideo(this.urls,function(L,B){n._loaded=!0,L?n.fire(new o.ErrorEvent(L)):B&&(n.video=B,n.video.loop=!0,n.video.addEventListener("playing",function(){n.map.triggerRepaint()}),n.map&&n.video.play(),n._finishLoading())})},i.prototype.pause=function(){this.video&&this.video.pause()},i.prototype.play=function(){this.video&&this.video.play()},i.prototype.seek=function(n){if(this.video){var l=this.video.seekable;n<l.start(0)||n>l.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+l.start(0)+" and "+l.end(0)+"-second mark."))):this.video.currentTime=n}},i.prototype.getVideo=function(){return this.video},i.prototype.onAdd=function(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},i.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var n=this.map.painter.context,l=n.gl;for(var y in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,be.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(n,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var M=this.tiles[y];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture)}}},i.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},i.prototype.hasTransition=function(){return this.video&&!this.video.paused},i}(me),fe=function(s){function i(n,l,y,M){s.call(this,n,l,y,M),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(function(L){return!Array.isArray(L)||L.length!==2||L.some(function(B){return typeof B!="number"})})||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},i.prototype.getCanvas=function(){return this.canvas},i.prototype.onAdd=function(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()},i.prototype.onRemove=function(){this.pause()},i.prototype.prepare=function(){var n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var l=this.map.painter.context,y=l.gl;for(var M in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,be.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(l,this.canvas,y.RGBA,{premultiply:!0}),this.tiles){var L=this.tiles[M];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture)}}},i.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},i.prototype.hasTransition=function(){return this._playing},i.prototype._hasInvalidDimensions=function(){for(var n=0,l=[this.canvas.width,this.canvas.height];n<l.length;n+=1){var y=l[n];if(isNaN(y)||y<=0)return!0}return!1},i}(me),Ne={vector:dt,raster:H,"raster-dem":z,geojson:V,video:le,image:me,canvas:fe};function lt(s,i){var n=o.identity([]);return o.translate(n,n,[1,1,0]),o.scale(n,n,[.5*s.width,.5*s.height,1]),o.multiply(n,n,s.calculatePosMatrix(i.toUnwrapped()))}function rt(s,i,n,l,y,M){var L=function(Yt,zt,jt){if(Yt)for(var rr=0,nr=Yt;rr<nr.length;rr+=1){var zr=zt[nr[rr]];if(zr&&zr.source===jt&&zr.type==="fill-extrusion")return!0}else for(var pr in zt){var Ar=zt[pr];if(Ar.source===jt&&Ar.type==="fill-extrusion")return!0}return!1}(y&&y.layers,i,s.id),B=M.maxPitchScaleFactor(),oe=s.tilesIn(l,B,L);oe.sort(ue);for(var Te=[],Ge=0,Ke=oe;Ge<Ke.length;Ge+=1){var et=Ke[Ge];Te.push({wrappedTileID:et.tileID.wrapped().key,queryResults:et.tile.queryRenderedFeatures(i,n,s._state,et.queryGeometry,et.cameraQueryGeometry,et.scale,y,M,B,lt(s.transform,et.tileID))})}var Ft=function(Yt){for(var zt={},jt={},rr=0,nr=Yt;rr<nr.length;rr+=1){var zr=nr[rr],pr=zr.queryResults,Ar=zr.wrappedTileID,wr=jt[Ar]=jt[Ar]||{};for(var sn in pr)for(var $r=pr[sn],xn=wr[sn]=wr[sn]||{},In=zt[sn]=zt[sn]||[],ei=0,si=$r;ei<si.length;ei+=1){var Ii=si[ei];xn[Ii.featureIndex]||(xn[Ii.featureIndex]=!0,In.push(Ii))}}return zt}(Te);for(var Rt in Ft)Ft[Rt].forEach(function(Yt){var zt=Yt.feature,jt=s.getFeatureState(zt.layer["source-layer"],zt.id);zt.source=zt.layer.source,zt.layer["source-layer"]&&(zt.sourceLayer=zt.layer["source-layer"]),zt.state=jt});return Ft}function ue(s,i){var n=s.tileID,l=i.tileID;return n.overscaledZ-l.overscaledZ||n.canonical.y-l.canonical.y||n.wrap-l.wrap||n.canonical.x-l.canonical.x}var ye=function(i,n){this.max=i,this.onRemove=n,this.reset()};ye.prototype.reset=function(){for(var s in this.data)for(var i=0,n=this.data[s];i<n.length;i+=1){var l=n[i];l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value)}return this.data={},this.order=[],this},ye.prototype.add=function(s,i,n){var l=this,y=s.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);var M={value:i,timeout:void 0};if(n!==void 0&&(M.timeout=setTimeout(function(){l.remove(s,M)},n)),this.data[y].push(M),this.order.push(y),this.order.length>this.max){var L=this._getAndRemoveByKey(this.order[0]);L&&this.onRemove(L)}return this},ye.prototype.has=function(s){return s.wrapped().key in this.data},ye.prototype.getAndRemove=function(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null},ye.prototype._getAndRemoveByKey=function(s){var i=this.data[s].shift();return i.timeout&&clearTimeout(i.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),i.value},ye.prototype.getByKey=function(s){var i=this.data[s];return i?i[0].value:null},ye.prototype.get=function(s){return this.has(s)?this.data[s.wrapped().key][0].value:null},ye.prototype.remove=function(s,i){if(!this.has(s))return this;var n=s.wrapped().key,l=i===void 0?0:this.data[n].indexOf(i),y=this.data[n][l];return this.data[n].splice(l,1),y.timeout&&clearTimeout(y.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(y.value),this.order.splice(this.order.indexOf(n),1),this},ye.prototype.setMaxSize=function(s){for(this.max=s;this.order.length>this.max;){var i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this},ye.prototype.filter=function(s){var i=[];for(var n in this.data)for(var l=0,y=this.data[n];l<y.length;l+=1){var M=y[l];s(M.value)||i.push(M)}for(var L=0,B=i;L<B.length;L+=1){var oe=B[L];this.remove(oe.value.tileID,oe)}};var Ue=function(i,n,l){this.context=i;var y=i.gl;this.buffer=y.createBuffer(),this.dynamicDraw=Boolean(l),this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};Ue.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ue.prototype.updateData=function(s){var i=this.context.gl;this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)},Ue.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ft={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Oe=function(i,n,l,y){this.length=n.length,this.attributes=l,this.itemSize=n.bytesPerElement,this.dynamicDraw=y,this.context=i;var M=i.gl;this.buffer=M.createBuffer(),i.bindVertexBuffer.set(this.buffer),M.bufferData(M.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};Oe.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Oe.prototype.updateData=function(s){var i=this.context.gl;this.bind(),i.bufferSubData(i.ARRAY_BUFFER,0,s.arrayBuffer)},Oe.prototype.enableAttributes=function(s,i){for(var n=0;n<this.attributes.length;n++){var l=i.attributes[this.attributes[n].name];l!==void 0&&s.enableVertexAttribArray(l)}},Oe.prototype.setVertexAttribPointers=function(s,i,n){for(var l=0;l<this.attributes.length;l++){var y=this.attributes[l],M=i.attributes[y.name];M!==void 0&&s.vertexAttribPointer(M,y.components,s[ft[y.type]],!1,this.itemSize,y.offset+this.itemSize*(n||0))}},Oe.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Ve=function(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Ve.prototype.get=function(){return this.current},Ve.prototype.set=function(s){},Ve.prototype.getDefault=function(){return this.default},Ve.prototype.setDefault=function(){this.set(this.default)};var P=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return o.Color.transparent},i.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},i}(Ve),R=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return 1},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)},i}(Ve),J=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return 0},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)},i}(Ve),de=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return[!0,!0,!0,!0]},i.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},i}(Ve),je=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return!0},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)},i}(Ve),We=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return 255},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)},i}(Ve),gt=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},i.prototype.set=function(n){var l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)},i}(Ve),nt=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){var n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]},i.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)},i}(Ve),Nt=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}},i}(Ve),Y=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return[0,1]},i.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)},i}(Ve),Xe=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}},i}(Ve),re=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return this.gl.LESS},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)},i}(Ve),Je=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}},i}(Ve),Gt=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){var n=this.gl;return[n.ONE,n.ZERO]},i.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)},i}(Ve),ur=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return o.Color.transparent},i.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},i}(Ve),ct=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return this.gl.FUNC_ADD},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)},i}(Ve),ht=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}},i}(Ve),Pt=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return this.gl.BACK},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)},i}(Ve),pt=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return this.gl.CCW},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)},i}(Ve),Pe=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)},i}(Ve),ot=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return this.gl.TEXTURE0},i.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)},i}(Ve),$e=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){var n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]},i.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},i}(Ve),Vt=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}},i}(Ve),dr=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},i}(Ve),Zr=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}},i}(Ve),cr=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}},i}(Ve),Un=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){var l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1},i}(Ve),Sn=function(s){function i(n){s.call(this,n),this.vao=n.extVertexArrayObject}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i.prototype.set=function(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)},i}(Ve),ni=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return 4},i.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}},i}(Ve),fi=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}},i}(Ve),Wn=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return!1},i.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}},i}(Ve),Gn=function(s){function i(n,l){s.call(this,n),this.context=n,this.parent=l}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getDefault=function(){return null},i}(Ve),Ee=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.setDirty=function(){this.dirty=!0},i.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}},i}(Gn),pe=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},i}(Gn),W=function(i,n,l,y){this.context=i,this.width=n,this.height=l;var M=this.framebuffer=i.gl.createFramebuffer();this.colorAttachment=new Ee(i,M),y&&(this.depthAttachment=new pe(i,M))};W.prototype.destroy=function(){var s=this.context.gl,i=this.colorAttachment.get();if(i&&s.deleteTexture(i),this.depthAttachment){var n=this.depthAttachment.get();n&&s.deleteRenderbuffer(n)}s.deleteFramebuffer(this.framebuffer)};var ae=function(i,n,l){this.func=i,this.mask=n,this.range=l};ae.ReadOnly=!1,ae.ReadWrite=!0,ae.disabled=new ae(519,ae.ReadOnly,[0,1]);var Ie=function(i,n,l,y,M,L){this.test=i,this.ref=n,this.mask=l,this.fail=y,this.depthFail=M,this.pass=L};Ie.disabled=new Ie({func:519,mask:0},0,0,7680,7680,7680);var qe=function(i,n,l){this.blendFunction=i,this.blendColor=n,this.mask=l};qe.disabled=new qe(qe.Replace=[1,0],o.Color.transparent,[!1,!1,!1,!1]),qe.unblended=new qe(qe.Replace,o.Color.transparent,[!0,!0,!0,!0]),qe.alphaBlended=new qe([1,771],o.Color.transparent,[!0,!0,!0,!0]);var Ct=function(i,n,l){this.enable=i,this.mode=n,this.frontFace=l};Ct.disabled=new Ct(!1,1029,2305),Ct.backCCW=new Ct(!0,1029,2305);var Re=function(i){this.gl=i,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new P(this),this.clearDepth=new R(this),this.clearStencil=new J(this),this.colorMask=new de(this),this.depthMask=new je(this),this.stencilMask=new We(this),this.stencilFunc=new gt(this),this.stencilOp=new nt(this),this.stencilTest=new Nt(this),this.depthRange=new Y(this),this.depthTest=new Xe(this),this.depthFunc=new re(this),this.blend=new Je(this),this.blendFunc=new Gt(this),this.blendColor=new ur(this),this.blendEquation=new ct(this),this.cullFace=new ht(this),this.cullFaceSide=new Pt(this),this.frontFace=new pt(this),this.program=new Pe(this),this.activeTexture=new ot(this),this.viewport=new $e(this),this.bindFramebuffer=new Vt(this),this.bindRenderbuffer=new dr(this),this.bindTexture=new Zr(this),this.bindVertexBuffer=new cr(this),this.bindElementBuffer=new Un(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Sn(this),this.pixelStoreUnpack=new ni(this),this.pixelStoreUnpackPremultiplyAlpha=new fi(this),this.pixelStoreUnpackFlipY=new Wn(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=i.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(i.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)};Re.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Re.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Re.prototype.createIndexBuffer=function(s,i){return new Ue(this,s,i)},Re.prototype.createVertexBuffer=function(s,i,n){return new Oe(this,s,i,n)},Re.prototype.createRenderbuffer=function(s,i,n){var l=this.gl,y=l.createRenderbuffer();return this.bindRenderbuffer.set(y),l.renderbufferStorage(l.RENDERBUFFER,s,i,n),this.bindRenderbuffer.set(null),y},Re.prototype.createFramebuffer=function(s,i,n){return new W(this,s,i,n)},Re.prototype.clear=function(s){var i=s.color,n=s.depth,l=this.gl,y=0;i&&(y|=l.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(y|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),l.clear(y)},Re.prototype.setCullFace=function(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))},Re.prototype.setDepthMode=function(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)},Re.prototype.setStencilMode=function(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)},Re.prototype.setColorMode=function(s){o.deepEqual(s.blendFunction,qe.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)},Re.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var mt=function(s){function i(n,l,y){var M=this;s.call(this),this.id=n,this.dispatcher=y,this.on("data",function(L){L.dataType==="source"&&L.sourceDataType==="metadata"&&(M._sourceLoaded=!0),M._sourceLoaded&&!M._paused&&L.dataType==="source"&&L.sourceDataType==="content"&&(M.reload(),M.transform&&M.update(M.transform))}),this.on("error",function(){M._sourceErrored=!0}),this._source=function(L,B,oe,Te){var Ge=new Ne[B.type](L,B,oe,Te);if(Ge.id!==L)throw new Error("Expected Source id to be "+L+" instead of "+Ge.id);return o.bindAll(["load","abort","unload","serialize","prepare"],Ge),Ge}(n,l,y,this),this._tiles={},this._cache=new ye(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new o.SourceFeatureState}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.onAdd=function(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)},i.prototype.onRemove=function(n){this._source&&this._source.onRemove&&this._source.onRemove(n)},i.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var n in this._tiles){var l=this._tiles[n];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0},i.prototype.getSource=function(){return this._source},i.prototype.pause=function(){this._paused=!0},i.prototype.resume=function(){if(this._paused){var n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}},i.prototype._loadTile=function(n,l){return this._source.loadTile(n,l)},i.prototype._unloadTile=function(n){if(this._source.unloadTile)return this._source.unloadTile(n,function(){})},i.prototype._abortTile=function(n){if(this._source.abortTile)return this._source.abortTile(n,function(){})},i.prototype.serialize=function(){return this._source.serialize()},i.prototype.prepare=function(n){for(var l in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var y=this._tiles[l];y.upload(n),y.prepare(this.map.style.imageManager)}},i.prototype.getIds=function(){return o.values(this._tiles).map(function(n){return n.tileID}).sort(Qt).map(function(n){return n.key})},i.prototype.getRenderableIds=function(n){var l=this,y=[];for(var M in this._tiles)this._isIdRenderable(M,n)&&y.push(this._tiles[M]);return n?y.sort(function(L,B){var oe=L.tileID,Te=B.tileID,Ge=new o.Point(oe.canonical.x,oe.canonical.y)._rotate(l.transform.angle),Ke=new o.Point(Te.canonical.x,Te.canonical.y)._rotate(l.transform.angle);return oe.overscaledZ-Te.overscaledZ||Ke.y-Ge.y||Ke.x-Ge.x}).map(function(L){return L.tileID.key}):y.map(function(L){return L.tileID}).sort(Qt).map(function(L){return L.key})},i.prototype.hasRenderableParent=function(n){var l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)},i.prototype._isIdRenderable=function(n,l){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())},i.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var n in this._cache.reset(),this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")},i.prototype._reloadTile=function(n,l){var y=this._tiles[n];y&&(y.state!=="loading"&&(y.state=l),this._loadTile(y,this._tileLoaded.bind(this,y,n,l)))},i.prototype._tileLoaded=function(n,l,y,M){if(M)return n.state="errored",void(M.status!==404?this._source.fire(new o.ErrorEvent(M,{tile:n})):this.update(this.transform));n.timeAdded=o.browser.now(),y==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new o.Event("data",{dataType:"source",tile:n,coord:n.tileID}))},i.prototype._backfillDEM=function(n){for(var l=this.getRenderableIds(),y=0;y<l.length;y++){var M=l[y];if(n.neighboringTiles&&n.neighboringTiles[M]){var L=this.getTileByID(M);B(n,L),B(L,n)}}function B(oe,Te){oe.needsHillshadePrepare=!0;var Ge=Te.tileID.canonical.x-oe.tileID.canonical.x,Ke=Te.tileID.canonical.y-oe.tileID.canonical.y,et=Math.pow(2,oe.tileID.canonical.z),Ft=Te.tileID.key;Ge===0&&Ke===0||Math.abs(Ke)>1||(Math.abs(Ge)>1&&(Math.abs(Ge+et)===1?Ge+=et:Math.abs(Ge-et)===1&&(Ge-=et)),Te.dem&&oe.dem&&(oe.dem.backfillBorder(Te.dem,Ge,Ke),oe.neighboringTiles&&oe.neighboringTiles[Ft]&&(oe.neighboringTiles[Ft].backfilled=!0)))}},i.prototype.getTile=function(n){return this.getTileByID(n.key)},i.prototype.getTileByID=function(n){return this._tiles[n]},i.prototype._retainLoadedChildren=function(n,l,y,M){for(var L in this._tiles){var B=this._tiles[L];if(!(M[L]||!B.hasData()||B.tileID.overscaledZ<=l||B.tileID.overscaledZ>y)){for(var oe=B.tileID;B&&B.tileID.overscaledZ>l+1;){var Te=B.tileID.scaledTo(B.tileID.overscaledZ-1);(B=this._tiles[Te.key])&&B.hasData()&&(oe=Te)}for(var Ge=oe;Ge.overscaledZ>l;)if(n[(Ge=Ge.scaledTo(Ge.overscaledZ-1)).key]){M[oe.key]=oe;break}}}},i.prototype.findLoadedParent=function(n,l){if(n.key in this._loadedParentTiles){var y=this._loadedParentTiles[n.key];return y&&y.tileID.overscaledZ>=l?y:null}for(var M=n.overscaledZ-1;M>=l;M--){var L=n.scaledTo(M),B=this._getLoadedTile(L);if(B)return B}},i.prototype._getLoadedTile=function(n){var l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(n.wrapped().key)},i.prototype.updateCacheSize=function(n){var l=Math.ceil(n.width/this._source.tileSize)+1,y=Math.ceil(n.height/this._source.tileSize)+1,M=Math.floor(l*y*5),L=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,M):M;this._cache.setMaxSize(L)},i.prototype.handleWrapJump=function(n){var l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){var y={};for(var M in this._tiles){var L=this._tiles[M];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+l),y[L.tileID.key]=L}for(var B in this._tiles=y,this._timers)clearTimeout(this._timers[B]),delete this._timers[B];for(var oe in this._tiles)this._setTileReloadTimer(oe,this._tiles[oe])}},i.prototype.update=function(n){var l=this;if(this.transform=n,this._sourceLoaded&&!this._paused){var y;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?y=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(wr){return new o.OverscaledTileID(wr.canonical.z,wr.wrap,wr.canonical.z,wr.canonical.x,wr.canonical.y)}):(y=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(y=y.filter(function(wr){return l._source.hasTile(wr)}))):y=[];var M=n.coveringZoomLevel(this._source),L=Math.max(M-i.maxOverzooming,this._source.minzoom),B=Math.max(M+i.maxUnderzooming,this._source.minzoom),oe=this._updateRetainedTiles(y,M);if(Br(this._source.type)){for(var Te={},Ge={},Ke=0,et=Object.keys(oe);Ke<et.length;Ke+=1){var Ft=et[Ke],Rt=oe[Ft],Yt=this._tiles[Ft];if(Yt&&!(Yt.fadeEndTime&&Yt.fadeEndTime<=o.browser.now())){var zt=this.findLoadedParent(Rt,L);zt&&(this._addTile(zt.tileID),Te[zt.tileID.key]=zt.tileID),Ge[Ft]=Rt}}for(var jt in this._retainLoadedChildren(Ge,M,B,oe),Te)oe[jt]||(this._coveredTiles[jt]=!0,oe[jt]=Te[jt])}for(var rr in oe)this._tiles[rr].clearFadeHold();for(var nr=0,zr=o.keysDifference(this._tiles,oe);nr<zr.length;nr+=1){var pr=zr[nr],Ar=this._tiles[pr];Ar.hasSymbolBuckets&&!Ar.holdingForFade()?Ar.setHoldDuration(this.map._fadeDuration):Ar.hasSymbolBuckets&&!Ar.symbolFadeFinished()||this._removeTile(pr)}this._updateLoadedParentTileCache()}},i.prototype.releaseSymbolFadeTiles=function(){for(var n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)},i.prototype._updateRetainedTiles=function(n,l){for(var y={},M={},L=Math.max(l-i.maxOverzooming,this._source.minzoom),B=Math.max(l+i.maxUnderzooming,this._source.minzoom),oe={},Te=0,Ge=n;Te<Ge.length;Te+=1){var Ke=Ge[Te],et=this._addTile(Ke);y[Ke.key]=Ke,et.hasData()||l<this._source.maxzoom&&(oe[Ke.key]=Ke)}this._retainLoadedChildren(oe,l,B,y);for(var Ft=0,Rt=n;Ft<Rt.length;Ft+=1){var Yt=Rt[Ft],zt=this._tiles[Yt.key];if(!zt.hasData()){if(l+1>this._source.maxzoom){var jt=Yt.children(this._source.maxzoom)[0],rr=this.getTile(jt);if(rr&&rr.hasData()){y[jt.key]=jt;continue}}else{var nr=Yt.children(this._source.maxzoom);if(y[nr[0].key]&&y[nr[1].key]&&y[nr[2].key]&&y[nr[3].key])continue}for(var zr=zt.wasRequested(),pr=Yt.overscaledZ-1;pr>=L;--pr){var Ar=Yt.scaledTo(pr);if(M[Ar.key]||(M[Ar.key]=!0,!(zt=this.getTile(Ar))&&zr&&(zt=this._addTile(Ar)),zt&&(y[Ar.key]=Ar,zr=zt.wasRequested(),zt.hasData())))break}}}return y},i.prototype._updateLoadedParentTileCache=function(){for(var n in this._loadedParentTiles={},this._tiles){for(var l=[],y=void 0,M=this._tiles[n].tileID;M.overscaledZ>0;){if(M.key in this._loadedParentTiles){y=this._loadedParentTiles[M.key];break}l.push(M.key);var L=M.scaledTo(M.overscaledZ-1);if(y=this._getLoadedTile(L))break;M=L}for(var B=0,oe=l;B<oe.length;B+=1)this._loadedParentTiles[oe[B]]=y}},i.prototype._addTile=function(n){var l=this._tiles[n.key];if(l)return l;(l=this._cache.getAndRemove(n))&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));var y=Boolean(l);return y||(l=new o.Tile(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(l,this._tileLoaded.bind(this,l,n.key,l.state))),l?(l.uses++,this._tiles[n.key]=l,y||this._source.fire(new o.Event("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null},i.prototype._setTileReloadTimer=function(n,l){var y=this;n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);var M=l.getExpiryTimeout();M&&(this._timers[n]=setTimeout(function(){y._reloadTile(n,"expired"),delete y._timers[n]},M))},i.prototype._removeTile=function(n){var l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))},i.prototype.clearTiles=function(){for(var n in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(n);this._cache.reset()},i.prototype.tilesIn=function(n,l,y){var M=this,L=[],B=this.transform;if(!B)return L;for(var oe=y?B.getCameraQueryGeometry(n):n,Te=n.map(function(pr){return B.pointCoordinate(pr)}),Ge=oe.map(function(pr){return B.pointCoordinate(pr)}),Ke=this.getIds(),et=1/0,Ft=1/0,Rt=-1/0,Yt=-1/0,zt=0,jt=Ge;zt<jt.length;zt+=1){var rr=jt[zt];et=Math.min(et,rr.x),Ft=Math.min(Ft,rr.y),Rt=Math.max(Rt,rr.x),Yt=Math.max(Yt,rr.y)}for(var nr=function(Ar){var wr=M._tiles[Ke[Ar]];if(!wr.holdingForFade()){var sn=wr.tileID,$r=Math.pow(2,B.zoom-wr.tileID.overscaledZ),xn=l*wr.queryPadding*o.EXTENT/wr.tileSize/$r,In=[sn.getTilePoint(new o.MercatorCoordinate(et,Ft)),sn.getTilePoint(new o.MercatorCoordinate(Rt,Yt))];if(In[0].x-xn<o.EXTENT&&In[0].y-xn<o.EXTENT&&In[1].x+xn>=0&&In[1].y+xn>=0){var ei=Te.map(function(Ii){return sn.getTilePoint(Ii)}),si=Ge.map(function(Ii){return sn.getTilePoint(Ii)});L.push({tile:wr,tileID:sn,queryGeometry:ei,cameraQueryGeometry:si,scale:$r})}}},zr=0;zr<Ke.length;zr++)nr(zr);return L},i.prototype.getVisibleCoordinates=function(n){for(var l=this,y=this.getRenderableIds(n).map(function(oe){return l._tiles[oe].tileID}),M=0,L=y;M<L.length;M+=1){var B=L[M];B.posMatrix=this.transform.calculatePosMatrix(B.toUnwrapped())}return y},i.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Br(this._source.type))for(var n in this._tiles){var l=this._tiles[n];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=o.browser.now())return!0}return!1},i.prototype.setFeatureState=function(n,l,y){this._state.updateState(n=n||"_geojsonTileLayer",l,y)},i.prototype.removeFeatureState=function(n,l,y){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,y)},i.prototype.getFeatureState=function(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)},i.prototype.setDependencies=function(n,l,y){var M=this._tiles[n];M&&M.setDependencies(l,y)},i.prototype.reloadTilesForDependencies=function(n,l){for(var y in this._tiles)this._tiles[y].hasDependency(n,l)&&this._reloadTile(y,"reloading");this._cache.filter(function(M){return!M.hasDependency(n,l)})},i}(o.Evented);function Qt(s,i){var n=Math.abs(2*s.wrap)-+(s.wrap<0),l=Math.abs(2*i.wrap)-+(i.wrap<0);return s.overscaledZ-i.overscaledZ||l-n||i.canonical.y-s.canonical.y||i.canonical.x-s.canonical.x}function Br(s){return s==="raster"||s==="image"||s==="video"}function Ur(){return new o.window.Worker(Il.workerUrl)}mt.maxOverzooming=10,mt.maxUnderzooming=3;var or="mapboxgl_preloaded_worker_pool",Vr=function(){this.active={}};Vr.prototype.acquire=function(s){if(!this.workers)for(this.workers=[];this.workers.length<Vr.workerCount;)this.workers.push(new Ur);return this.active[s]=!0,this.workers.slice()},Vr.prototype.release=function(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(function(i){i.terminate()}),this.workers=null)},Vr.prototype.isPreloaded=function(){return!!this.active[or]},Vr.prototype.numActive=function(){return Object.keys(this.active).length};var An,dn=Math.floor(o.browser.hardwareConcurrency/2);function Cr(){return An||(An=new Vr),An}function Tn(s,i){var n={};for(var l in s)l!=="ref"&&(n[l]=s[l]);return o.refProperties.forEach(function(y){y in i&&(n[y]=i[y])}),n}function fn(s){s=s.slice();for(var i=Object.create(null),n=0;n<s.length;n++)i[s[n].id]=s[n];for(var l=0;l<s.length;l++)"ref"in s[l]&&(s[l]=Tn(s[l],i[s[l].ref]));return s}Vr.workerCount=Math.max(Math.min(dn,6),1);var En={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Cn(s,i,n){n.push({command:En.addSource,args:[s,i[s]]})}function pn(s,i,n){i.push({command:En.removeSource,args:[s]}),n[s]=!0}function Lr(s,i,n,l){pn(s,n,l),Cn(s,i,n)}function hi(s,i,n){var l;for(l in s[n])if(s[n].hasOwnProperty(l)&&l!=="data"&&!o.deepEqual(s[n][l],i[n][l]))return!1;for(l in i[n])if(i[n].hasOwnProperty(l)&&l!=="data"&&!o.deepEqual(s[n][l],i[n][l]))return!1;return!0}function xi(s,i,n,l,y,M){var L;for(L in i=i||{},s=s||{})s.hasOwnProperty(L)&&(o.deepEqual(s[L],i[L])||n.push({command:M,args:[l,L,i[L],y]}));for(L in i)i.hasOwnProperty(L)&&!s.hasOwnProperty(L)&&(o.deepEqual(s[L],i[L])||n.push({command:M,args:[l,L,i[L],y]}))}function ki(s){return s.id}function _i(s,i){return s[i.id]=i,s}var eo=function(i,n){this.reset(i,n)};eo.prototype.reset=function(s,i){this.points=s||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(i||0,.5*this.length),this.paddedLength=this.length-2*this.padding},eo.prototype.lerp=function(s){if(this.points.length===1)return this.points[0];s=o.clamp(s,0,1);for(var i=1,n=this._distances[i],l=s*this.paddedLength+this.padding;n<l&&i<this._distances.length;)n=this._distances[++i];var y=i-1,M=this._distances[y],L=n-M,B=L>0?(l-M)/L:0;return this.points[y].mult(1-B).add(this.points[i].mult(B))};var pi=function(i,n,l){var y=this.boxCells=[],M=this.circleCells=[];this.xCellCount=Math.ceil(i/l),this.yCellCount=Math.ceil(n/l);for(var L=0;L<this.xCellCount*this.yCellCount;L++)y.push([]),M.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=n,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0};function Ta(s,i,n,l,y){var M=o.create();return i?(o.scale(M,M,[1/y,1/y,1]),n||o.rotateZ(M,M,l.angle)):o.multiply(M,l.labelPlaneMatrix,s),M}function Di(s,i,n,l,y){if(i){var M=o.clone(s);return o.scale(M,M,[y,y,1]),n||o.rotateZ(M,M,-l.angle),M}return l.glCoordMatrix}function bi(s,i){var n=[s.x,s.y,0,1];Ya(n,n,i);var l=n[3];return{point:new o.Point(n[0]/l,n[1]/l),signedDistanceFromCamera:l}}function ci(s,i){return .5+s/i*.5}function ja(s,i){var n=s[0]/s[3],l=s[1]/s[3];return n>=-i[0]&&n<=i[0]&&l>=-i[1]&&l<=i[1]}function ps(s,i,n,l,y,M,L,B){var oe=l?s.textSizeData:s.iconSizeData,Te=o.evaluateSizeForZoom(oe,n.transform.zoom),Ge=[256/n.width*2+1,256/n.height*2+1],Ke=l?s.text.dynamicLayoutVertexArray:s.icon.dynamicLayoutVertexArray;Ke.clear();for(var et=s.lineVertexArray,Ft=l?s.text.placedSymbolArray:s.icon.placedSymbolArray,Rt=n.transform.width/n.transform.height,Yt=!1,zt=0;zt<Ft.length;zt++){var jt=Ft.get(zt);if(jt.hidden||jt.writingMode===o.WritingMode.vertical&&!Yt)ca(jt.numGlyphs,Ke);else{Yt=!1;var rr=[jt.anchorX,jt.anchorY,0,1];if(o.transformMat4(rr,rr,i),ja(rr,Ge)){var nr=ci(n.transform.cameraToCenterDistance,rr[3]),zr=o.evaluateSizeForFeature(oe,Te,jt),pr=L?zr/nr:zr*nr,Ar=new o.Point(jt.anchorX,jt.anchorY),wr=bi(Ar,y).point,sn={},$r=Gu(jt,pr,!1,B,i,y,M,s.glyphOffsetArray,et,Ke,wr,Ar,sn,Rt);Yt=$r.useVertical,($r.notEnoughRoom||Yt||$r.needsFlipping&&Gu(jt,pr,!0,B,i,y,M,s.glyphOffsetArray,et,Ke,wr,Ar,sn,Rt).notEnoughRoom)&&ca(jt.numGlyphs,Ke)}else ca(jt.numGlyphs,Ke)}}l?s.text.dynamicLayoutVertexBuffer.updateData(Ke):s.icon.dynamicLayoutVertexBuffer.updateData(Ke)}function to(s,i,n,l,y,M,L,B,oe,Te,Ge){var Ke=B.glyphStartIndex+B.numGlyphs,et=B.lineStartIndex,Ft=B.lineStartIndex+B.lineLength,Rt=i.getoffsetX(B.glyphStartIndex),Yt=i.getoffsetX(Ke-1),zt=Oa(s*Rt,n,l,y,M,L,B.segment,et,Ft,oe,Te,Ge);if(!zt)return null;var jt=Oa(s*Yt,n,l,y,M,L,B.segment,et,Ft,oe,Te,Ge);return jt?{first:zt,last:jt}:null}function lo(s,i,n,l){return s===o.WritingMode.horizontal&&Math.abs(n.y-i.y)>Math.abs(n.x-i.x)*l?{useVertical:!0}:(s===o.WritingMode.vertical?i.y<n.y:i.x>n.x)?{needsFlipping:!0}:null}function Gu(s,i,n,l,y,M,L,B,oe,Te,Ge,Ke,et,Ft){var Rt,Yt=i/24,zt=s.lineOffsetX*Yt,jt=s.lineOffsetY*Yt;if(s.numGlyphs>1){var rr=s.glyphStartIndex+s.numGlyphs,nr=s.lineStartIndex,zr=s.lineStartIndex+s.lineLength,pr=to(Yt,B,zt,jt,n,Ge,Ke,s,oe,M,et);if(!pr)return{notEnoughRoom:!0};var Ar=bi(pr.first.point,L).point,wr=bi(pr.last.point,L).point;if(l&&!n){var sn=lo(s.writingMode,Ar,wr,Ft);if(sn)return sn}Rt=[pr.first];for(var $r=s.glyphStartIndex+1;$r<rr-1;$r++)Rt.push(Oa(Yt*B.getoffsetX($r),zt,jt,n,Ge,Ke,s.segment,nr,zr,oe,M,et));Rt.push(pr.last)}else{if(l&&!n){var xn=bi(Ke,y).point,In=s.lineStartIndex+s.segment+1,ei=new o.Point(oe.getx(In),oe.gety(In)),si=bi(ei,y),Ii=si.signedDistanceFromCamera>0?si.point:qi(Ke,ei,xn,1,y),$i=lo(s.writingMode,xn,Ii,Ft);if($i)return $i}var wn=Oa(Yt*B.getoffsetX(s.glyphStartIndex),zt,jt,n,Ge,Ke,s.segment,s.lineStartIndex,s.lineStartIndex+s.lineLength,oe,M,et);if(!wn)return{notEnoughRoom:!0};Rt=[wn]}for(var ui=0,Si=Rt;ui<Si.length;ui+=1){var Hn=Si[ui];o.addDynamicAttributes(Te,Hn.point,Hn.angle)}return{}}function qi(s,i,n,l,y){var M=bi(s.add(s.sub(i)._unit()),y).point,L=n.sub(M);return n.add(L._mult(l/L.mag()))}function Oa(s,i,n,l,y,M,L,B,oe,Te,Ge,Ke){var et=l?s-i:s+i,Ft=et>0?1:-1,Rt=0;l&&(Ft*=-1,Rt=Math.PI),Ft<0&&(Rt+=Math.PI);for(var Yt=Ft>0?B+L:B+L+1,zt=y,jt=y,rr=0,nr=0,zr=Math.abs(et),pr=[];rr+nr<=zr;){if((Yt+=Ft)<B||Yt>=oe)return null;if(jt=zt,pr.push(zt),(zt=Ke[Yt])===void 0){var Ar=new o.Point(Te.getx(Yt),Te.gety(Yt)),wr=bi(Ar,Ge);if(wr.signedDistanceFromCamera>0)zt=Ke[Yt]=wr.point;else{var sn=Yt-Ft;zt=qi(rr===0?M:new o.Point(Te.getx(sn),Te.gety(sn)),Ar,jt,zr-rr+1,Ge)}}rr+=nr,nr=jt.dist(zt)}var $r=(zr-rr)/nr,xn=zt.sub(jt),In=xn.mult($r)._add(jt);In._add(xn._unit()._perp()._mult(n*Ft));var ei=Rt+Math.atan2(zt.y-jt.y,zt.x-jt.x);return pr.push(In),{point:In,angle:ei,path:pr}}pi.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},pi.prototype.insert=function(s,i,n,l,y){this._forEachCell(i,n,l,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(y)},pi.prototype.insertCircle=function(s,i,n,l){this._forEachCell(i-l,n-l,i+l,n+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(i),this.circles.push(n),this.circles.push(l)},pi.prototype._insertBoxCell=function(s,i,n,l,y,M){this.boxCells[y].push(M)},pi.prototype._insertCircleCell=function(s,i,n,l,y,M){this.circleCells[y].push(M)},pi.prototype._query=function(s,i,n,l,y,M){if(n<0||s>this.width||l<0||i>this.height)return!y&&[];var L=[];if(s<=0&&i<=0&&this.width<=n&&this.height<=l){if(y)return!0;for(var B=0;B<this.boxKeys.length;B++)L.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(var oe=0;oe<this.circleKeys.length;oe++){var Te=this.circles[3*oe],Ge=this.circles[3*oe+1],Ke=this.circles[3*oe+2];L.push({key:this.circleKeys[oe],x1:Te-Ke,y1:Ge-Ke,x2:Te+Ke,y2:Ge+Ke})}return M?L.filter(M):L}return this._forEachCell(s,i,n,l,this._queryCell,L,{hitTest:y,seenUids:{box:{},circle:{}}},M),y?L.length>0:L},pi.prototype._queryCircle=function(s,i,n,l,y){var M=s-n,L=s+n,B=i-n,oe=i+n;if(L<0||M>this.width||oe<0||B>this.height)return!l&&[];var Te=[];return this._forEachCell(M,B,L,oe,this._queryCellCircle,Te,{hitTest:l,circle:{x:s,y:i,radius:n},seenUids:{box:{},circle:{}}},y),l?Te.length>0:Te},pi.prototype.query=function(s,i,n,l,y){return this._query(s,i,n,l,!1,y)},pi.prototype.hitTest=function(s,i,n,l,y){return this._query(s,i,n,l,!0,y)},pi.prototype.hitTestCircle=function(s,i,n,l){return this._queryCircle(s,i,n,!0,l)},pi.prototype._queryCell=function(s,i,n,l,y,M,L,B){var oe=L.seenUids,Te=this.boxCells[y];if(Te!==null)for(var Ge=this.bboxes,Ke=0,et=Te;Ke<et.length;Ke+=1){var Ft=et[Ke];if(!oe.box[Ft]){oe.box[Ft]=!0;var Rt=4*Ft;if(s<=Ge[Rt+2]&&i<=Ge[Rt+3]&&n>=Ge[Rt+0]&&l>=Ge[Rt+1]&&(!B||B(this.boxKeys[Ft]))){if(L.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[Ft],x1:Ge[Rt],y1:Ge[Rt+1],x2:Ge[Rt+2],y2:Ge[Rt+3]})}}}var Yt=this.circleCells[y];if(Yt!==null)for(var zt=this.circles,jt=0,rr=Yt;jt<rr.length;jt+=1){var nr=rr[jt];if(!oe.circle[nr]){oe.circle[nr]=!0;var zr=3*nr;if(this._circleAndRectCollide(zt[zr],zt[zr+1],zt[zr+2],s,i,n,l)&&(!B||B(this.circleKeys[nr]))){if(L.hitTest)return M.push(!0),!0;var pr=zt[zr],Ar=zt[zr+1],wr=zt[zr+2];M.push({key:this.circleKeys[nr],x1:pr-wr,y1:Ar-wr,x2:pr+wr,y2:Ar+wr})}}}},pi.prototype._queryCellCircle=function(s,i,n,l,y,M,L,B){var oe=L.circle,Te=L.seenUids,Ge=this.boxCells[y];if(Ge!==null)for(var Ke=this.bboxes,et=0,Ft=Ge;et<Ft.length;et+=1){var Rt=Ft[et];if(!Te.box[Rt]){Te.box[Rt]=!0;var Yt=4*Rt;if(this._circleAndRectCollide(oe.x,oe.y,oe.radius,Ke[Yt+0],Ke[Yt+1],Ke[Yt+2],Ke[Yt+3])&&(!B||B(this.boxKeys[Rt])))return M.push(!0),!0}}var zt=this.circleCells[y];if(zt!==null)for(var jt=this.circles,rr=0,nr=zt;rr<nr.length;rr+=1){var zr=nr[rr];if(!Te.circle[zr]){Te.circle[zr]=!0;var pr=3*zr;if(this._circlesCollide(jt[pr],jt[pr+1],jt[pr+2],oe.x,oe.y,oe.radius)&&(!B||B(this.circleKeys[zr])))return M.push(!0),!0}}},pi.prototype._forEachCell=function(s,i,n,l,y,M,L,B){for(var oe=this._convertToXCellCoord(s),Te=this._convertToYCellCoord(i),Ge=this._convertToXCellCoord(n),Ke=this._convertToYCellCoord(l),et=oe;et<=Ge;et++)for(var Ft=Te;Ft<=Ke;Ft++)if(y.call(this,s,i,n,l,this.xCellCount*Ft+et,M,L,B))return},pi.prototype._convertToXCellCoord=function(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))},pi.prototype._convertToYCellCoord=function(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))},pi.prototype._circlesCollide=function(s,i,n,l,y,M){var L=l-s,B=y-i,oe=n+M;return oe*oe>L*L+B*B},pi.prototype._circleAndRectCollide=function(s,i,n,l,y,M,L){var B=(M-l)/2,oe=Math.abs(s-(l+B));if(oe>B+n)return!1;var Te=(L-y)/2,Ge=Math.abs(i-(y+Te));if(Ge>Te+n)return!1;if(oe<=B||Ge<=Te)return!0;var Ke=oe-B,et=Ge-Te;return Ke*Ke+et*et<=n*n};var is=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ca(s,i){for(var n=0;n<s;n++){var l=i.length;i.resize(l+4),i.float32.set(is,3*l)}}function Ya(s,i,n){var l=i[0],y=i[1];return s[0]=n[0]*l+n[4]*y+n[12],s[1]=n[1]*l+n[5]*y+n[13],s[3]=n[3]*l+n[7]*y+n[15],s}var qo=function(i,n,l){n===void 0&&(n=new pi(i.width+200,i.height+200,25)),l===void 0&&(l=new pi(i.width+200,i.height+200,25)),this.transform=i,this.grid=n,this.ignoredGrid=l,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+100,this.screenBottomBoundary=i.height+100,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200};function sa(s,i,n){return i*(o.EXTENT/(s.tileSize*Math.pow(2,n-s.tileID.overscaledZ)))}qo.prototype.placeCollisionBox=function(s,i,n,l,y){var M=this.projectAndGetPerspectiveRatio(l,s.anchorPointX,s.anchorPointY),L=n*M.perspectiveRatio,B=s.x1*L+M.point.x,oe=s.y1*L+M.point.y,Te=s.x2*L+M.point.x,Ge=s.y2*L+M.point.y;return!this.isInsideGrid(B,oe,Te,Ge)||!i&&this.grid.hitTest(B,oe,Te,Ge,y)?{box:[],offscreen:!1}:{box:[B,oe,Te,Ge],offscreen:this.isOffscreen(B,oe,Te,Ge)}},qo.prototype.placeCollisionCircles=function(s,i,n,l,y,M,L,B,oe,Te,Ge,Ke,et){var Ft=[],Rt=new o.Point(i.anchorX,i.anchorY),Yt=bi(Rt,M),zt=ci(this.transform.cameraToCenterDistance,Yt.signedDistanceFromCamera),jt=(Te?y/zt:y*zt)/o.ONE_EM,rr=bi(Rt,L).point,nr=to(jt,l,i.lineOffsetX*jt,i.lineOffsetY*jt,!1,rr,Rt,i,n,L,{}),zr=!1,pr=!1,Ar=!0;if(nr){for(var wr=.5*Ke*zt+et,sn=new o.Point(-100,-100),$r=new o.Point(this.screenRightBoundary,this.screenBottomBoundary),xn=new eo,In=nr.first,ei=nr.last,si=[],Ii=In.path.length-1;Ii>=1;Ii--)si.push(In.path[Ii]);for(var $i=1;$i<ei.path.length;$i++)si.push(ei.path[$i]);var wn=2.5*wr;if(B){var ui=si.map(function(Bs){return bi(Bs,B)});si=ui.some(function(Bs){return Bs.signedDistanceFromCamera<=0})?[]:ui.map(function(Bs){return Bs.point})}var Si=[];if(si.length>0){for(var Hn=si[0].clone(),Ei=si[0].clone(),ii=1;ii<si.length;ii++)Hn.x=Math.min(Hn.x,si[ii].x),Hn.y=Math.min(Hn.y,si[ii].y),Ei.x=Math.max(Ei.x,si[ii].x),Ei.y=Math.max(Ei.y,si[ii].y);Si=Hn.x>=sn.x&&Ei.x<=$r.x&&Hn.y>=sn.y&&Ei.y<=$r.y?[si]:Ei.x<sn.x||Hn.x>$r.x||Ei.y<sn.y||Hn.y>$r.y?[]:o.clipLine([si],sn.x,sn.y,$r.x,$r.y)}for(var Ni=0,Hi=Si;Ni<Hi.length;Ni+=1){var no;xn.reset(Hi[Ni],.25*wr),no=xn.length<=.5*wr?1:Math.ceil(xn.paddedLength/wn)+1;for(var za=0;za<no;za++){var Mo=za/Math.max(no-1,1),_a=xn.lerp(Mo),Ja=_a.x+100,Os=_a.y+100;Ft.push(Ja,Os,wr,0);var Ls=Ja-wr,yu=Os-wr,Fu=Ja+wr,Ss=Os+wr;if(Ar=Ar&&this.isOffscreen(Ls,yu,Fu,Ss),pr=pr||this.isInsideGrid(Ls,yu,Fu,Ss),!s&&this.grid.hitTestCircle(Ja,Os,wr,Ge)&&(zr=!0,!oe))return{circles:[],offscreen:!1,collisionDetected:zr}}}}return{circles:!oe&&zr||!pr?[]:Ft,offscreen:Ar,collisionDetected:zr}},qo.prototype.queryRenderedSymbols=function(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var i=[],n=1/0,l=1/0,y=-1/0,M=-1/0,L=0,B=s;L<B.length;L+=1){var oe=B[L],Te=new o.Point(oe.x+100,oe.y+100);n=Math.min(n,Te.x),l=Math.min(l,Te.y),y=Math.max(y,Te.x),M=Math.max(M,Te.y),i.push(Te)}for(var Ge={},Ke={},et=0,Ft=this.grid.query(n,l,y,M).concat(this.ignoredGrid.query(n,l,y,M));et<Ft.length;et+=1){var Rt=Ft[et],Yt=Rt.key;if(Ge[Yt.bucketInstanceId]===void 0&&(Ge[Yt.bucketInstanceId]={}),!Ge[Yt.bucketInstanceId][Yt.featureIndex]){var zt=[new o.Point(Rt.x1,Rt.y1),new o.Point(Rt.x2,Rt.y1),new o.Point(Rt.x2,Rt.y2),new o.Point(Rt.x1,Rt.y2)];o.polygonIntersectsPolygon(i,zt)&&(Ge[Yt.bucketInstanceId][Yt.featureIndex]=!0,Ke[Yt.bucketInstanceId]===void 0&&(Ke[Yt.bucketInstanceId]=[]),Ke[Yt.bucketInstanceId].push(Yt.featureIndex))}}return Ke},qo.prototype.insertCollisionBox=function(s,i,n,l,y){(i?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:l,collisionGroupID:y},s[0],s[1],s[2],s[3])},qo.prototype.insertCollisionCircles=function(s,i,n,l,y){for(var M=i?this.ignoredGrid:this.grid,L={bucketInstanceId:n,featureIndex:l,collisionGroupID:y},B=0;B<s.length;B+=4)M.insertCircle(L,s[B],s[B+1],s[B+2])},qo.prototype.projectAndGetPerspectiveRatio=function(s,i,n){var l=[i,n,0,1];return Ya(l,l,s),{point:new o.Point((l[0]/l[3]+1)/2*this.transform.width+100,(-l[1]/l[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/l[3]*.5}},qo.prototype.isOffscreen=function(s,i,n,l){return n<100||s>=this.screenRightBoundary||l<100||i>this.screenBottomBoundary},qo.prototype.isInsideGrid=function(s,i,n,l){return n>=0&&s<this.gridRightBoundary&&l>=0&&i<this.gridBottomBoundary},qo.prototype.getViewportMatrix=function(){var s=o.identity([]);return o.translate(s,s,[-100,-100,0]),s};var yo=function(i,n,l,y){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?n:-n))):y&&l?1:0,this.placed=l};yo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var co=function(i,n,l,y,M){this.text=new yo(i?i.text:null,n,l,M),this.icon=new yo(i?i.icon:null,n,y,M)};co.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Tu=function(i,n,l){this.text=i,this.icon=n,this.skipFade=l},as=function(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]},bl=function(i,n,l,y,M){this.bucketInstanceId=i,this.featureIndex=n,this.sourceLayerIndex=l,this.bucketIndex=y,this.tileID=M},_s=function(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}};function Lo(s,i,n,l,y){var M=o.getAnchorAlignment(s),L=-(M.horizontalAlign-.5)*i,B=-(M.verticalAlign-.5)*n,oe=o.evaluateVariableOffset(s,l);return new o.Point(L+oe[0]*y,B+oe[1]*y)}function kt(s,i,n,l,y,M){var L=s.x1,B=s.x2,oe=s.y1,Te=s.y2,Ge=s.anchorPointX,Ke=s.anchorPointY,et=new o.Point(i,n);return l&&et._rotate(y?M:-M),{x1:L+et.x,y1:oe+et.y,x2:B+et.x,y2:Te+et.y,anchorPointX:Ge,anchorPointY:Ke}}_s.prototype.get=function(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){var i=++this.maxGroupID;this.collisionGroups[s]={ID:i,predicate:function(l){return l.collisionGroupID===i}}}return this.collisionGroups[s]};var ze=function(i,n,l,y){this.transform=i.clone(),this.collisionIndex=new qo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new _s(l),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}};function It(s,i,n,l,y){s.emplaceBack(i?1:0,n?1:0,l||0,y||0),s.emplaceBack(i?1:0,n?1:0,l||0,y||0),s.emplaceBack(i?1:0,n?1:0,l||0,y||0),s.emplaceBack(i?1:0,n?1:0,l||0,y||0)}ze.prototype.getBucketParts=function(s,i,n,l){var y=n.getBucket(i),M=n.latestFeatureIndex;if(y&&M&&i.id===y.layerIds[0]){var L=n.collisionBoxArray,B=y.layers[0].layout,oe=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),Te=n.tileSize/o.EXTENT,Ge=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),Ke=B.get("text-pitch-alignment")==="map",et=B.get("text-rotation-alignment")==="map",Ft=sa(n,1,this.transform.zoom),Rt=Ta(Ge,Ke,et,this.transform,Ft),Yt=null;if(Ke){var zt=Di(Ge,Ke,et,this.transform,Ft);Yt=o.multiply([],this.transform.labelPlaneMatrix,zt)}this.retainedQueryData[y.bucketInstanceId]=new bl(y.bucketInstanceId,M,y.sourceLayerIndex,y.index,n.tileID);var jt={bucket:y,layout:B,posMatrix:Ge,textLabelPlaneMatrix:Rt,labelToScreenMatrix:Yt,scale:oe,textPixelRatio:Te,holdingForFade:n.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(l)for(var rr=0,nr=y.sortKeyRanges;rr<nr.length;rr+=1){var zr=nr[rr];s.push({sortKey:zr.sortKey,symbolInstanceStart:zr.symbolInstanceStart,symbolInstanceEnd:zr.symbolInstanceEnd,parameters:jt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:jt})}},ze.prototype.attemptAnchorPlacement=function(s,i,n,l,y,M,L,B,oe,Te,Ge,Ke,et,Ft,Rt){var Yt,zt=[Ke.textOffset0,Ke.textOffset1],jt=Lo(s,n,l,zt,y),rr=this.collisionIndex.placeCollisionBox(kt(i,jt.x,jt.y,M,L,this.transform.angle),Ge,B,oe,Te.predicate);if(!Rt||this.collisionIndex.placeCollisionBox(kt(Rt,jt.x,jt.y,M,L,this.transform.angle),Ge,B,oe,Te.predicate).box.length!==0)return rr.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Ke.crossTileID]&&this.prevPlacement.placements[Ke.crossTileID]&&this.prevPlacement.placements[Ke.crossTileID].text&&(Yt=this.prevPlacement.variableOffsets[Ke.crossTileID].anchor),this.variableOffsets[Ke.crossTileID]={textOffset:zt,width:n,height:l,anchor:s,textBoxScale:y,prevAnchor:Yt},this.markUsedJustification(et,s,Ke,Ft),et.allowVerticalPlacement&&(this.markUsedOrientation(et,Ft,Ke),this.placedOrientations[Ke.crossTileID]=Ft),{shift:jt,placedGlyphBoxes:rr}):void 0},ze.prototype.placeLayerBucketPart=function(s,i,n){var l=this,y=s.parameters,M=y.bucket,L=y.layout,B=y.posMatrix,oe=y.textLabelPlaneMatrix,Te=y.labelToScreenMatrix,Ge=y.textPixelRatio,Ke=y.holdingForFade,et=y.collisionBoxArray,Ft=y.partiallyEvaluatedTextSize,Rt=y.collisionGroup,Yt=L.get("text-optional"),zt=L.get("icon-optional"),jt=L.get("text-allow-overlap"),rr=L.get("icon-allow-overlap"),nr=L.get("text-rotation-alignment")==="map",zr=L.get("text-pitch-alignment")==="map",pr=L.get("icon-text-fit")!=="none",Ar=L.get("symbol-z-order")==="viewport-y",wr=jt&&(rr||!M.hasIconData()||zt),sn=rr&&(jt||!M.hasTextData()||Yt);!M.collisionArrays&&et&&M.deserializeCollisionBoxes(et);var $r=function(wn,ui){if(!i[wn.crossTileID])if(Ke)l.placements[wn.crossTileID]=new Tu(!1,!1,!1);else{var Si,Hn=!1,Ei=!1,ii=!0,Ni=null,Hi={box:null,offscreen:null},no={box:null,offscreen:null},za=null,Mo=null,_a=0,Ja=0,Os=0;ui.textFeatureIndex?_a=ui.textFeatureIndex:wn.useRuntimeCollisionCircles&&(_a=wn.featureIndex),ui.verticalTextFeatureIndex&&(Ja=ui.verticalTextFeatureIndex);var Ls=ui.textBox;if(Ls){var yu=function(es){var Ao=o.WritingMode.horizontal;if(M.allowVerticalPlacement&&!es&&l.prevPlacement){var io=l.prevPlacement.placedOrientations[wn.crossTileID];io&&(l.placedOrientations[wn.crossTileID]=io,l.markUsedOrientation(M,Ao=io,wn))}return Ao},Fu=function(es,Ao){if(M.allowVerticalPlacement&&wn.numVerticalGlyphVertices>0&&ui.verticalTextBox)for(var io=0,ts=M.writingModes;io<ts.length&&(ts[io]===o.WritingMode.vertical?(Hi=Ao(),no=Hi):Hi=es(),!(Hi&&Hi.box&&Hi.box.length));io+=1);else Hi=es()};if(L.get("text-variable-anchor")){var Ss=L.get("text-variable-anchor");if(l.prevPlacement&&l.prevPlacement.variableOffsets[wn.crossTileID]){var Bs=l.prevPlacement.variableOffsets[wn.crossTileID];Ss.indexOf(Bs.anchor)>0&&(Ss=Ss.filter(function(vo){return vo!==Bs.anchor})).unshift(Bs.anchor)}var Bu=function(es,Ao,io){for(var ts=es.x2-es.x1,yl=es.y2-es.y1,Pc=wn.textBoxScale,Xc=pr&&!rr?Ao:null,el={box:[],offscreen:!1},vc=jt?2*Ss.length:Ss.length,Ol=0;Ol<vc;++Ol){var Hs=l.attemptAnchorPlacement(Ss[Ol%Ss.length],es,ts,yl,Pc,nr,zr,Ge,B,Rt,Ol>=Ss.length,wn,M,io,Xc);if(Hs&&(el=Hs.placedGlyphBoxes)&&el.box&&el.box.length){Hn=!0,Ni=Hs.shift;break}}return el};Fu(function(){return Bu(Ls,ui.iconBox,o.WritingMode.horizontal)},function(){var vo=ui.verticalTextBox;return M.allowVerticalPlacement&&!(Hi&&Hi.box&&Hi.box.length)&&wn.numVerticalGlyphVertices>0&&vo?Bu(vo,ui.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),Hi&&(Hn=Hi.box,ii=Hi.offscreen);var xu=yu(Hi&&Hi.box);if(!Hn&&l.prevPlacement){var qu=l.prevPlacement.variableOffsets[wn.crossTileID];qu&&(l.variableOffsets[wn.crossTileID]=qu,l.markUsedJustification(M,qu.anchor,wn,xu))}}else{var $l=function(es,Ao){var io=l.collisionIndex.placeCollisionBox(es,jt,Ge,B,Rt.predicate);return io&&io.box&&io.box.length&&(l.markUsedOrientation(M,Ao,wn),l.placedOrientations[wn.crossTileID]=Ao),io};Fu(function(){return $l(Ls,o.WritingMode.horizontal)},function(){var vo=ui.verticalTextBox;return M.allowVerticalPlacement&&wn.numVerticalGlyphVertices>0&&vo?$l(vo,o.WritingMode.vertical):{box:null,offscreen:null}}),yu(Hi&&Hi.box&&Hi.box.length)}}if(Hn=(Si=Hi)&&Si.box&&Si.box.length>0,ii=Si&&Si.offscreen,wn.useRuntimeCollisionCircles){var ml=M.text.placedSymbolArray.get(wn.centerJustifiedTextSymbolIndex),iu=o.evaluateSizeForFeature(M.textSizeData,Ft,ml),pc=L.get("text-padding");za=l.collisionIndex.placeCollisionCircles(jt,ml,M.lineVertexArray,M.glyphOffsetArray,iu,B,oe,Te,n,zr,Rt.predicate,wn.collisionCircleDiameter,pc),Hn=jt||za.circles.length>0&&!za.collisionDetected,ii=ii&&za.offscreen}if(ui.iconFeatureIndex&&(Os=ui.iconFeatureIndex),ui.iconBox){var bu=function(es){var Ao=pr&&Ni?kt(es,Ni.x,Ni.y,nr,zr,l.transform.angle):es;return l.collisionIndex.placeCollisionBox(Ao,rr,Ge,B,Rt.predicate)};Ei=no&&no.box&&no.box.length&&ui.verticalIconBox?(Mo=bu(ui.verticalIconBox)).box.length>0:(Mo=bu(ui.iconBox)).box.length>0,ii=ii&&Mo.offscreen}var Eo=Yt||wn.numHorizontalGlyphVertices===0&&wn.numVerticalGlyphVertices===0,gl=zt||wn.numIconVertices===0;if(Eo||gl?gl?Eo||(Ei=Ei&&Hn):Hn=Ei&&Hn:Ei=Hn=Ei&&Hn,Hn&&Si&&Si.box&&l.collisionIndex.insertCollisionBox(Si.box,L.get("text-ignore-placement"),M.bucketInstanceId,no&&no.box&&Ja?Ja:_a,Rt.ID),Ei&&Mo&&l.collisionIndex.insertCollisionBox(Mo.box,L.get("icon-ignore-placement"),M.bucketInstanceId,Os,Rt.ID),za&&(Hn&&l.collisionIndex.insertCollisionCircles(za.circles,L.get("text-ignore-placement"),M.bucketInstanceId,_a,Rt.ID),n)){var Jl=M.bucketInstanceId,Rs=l.collisionCircleArrays[Jl];Rs===void 0&&(Rs=l.collisionCircleArrays[Jl]=new as);for(var To=0;To<za.circles.length;To+=4)Rs.circles.push(za.circles[To+0]),Rs.circles.push(za.circles[To+1]),Rs.circles.push(za.circles[To+2]),Rs.circles.push(za.collisionDetected?1:0)}l.placements[wn.crossTileID]=new Tu(Hn||wr,Ei||sn,ii||M.justReloaded),i[wn.crossTileID]=!0}};if(Ar)for(var xn=M.getSortedSymbolIndexes(this.transform.angle),In=xn.length-1;In>=0;--In){var ei=xn[In];$r(M.symbolInstances.get(ei),M.collisionArrays[ei])}else for(var si=s.symbolInstanceStart;si<s.symbolInstanceEnd;si++)$r(M.symbolInstances.get(si),M.collisionArrays[si]);if(n&&M.bucketInstanceId in this.collisionCircleArrays){var Ii=this.collisionCircleArrays[M.bucketInstanceId];o.invert(Ii.invProjMatrix,B),Ii.viewportMatrix=this.collisionIndex.getViewportMatrix()}M.justReloaded=!1},ze.prototype.markUsedJustification=function(s,i,n,l){var y;y=l===o.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(i)];for(var M=0,L=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];M<L.length;M+=1){var B=L[M];B>=0&&(s.text.placedSymbolArray.get(B).crossTileID=y>=0&&B!==y?0:n.crossTileID)}},ze.prototype.markUsedOrientation=function(s,i,n){for(var l=i===o.WritingMode.horizontal||i===o.WritingMode.horizontalOnly?i:0,y=i===o.WritingMode.vertical?i:0,M=0,L=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];M<L.length;M+=1)s.text.placedSymbolArray.get(L[M]).placedOrientation=l;n.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=y)},ze.prototype.commit=function(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;var i=this.prevPlacement,n=!1;this.prevZoomAdjustment=i?i.zoomAdjustment(this.transform.zoom):0;var l=i?i.symbolFadeChange(s):1,y=i?i.opacities:{},M=i?i.variableOffsets:{},L=i?i.placedOrientations:{};for(var B in this.placements){var oe=this.placements[B],Te=y[B];Te?(this.opacities[B]=new co(Te,l,oe.text,oe.icon),n=n||oe.text!==Te.text.placed||oe.icon!==Te.icon.placed):(this.opacities[B]=new co(null,l,oe.text,oe.icon,oe.skipFade),n=n||oe.text||oe.icon)}for(var Ge in y){var Ke=y[Ge];if(!this.opacities[Ge]){var et=new co(Ke,l,!1,!1);et.isHidden()||(this.opacities[Ge]=et,n=n||Ke.text.placed||Ke.icon.placed)}}for(var Ft in M)this.variableOffsets[Ft]||!this.opacities[Ft]||this.opacities[Ft].isHidden()||(this.variableOffsets[Ft]=M[Ft]);for(var Rt in L)this.placedOrientations[Rt]||!this.opacities[Rt]||this.opacities[Rt].isHidden()||(this.placedOrientations[Rt]=L[Rt]);n?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=i?i.lastPlacementChangeTime:s)},ze.prototype.updateLayerOpacities=function(s,i){for(var n={},l=0,y=i;l<y.length;l+=1){var M=y[l],L=M.getBucket(s);L&&M.latestFeatureIndex&&s.id===L.layerIds[0]&&this.updateBucketOpacities(L,n,M.collisionBoxArray)}},ze.prototype.updateBucketOpacities=function(s,i,n){var l=this;s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();var y=s.layers[0].layout,M=new co(null,0,!1,!1,!0),L=y.get("text-allow-overlap"),B=y.get("icon-allow-overlap"),oe=y.get("text-variable-anchor"),Te=y.get("text-rotation-alignment")==="map",Ge=y.get("text-pitch-alignment")==="map",Ke=y.get("icon-text-fit")!=="none",et=new co(null,0,L&&(B||!s.hasIconData()||y.get("icon-optional")),B&&(L||!s.hasTextData()||y.get("text-optional")),!0);!s.collisionArrays&&n&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(n);for(var Ft=function(rr,nr,zr){for(var pr=0;pr<nr/4;pr++)rr.opacityVertexArray.emplaceBack(zr)},Rt=function(rr){var nr=s.symbolInstances.get(rr),zr=nr.numHorizontalGlyphVertices,pr=nr.numVerticalGlyphVertices,Ar=nr.crossTileID,wr=l.opacities[Ar];i[Ar]?wr=M:wr||(l.opacities[Ar]=wr=et),i[Ar]=!0;var sn=nr.numIconVertices>0,$r=l.placedOrientations[nr.crossTileID],xn=$r===o.WritingMode.vertical,In=$r===o.WritingMode.horizontal||$r===o.WritingMode.horizontalOnly;if(zr>0||pr>0){var ei=Ro(wr.text);Ft(s.text,zr,xn?Hu:ei),Ft(s.text,pr,In?Hu:ei);var si=wr.text.isHidden();[nr.rightJustifiedTextSymbolIndex,nr.centerJustifiedTextSymbolIndex,nr.leftJustifiedTextSymbolIndex].forEach(function(Hi){Hi>=0&&(s.text.placedSymbolArray.get(Hi).hidden=si||xn?1:0)}),nr.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(nr.verticalPlacedTextSymbolIndex).hidden=si||In?1:0);var Ii=l.variableOffsets[nr.crossTileID];Ii&&l.markUsedJustification(s,Ii.anchor,nr,$r);var $i=l.placedOrientations[nr.crossTileID];$i&&(l.markUsedJustification(s,"left",nr,$i),l.markUsedOrientation(s,$i,nr))}if(sn){var wn=Ro(wr.icon),ui=!(Ke&&nr.verticalPlacedIconSymbolIndex&&xn);nr.placedIconSymbolIndex>=0&&(Ft(s.icon,nr.numIconVertices,ui?wn:Hu),s.icon.placedSymbolArray.get(nr.placedIconSymbolIndex).hidden=wr.icon.isHidden()),nr.verticalPlacedIconSymbolIndex>=0&&(Ft(s.icon,nr.numVerticalIconVertices,ui?Hu:wn),s.icon.placedSymbolArray.get(nr.verticalPlacedIconSymbolIndex).hidden=wr.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){var Si=s.collisionArrays[rr];if(Si){var Hn=new o.Point(0,0);if(Si.textBox||Si.verticalTextBox){var Ei=!0;if(oe){var ii=l.variableOffsets[Ar];ii?(Hn=Lo(ii.anchor,ii.width,ii.height,ii.textOffset,ii.textBoxScale),Te&&Hn._rotate(Ge?l.transform.angle:-l.transform.angle)):Ei=!1}Si.textBox&&It(s.textCollisionBox.collisionVertexArray,wr.text.placed,!Ei||xn,Hn.x,Hn.y),Si.verticalTextBox&&It(s.textCollisionBox.collisionVertexArray,wr.text.placed,!Ei||In,Hn.x,Hn.y)}var Ni=Boolean(!In&&Si.verticalIconBox);Si.iconBox&&It(s.iconCollisionBox.collisionVertexArray,wr.icon.placed,Ni,Ke?Hn.x:0,Ke?Hn.y:0),Si.verticalIconBox&&It(s.iconCollisionBox.collisionVertexArray,wr.icon.placed,!Ni,Ke?Hn.x:0,Ke?Hn.y:0)}}},Yt=0;Yt<s.symbolInstances.length;Yt++)Rt(Yt);if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){var zt=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=zt.invProjMatrix,s.placementViewportMatrix=zt.viewportMatrix,s.collisionCircleArray=zt.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}},ze.prototype.symbolFadeChange=function(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},ze.prototype.zoomAdjustment=function(s){return Math.max(0,(this.transform.zoom-s)/1.5)},ze.prototype.hasTransitions=function(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration},ze.prototype.stillRecent=function(s,i){var n=this.zoomAtLastRecencyCheck===i?1-this.zoomAdjustment(i):1;return this.zoomAtLastRecencyCheck=i,this.commitTime+this.fadeDuration*n>s},ze.prototype.setStale=function(){this.stale=!0};var fr=Math.pow(2,25),nn=Math.pow(2,24),yn=Math.pow(2,17),Vn=Math.pow(2,16),Ua=Math.pow(2,9),xo=Math.pow(2,8),_o=Math.pow(2,1);function Ro(s){if(s.opacity===0&&!s.placed)return 0;if(s.opacity===1&&s.placed)return 4294967295;var i=s.placed?1:0,n=Math.floor(127*s.opacity);return n*fr+i*nn+n*yn+i*Vn+n*Ua+i*xo+n*_o+i}var Hu=0,zl=function(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&i.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};zl.prototype.continuePlacement=function(s,i,n,l,y){for(var M=this._bucketParts;this._currentTileIndex<s.length;)if(i.getBucketParts(M,l,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort(function(L,B){return L.sortKey-B.sortKey}));this._currentPartIndex<M.length;)if(i.placeLayerBucketPart(M[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,y())return!0;return!1};var Ks=function(i,n,l,y,M,L,B){this.placement=new ze(i,M,L,B),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=y,this._done=!1};Ks.prototype.isDone=function(){return this._done},Ks.prototype.continuePlacement=function(s,i,n){for(var l=this,y=o.browser.now(),M=function(){var Te=o.browser.now()-y;return!l._forceFullPlacement&&Te>2};this._currentPlacementIndex>=0;){var L=i[s[this._currentPlacementIndex]],B=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=B)&&(!L.maxzoom||L.maxzoom>B)){if(this._inProgressLayer||(this._inProgressLayer=new zl(L)),this._inProgressLayer.continuePlacement(n[L.source],this.placement,this._showCollisionBoxes,L,M))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ks.prototype.commit=function(s){return this.placement.commit(s),this.placement};var nf=512/o.EXTENT/2,Nl=function(i,n,l){this.tileID=i,this.indexedSymbolInstances={},this.bucketInstanceId=l;for(var y=0;y<n.length;y++){var M=n.get(y),L=M.key;this.indexedSymbolInstances[L]||(this.indexedSymbolInstances[L]=[]),this.indexedSymbolInstances[L].push({crossTileID:M.crossTileID,coord:this.getScaledCoordinates(M,i)})}};Nl.prototype.getScaledCoordinates=function(s,i){var n=nf/Math.pow(2,i.canonical.z-this.tileID.canonical.z);return{x:Math.floor((i.canonical.x*o.EXTENT+s.anchorX)*n),y:Math.floor((i.canonical.y*o.EXTENT+s.anchorY)*n)}},Nl.prototype.findMatches=function(s,i,n){for(var l=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z),y=0;y<s.length;y++){var M=s.get(y);if(!M.crossTileID){var L=this.indexedSymbolInstances[M.key];if(L)for(var B=this.getScaledCoordinates(M,i),oe=0,Te=L;oe<Te.length;oe+=1){var Ge=Te[oe];if(Math.abs(Ge.coord.x-B.x)<=l&&Math.abs(Ge.coord.y-B.y)<=l&&!n[Ge.crossTileID]){n[Ge.crossTileID]=!0,M.crossTileID=Ge.crossTileID;break}}}}};var vs=function(){this.maxCrossTileID=0};vs.prototype.generate=function(){return++this.maxCrossTileID};var fu=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};fu.prototype.handleWrapJump=function(s){var i=Math.round((s-this.lng)/360);if(i!==0)for(var n in this.indexes){var l=this.indexes[n],y={};for(var M in l){var L=l[M];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+i),y[L.tileID.key]=L}this.indexes[n]=y}this.lng=s},fu.prototype.addBucket=function(s,i,n){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===i.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(var l=0;l<i.symbolInstances.length;l++)i.symbolInstances.get(l).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});var y=this.usedCrossTileIDs[s.overscaledZ];for(var M in this.indexes){var L=this.indexes[M];if(Number(M)>s.overscaledZ)for(var B in L){var oe=L[B];oe.tileID.isChildOf(s)&&oe.findMatches(i.symbolInstances,s,y)}else{var Te=L[s.scaledTo(Number(M)).key];Te&&Te.findMatches(i.symbolInstances,s,y)}}for(var Ge=0;Ge<i.symbolInstances.length;Ge++){var Ke=i.symbolInstances.get(Ge);Ke.crossTileID||(Ke.crossTileID=n.generate(),y[Ke.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new Nl(s,i.symbolInstances,i.bucketInstanceId),!0},fu.prototype.removeBucketCrossTileIDs=function(s,i){for(var n in i.indexedSymbolInstances)for(var l=0,y=i.indexedSymbolInstances[n];l<y.length;l+=1)delete this.usedCrossTileIDs[s][y[l].crossTileID]},fu.prototype.removeStaleBuckets=function(s){var i=!1;for(var n in this.indexes){var l=this.indexes[n];for(var y in l)s[l[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,l[y]),delete l[y],i=!0)}return i};var bo=function(){this.layerIndexes={},this.crossTileIDs=new vs,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};bo.prototype.addLayer=function(s,i,n){var l=this.layerIndexes[s.id];l===void 0&&(l=this.layerIndexes[s.id]=new fu);var y=!1,M={};l.handleWrapJump(n);for(var L=0,B=i;L<B.length;L+=1){var oe=B[L],Te=oe.getBucket(s);Te&&s.id===Te.layerIds[0]&&(Te.bucketInstanceId||(Te.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(oe.tileID,Te,this.crossTileIDs)&&(y=!0),M[Te.bucketInstanceId]=!0)}return l.removeStaleBuckets(M)&&(y=!0),y},bo.prototype.pruneUnusedLayers=function(s){var i={};for(var n in s.forEach(function(l){i[l]=!0}),this.layerIndexes)i[n]||delete this.layerIndexes[n]};var $s=function(i,n){return o.emitValidationErrors(i,n&&n.filter(function(l){return l.identifier!=="source.canvas"}))},Zu=o.pick(En,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Js=o.pick(En,["setCenter","setZoom","setBearing","setPitch"]),Wu=function(){var s={},i=o.styleSpec.$version;for(var n in o.styleSpec.$root){var l,y=o.styleSpec.$root[n];y.required&&(l=n==="version"?i:y.type==="array"?[]:{})!=null&&(s[n]=l)}return s}(),wa=function(s){function i(n,l){var y=this;l===void 0&&(l={}),s.call(this),this.map=n,this.dispatcher=new at(Cr(),this),this.imageManager=new Me,this.imageManager.setEventedParent(this),this.glyphManager=new Ht(n._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Le(256,512),this.crossTileSymbolIndex=new bo,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());var M=this;this._rtlTextPluginCallback=i.registerForPluginStateChange(function(L){M.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:L.pluginStatus,pluginURL:L.pluginURL},function(B,oe){if(o.triggerPluginCompletionEvent(B),oe&&oe.every(function(Ge){return Ge}))for(var Te in M.sourceCaches)M.sourceCaches[Te].reload()})}),this.on("data",function(L){if(L.dataType==="source"&&L.sourceDataType==="metadata"){var B=y.sourceCaches[L.sourceId];if(B){var oe=B.getSource();if(oe&&oe.vectorLayerIds)for(var Te in y._layers){var Ge=y._layers[Te];Ge.source===oe.id&&y._validateLayer(Ge)}}}})}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.loadURL=function(n,l){var y=this;l===void 0&&(l={}),this.fire(new o.Event("dataloading",{dataType:"style"}));var M=typeof l.validate=="boolean"?l.validate:!o.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,l.accessToken);var L=this.map._requestManager.transformRequest(n,o.ResourceType.Style);this._request=o.getJSON(L,function(B,oe){y._request=null,B?y.fire(new o.ErrorEvent(B)):oe&&y._load(oe,M)})},i.prototype.loadJSON=function(n,l){var y=this;l===void 0&&(l={}),this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.browser.frame(function(){y._request=null,y._load(n,l.validate!==!1)})},i.prototype.loadEmpty=function(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Wu,!1)},i.prototype._load=function(n,l){if(!l||!$s(this,o.validateStyle(n))){for(var y in this._loaded=!0,this.stylesheet=n,n.sources)this.addSource(y,n.sources[y],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);var M=fn(this.stylesheet.layers);this._order=M.map(function(Te){return Te.id}),this._layers={},this._serializedLayers={};for(var L=0,B=M;L<B.length;L+=1){var oe=B[L];(oe=o.createStyleLayer(oe)).setEventedParent(this,{layer:{id:oe.id}}),this._layers[oe.id]=oe,this._serializedLayers[oe.id]=oe.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Et(this.stylesheet.light),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}},i.prototype._loadSprite=function(n){var l=this;this._spriteRequest=function(y,M,L){var B,oe,Te,Ge=o.browser.devicePixelRatio>1?"@2x":"",Ke=o.getJSON(M.transformRequest(M.normalizeSpriteURL(y,Ge,".json"),o.ResourceType.SpriteJSON),function(Rt,Yt){Ke=null,Te||(Te=Rt,B=Yt,Ft())}),et=o.getImage(M.transformRequest(M.normalizeSpriteURL(y,Ge,".png"),o.ResourceType.SpriteImage),function(Rt,Yt){et=null,Te||(Te=Rt,oe=Yt,Ft())});function Ft(){if(Te)L(Te);else if(B&&oe){var Rt=o.browser.getImageData(oe),Yt={};for(var zt in B){var jt=B[zt],rr=jt.width,nr=jt.height,zr=jt.x,pr=jt.y,Ar=jt.sdf,wr=jt.pixelRatio,sn=jt.stretchX,$r=jt.stretchY,xn=jt.content,In=new o.RGBAImage({width:rr,height:nr});o.RGBAImage.copy(Rt,In,{x:zr,y:pr},{x:0,y:0},{width:rr,height:nr}),Yt[zt]={data:In,pixelRatio:wr,sdf:Ar,stretchX:sn,stretchY:$r,content:xn}}L(null,Yt)}}return{cancel:function(){Ke&&(Ke.cancel(),Ke=null),et&&(et.cancel(),et=null)}}}(n,this.map._requestManager,function(y,M){if(l._spriteRequest=null,y)l.fire(new o.ErrorEvent(y));else if(M)for(var L in M)l.imageManager.addImage(L,M[L]);l.imageManager.setLoaded(!0),l._availableImages=l.imageManager.listImages(),l.dispatcher.broadcast("setImages",l._availableImages),l.fire(new o.Event("data",{dataType:"style"}))})},i.prototype._validateLayer=function(n){var l=this.sourceCaches[n.source];if(l){var y=n.sourceLayer;if(y){var M=l.getSource();(M.type==="geojson"||M.vectorLayerIds&&M.vectorLayerIds.indexOf(y)===-1)&&this.fire(new o.ErrorEvent(new Error('Source layer "'+y+'" does not exist on source "'+M.id+'" as specified by style layer "'+n.id+'"')))}}},i.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()},i.prototype._serializeLayers=function(n){for(var l=[],y=0,M=n;y<M.length;y+=1){var L=this._layers[M[y]];L.type!=="custom"&&l.push(L.serialize())}return l},i.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(var l in this._layers)if(this._layers[l].hasTransition())return!0;return!1},i.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},i.prototype.update=function(n){if(this._loaded){var l=this._changed;if(this._changed){var y=Object.keys(this._updatedLayers),M=Object.keys(this._removedLayers);for(var L in(y.length||M.length)&&this._updateWorkerLayers(y,M),this._updatedSources){var B=this._updatedSources[L];B==="reload"?this._reloadSource(L):B==="clear"&&this._clearSource(L)}for(var oe in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[oe].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}var Te={};for(var Ge in this.sourceCaches){var Ke=this.sourceCaches[Ge];Te[Ge]=Ke.used,Ke.used=!1}for(var et=0,Ft=this._order;et<Ft.length;et+=1){var Rt=this._layers[Ft[et]];Rt.recalculate(n,this._availableImages),!Rt.isHidden(n.zoom)&&Rt.source&&(this.sourceCaches[Rt.source].used=!0)}for(var Yt in Te){var zt=this.sourceCaches[Yt];Te[Yt]!==zt.used&&zt.fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Yt}))}this.light.recalculate(n),this.z=n.zoom,l&&this.fire(new o.Event("data",{dataType:"style"}))}},i.prototype._updateTilesForChangedImages=function(){var n=Object.keys(this._changedImages);if(n.length){for(var l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}},i.prototype._updateWorkerLayers=function(n,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:l})},i.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},i.prototype.setState=function(n){var l=this;if(this._checkLoaded(),$s(this,o.validateStyle(n)))return!1;(n=o.clone$1(n)).layers=fn(n.layers);var y=function(L,B){if(!L)return[{command:En.setStyle,args:[B]}];var oe=[];try{if(!o.deepEqual(L.version,B.version))return[{command:En.setStyle,args:[B]}];o.deepEqual(L.center,B.center)||oe.push({command:En.setCenter,args:[B.center]}),o.deepEqual(L.zoom,B.zoom)||oe.push({command:En.setZoom,args:[B.zoom]}),o.deepEqual(L.bearing,B.bearing)||oe.push({command:En.setBearing,args:[B.bearing]}),o.deepEqual(L.pitch,B.pitch)||oe.push({command:En.setPitch,args:[B.pitch]}),o.deepEqual(L.sprite,B.sprite)||oe.push({command:En.setSprite,args:[B.sprite]}),o.deepEqual(L.glyphs,B.glyphs)||oe.push({command:En.setGlyphs,args:[B.glyphs]}),o.deepEqual(L.transition,B.transition)||oe.push({command:En.setTransition,args:[B.transition]}),o.deepEqual(L.light,B.light)||oe.push({command:En.setLight,args:[B.light]});var Te={},Ge=[];(function(et,Ft,Rt,Yt){var zt;for(zt in Ft=Ft||{},et=et||{})et.hasOwnProperty(zt)&&(Ft.hasOwnProperty(zt)||pn(zt,Rt,Yt));for(zt in Ft)Ft.hasOwnProperty(zt)&&(et.hasOwnProperty(zt)?o.deepEqual(et[zt],Ft[zt])||(et[zt].type==="geojson"&&Ft[zt].type==="geojson"&&hi(et,Ft,zt)?Rt.push({command:En.setGeoJSONSourceData,args:[zt,Ft[zt].data]}):Lr(zt,Ft,Rt,Yt)):Cn(zt,Ft,Rt))})(L.sources,B.sources,Ge,Te);var Ke=[];L.layers&&L.layers.forEach(function(et){Te[et.source]?oe.push({command:En.removeLayer,args:[et.id]}):Ke.push(et)}),oe=oe.concat(Ge),function(et,Ft,Rt){Ft=Ft||[];var Yt,zt,jt,rr,nr,zr,pr,Ar=(et=et||[]).map(ki),wr=Ft.map(ki),sn=et.reduce(_i,{}),$r=Ft.reduce(_i,{}),xn=Ar.slice(),In=Object.create(null);for(Yt=0,zt=0;Yt<Ar.length;Yt++)$r.hasOwnProperty(jt=Ar[Yt])?zt++:(Rt.push({command:En.removeLayer,args:[jt]}),xn.splice(xn.indexOf(jt,zt),1));for(Yt=0,zt=0;Yt<wr.length;Yt++)xn[xn.length-1-Yt]!==(jt=wr[wr.length-1-Yt])&&(sn.hasOwnProperty(jt)?(Rt.push({command:En.removeLayer,args:[jt]}),xn.splice(xn.lastIndexOf(jt,xn.length-zt),1)):zt++,Rt.push({command:En.addLayer,args:[$r[jt],zr=xn[xn.length-Yt]]}),xn.splice(xn.length-Yt,0,jt),In[jt]=!0);for(Yt=0;Yt<wr.length;Yt++)if(rr=sn[jt=wr[Yt]],nr=$r[jt],!In[jt]&&!o.deepEqual(rr,nr))if(o.deepEqual(rr.source,nr.source)&&o.deepEqual(rr["source-layer"],nr["source-layer"])&&o.deepEqual(rr.type,nr.type)){for(pr in xi(rr.layout,nr.layout,Rt,jt,null,En.setLayoutProperty),xi(rr.paint,nr.paint,Rt,jt,null,En.setPaintProperty),o.deepEqual(rr.filter,nr.filter)||Rt.push({command:En.setFilter,args:[jt,nr.filter]}),o.deepEqual(rr.minzoom,nr.minzoom)&&o.deepEqual(rr.maxzoom,nr.maxzoom)||Rt.push({command:En.setLayerZoomRange,args:[jt,nr.minzoom,nr.maxzoom]}),rr)rr.hasOwnProperty(pr)&&pr!=="layout"&&pr!=="paint"&&pr!=="filter"&&pr!=="metadata"&&pr!=="minzoom"&&pr!=="maxzoom"&&(pr.indexOf("paint.")===0?xi(rr[pr],nr[pr],Rt,jt,pr.slice(6),En.setPaintProperty):o.deepEqual(rr[pr],nr[pr])||Rt.push({command:En.setLayerProperty,args:[jt,pr,nr[pr]]}));for(pr in nr)nr.hasOwnProperty(pr)&&!rr.hasOwnProperty(pr)&&pr!=="layout"&&pr!=="paint"&&pr!=="filter"&&pr!=="metadata"&&pr!=="minzoom"&&pr!=="maxzoom"&&(pr.indexOf("paint.")===0?xi(rr[pr],nr[pr],Rt,jt,pr.slice(6),En.setPaintProperty):o.deepEqual(rr[pr],nr[pr])||Rt.push({command:En.setLayerProperty,args:[jt,pr,nr[pr]]}))}else Rt.push({command:En.removeLayer,args:[jt]}),zr=xn[xn.lastIndexOf(jt)+1],Rt.push({command:En.addLayer,args:[nr,zr]})}(Ke,B.layers,oe)}catch(et){console.warn("Unable to compute style diff:",et),oe=[{command:En.setStyle,args:[B]}]}return oe}(this.serialize(),n).filter(function(L){return!(L.command in Js)});if(y.length===0)return!1;var M=y.filter(function(L){return!(L.command in Zu)});if(M.length>0)throw new Error("Unimplemented: "+M.map(function(L){return L.command}).join(", ")+".");return y.forEach(function(L){L.command!=="setTransition"&&l[L.command].apply(l,L.args)}),this.stylesheet=n,!0},i.prototype.addImage=function(n,l){if(this.getImage(n))return this.fire(new o.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(n,l),this._afterImageUpdated(n)},i.prototype.updateImage=function(n,l){this.imageManager.updateImage(n,l)},i.prototype.getImage=function(n){return this.imageManager.getImage(n)},i.prototype.removeImage=function(n){if(!this.getImage(n))return this.fire(new o.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(n),this._afterImageUpdated(n)},i.prototype._afterImageUpdated=function(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))},i.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},i.prototype.addSource=function(n,l,y){var M=this;if(y===void 0&&(y={}),this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error("There is already a source with this ID");if(!l.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(l).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(o.validateStyle.source,"sources."+n,l,null,y))){this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);var L=this.sourceCaches[n]=new mt(n,l,this.dispatcher);L.style=this,L.setEventedParent(this,function(){return{isSourceLoaded:M.loaded(),source:L.serialize(),sourceId:n}}),L.onAdd(this.map),this._changed=!0}},i.prototype.removeSource=function(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(var l in this._layers)if(this._layers[l].source===n)return this.fire(new o.ErrorEvent(new Error('Source "'+n+'" cannot be removed while layer "'+l+'" is using it.')));var y=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],y.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),y.setEventedParent(null),y.clearTiles(),y.onRemove&&y.onRemove(this.map),this._changed=!0},i.prototype.setGeoJSONSourceData=function(n,l){this._checkLoaded(),this.sourceCaches[n].getSource().setData(l),this._changed=!0},i.prototype.getSource=function(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()},i.prototype.addLayer=function(n,l,y){y===void 0&&(y={}),this._checkLoaded();var M=n.id;if(this.getLayer(M))this.fire(new o.ErrorEvent(new Error('Layer with id "'+M+'" already exists on this map')));else{var L;if(n.type==="custom"){if($s(this,o.validateCustomStyleLayer(n)))return;L=o.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(M,n.source),n=o.clone$1(n),n=o.extend(n,{source:M})),this._validate(o.validateStyle.layer,"layers."+M,n,{arrayIndex:-1},y))return;L=o.createStyleLayer(n),this._validateLayer(L),L.setEventedParent(this,{layer:{id:M}}),this._serializedLayers[L.id]=L.serialize()}var B=l?this._order.indexOf(l):this._order.length;if(l&&B===-1)this.fire(new o.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.')));else{if(this._order.splice(B,0,M),this._layerOrderChanged=!0,this._layers[M]=L,this._removedLayers[M]&&L.source&&L.type!=="custom"){var oe=this._removedLayers[M];delete this._removedLayers[M],oe.type!==L.type?this._updatedSources[L.source]="clear":(this._updatedSources[L.source]="reload",this.sourceCaches[L.source].pause())}this._updateLayer(L),L.onAdd&&L.onAdd(this.map)}}},i.prototype.moveLayer=function(n,l){if(this._checkLoaded(),this._changed=!0,this._layers[n]){if(n!==l){var y=this._order.indexOf(n);this._order.splice(y,1);var M=l?this._order.indexOf(l):this._order.length;l&&M===-1?this.fire(new o.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.'))):(this._order.splice(M,0,n),this._layerOrderChanged=!0)}}else this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be moved.")))},i.prototype.removeLayer=function(n){this._checkLoaded();var l=this._layers[n];if(l){l.setEventedParent(null);var y=this._order.indexOf(n);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=l,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],l.onRemove&&l.onRemove(this.map)}else this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be removed.")))},i.prototype.getLayer=function(n){return this._layers[n]},i.prototype.hasLayer=function(n){return n in this._layers},i.prototype.setLayerZoomRange=function(n,l,y){this._checkLoaded();var M=this.getLayer(n);M?M.minzoom===l&&M.maxzoom===y||(l!=null&&(M.minzoom=l),y!=null&&(M.maxzoom=y),this._updateLayer(M)):this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot have zoom extent.")))},i.prototype.setFilter=function(n,l,y){y===void 0&&(y={}),this._checkLoaded();var M=this.getLayer(n);if(M){if(!o.deepEqual(M.filter,l))return l==null?(M.filter=void 0,void this._updateLayer(M)):void(this._validate(o.validateStyle.filter,"layers."+M.id+".filter",l,null,y)||(M.filter=o.clone$1(l),this._updateLayer(M)))}else this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be filtered.")))},i.prototype.getFilter=function(n){return o.clone$1(this.getLayer(n).filter)},i.prototype.setLayoutProperty=function(n,l,y,M){M===void 0&&(M={}),this._checkLoaded();var L=this.getLayer(n);L?o.deepEqual(L.getLayoutProperty(l),y)||(L.setLayoutProperty(l,y,M),this._updateLayer(L)):this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getLayoutProperty=function(n,l){var y=this.getLayer(n);if(y)return y.getLayoutProperty(l);this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style.")))},i.prototype.setPaintProperty=function(n,l,y,M){M===void 0&&(M={}),this._checkLoaded();var L=this.getLayer(n);L?o.deepEqual(L.getPaintProperty(l),y)||(L.setPaintProperty(l,y,M)&&this._updateLayer(L),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new o.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getPaintProperty=function(n,l){return this.getLayer(n).getPaintProperty(l)},i.prototype.setFeatureState=function(n,l){this._checkLoaded();var y=n.source,M=n.sourceLayer,L=this.sourceCaches[y];if(L!==void 0){var B=L.getSource().type;B==="geojson"&&M?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):B!=="vector"||M?(n.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),L.setFeatureState(M,n.id,l)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+y+"' does not exist in the map's style.")))},i.prototype.removeFeatureState=function(n,l){this._checkLoaded();var y=n.source,M=this.sourceCaches[y];if(M!==void 0){var L=M.getSource().type,B=L==="vector"?n.sourceLayer:void 0;L!=="vector"||B?l&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):M.removeFeatureState(B,n.id,l):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+y+"' does not exist in the map's style.")))},i.prototype.getFeatureState=function(n){this._checkLoaded();var l=n.source,y=n.sourceLayer,M=this.sourceCaches[l];if(M!==void 0){if(M.getSource().type!=="vector"||y)return n.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),M.getFeatureState(y,n.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+l+"' does not exist in the map's style.")))},i.prototype.getTransition=function(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},i.prototype.serialize=function(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,function(n){return n.serialize()}),layers:this._serializeLayers(this._order)},function(n){return n!==void 0})},i.prototype._updateLayer=function(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0},i.prototype._flattenAndSortRenderedFeatures=function(n){for(var l=this,y=function($r){return l._layers[$r].type==="fill-extrusion"},M={},L=[],B=this._order.length-1;B>=0;B--){var oe=this._order[B];if(y(oe)){M[oe]=B;for(var Te=0,Ge=n;Te<Ge.length;Te+=1){var Ke=Ge[Te][oe];if(Ke)for(var et=0,Ft=Ke;et<Ft.length;et+=1)L.push(Ft[et])}}}L.sort(function(sn,$r){return $r.intersectionZ-sn.intersectionZ});for(var Rt=[],Yt=this._order.length-1;Yt>=0;Yt--){var zt=this._order[Yt];if(y(zt))for(var jt=L.length-1;jt>=0;jt--){var rr=L[jt].feature;if(M[rr.layer.id]<Yt)break;Rt.push(rr),L.pop()}else for(var nr=0,zr=n;nr<zr.length;nr+=1){var pr=zr[nr][zt];if(pr)for(var Ar=0,wr=pr;Ar<wr.length;Ar+=1)Rt.push(wr[Ar].feature)}}return Rt},i.prototype.queryRenderedFeatures=function(n,l,y){l&&l.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",l.filter,null,l);var M={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var L=0,B=l.layers;L<B.length;L+=1){var oe=B[L],Te=this._layers[oe];if(!Te)return this.fire(new o.ErrorEvent(new Error("The layer '"+oe+"' does not exist in the map's style and cannot be queried for features."))),[];M[Te.source]=!0}}var Ge=[];for(var Ke in l.availableImages=this._availableImages,this.sourceCaches)l.layers&&!M[Ke]||Ge.push(rt(this.sourceCaches[Ke],this._layers,this._serializedLayers,n,l,y));return this.placement&&Ge.push(function(et,Ft,Rt,Yt,zt,jt,rr){for(var nr={},zr=jt.queryRenderedSymbols(Yt),pr=[],Ar=0,wr=Object.keys(zr).map(Number);Ar<wr.length;Ar+=1)pr.push(rr[wr[Ar]]);pr.sort(ue);for(var sn=function(){var Ii=xn[$r],$i=Ii.featureIndex.lookupSymbolFeatures(zr[Ii.bucketInstanceId],Ft,Ii.bucketIndex,Ii.sourceLayerIndex,zt.filter,zt.layers,zt.availableImages,et);for(var wn in $i){var ui=nr[wn]=nr[wn]||[],Si=$i[wn];Si.sort(function(ii,Ni){var Hi=Ii.featureSortOrder;if(Hi){var no=Hi.indexOf(ii.featureIndex);return Hi.indexOf(Ni.featureIndex)-no}return Ni.featureIndex-ii.featureIndex});for(var Hn=0,Ei=Si;Hn<Ei.length;Hn+=1)ui.push(Ei[Hn])}},$r=0,xn=pr;$r<xn.length;$r+=1)sn();var In=function(Ii){nr[Ii].forEach(function($i){var wn=$i.feature,ui=Rt[et[Ii].source].getFeatureState(wn.layer["source-layer"],wn.id);wn.source=wn.layer.source,wn.layer["source-layer"]&&(wn.sourceLayer=wn.layer["source-layer"]),wn.state=ui})};for(var ei in nr)In(ei);return nr}(this._layers,this._serializedLayers,this.sourceCaches,n,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Ge)},i.prototype.querySourceFeatures=function(n,l){l&&l.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",l.filter,null,l);var y=this.sourceCaches[n];return y?function(M,L){for(var B=M.getRenderableIds().map(function(Ft){return M.getTileByID(Ft)}),oe=[],Te={},Ge=0;Ge<B.length;Ge++){var Ke=B[Ge],et=Ke.tileID.canonical.key;Te[et]||(Te[et]=!0,Ke.querySourceFeatures(oe,L))}return oe}(y,l):[]},i.prototype.addSourceType=function(n,l,y){return i.getSourceType(n)?y(new Error('A source type called "'+n+'" already exists.')):(i.setSourceType(n,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:l.workerSourceURL},y):y(null,null))},i.prototype.getLight=function(){return this.light.getLight()},i.prototype.setLight=function(n,l){l===void 0&&(l={}),this._checkLoaded();var y=this.light.getLight(),M=!1;for(var L in n)if(!o.deepEqual(n[L],y[L])){M=!0;break}if(M){var B={now:o.browser.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,l),this.light.updateTransitions(B)}},i.prototype._validate=function(n,l,y,M,L){return L===void 0&&(L={}),(!L||L.validate!==!1)&&$s(this,n.call(o.validateStyle,o.extend({key:l,style:this.serialize(),value:y,styleSpec:o.styleSpec},M)))},i.prototype._remove=function(){for(var n in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[n].setEventedParent(null);for(var l in this.sourceCaches)this.sourceCaches[l].clearTiles(),this.sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},i.prototype._clearSource=function(n){this.sourceCaches[n].clearTiles()},i.prototype._reloadSource=function(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()},i.prototype._updateSources=function(n){for(var l in this.sourceCaches)this.sourceCaches[l].update(n)},i.prototype._generateCollisionBoxes=function(){for(var n in this.sourceCaches)this._reloadSource(n)},i.prototype._updatePlacement=function(n,l,y,M,L){L===void 0&&(L=!1);for(var B=!1,oe=!1,Te={},Ge=0,Ke=this._order;Ge<Ke.length;Ge+=1){var et=this._layers[Ke[Ge]];if(et.type==="symbol"){if(!Te[et.source]){var Ft=this.sourceCaches[et.source];Te[et.source]=Ft.getRenderableIds(!0).map(function(rr){return Ft.getTileByID(rr)}).sort(function(rr,nr){return nr.tileID.overscaledZ-rr.tileID.overscaledZ||(rr.tileID.isLessThan(nr.tileID)?-1:1)})}var Rt=this.crossTileSymbolIndex.addLayer(et,Te[et.source],n.center.lng);B=B||Rt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((L=L||this._layerOrderChanged||y===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.browser.now(),n.zoom))&&(this.pauseablePlacement=new Ks(n,this._order,L,l,y,M,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Te),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.browser.now()),oe=!0),B&&this.pauseablePlacement.placement.setStale()),oe||B)for(var Yt=0,zt=this._order;Yt<zt.length;Yt+=1){var jt=this._layers[zt[Yt]];jt.type==="symbol"&&this.placement.updateLayerOpacities(jt,Te[jt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.browser.now())},i.prototype._releaseSymbolFadeTiles=function(){for(var n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()},i.prototype.getImages=function(n,l,y){this.imageManager.getImages(l.icons,y),this._updateTilesForChangedImages();var M=this.sourceCaches[l.source];M&&M.setDependencies(l.tileID.key,l.type,l.icons)},i.prototype.getGlyphs=function(n,l,y){this.glyphManager.getGlyphs(l.stacks,y)},i.prototype.getResource=function(n,l,y){return o.makeRequest(l,y)},i}(o.Evented);wa.getSourceType=function(s){return Ne[s]},wa.setSourceType=function(s,i){Ne[s]=i},wa.registerForPluginStateChange=o.registerForPluginStateChange;var Ka=o.createLayout([{name:"a_pos",type:"Int16",components:2}]),hu=ba(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Xu=ba(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),nc=ba(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ot=ba(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),tr=ba("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Mr=ba(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Xn=ba(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Wi=ba("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),oa=ba("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Xa=ba("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),zi=ba(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),La=ba(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Do=ba(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ms=ba(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Aa=ba(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Sl=ba(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),du=ba(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),os=ba(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Yu=ba(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Au=ba(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ku=ba(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Cu=ba(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),ol=ba(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),pu=ba(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),af=ba(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Nf=ba(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function ba(s,i){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=i.match(/attribute ([\w]+) ([\w]+)/g),y=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),M=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=M?M.concat(y):y,B={};return{fragmentSource:s=s.replace(n,function(oe,Te,Ge,Ke,et){return B[et]=!0,Te==="define"?`
#ifndef HAS_UNIFORM_u_`+et+`
varying `+Ge+" "+Ke+" "+et+`;
#else
uniform `+Ge+" "+Ke+" u_"+et+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+et+`
    `+Ge+" "+Ke+" "+et+" = u_"+et+`;
#endif
`}),vertexSource:i=i.replace(n,function(oe,Te,Ge,Ke,et){var Ft=Ke==="float"?"vec2":"vec4",Rt=et.match(/color/)?"color":Ft;return B[et]?Te==="define"?`
#ifndef HAS_UNIFORM_u_`+et+`
uniform lowp float u_`+et+`_t;
attribute `+Ge+" "+Ft+" a_"+et+`;
varying `+Ge+" "+Ke+" "+et+`;
#else
uniform `+Ge+" "+Ke+" u_"+et+`;
#endif
`:Rt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+et+`
    `+et+" = a_"+et+`;
#else
    `+Ge+" "+Ke+" "+et+" = u_"+et+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+et+`
    `+et+" = unpack_mix_"+Rt+"(a_"+et+", u_"+et+`_t);
#else
    `+Ge+" "+Ke+" "+et+" = u_"+et+`;
#endif
`:Te==="define"?`
#ifndef HAS_UNIFORM_u_`+et+`
uniform lowp float u_`+et+`_t;
attribute `+Ge+" "+Ft+" a_"+et+`;
#else
uniform `+Ge+" "+Ke+" u_"+et+`;
#endif
`:Rt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+et+`
    `+Ge+" "+Ke+" "+et+" = a_"+et+`;
#else
    `+Ge+" "+Ke+" "+et+" = u_"+et+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+et+`
    `+Ge+" "+Ke+" "+et+" = unpack_mix_"+Rt+"(a_"+et+", u_"+et+`_t);
#else
    `+Ge+" "+Ke+" "+et+" = u_"+et+`;
#endif
`}),staticAttributes:l,staticUniforms:L}}var Nc=Object.freeze({__proto__:null,prelude:hu,background:Xu,backgroundPattern:nc,circle:Ot,clippingMask:tr,heatmap:Mr,heatmapTexture:Xn,collisionBox:Wi,collisionCircle:oa,debug:Xa,fill:zi,fillOutline:La,fillOutlinePattern:Do,fillPattern:ms,fillExtrusion:Aa,fillExtrusionPattern:Sl,hillshadePrepare:du,hillshade:os,line:Yu,lineGradient:Au,linePattern:Ku,lineSDF:Cu,raster:ol,symbolIcon:pu,symbolSDF:af,symbolTextAndIcon:Nf}),Fc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function bf(s){for(var i=[],n=0;n<s.length;n++)if(s[n]!==null){var l=s[n].split(" ");i.push(l.pop())}return i}Fc.prototype.bind=function(s,i,n,l,y,M,L,B){this.context=s;for(var oe=this.boundPaintVertexBuffers.length!==l.length,Te=0;!oe&&Te<l.length;Te++)this.boundPaintVertexBuffers[Te]!==l[Te]&&(oe=!0);s.extVertexArrayObject&&this.vao&&this.boundProgram===i&&this.boundLayoutVertexBuffer===n&&!oe&&this.boundIndexBuffer===y&&this.boundVertexOffset===M&&this.boundDynamicVertexBuffer===L&&this.boundDynamicVertexBuffer2===B?(s.bindVertexArrayOES.set(this.vao),L&&L.bind(),y&&y.dynamicDraw&&y.bind(),B&&B.bind()):this.freshBind(i,n,l,y,M,L,B)},Fc.prototype.freshBind=function(s,i,n,l,y,M,L){var B,oe=s.numAttributes,Te=this.context,Ge=Te.gl;if(Te.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Te.extVertexArrayObject.createVertexArrayOES(),Te.bindVertexArrayOES.set(this.vao),B=0,this.boundProgram=s,this.boundLayoutVertexBuffer=i,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=l,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=M,this.boundDynamicVertexBuffer2=L;else{B=Te.currentNumAttributes||0;for(var Ke=oe;Ke<B;Ke++)Ge.disableVertexAttribArray(Ke)}i.enableAttributes(Ge,s);for(var et=0,Ft=n;et<Ft.length;et+=1)Ft[et].enableAttributes(Ge,s);M&&M.enableAttributes(Ge,s),L&&L.enableAttributes(Ge,s),i.bind(),i.setVertexAttribPointers(Ge,s,y);for(var Rt=0,Yt=n;Rt<Yt.length;Rt+=1){var zt=Yt[Rt];zt.bind(),zt.setVertexAttribPointers(Ge,s,y)}M&&(M.bind(),M.setVertexAttribPointers(Ge,s,y)),l&&l.bind(),L&&(L.bind(),L.setVertexAttribPointers(Ge,s,y)),Te.currentNumAttributes=oe},Fc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Bc=function(i,n,l,y,M,L){var B=i.gl;this.program=B.createProgram();for(var oe=bf(l.staticAttributes),Te=y?y.getBinderAttributes():[],Ge=oe.concat(Te),Ke=l.staticUniforms?bf(l.staticUniforms):[],et=y?y.getBinderUniforms():[],Ft=[],Rt=0,Yt=Ke.concat(et);Rt<Yt.length;Rt+=1){var zt=Yt[Rt];Ft.indexOf(zt)<0&&Ft.push(zt)}var jt=y?y.defines():[];L&&jt.push("#define OVERDRAW_INSPECTOR;");var rr=jt.concat(hu.fragmentSource,l.fragmentSource).join(`
`),nr=jt.concat(hu.vertexSource,l.vertexSource).join(`
`),zr=B.createShader(B.FRAGMENT_SHADER);if(B.isContextLost())this.failedToCreate=!0;else{B.shaderSource(zr,rr),B.compileShader(zr),B.attachShader(this.program,zr);var pr=B.createShader(B.VERTEX_SHADER);if(B.isContextLost())this.failedToCreate=!0;else{B.shaderSource(pr,nr),B.compileShader(pr),B.attachShader(this.program,pr),this.attributes={};var Ar={};this.numAttributes=Ge.length;for(var wr=0;wr<this.numAttributes;wr++)Ge[wr]&&(B.bindAttribLocation(this.program,wr,Ge[wr]),this.attributes[Ge[wr]]=wr);B.linkProgram(this.program),B.deleteShader(pr),B.deleteShader(zr);for(var sn=0;sn<Ft.length;sn++){var $r=Ft[sn];if($r&&!Ar[$r]){var xn=B.getUniformLocation(this.program,$r);xn&&(Ar[$r]=xn)}}this.fixedUniforms=M(i,Ar),this.binderUniforms=y?y.getUniforms(i,Ar):[]}}};function Sf(s,i,n){var l=1/sa(n,1,i.transform.tileZoom),y=Math.pow(2,n.tileID.overscaledZ),M=n.tileSize*Math.pow(2,i.transform.tileZoom)/y,L=M*(n.tileID.canonical.x+n.tileID.wrap*y),B=M*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[l,s.fromScale,s.toScale],u_fade:s.t,u_pixel_coord_upper:[L>>16,B>>16],u_pixel_coord_lower:[65535&L,65535&B]}}Bc.prototype.draw=function(s,i,n,l,y,M,L,B,oe,Te,Ge,Ke,et,Ft,Rt,Yt){var zt,jt=s.gl;if(!this.failedToCreate){for(var rr in s.program.set(this.program),s.setDepthMode(n),s.setStencilMode(l),s.setColorMode(y),s.setCullFace(M),this.fixedUniforms)this.fixedUniforms[rr].set(L[rr]);Ft&&Ft.setUniforms(s,this.binderUniforms,Ke,{zoom:et});for(var nr=(zt={},zt[jt.LINES]=2,zt[jt.TRIANGLES]=3,zt[jt.LINE_STRIP]=1,zt)[i],zr=0,pr=Ge.get();zr<pr.length;zr+=1){var Ar=pr[zr],wr=Ar.vaos||(Ar.vaos={});(wr[B]||(wr[B]=new Fc)).bind(s,this,oe,Ft?Ft.getPaintVertexBuffers():[],Te,Ar.vertexOffset,Rt,Yt),jt.drawElements(i,Ar.primitiveLength*nr,jt.UNSIGNED_SHORT,Ar.primitiveOffset*nr*2)}}};var ro=function(i,n,l,y){var M=n.style.light,L=M.properties.get("position"),B=[L.x,L.y,L.z],oe=o.create$1();M.properties.get("anchor")==="viewport"&&o.fromRotation(oe,-n.transform.angle),o.transformMat3(B,B,oe);var Te=M.properties.get("color");return{u_matrix:i,u_lightpos:B,u_lightintensity:M.properties.get("intensity"),u_lightcolor:[Te.r,Te.g,Te.b],u_vertical_gradient:+l,u_opacity:y}},wu=function(i,n,l,y,M,L,B){return o.extend(ro(i,n,l,y),Sf(L,n,B),{u_height_factor:-Math.pow(2,M.overscaledZ)/B.tileSize/8})},El=function(i){return{u_matrix:i}},gs=function(i,n,l,y){return o.extend(El(i),Sf(l,n,y))},kc=function(i,n){return{u_matrix:i,u_world:n}},bc=function(i,n,l,y,M){return o.extend(gs(i,n,l,y),{u_world:M})},Tl=function(i,n,l,y){var M,L,B=i.transform;if(y.paint.get("circle-pitch-alignment")==="map"){var oe=sa(l,1,B.zoom);M=!0,L=[oe,oe]}else M=!1,L=B.pixelsToGLUnits;return{u_camera_to_center_distance:B.cameraToCenterDistance,u_scale_with_map:+(y.paint.get("circle-pitch-scale")==="map"),u_matrix:i.translatePosMatrix(n.posMatrix,l,y.paint.get("circle-translate"),y.paint.get("circle-translate-anchor")),u_pitch_with_map:+M,u_device_pixel_ratio:o.browser.devicePixelRatio,u_extrude_scale:L}},sl=function(i,n,l){var y=sa(l,1,n.zoom),M=Math.pow(2,n.zoom-l.tileID.overscaledZ),L=l.tileID.overscaleFactor();return{u_matrix:i,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:y,u_extrude_scale:[n.pixelsToGLUnits[0]/(y*M),n.pixelsToGLUnits[1]/(y*M)],u_overscale_factor:L}},$u=function(i,n,l){return{u_matrix:i,u_inv_matrix:n,u_camera_to_center_distance:l.cameraToCenterDistance,u_viewport_size:[l.width,l.height]}},Qs=function(i,n,l){return l===void 0&&(l=1),{u_matrix:i,u_color:n,u_overlay:0,u_overlay_scale:l}},Pu=function(i){return{u_matrix:i}},jc=function(i,n,l,y){return{u_matrix:i,u_extrude_scale:sa(n,1,l),u_intensity:y}},Fl=function(i,n,l){var y=i.transform;return{u_matrix:Ec(i,n,l),u_ratio:1/sa(n,1,y.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Pa=function(i,n,l,y){return o.extend(Fl(i,n,l),{u_image:0,u_image_height:y})},Uc=function(i,n,l,y){var M=i.transform,L=Sc(n,M);return{u_matrix:Ec(i,n,l),u_texsize:n.imageAtlasTexture.size,u_ratio:1/sa(n,1,M.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_image:0,u_scale:[L,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]]}},Ef=function(i,n,l,y,M){var L=i.lineAtlas,B=Sc(n,i.transform),oe=l.layout.get("line-cap")==="round",Te=L.getDash(y.from,oe),Ge=L.getDash(y.to,oe),Ke=Te.width*M.fromScale,et=Ge.width*M.toScale;return o.extend(Fl(i,n,l),{u_patternscale_a:[B/Ke,-Te.height/2],u_patternscale_b:[B/et,-Ge.height/2],u_sdfgamma:L.width/(256*Math.min(Ke,et)*o.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Te.y,u_tex_y_b:Ge.y,u_mix:M.t})};function Sc(s,i){return 1/sa(s,1,i.tileZoom)}function Ec(s,i,n){return s.translatePosMatrix(i.tileID.posMatrix,i,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var ic=function(i,n,l,y,M){return{u_matrix:i,u_tl_parent:n,u_scale_parent:l,u_buffer_scale:1,u_fade_t:y.mix,u_opacity:y.opacity*M.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:M.paint.get("raster-brightness-min"),u_brightness_high:M.paint.get("raster-brightness-max"),u_saturation_factor:(B=M.paint.get("raster-saturation"),B>0?1-1/(1.001-B):-B),u_contrast_factor:(L=M.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:ul(M.paint.get("raster-hue-rotate"))};var L,B};function ul(s){s*=Math.PI/180;var i=Math.sin(s),n=Math.cos(s);return[(2*n+1)/3,(-Math.sqrt(3)*i-n+1)/3,(Math.sqrt(3)*i-n+1)/3]}var _u,Bl=function(i,n,l,y,M,L,B,oe,Te,Ge){var Ke=M.transform;return{u_is_size_zoom_constant:+(i==="constant"||i==="source"),u_is_size_feature_constant:+(i==="constant"||i==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:Ke.cameraToCenterDistance,u_pitch:Ke.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:Ke.width/Ke.height,u_fade_change:M.options.fadeDuration?M.symbolFadeChange:1,u_matrix:L,u_label_plane_matrix:B,u_coord_matrix:oe,u_is_text:+Te,u_pitch_with_map:+y,u_texsize:Ge,u_texture:0}},Vo=function(i,n,l,y,M,L,B,oe,Te,Ge,Ke){var et=M.transform;return o.extend(Bl(i,n,l,y,M,L,B,oe,Te,Ge),{u_gamma_scale:y?Math.cos(et._pitch)*et.cameraToCenterDistance:1,u_device_pixel_ratio:o.browser.devicePixelRatio,u_is_halo:+Ke})},ac=function(i,n,l,y,M,L,B,oe,Te,Ge){return o.extend(Vo(i,n,l,y,M,L,B,oe,!0,Te,!0),{u_texsize_icon:Ge,u_texture_icon:1})},kl=function(i,n,l){return{u_matrix:i,u_opacity:n,u_color:l}},Al=function(i,n,l,y,M,L){return o.extend(function(B,oe,Te,Ge){var Ke=Te.imageManager.getPattern(B.from.toString()),et=Te.imageManager.getPattern(B.to.toString()),Ft=Te.imageManager.getPixelSize(),Rt=Ft.width,Yt=Ft.height,zt=Math.pow(2,Ge.tileID.overscaledZ),jt=Ge.tileSize*Math.pow(2,Te.transform.tileZoom)/zt,rr=jt*(Ge.tileID.canonical.x+Ge.tileID.wrap*zt),nr=jt*Ge.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Ke.tl,u_pattern_br_a:Ke.br,u_pattern_tl_b:et.tl,u_pattern_br_b:et.br,u_texsize:[Rt,Yt],u_mix:oe.t,u_pattern_size_a:Ke.displaySize,u_pattern_size_b:et.displaySize,u_scale_a:oe.fromScale,u_scale_b:oe.toScale,u_tile_units_to_pixels:1/sa(Ge,1,Te.transform.tileZoom),u_pixel_coord_upper:[rr>>16,nr>>16],u_pixel_coord_lower:[65535&rr,65535&nr]}}(y,L,l,M),{u_matrix:i,u_opacity:n})},Tc={fillExtrusion:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_lightpos:new o.Uniform3f(i,n.u_lightpos),u_lightintensity:new o.Uniform1f(i,n.u_lightintensity),u_lightcolor:new o.Uniform3f(i,n.u_lightcolor),u_vertical_gradient:new o.Uniform1f(i,n.u_vertical_gradient),u_opacity:new o.Uniform1f(i,n.u_opacity)}},fillExtrusionPattern:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_lightpos:new o.Uniform3f(i,n.u_lightpos),u_lightintensity:new o.Uniform1f(i,n.u_lightintensity),u_lightcolor:new o.Uniform3f(i,n.u_lightcolor),u_vertical_gradient:new o.Uniform1f(i,n.u_vertical_gradient),u_height_factor:new o.Uniform1f(i,n.u_height_factor),u_image:new o.Uniform1i(i,n.u_image),u_texsize:new o.Uniform2f(i,n.u_texsize),u_pixel_coord_upper:new o.Uniform2f(i,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(i,n.u_pixel_coord_lower),u_scale:new o.Uniform3f(i,n.u_scale),u_fade:new o.Uniform1f(i,n.u_fade),u_opacity:new o.Uniform1f(i,n.u_opacity)}},fill:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix)}},fillPattern:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_image:new o.Uniform1i(i,n.u_image),u_texsize:new o.Uniform2f(i,n.u_texsize),u_pixel_coord_upper:new o.Uniform2f(i,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(i,n.u_pixel_coord_lower),u_scale:new o.Uniform3f(i,n.u_scale),u_fade:new o.Uniform1f(i,n.u_fade)}},fillOutline:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_world:new o.Uniform2f(i,n.u_world)}},fillOutlinePattern:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_world:new o.Uniform2f(i,n.u_world),u_image:new o.Uniform1i(i,n.u_image),u_texsize:new o.Uniform2f(i,n.u_texsize),u_pixel_coord_upper:new o.Uniform2f(i,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(i,n.u_pixel_coord_lower),u_scale:new o.Uniform3f(i,n.u_scale),u_fade:new o.Uniform1f(i,n.u_fade)}},circle:function(i,n){return{u_camera_to_center_distance:new o.Uniform1f(i,n.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(i,n.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(i,n.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(i,n.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(i,n.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(i,n.u_matrix)}},collisionBox:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_camera_to_center_distance:new o.Uniform1f(i,n.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(i,n.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(i,n.u_extrude_scale),u_overscale_factor:new o.Uniform1f(i,n.u_overscale_factor)}},collisionCircle:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_inv_matrix:new o.UniformMatrix4f(i,n.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(i,n.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(i,n.u_viewport_size)}},debug:function(i,n){return{u_color:new o.UniformColor(i,n.u_color),u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_overlay:new o.Uniform1i(i,n.u_overlay),u_overlay_scale:new o.Uniform1f(i,n.u_overlay_scale)}},clippingMask:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix)}},heatmap:function(i,n){return{u_extrude_scale:new o.Uniform1f(i,n.u_extrude_scale),u_intensity:new o.Uniform1f(i,n.u_intensity),u_matrix:new o.UniformMatrix4f(i,n.u_matrix)}},heatmapTexture:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_world:new o.Uniform2f(i,n.u_world),u_image:new o.Uniform1i(i,n.u_image),u_color_ramp:new o.Uniform1i(i,n.u_color_ramp),u_opacity:new o.Uniform1f(i,n.u_opacity)}},hillshade:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_image:new o.Uniform1i(i,n.u_image),u_latrange:new o.Uniform2f(i,n.u_latrange),u_light:new o.Uniform2f(i,n.u_light),u_shadow:new o.UniformColor(i,n.u_shadow),u_highlight:new o.UniformColor(i,n.u_highlight),u_accent:new o.UniformColor(i,n.u_accent)}},hillshadePrepare:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_image:new o.Uniform1i(i,n.u_image),u_dimension:new o.Uniform2f(i,n.u_dimension),u_zoom:new o.Uniform1f(i,n.u_zoom),u_unpack:new o.Uniform4f(i,n.u_unpack)}},line:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_ratio:new o.Uniform1f(i,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(i,n.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(i,n.u_units_to_pixels)}},lineGradient:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_ratio:new o.Uniform1f(i,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(i,n.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(i,n.u_units_to_pixels),u_image:new o.Uniform1i(i,n.u_image),u_image_height:new o.Uniform1f(i,n.u_image_height)}},linePattern:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_texsize:new o.Uniform2f(i,n.u_texsize),u_ratio:new o.Uniform1f(i,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(i,n.u_device_pixel_ratio),u_image:new o.Uniform1i(i,n.u_image),u_units_to_pixels:new o.Uniform2f(i,n.u_units_to_pixels),u_scale:new o.Uniform3f(i,n.u_scale),u_fade:new o.Uniform1f(i,n.u_fade)}},lineSDF:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_ratio:new o.Uniform1f(i,n.u_ratio),u_device_pixel_ratio:new o.Uniform1f(i,n.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(i,n.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(i,n.u_patternscale_a),u_patternscale_b:new o.Uniform2f(i,n.u_patternscale_b),u_sdfgamma:new o.Uniform1f(i,n.u_sdfgamma),u_image:new o.Uniform1i(i,n.u_image),u_tex_y_a:new o.Uniform1f(i,n.u_tex_y_a),u_tex_y_b:new o.Uniform1f(i,n.u_tex_y_b),u_mix:new o.Uniform1f(i,n.u_mix)}},raster:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_tl_parent:new o.Uniform2f(i,n.u_tl_parent),u_scale_parent:new o.Uniform1f(i,n.u_scale_parent),u_buffer_scale:new o.Uniform1f(i,n.u_buffer_scale),u_fade_t:new o.Uniform1f(i,n.u_fade_t),u_opacity:new o.Uniform1f(i,n.u_opacity),u_image0:new o.Uniform1i(i,n.u_image0),u_image1:new o.Uniform1i(i,n.u_image1),u_brightness_low:new o.Uniform1f(i,n.u_brightness_low),u_brightness_high:new o.Uniform1f(i,n.u_brightness_high),u_saturation_factor:new o.Uniform1f(i,n.u_saturation_factor),u_contrast_factor:new o.Uniform1f(i,n.u_contrast_factor),u_spin_weights:new o.Uniform3f(i,n.u_spin_weights)}},symbolIcon:function(i,n){return{u_is_size_zoom_constant:new o.Uniform1i(i,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(i,n.u_is_size_feature_constant),u_size_t:new o.Uniform1f(i,n.u_size_t),u_size:new o.Uniform1f(i,n.u_size),u_camera_to_center_distance:new o.Uniform1f(i,n.u_camera_to_center_distance),u_pitch:new o.Uniform1f(i,n.u_pitch),u_rotate_symbol:new o.Uniform1i(i,n.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(i,n.u_aspect_ratio),u_fade_change:new o.Uniform1f(i,n.u_fade_change),u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(i,n.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(i,n.u_coord_matrix),u_is_text:new o.Uniform1i(i,n.u_is_text),u_pitch_with_map:new o.Uniform1i(i,n.u_pitch_with_map),u_texsize:new o.Uniform2f(i,n.u_texsize),u_texture:new o.Uniform1i(i,n.u_texture)}},symbolSDF:function(i,n){return{u_is_size_zoom_constant:new o.Uniform1i(i,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(i,n.u_is_size_feature_constant),u_size_t:new o.Uniform1f(i,n.u_size_t),u_size:new o.Uniform1f(i,n.u_size),u_camera_to_center_distance:new o.Uniform1f(i,n.u_camera_to_center_distance),u_pitch:new o.Uniform1f(i,n.u_pitch),u_rotate_symbol:new o.Uniform1i(i,n.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(i,n.u_aspect_ratio),u_fade_change:new o.Uniform1f(i,n.u_fade_change),u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(i,n.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(i,n.u_coord_matrix),u_is_text:new o.Uniform1i(i,n.u_is_text),u_pitch_with_map:new o.Uniform1i(i,n.u_pitch_with_map),u_texsize:new o.Uniform2f(i,n.u_texsize),u_texture:new o.Uniform1i(i,n.u_texture),u_gamma_scale:new o.Uniform1f(i,n.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(i,n.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(i,n.u_is_halo)}},symbolTextAndIcon:function(i,n){return{u_is_size_zoom_constant:new o.Uniform1i(i,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(i,n.u_is_size_feature_constant),u_size_t:new o.Uniform1f(i,n.u_size_t),u_size:new o.Uniform1f(i,n.u_size),u_camera_to_center_distance:new o.Uniform1f(i,n.u_camera_to_center_distance),u_pitch:new o.Uniform1f(i,n.u_pitch),u_rotate_symbol:new o.Uniform1i(i,n.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(i,n.u_aspect_ratio),u_fade_change:new o.Uniform1f(i,n.u_fade_change),u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(i,n.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(i,n.u_coord_matrix),u_is_text:new o.Uniform1i(i,n.u_is_text),u_pitch_with_map:new o.Uniform1i(i,n.u_pitch_with_map),u_texsize:new o.Uniform2f(i,n.u_texsize),u_texsize_icon:new o.Uniform2f(i,n.u_texsize_icon),u_texture:new o.Uniform1i(i,n.u_texture),u_texture_icon:new o.Uniform1i(i,n.u_texture_icon),u_gamma_scale:new o.Uniform1f(i,n.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(i,n.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(i,n.u_is_halo)}},background:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_opacity:new o.Uniform1f(i,n.u_opacity),u_color:new o.UniformColor(i,n.u_color)}},backgroundPattern:function(i,n){return{u_matrix:new o.UniformMatrix4f(i,n.u_matrix),u_opacity:new o.Uniform1f(i,n.u_opacity),u_image:new o.Uniform1i(i,n.u_image),u_pattern_tl_a:new o.Uniform2f(i,n.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(i,n.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(i,n.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(i,n.u_pattern_br_b),u_texsize:new o.Uniform2f(i,n.u_texsize),u_mix:new o.Uniform1f(i,n.u_mix),u_pattern_size_a:new o.Uniform2f(i,n.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(i,n.u_pattern_size_b),u_scale_a:new o.Uniform1f(i,n.u_scale_a),u_scale_b:new o.Uniform1f(i,n.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(i,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(i,n.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(i,n.u_tile_units_to_pixels)}}};function jl(s,i,n,l,y,M,L){for(var B=s.context,oe=B.gl,Te=s.useProgram("collisionBox"),Ge=[],Ke=0,et=0,Ft=0;Ft<l.length;Ft++){var Rt=l[Ft],Yt=i.getTile(Rt),zt=Yt.getBucket(n);if(zt){var jt=Rt.posMatrix;y[0]===0&&y[1]===0||(jt=s.translatePosMatrix(Rt.posMatrix,Yt,y,M));var rr=L?zt.textCollisionBox:zt.iconCollisionBox,nr=zt.collisionCircleArray;if(nr.length>0){var zr=o.create(),pr=jt;o.mul(zr,zt.placementInvProjMatrix,s.transform.glCoordMatrix),o.mul(zr,zr,zt.placementViewportMatrix),Ge.push({circleArray:nr,circleOffset:et,transform:pr,invTransform:zr}),et=Ke+=nr.length/4}rr&&Te.draw(B,oe.LINES,ae.disabled,Ie.disabled,s.colorModeForRenderPass(),Ct.disabled,sl(jt,s.transform,Yt),n.id,rr.layoutVertexBuffer,rr.indexBuffer,rr.segments,null,s.transform.zoom,null,null,rr.collisionVertexBuffer)}}if(L&&Ge.length){var Ar=s.useProgram("collisionCircle"),wr=new o.StructArrayLayout2f1f2i16;wr.resize(4*Ke),wr._trim();for(var sn=0,$r=0,xn=Ge;$r<xn.length;$r+=1)for(var In=xn[$r],ei=0;ei<In.circleArray.length/4;ei++){var si=4*ei,Ii=In.circleArray[si+0],$i=In.circleArray[si+1],wn=In.circleArray[si+2],ui=In.circleArray[si+3];wr.emplace(sn++,Ii,$i,wn,ui,0),wr.emplace(sn++,Ii,$i,wn,ui,1),wr.emplace(sn++,Ii,$i,wn,ui,2),wr.emplace(sn++,Ii,$i,wn,ui,3)}(!_u||_u.length<2*Ke)&&(_u=function(no){var za=2*no,Mo=new o.StructArrayLayout3ui6;Mo.resize(za),Mo._trim();for(var _a=0;_a<za;_a++){var Ja=6*_a;Mo.uint16[Ja+0]=4*_a+0,Mo.uint16[Ja+1]=4*_a+1,Mo.uint16[Ja+2]=4*_a+2,Mo.uint16[Ja+3]=4*_a+2,Mo.uint16[Ja+4]=4*_a+3,Mo.uint16[Ja+5]=4*_a+0}return Mo}(Ke));for(var Si=B.createIndexBuffer(_u,!0),Hn=B.createVertexBuffer(wr,o.collisionCircleLayout.members,!0),Ei=0,ii=Ge;Ei<ii.length;Ei+=1){var Ni=ii[Ei],Hi=$u(Ni.transform,Ni.invTransform,s.transform);Ar.draw(B,oe.TRIANGLES,ae.disabled,Ie.disabled,s.colorModeForRenderPass(),Ct.disabled,Hi,n.id,Hn,Si,o.SegmentVector.simpleSegment(0,2*Ni.circleOffset,Ni.circleArray.length,Ni.circleArray.length/2),null,s.transform.zoom,null,null,null)}Hn.destroy(),Si.destroy()}}var qs=o.identity(new Float32Array(16));function Tf(s,i,n,l,y,M){var L=o.getAnchorAlignment(s),B=-(L.horizontalAlign-.5)*i,oe=-(L.verticalAlign-.5)*n,Te=o.evaluateVariableOffset(s,l);return new o.Point((B/y+Te[0])*M,(oe/y+Te[1])*M)}function Af(s,i,n,l,y,M,L,B,oe,Te,Ge){var Ke=s.text.placedSymbolArray,et=s.text.dynamicLayoutVertexArray,Ft=s.icon.dynamicLayoutVertexArray,Rt={};et.clear();for(var Yt=0;Yt<Ke.length;Yt++){var zt=Ke.get(Yt),jt=zt.hidden||!zt.crossTileID||s.allowVerticalPlacement&&!zt.placedOrientation?null:l[zt.crossTileID];if(jt){var rr=new o.Point(zt.anchorX,zt.anchorY),nr=bi(rr,n?B:L),zr=ci(M.cameraToCenterDistance,nr.signedDistanceFromCamera),pr=y.evaluateSizeForFeature(s.textSizeData,Te,zt)*zr/o.ONE_EM;n&&(pr*=s.tilePixelRatio/oe);for(var Ar=Tf(jt.anchor,jt.width,jt.height,jt.textOffset,jt.textBoxScale,pr),wr=n?bi(rr.add(Ar),L).point:nr.point.add(i?Ar.rotate(-M.angle):Ar),sn=s.allowVerticalPlacement&&zt.placedOrientation===o.WritingMode.vertical?Math.PI/2:0,$r=0;$r<zt.numGlyphs;$r++)o.addDynamicAttributes(et,wr,sn);Ge&&zt.associatedIconIndex>=0&&(Rt[zt.associatedIconIndex]={shiftedAnchor:wr,angle:sn})}else ca(zt.numGlyphs,et)}if(Ge){Ft.clear();for(var xn=s.icon.placedSymbolArray,In=0;In<xn.length;In++){var ei=xn.get(In);if(ei.hidden)ca(ei.numGlyphs,Ft);else{var si=Rt[In];if(si)for(var Ii=0;Ii<ei.numGlyphs;Ii++)o.addDynamicAttributes(Ft,si.shiftedAnchor,si.angle);else ca(ei.numGlyphs,Ft)}}s.icon.dynamicLayoutVertexBuffer.updateData(Ft)}s.text.dynamicLayoutVertexBuffer.updateData(et)}function of(s,i,n){return n.iconsInText&&i?"symbolTextAndIcon":s?"symbolSDF":"symbolIcon"}function Cl(s,i,n,l,y,M,L,B,oe,Te,Ge,Ke){for(var et=s.context,Ft=et.gl,Rt=s.transform,Yt=B==="map",zt=oe==="map",jt=Yt&&n.layout.get("symbol-placement")!=="point",rr=Yt&&!zt&&!jt,nr=n.layout.get("symbol-sort-key").constantOr(1)!==void 0,zr=!1,pr=s.depthModeForSublayer(0,ae.ReadOnly),Ar=n.layout.get("text-variable-anchor"),wr=[],sn=0,$r=l;sn<$r.length;sn+=1){var xn=$r[sn],In=i.getTile(xn),ei=In.getBucket(n);if(ei){var si=y?ei.text:ei.icon;if(si&&si.segments.get().length){var Ii=si.programConfigurations.get(n.id),$i=y||ei.sdfIcons,wn=y?ei.textSizeData:ei.iconSizeData,ui=zt||Rt.pitch!==0,Si=s.useProgram(of($i,y,ei),Ii),Hn=o.evaluateSizeForZoom(wn,Rt.zoom),Ei=void 0,ii=[0,0],Ni=void 0,Hi=void 0,no=null,za=void 0;if(y)Ni=In.glyphAtlasTexture,Hi=Ft.LINEAR,Ei=In.glyphAtlasTexture.size,ei.iconsInText&&(ii=In.imageAtlasTexture.size,no=In.imageAtlasTexture,za=ui||s.options.rotating||s.options.zooming||wn.kind==="composite"||wn.kind==="camera"?Ft.LINEAR:Ft.NEAREST);else{var Mo=n.layout.get("icon-size").constantOr(0)!==1||ei.iconsNeedLinear;Ni=In.imageAtlasTexture,Hi=$i||s.options.rotating||s.options.zooming||Mo||ui?Ft.LINEAR:Ft.NEAREST,Ei=In.imageAtlasTexture.size}var _a=sa(In,1,s.transform.zoom),Ja=Ta(xn.posMatrix,zt,Yt,s.transform,_a),Os=Di(xn.posMatrix,zt,Yt,s.transform,_a),Ls=Ar&&ei.hasTextData(),yu=n.layout.get("icon-text-fit")!=="none"&&Ls&&ei.hasIconData();jt&&ps(ei,xn.posMatrix,s,y,Ja,Os,zt,Te);var Fu=s.translatePosMatrix(xn.posMatrix,In,M,L),Ss=jt||y&&Ar||yu?qs:Ja,Bs=s.translatePosMatrix(Os,In,M,L,!0),Bu=$i&&n.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0,xu={program:Si,buffers:si,uniformValues:$i?ei.iconsInText?ac(wn.kind,Hn,rr,zt,s,Fu,Ss,Bs,Ei,ii):Vo(wn.kind,Hn,rr,zt,s,Fu,Ss,Bs,y,Ei,!0):Bl(wn.kind,Hn,rr,zt,s,Fu,Ss,Bs,y,Ei),atlasTexture:Ni,atlasTextureIcon:no,atlasInterpolation:Hi,atlasInterpolationIcon:za,isSDF:$i,hasHalo:Bu};if(nr&&ei.canOverlap){zr=!0;for(var qu=0,$l=si.segments.get();qu<$l.length;qu+=1){var ml=$l[qu];wr.push({segments:new o.SegmentVector([ml]),sortKey:ml.sortKey,state:xu})}}else wr.push({segments:si.segments,sortKey:0,state:xu})}}}zr&&wr.sort(function(Jl,Rs){return Jl.sortKey-Rs.sortKey});for(var iu=0,pc=wr;iu<pc.length;iu+=1){var bu=pc[iu],Eo=bu.state;if(et.activeTexture.set(Ft.TEXTURE0),Eo.atlasTexture.bind(Eo.atlasInterpolation,Ft.CLAMP_TO_EDGE),Eo.atlasTextureIcon&&(et.activeTexture.set(Ft.TEXTURE1),Eo.atlasTextureIcon&&Eo.atlasTextureIcon.bind(Eo.atlasInterpolationIcon,Ft.CLAMP_TO_EDGE)),Eo.isSDF){var gl=Eo.uniformValues;Eo.hasHalo&&(gl.u_is_halo=1,oc(Eo.buffers,bu.segments,n,s,Eo.program,pr,Ge,Ke,gl)),gl.u_is_halo=0}oc(Eo.buffers,bu.segments,n,s,Eo.program,pr,Ge,Ke,Eo.uniformValues)}}function oc(s,i,n,l,y,M,L,B,oe){var Te=l.context;y.draw(Te,Te.gl.TRIANGLES,M,L,B,Ct.disabled,oe,n.id,s.layoutVertexBuffer,s.indexBuffer,i,n.paint,l.transform.zoom,s.programConfigurations.get(n.id),s.dynamicLayoutVertexBuffer,s.opacityVertexBuffer)}function ll(s,i,n,l,y,M,L){var B,oe,Te,Ge,Ke,et=s.context.gl,Ft=n.paint.get("fill-pattern"),Rt=Ft&&Ft.constantOr(1),Yt=n.getCrossfadeParameters();L?(oe=Rt&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",B=et.LINES):(oe=Rt?"fillPattern":"fill",B=et.TRIANGLES);for(var zt=0,jt=l;zt<jt.length;zt+=1){var rr=jt[zt],nr=i.getTile(rr);if(!Rt||nr.patternsLoaded()){var zr=nr.getBucket(n);if(zr){var pr=zr.programConfigurations.get(n.id),Ar=s.useProgram(oe,pr);Rt&&(s.context.activeTexture.set(et.TEXTURE0),nr.imageAtlasTexture.bind(et.LINEAR,et.CLAMP_TO_EDGE),pr.updatePaintBuffers(Yt));var wr=Ft.constantOr(null);if(wr&&nr.imageAtlas){var sn=nr.imageAtlas,$r=sn.patternPositions[wr.to.toString()],xn=sn.patternPositions[wr.from.toString()];$r&&xn&&pr.setConstantPatternPositions($r,xn)}var In=s.translatePosMatrix(rr.posMatrix,nr,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(L){Ge=zr.indexBuffer2,Ke=zr.segments2;var ei=[et.drawingBufferWidth,et.drawingBufferHeight];Te=oe==="fillOutlinePattern"&&Rt?bc(In,s,Yt,nr,ei):kc(In,ei)}else Ge=zr.indexBuffer,Ke=zr.segments,Te=Rt?gs(In,s,Yt,nr):El(In);Ar.draw(s.context,B,y,s.stencilModeForClipping(rr),M,Ct.disabled,Te,n.id,zr.layoutVertexBuffer,Ge,Ke,n.paint,s.transform.zoom,pr)}}}}function Ul(s,i,n,l,y,M,L){for(var B=s.context,oe=B.gl,Te=n.paint.get("fill-extrusion-pattern"),Ge=Te.constantOr(1),Ke=n.getCrossfadeParameters(),et=n.paint.get("fill-extrusion-opacity"),Ft=0,Rt=l;Ft<Rt.length;Ft+=1){var Yt=Rt[Ft],zt=i.getTile(Yt),jt=zt.getBucket(n);if(jt){var rr=jt.programConfigurations.get(n.id),nr=s.useProgram(Ge?"fillExtrusionPattern":"fillExtrusion",rr);Ge&&(s.context.activeTexture.set(oe.TEXTURE0),zt.imageAtlasTexture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE),rr.updatePaintBuffers(Ke));var zr=Te.constantOr(null);if(zr&&zt.imageAtlas){var pr=zt.imageAtlas,Ar=pr.patternPositions[zr.to.toString()],wr=pr.patternPositions[zr.from.toString()];Ar&&wr&&rr.setConstantPatternPositions(Ar,wr)}var sn=s.translatePosMatrix(Yt.posMatrix,zt,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),$r=n.paint.get("fill-extrusion-vertical-gradient"),xn=Ge?wu(sn,s,$r,et,Yt,Ke,zt):ro(sn,s,$r,et);nr.draw(B,B.gl.TRIANGLES,y,M,L,Ct.backCCW,xn,n.id,jt.layoutVertexBuffer,jt.indexBuffer,jt.segments,n.paint,s.transform.zoom,rr)}}}function Ac(s,i,n,l,y,M){var L=s.context,B=L.gl,oe=i.fbo;if(oe){var Te=s.useProgram("hillshade");L.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,oe.colorAttachment.get());var Ge=function(Ke,et,Ft){var Rt=Ft.paint.get("hillshade-shadow-color"),Yt=Ft.paint.get("hillshade-highlight-color"),zt=Ft.paint.get("hillshade-accent-color"),jt=Ft.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ft.paint.get("hillshade-illumination-anchor")==="viewport"&&(jt-=Ke.transform.angle);var rr,nr,zr,pr=!Ke.options.moving;return{u_matrix:Ke.transform.calculatePosMatrix(et.tileID.toUnwrapped(),pr),u_image:0,u_latrange:(rr=et.tileID,nr=Math.pow(2,rr.canonical.z),zr=rr.canonical.y,[new o.MercatorCoordinate(0,zr/nr).toLngLat().lat,new o.MercatorCoordinate(0,(zr+1)/nr).toLngLat().lat]),u_light:[Ft.paint.get("hillshade-exaggeration"),jt],u_shadow:Rt,u_highlight:Yt,u_accent:zt}}(s,i,n);Te.draw(L,B.TRIANGLES,l,y,M,Ct.disabled,Ge,n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments)}}function Cc(s,i,n,l,y,M){var L=s.context,B=L.gl,oe=i.dem;if(oe&&oe.data){var Te=oe.dim,Ge=oe.stride,Ke=oe.getPixels();if(L.activeTexture.set(B.TEXTURE1),L.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||s.getTileTexture(Ge),i.demTexture){var et=i.demTexture;et.update(Ke,{premultiply:!1}),et.bind(B.NEAREST,B.CLAMP_TO_EDGE)}else i.demTexture=new o.Texture(L,Ke,B.RGBA,{premultiply:!1}),i.demTexture.bind(B.NEAREST,B.CLAMP_TO_EDGE);L.activeTexture.set(B.TEXTURE0);var Ft=i.fbo;if(!Ft){var Rt=new o.Texture(L,{width:Te,height:Te,data:null},B.RGBA);Rt.bind(B.LINEAR,B.CLAMP_TO_EDGE),(Ft=i.fbo=L.createFramebuffer(Te,Te,!0)).colorAttachment.set(Rt.texture)}L.bindFramebuffer.set(Ft.framebuffer),L.viewport.set([0,0,Te,Te]),s.useProgram("hillshadePrepare").draw(L,B.TRIANGLES,l,y,M,Ct.disabled,function(Yt,zt){var jt=zt.stride,rr=o.create();return o.ortho(rr,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(rr,rr,[0,-o.EXTENT,0]),{u_matrix:rr,u_image:1,u_dimension:[jt,jt],u_zoom:Yt.overscaledZ,u_unpack:zt.getUnpackVector()}}(i.tileID,oe),n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function Vl(s,i,n,l,y){var M=l.paint.get("raster-fade-duration");if(M>0){var L=o.browser.now(),B=(L-s.timeAdded)/M,oe=i?(L-i.timeAdded)/M:-1,Te=n.getSource(),Ge=y.coveringZoomLevel({tileSize:Te.tileSize,roundZoom:Te.roundZoom}),Ke=!i||Math.abs(i.tileID.overscaledZ-Ge)>Math.abs(s.tileID.overscaledZ-Ge),et=Ke&&s.refreshedUponExpiration?1:o.clamp(Ke?B:1-oe,0,1);return s.refreshedUponExpiration&&B>=1&&(s.refreshedUponExpiration=!1),i?{opacity:1,mix:1-et}:{opacity:et,mix:0}}return{opacity:1,mix:0}}var So=new o.Color(1,0,0,1),Ff=new o.Color(0,1,0,1),Cf=new o.Color(0,0,1,1),sc=new o.Color(1,0,1,1),Vc=new o.Color(0,1,1,1);function sf(s,i,n,l){Gl(s,0,i+n/2,s.transform.width,n,l)}function uf(s,i,n,l){Gl(s,i-n/2,0,n,s.transform.height,l)}function Gl(s,i,n,l,y,M){var L=s.context,B=L.gl;B.enable(B.SCISSOR_TEST),B.scissor(i*o.browser.devicePixelRatio,n*o.browser.devicePixelRatio,l*o.browser.devicePixelRatio,y*o.browser.devicePixelRatio),L.clear({color:M}),B.disable(B.SCISSOR_TEST)}function lf(s,i,n){var l=s.context,y=l.gl,M=n.posMatrix,L=s.useProgram("debug"),B=ae.disabled,oe=Ie.disabled,Te=s.colorModeForRenderPass();l.activeTexture.set(y.TEXTURE0),s.emptyTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),L.draw(l,y.LINE_STRIP,B,oe,Te,Ct.disabled,Qs(M,o.Color.red),"$debug",s.debugBuffer,s.tileBorderIndexBuffer,s.debugSegments);var Ge=i.getTileByID(n.key).latestRawTileData,Ke=Math.floor((Ge&&Ge.byteLength||0)/1024),et=i.getTile(n).tileSize,Ft=512/Math.min(et,512)*(n.overscaledZ/s.transform.zoom)*.5,Rt=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(Rt+=" => "+n.overscaledZ),function(Yt,zt){Yt.initDebugOverlayCanvas();var jt=Yt.debugOverlayCanvas,rr=Yt.context.gl,nr=Yt.debugOverlayCanvas.getContext("2d");nr.clearRect(0,0,jt.width,jt.height),nr.shadowColor="white",nr.shadowBlur=2,nr.lineWidth=1.5,nr.strokeStyle="white",nr.textBaseline="top",nr.font="bold 36px Open Sans, sans-serif",nr.fillText(zt,5,5),nr.strokeText(zt,5,5),Yt.debugOverlayTexture.update(jt),Yt.debugOverlayTexture.bind(rr.LINEAR,rr.CLAMP_TO_EDGE)}(s,Rt+" "+Ke+"kb"),L.draw(l,y.TRIANGLES,B,oe,qe.alphaBlended,Ct.disabled,Qs(M,o.Color.transparent,Ft),"$debug",s.debugBuffer,s.quadTriangleIndexBuffer,s.debugSegments)}var Mu={symbol:function(i,n,l,y,M){if(i.renderPass==="translucent"){var L=Ie.disabled,B=i.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(oe,Te,Ge,Ke,et,Ft,Rt){for(var Yt=Te.transform,zt=et==="map",jt=Ft==="map",rr=0,nr=oe;rr<nr.length;rr+=1){var zr=nr[rr],pr=Ke.getTile(zr),Ar=pr.getBucket(Ge);if(Ar&&Ar.text&&Ar.text.segments.get().length){var wr=o.evaluateSizeForZoom(Ar.textSizeData,Yt.zoom),sn=sa(pr,1,Te.transform.zoom),$r=Ta(zr.posMatrix,jt,zt,Te.transform,sn),xn=Ge.layout.get("icon-text-fit")!=="none"&&Ar.hasIconData();if(wr){var In=Math.pow(2,Yt.zoom-pr.tileID.overscaledZ);Af(Ar,zt,jt,Rt,o.symbolSize,Yt,$r,zr.posMatrix,In,wr,xn)}}}}(y,i,l,n,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),M),l.paint.get("icon-opacity").constantOr(1)!==0&&Cl(i,n,l,y,!1,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),l.layout.get("icon-rotation-alignment"),l.layout.get("icon-pitch-alignment"),l.layout.get("icon-keep-upright"),L,B),l.paint.get("text-opacity").constantOr(1)!==0&&Cl(i,n,l,y,!0,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),l.layout.get("text-keep-upright"),L,B),n.map.showCollisionBoxes&&(jl(i,n,l,y,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),jl(i,n,l,y,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))}},circle:function(i,n,l,y){if(i.renderPass==="translucent"){var M=l.paint.get("circle-opacity"),L=l.paint.get("circle-stroke-width"),B=l.paint.get("circle-stroke-opacity"),oe=l.layout.get("circle-sort-key").constantOr(1)!==void 0;if(M.constantOr(1)!==0||L.constantOr(1)!==0&&B.constantOr(1)!==0){for(var Te=i.context,Ge=Te.gl,Ke=i.depthModeForSublayer(0,ae.ReadOnly),et=Ie.disabled,Ft=i.colorModeForRenderPass(),Rt=[],Yt=0;Yt<y.length;Yt++){var zt=y[Yt],jt=n.getTile(zt),rr=jt.getBucket(l);if(rr){var nr=rr.programConfigurations.get(l.id),zr={programConfiguration:nr,program:i.useProgram("circle",nr),layoutVertexBuffer:rr.layoutVertexBuffer,indexBuffer:rr.indexBuffer,uniformValues:Tl(i,zt,jt,l)};if(oe)for(var pr=0,Ar=rr.segments.get();pr<Ar.length;pr+=1){var wr=Ar[pr];Rt.push({segments:new o.SegmentVector([wr]),sortKey:wr.sortKey,state:zr})}else Rt.push({segments:rr.segments,sortKey:0,state:zr})}}oe&&Rt.sort(function(ei,si){return ei.sortKey-si.sortKey});for(var sn=0,$r=Rt;sn<$r.length;sn+=1){var xn=$r[sn],In=xn.state;In.program.draw(Te,Ge.TRIANGLES,Ke,et,Ft,Ct.disabled,In.uniformValues,l.id,In.layoutVertexBuffer,In.indexBuffer,xn.segments,l.paint,i.transform.zoom,In.programConfiguration)}}}},heatmap:function(i,n,l,y){if(l.paint.get("heatmap-opacity")!==0)if(i.renderPass==="offscreen"){var M=i.context,L=M.gl,B=Ie.disabled,oe=new qe([L.ONE,L.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(Rt,Yt,zt){var jt=Rt.gl;Rt.activeTexture.set(jt.TEXTURE1),Rt.viewport.set([0,0,Yt.width/4,Yt.height/4]);var rr=zt.heatmapFbo;if(rr)jt.bindTexture(jt.TEXTURE_2D,rr.colorAttachment.get()),Rt.bindFramebuffer.set(rr.framebuffer);else{var nr=jt.createTexture();jt.bindTexture(jt.TEXTURE_2D,nr),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_WRAP_S,jt.CLAMP_TO_EDGE),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_WRAP_T,jt.CLAMP_TO_EDGE),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_MIN_FILTER,jt.LINEAR),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_MAG_FILTER,jt.LINEAR),rr=zt.heatmapFbo=Rt.createFramebuffer(Yt.width/4,Yt.height/4,!1),function(zr,pr,Ar,wr){var sn=zr.gl;sn.texImage2D(sn.TEXTURE_2D,0,sn.RGBA,pr.width/4,pr.height/4,0,sn.RGBA,zr.extRenderToTextureHalfFloat?zr.extTextureHalfFloat.HALF_FLOAT_OES:sn.UNSIGNED_BYTE,null),wr.colorAttachment.set(Ar)}(Rt,Yt,nr,rr)}})(M,i,l),M.clear({color:o.Color.transparent});for(var Te=0;Te<y.length;Te++){var Ge=y[Te];if(!n.hasRenderableParent(Ge)){var Ke=n.getTile(Ge),et=Ke.getBucket(l);if(et){var Ft=et.programConfigurations.get(l.id);i.useProgram("heatmap",Ft).draw(M,L.TRIANGLES,ae.disabled,B,oe,Ct.disabled,jc(Ge.posMatrix,Ke,i.transform.zoom,l.paint.get("heatmap-intensity")),l.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,l.paint,i.transform.zoom,Ft)}}}M.viewport.set([0,0,i.width,i.height])}else i.renderPass==="translucent"&&(i.context.setColorMode(i.colorModeForRenderPass()),function(Rt,Yt){var zt=Rt.context,jt=zt.gl,rr=Yt.heatmapFbo;if(rr){zt.activeTexture.set(jt.TEXTURE0),jt.bindTexture(jt.TEXTURE_2D,rr.colorAttachment.get()),zt.activeTexture.set(jt.TEXTURE1);var nr=Yt.colorRampTexture;nr||(nr=Yt.colorRampTexture=new o.Texture(zt,Yt.colorRamp,jt.RGBA)),nr.bind(jt.LINEAR,jt.CLAMP_TO_EDGE),Rt.useProgram("heatmapTexture").draw(zt,jt.TRIANGLES,ae.disabled,Ie.disabled,Rt.colorModeForRenderPass(),Ct.disabled,function(zr,pr,Ar,wr){var sn=o.create();o.ortho(sn,0,zr.width,zr.height,0,0,1);var $r=zr.context.gl;return{u_matrix:sn,u_world:[$r.drawingBufferWidth,$r.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:pr.paint.get("heatmap-opacity")}}(Rt,Yt),Yt.id,Rt.viewportBuffer,Rt.quadTriangleIndexBuffer,Rt.viewportSegments,Yt.paint,Rt.transform.zoom)}}(i,l))},line:function(i,n,l,y){if(i.renderPass==="translucent"){var M=l.paint.get("line-opacity"),L=l.paint.get("line-width");if(M.constantOr(1)!==0&&L.constantOr(1)!==0)for(var B=i.depthModeForSublayer(0,ae.ReadOnly),oe=i.colorModeForRenderPass(),Te=l.paint.get("line-dasharray"),Ge=l.paint.get("line-pattern"),Ke=Ge.constantOr(1),et=l.paint.get("line-gradient"),Ft=l.getCrossfadeParameters(),Rt=Ke?"linePattern":Te?"lineSDF":et?"lineGradient":"line",Yt=i.context,zt=Yt.gl,jt=!0,rr=0,nr=y;rr<nr.length;rr+=1){var zr=nr[rr],pr=n.getTile(zr);if(!Ke||pr.patternsLoaded()){var Ar=pr.getBucket(l);if(Ar){var wr=Ar.programConfigurations.get(l.id),sn=i.context.program.get(),$r=i.useProgram(Rt,wr),xn=jt||$r.program!==sn,In=Ge.constantOr(null);if(In&&pr.imageAtlas){var ei=pr.imageAtlas,si=ei.patternPositions[In.to.toString()],Ii=ei.patternPositions[In.from.toString()];si&&Ii&&wr.setConstantPatternPositions(si,Ii)}var $i=Ke?Uc(i,pr,l,Ft):Te?Ef(i,pr,l,Te,Ft):et?Pa(i,pr,l,Ar.lineClipsArray.length):Fl(i,pr,l);if(Ke)Yt.activeTexture.set(zt.TEXTURE0),pr.imageAtlasTexture.bind(zt.LINEAR,zt.CLAMP_TO_EDGE),wr.updatePaintBuffers(Ft);else if(Te&&(xn||i.lineAtlas.dirty))Yt.activeTexture.set(zt.TEXTURE0),i.lineAtlas.bind(Yt);else if(et){var wn=Ar.gradients[l.id],ui=wn.texture;if(l.gradientVersion!==wn.version){var Si=256;if(l.stepInterpolant){var Hn=n.getSource().maxzoom,Ei=zr.canonical.z===Hn?Math.ceil(1<<i.transform.maxZoom-zr.canonical.z):1;Si=o.clamp(o.nextPowerOfTwo(Ar.maxLineLength/o.EXTENT*1024*Ei),256,Yt.maxTextureSize)}wn.gradient=o.renderColorRamp({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:Si,image:wn.gradient||void 0,clips:Ar.lineClipsArray}),wn.texture?wn.texture.update(wn.gradient):wn.texture=new o.Texture(Yt,wn.gradient,zt.RGBA),wn.version=l.gradientVersion,ui=wn.texture}Yt.activeTexture.set(zt.TEXTURE0),ui.bind(l.stepInterpolant?zt.NEAREST:zt.LINEAR,zt.CLAMP_TO_EDGE)}$r.draw(Yt,zt.TRIANGLES,B,i.stencilModeForClipping(zr),oe,Ct.disabled,$i,l.id,Ar.layoutVertexBuffer,Ar.indexBuffer,Ar.segments,l.paint,i.transform.zoom,wr,Ar.layoutVertexBuffer2),jt=!1}}}}},fill:function(i,n,l,y){var M=l.paint.get("fill-color"),L=l.paint.get("fill-opacity");if(L.constantOr(1)!==0){var B=i.colorModeForRenderPass(),oe=l.paint.get("fill-pattern"),Te=i.opaquePassEnabledForLayer()&&!oe.constantOr(1)&&M.constantOr(o.Color.transparent).a===1&&L.constantOr(0)===1?"opaque":"translucent";if(i.renderPass===Te){var Ge=i.depthModeForSublayer(1,i.renderPass==="opaque"?ae.ReadWrite:ae.ReadOnly);ll(i,n,l,y,Ge,B,!1)}if(i.renderPass==="translucent"&&l.paint.get("fill-antialias")){var Ke=i.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,ae.ReadOnly);ll(i,n,l,y,Ke,B,!0)}}},"fill-extrusion":function(i,n,l,y){var M=l.paint.get("fill-extrusion-opacity");if(M!==0&&i.renderPass==="translucent"){var L=new ae(i.context.gl.LEQUAL,ae.ReadWrite,i.depthRangeFor3D);if(M!==1||l.paint.get("fill-extrusion-pattern").constantOr(1))Ul(i,n,l,y,L,Ie.disabled,qe.disabled),Ul(i,n,l,y,L,i.stencilModeFor3D(),i.colorModeForRenderPass());else{var B=i.colorModeForRenderPass();Ul(i,n,l,y,L,Ie.disabled,B)}}},hillshade:function(i,n,l,y){if(i.renderPass==="offscreen"||i.renderPass==="translucent"){for(var M=i.context,L=i.depthModeForSublayer(0,ae.ReadOnly),B=i.colorModeForRenderPass(),oe=i.renderPass==="translucent"?i.stencilConfigForOverlap(y):[{},y],Te=oe[0],Ge=0,Ke=oe[1];Ge<Ke.length;Ge+=1){var et=Ke[Ge],Ft=n.getTile(et);Ft.needsHillshadePrepare&&i.renderPass==="offscreen"?Cc(i,Ft,l,L,Ie.disabled,B):i.renderPass==="translucent"&&Ac(i,Ft,l,L,Te[et.overscaledZ],B)}M.viewport.set([0,0,i.width,i.height])}},raster:function(i,n,l,y){if(i.renderPass==="translucent"&&l.paint.get("raster-opacity")!==0&&y.length)for(var M=i.context,L=M.gl,B=n.getSource(),oe=i.useProgram("raster"),Te=i.colorModeForRenderPass(),Ge=B instanceof me?[{},y]:i.stencilConfigForOverlap(y),Ke=Ge[0],et=Ge[1],Ft=et[et.length-1].overscaledZ,Rt=!i.options.moving,Yt=0,zt=et;Yt<zt.length;Yt+=1){var jt=zt[Yt],rr=i.depthModeForSublayer(jt.overscaledZ-Ft,l.paint.get("raster-opacity")===1?ae.ReadWrite:ae.ReadOnly,L.LESS),nr=n.getTile(jt),zr=i.transform.calculatePosMatrix(jt.toUnwrapped(),Rt);nr.registerFadeDuration(l.paint.get("raster-fade-duration"));var pr=n.findLoadedParent(jt,0),Ar=Vl(nr,pr,n,l,i.transform),wr=void 0,sn=void 0,$r=l.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;M.activeTexture.set(L.TEXTURE0),nr.texture.bind($r,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),M.activeTexture.set(L.TEXTURE1),pr?(pr.texture.bind($r,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),wr=Math.pow(2,pr.tileID.overscaledZ-nr.tileID.overscaledZ),sn=[nr.tileID.canonical.x*wr%1,nr.tileID.canonical.y*wr%1]):nr.texture.bind($r,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST);var xn=ic(zr,sn||[0,0],wr||1,Ar,l);B instanceof me?oe.draw(M,L.TRIANGLES,rr,Ie.disabled,Te,Ct.disabled,xn,l.id,B.boundsBuffer,i.quadTriangleIndexBuffer,B.boundsSegments):oe.draw(M,L.TRIANGLES,rr,Ke[jt.overscaledZ],Te,Ct.disabled,xn,l.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments)}},background:function(i,n,l){var y=l.paint.get("background-color"),M=l.paint.get("background-opacity");if(M!==0){var L=i.context,B=L.gl,oe=i.transform,Te=oe.tileSize,Ge=l.paint.get("background-pattern");if(!i.isPatternMissing(Ge)){var Ke=!Ge&&y.a===1&&M===1&&i.opaquePassEnabledForLayer()?"opaque":"translucent";if(i.renderPass===Ke){var et=Ie.disabled,Ft=i.depthModeForSublayer(0,Ke==="opaque"?ae.ReadWrite:ae.ReadOnly),Rt=i.colorModeForRenderPass(),Yt=i.useProgram(Ge?"backgroundPattern":"background"),zt=oe.coveringTiles({tileSize:Te});Ge&&(L.activeTexture.set(B.TEXTURE0),i.imageManager.bind(i.context));for(var jt=l.getCrossfadeParameters(),rr=0,nr=zt;rr<nr.length;rr+=1){var zr=nr[rr],pr=i.transform.calculatePosMatrix(zr.toUnwrapped()),Ar=Ge?Al(pr,M,i,Ge,{tileID:zr,tileSize:Te},jt):kl(pr,M,y);Yt.draw(L,B.TRIANGLES,Ft,et,Rt,Ct.disabled,Ar,l.id,i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}}}},debug:function(i,n,l){for(var y=0;y<l.length;y++)lf(i,n,l[y])},custom:function(i,n,l){var y=i.context,M=l.implementation;if(i.renderPass==="offscreen"){var L=M.prerender;L&&(i.setCustomLayerDefaults(),y.setColorMode(i.colorModeForRenderPass()),L.call(M,y.gl,i.transform.customLayerMatrix()),y.setDirty(),i.setBaseState())}else if(i.renderPass==="translucent"){i.setCustomLayerDefaults(),y.setColorMode(i.colorModeForRenderPass()),y.setStencilMode(Ie.disabled);var B=M.renderingMode==="3d"?new ae(i.context.gl.LEQUAL,ae.ReadWrite,i.depthRangeFor3D):i.depthModeForSublayer(0,ae.ReadOnly);y.setDepthMode(B),M.render(y.gl,i.transform.customLayerMatrix()),y.setDirty(),i.setBaseState(),y.bindFramebuffer.set(null)}}},Ra=function(i,n){this.context=new Re(i),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=mt.maxUnderzooming+mt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new bo,this.gpuTimers={}};Ra.prototype.resize=function(s,i){if(this.width=s*o.browser.devicePixelRatio,this.height=i*o.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,l=this.style._order;n<l.length;n+=1)this.style._layers[l[n]].resize()},Ra.prototype.setup=function(){var s=this.context,i=new o.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(o.EXTENT,0),i.emplaceBack(0,o.EXTENT),i.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=s.createVertexBuffer(i,Ka.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);var n=new o.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(o.EXTENT,0),n.emplaceBack(0,o.EXTENT),n.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=s.createVertexBuffer(n,Ka.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);var l=new o.StructArrayLayout4i8;l.emplaceBack(0,0,0,0),l.emplaceBack(o.EXTENT,0,o.EXTENT,0),l.emplaceBack(0,o.EXTENT,0,o.EXTENT),l.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=s.createVertexBuffer(l,be.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);var y=new o.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(y,Ka.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);var M=new o.StructArrayLayout1ui2;M.emplaceBack(0),M.emplaceBack(1),M.emplaceBack(3),M.emplaceBack(2),M.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(M);var L=new o.StructArrayLayout3ui6;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(L),this.emptyTexture=new o.Texture(s,{width:1,height:1,data:new Uint8Array([0,0,0,0])},s.gl.RGBA);var B=this.context.gl;this.stencilClearMode=new Ie({func:B.ALWAYS,mask:0},0,255,B.ZERO,B.ZERO,B.ZERO)},Ra.prototype.clearStencil=function(){var s=this.context,i=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var n=o.create();o.ortho(n,0,this.width,this.height,0,0,1),o.scale(n,n,[i.drawingBufferWidth,i.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,i.TRIANGLES,ae.disabled,this.stencilClearMode,qe.disabled,Ct.disabled,Pu(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Ra.prototype._renderTileClippingMasks=function(s,i){if(this.currentStencilSource!==s.source&&s.isTileClipped()&&i&&i.length){this.currentStencilSource=s.source;var n=this.context,l=n.gl;this.nextStencilID+i.length>256&&this.clearStencil(),n.setColorMode(qe.disabled),n.setDepthMode(ae.disabled);var y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var M=0,L=i;M<L.length;M+=1){var B=L[M],oe=this._tileClippingMaskIDs[B.key]=this.nextStencilID++;y.draw(n,l.TRIANGLES,ae.disabled,new Ie({func:l.ALWAYS,mask:0},oe,255,l.KEEP,l.KEEP,l.REPLACE),qe.disabled,Ct.disabled,Pu(B.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Ra.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var s=this.nextStencilID++,i=this.context.gl;return new Ie({func:i.NOTEQUAL,mask:255},s,255,i.KEEP,i.KEEP,i.REPLACE)},Ra.prototype.stencilModeForClipping=function(s){var i=this.context.gl;return new Ie({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,i.KEEP,i.KEEP,i.REPLACE)},Ra.prototype.stencilConfigForOverlap=function(s){var i,n=this.context.gl,l=s.sort(function(oe,Te){return Te.overscaledZ-oe.overscaledZ}),y=l[l.length-1].overscaledZ,M=l[0].overscaledZ-y+1;if(M>1){this.currentStencilSource=void 0,this.nextStencilID+M>256&&this.clearStencil();for(var L={},B=0;B<M;B++)L[B+y]=new Ie({func:n.GEQUAL,mask:255},B+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=M,[L,l]}return[(i={},i[y]=Ie.disabled,i),l]},Ra.prototype.colorModeForRenderPass=function(){var s=this.context.gl;return this._showOverdrawInspector?new qe([s.CONSTANT_COLOR,s.ONE],new o.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?qe.unblended:qe.alphaBlended},Ra.prototype.depthModeForSublayer=function(s,i,n){if(!this.opaquePassEnabledForLayer())return ae.disabled;var l=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new ae(n||this.context.gl.LEQUAL,i,[l,l])},Ra.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Ra.prototype.render=function(s,i){var n=this;this.style=s,this.options=i,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(o.browser.now()),this.imageManager.beginFrame();var l=this.style._order,y=this.style.sourceCaches;for(var M in y){var L=y[M];L.used&&L.prepare(this.context)}var B,oe,Te={},Ge={},Ke={};for(var et in y){var Ft=y[et];Te[et]=Ft.getVisibleCoordinates(),Ge[et]=Te[et].slice().reverse(),Ke[et]=Ft.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Rt=0;Rt<l.length;Rt++)if(this.style._layers[l[Rt]].is3D()){this.opaquePassCutoff=Rt;break}this.renderPass="offscreen";for(var Yt=0,zt=l;Yt<zt.length;Yt+=1){var jt=this.style._layers[zt[Yt]];if(jt.hasOffscreenPass()&&!jt.isHidden(this.transform.zoom)){var rr=Ge[jt.source];(jt.type==="custom"||rr.length)&&this.renderLayer(this,y[jt.source],jt,rr)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){var nr=this.style._layers[l[this.currentLayer]],zr=y[nr.source],pr=Te[nr.source];this._renderTileClippingMasks(nr,pr),this.renderLayer(this,zr,nr,pr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){var Ar=this.style._layers[l[this.currentLayer]],wr=y[Ar.source],sn=(Ar.type==="symbol"?Ke:Ge)[Ar.source];this._renderTileClippingMasks(Ar,Te[Ar.source]),this.renderLayer(this,wr,Ar,sn)}this.options.showTileBoundaries&&(o.values(this.style._layers).forEach(function($r){$r.source&&!$r.isHidden(n.transform.zoom)&&($r.source!==(oe&&oe.id)&&(oe=n.style.sourceCaches[$r.source]),(!B||B.getSource().maxzoom<oe.getSource().maxzoom)&&(B=oe))}),B&&Mu.debug(this,B,B.getVisibleCoordinates())),this.options.showPadding&&function($r){var xn=$r.transform.padding;sf($r,$r.transform.height-(xn.top||0),3,So),sf($r,xn.bottom||0,3,Ff),uf($r,xn.left||0,3,Cf),uf($r,$r.transform.width-(xn.right||0),3,sc);var In=$r.transform.centerPoint;(function(ei,si,Ii,$i){Gl(ei,si-1,Ii-10,2,20,$i),Gl(ei,si-10,Ii-1,20,2,$i)})($r,In.x,$r.transform.height-In.y,Vc)}(this),this.context.setDefault()},Ra.prototype.renderLayer=function(s,i,n,l){n.isHidden(this.transform.zoom)||(n.type==="background"||n.type==="custom"||l.length)&&(this.id=n.id,this.gpuTimingStart(n),Mu[n.type](s,i,n,l,this.style.placement.variableOffsets),this.gpuTimingEnd())},Ra.prototype.gpuTimingStart=function(s){if(this.options.gpuTiming){var i=this.context.extTimerQuery,n=this.gpuTimers[s.id];n||(n=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:i.createQueryEXT()}),n.calls++,i.beginQueryEXT(i.TIME_ELAPSED_EXT,n.query)}},Ra.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var s=this.context.extTimerQuery;s.endQueryEXT(s.TIME_ELAPSED_EXT)}},Ra.prototype.collectGpuTimers=function(){var s=this.gpuTimers;return this.gpuTimers={},s},Ra.prototype.queryGpuTimers=function(s){var i={};for(var n in s){var l=s[n],y=this.context.extTimerQuery,M=y.getQueryObjectEXT(l.query,y.QUERY_RESULT_EXT)/1e6;y.deleteQueryEXT(l.query),i[n]=M}return i},Ra.prototype.translatePosMatrix=function(s,i,n,l,y){if(!n[0]&&!n[1])return s;var M=y?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(M){var L=Math.sin(M),B=Math.cos(M);n=[n[0]*B-n[1]*L,n[0]*L+n[1]*B]}var oe=[y?n[0]:sa(i,n[0],this.transform.zoom),y?n[1]:sa(i,n[1],this.transform.zoom),0],Te=new Float32Array(16);return o.translate(Te,s,oe),Te},Ra.prototype.saveTileTexture=function(s){var i=this._tileTextures[s.size[0]];i?i.push(s):this._tileTextures[s.size[0]]=[s]},Ra.prototype.getTileTexture=function(s){var i=this._tileTextures[s];return i&&i.length>0?i.pop():null},Ra.prototype.isPatternMissing=function(s){if(!s)return!1;if(!s.from||!s.to)return!0;var i=this.imageManager.getPattern(s.from.toString()),n=this.imageManager.getPattern(s.to.toString());return!i||!n},Ra.prototype.useProgram=function(s,i){this.cache=this.cache||{};var n=""+s+(i?i.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new Bc(this.context,s,Nc[s],i,Tc[s],this._showOverdrawInspector)),this.cache[n]},Ra.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Ra.prototype.setBaseState=function(){var s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)},Ra.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Ra.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var eu=function(i,n){this.points=i,this.planes=n};eu.fromInvProjectionMatrix=function(s,i,n){var l=Math.pow(2,n),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(L){return o.transformMat4([],L,s)}).map(function(L){return o.scale$1([],L,1/L[3]/i*l)}),M=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(L){var B=o.sub([],y[L[0]],y[L[1]]),oe=o.sub([],y[L[2]],y[L[1]]),Te=o.normalize([],o.cross([],B,oe)),Ge=-o.dot(Te,y[L[1]]);return Te.concat(Ge)});return new eu(y,M)};var Go=function(i,n){this.min=i,this.max=n,this.center=o.scale$2([],o.add([],this.min,this.max),.5)};Go.prototype.quadrant=function(s){for(var i=[s%2==0,s<2],n=o.clone$2(this.min),l=o.clone$2(this.max),y=0;y<i.length;y++)n[y]=i[y]?this.min[y]:this.center[y],l[y]=i[y]?this.center[y]:this.max[y];return l[2]=this.max[2],new Go(n,l)},Go.prototype.distanceX=function(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]},Go.prototype.distanceY=function(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]},Go.prototype.intersects=function(s){for(var i=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],n=!0,l=0;l<s.planes.length;l++){for(var y=s.planes[l],M=0,L=0;L<i.length;L++)M+=o.dot$1(y,i[L])>=0;if(M===0)return 0;M!==i.length&&(n=!1)}if(n)return 2;for(var B=0;B<3;B++){for(var oe=Number.MAX_VALUE,Te=-Number.MAX_VALUE,Ge=0;Ge<s.points.length;Ge++){var Ke=s.points[Ge][B]-this.min[B];oe=Math.min(oe,Ke),Te=Math.max(Te,Ke)}if(Te<0||oe>this.max[B]-this.min[B])return 0}return 1};var Iu=function(i,n,l,y){if(i===void 0&&(i=0),n===void 0&&(n=0),l===void 0&&(l=0),y===void 0&&(y=0),isNaN(i)||i<0||isNaN(n)||n<0||isNaN(l)||l<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=n,this.left=l,this.right=y};Iu.prototype.interpolate=function(s,i,n){return i.top!=null&&s.top!=null&&(this.top=o.number(s.top,i.top,n)),i.bottom!=null&&s.bottom!=null&&(this.bottom=o.number(s.bottom,i.bottom,n)),i.left!=null&&s.left!=null&&(this.left=o.number(s.left,i.left,n)),i.right!=null&&s.right!=null&&(this.right=o.number(s.right,i.right,n)),this},Iu.prototype.getCenter=function(s,i){var n=o.clamp((this.left+s-this.right)/2,0,s),l=o.clamp((this.top+i-this.bottom)/2,0,i);return new o.Point(n,l)},Iu.prototype.equals=function(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right},Iu.prototype.clone=function(){return new Iu(this.top,this.bottom,this.left,this.right)},Iu.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var ji=function(i,n,l,y,M){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=M===void 0||M,this._minZoom=i||0,this._maxZoom=n||22,this._minPitch=l==null?0:l,this._maxPitch=y==null?60:y,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Iu,this._posMatrixCache={},this._alignedPosMatrixCache={}},Da={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};ji.prototype.clone=function(){var s=new ji(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.tileSize=this.tileSize,s.latRange=this.latRange,s.width=this.width,s.height=this.height,s._center=this._center,s.zoom=this.zoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._calcMatrices(),s},Da.minZoom.get=function(){return this._minZoom},Da.minZoom.set=function(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))},Da.maxZoom.get=function(){return this._maxZoom},Da.maxZoom.set=function(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))},Da.minPitch.get=function(){return this._minPitch},Da.minPitch.set=function(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))},Da.maxPitch.get=function(){return this._maxPitch},Da.maxPitch.set=function(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))},Da.renderWorldCopies.get=function(){return this._renderWorldCopies},Da.renderWorldCopies.set=function(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s},Da.worldSize.get=function(){return this.tileSize*this.scale},Da.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Da.size.get=function(){return new o.Point(this.width,this.height)},Da.bearing.get=function(){return-this.angle/Math.PI*180},Da.bearing.set=function(s){var i=-o.wrap(s,-180,180)*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=o.create$2(),o.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Da.pitch.get=function(){return this._pitch/Math.PI*180},Da.pitch.set=function(s){var i=o.clamp(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())},Da.fov.get=function(){return this._fov/Math.PI*180},Da.fov.set=function(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())},Da.zoom.get=function(){return this._zoom},Da.zoom.set=function(s){var i=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==i&&(this._unmodified=!1,this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom,this._constrain(),this._calcMatrices())},Da.center.get=function(){return this._center},Da.center.set=function(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())},Da.padding.get=function(){return this._edgeInsets.toJSON()},Da.padding.set=function(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())},Da.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},ji.prototype.isPaddingEqual=function(s){return this._edgeInsets.equals(s)},ji.prototype.interpolatePadding=function(s,i,n){this._unmodified=!1,this._edgeInsets.interpolate(s,i,n),this._constrain(),this._calcMatrices()},ji.prototype.coveringZoomLevel=function(s){var i=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,i)},ji.prototype.getVisibleUnwrappedCoordinates=function(s){var i=[new o.UnwrappedTileID(0,s)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new o.Point(0,0)),l=this.pointCoordinate(new o.Point(this.width,0)),y=this.pointCoordinate(new o.Point(this.width,this.height)),M=this.pointCoordinate(new o.Point(0,this.height)),L=Math.floor(Math.min(n.x,l.x,y.x,M.x)),B=Math.floor(Math.max(n.x,l.x,y.x,M.x)),oe=L-1;oe<=B+1;oe++)oe!==0&&i.push(new o.UnwrappedTileID(oe,s));return i},ji.prototype.coveringTiles=function(s){var i=this.coveringZoomLevel(s),n=i;if(s.minzoom!==void 0&&i<s.minzoom)return[];s.maxzoom!==void 0&&i>s.maxzoom&&(i=s.maxzoom);var l=o.MercatorCoordinate.fromLngLat(this.center),y=Math.pow(2,i),M=[y*l.x,y*l.y,0],L=eu.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i),B=s.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(B=i);var oe=function(xn){return{aabb:new Go([xn*y,0,0],[(xn+1)*y,y,0]),zoom:0,x:0,y:0,wrap:xn,fullyVisible:!1}},Te=[],Ge=[],Ke=i,et=s.reparseOverscaled?n:i;if(this._renderWorldCopies)for(var Ft=1;Ft<=3;Ft++)Te.push(oe(-Ft)),Te.push(oe(Ft));for(Te.push(oe(0));Te.length>0;){var Rt=Te.pop(),Yt=Rt.x,zt=Rt.y,jt=Rt.fullyVisible;if(!jt){var rr=Rt.aabb.intersects(L);if(rr===0)continue;jt=rr===2}var nr=Rt.aabb.distanceX(M),zr=Rt.aabb.distanceY(M),pr=Math.max(Math.abs(nr),Math.abs(zr));if(Rt.zoom===Ke||pr>3+(1<<Ke-Rt.zoom)-2&&Rt.zoom>=B)Ge.push({tileID:new o.OverscaledTileID(Rt.zoom===Ke?et:Rt.zoom,Rt.wrap,Rt.zoom,Yt,zt),distanceSq:o.sqrLen([M[0]-.5-Yt,M[1]-.5-zt])});else for(var Ar=0;Ar<4;Ar++){var wr=(Yt<<1)+Ar%2,sn=(zt<<1)+(Ar>>1);Te.push({aabb:Rt.aabb.quadrant(Ar),zoom:Rt.zoom+1,x:wr,y:sn,wrap:Rt.wrap,fullyVisible:jt})}}return Ge.sort(function($r,xn){return $r.distanceSq-xn.distanceSq}).map(function($r){return $r.tileID})},ji.prototype.resize=function(s,i){this.width=s,this.height=i,this.pixelsToGLUnits=[2/s,-2/i],this._constrain(),this._calcMatrices()},Da.unmodified.get=function(){return this._unmodified},ji.prototype.zoomScale=function(s){return Math.pow(2,s)},ji.prototype.scaleZoom=function(s){return Math.log(s)/Math.LN2},ji.prototype.project=function(s){var i=o.clamp(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.Point(o.mercatorXfromLng(s.lng)*this.worldSize,o.mercatorYfromLat(i)*this.worldSize)},ji.prototype.unproject=function(s){return new o.MercatorCoordinate(s.x/this.worldSize,s.y/this.worldSize).toLngLat()},Da.point.get=function(){return this.project(this.center)},ji.prototype.setLocationAtPoint=function(s,i){var n=this.pointCoordinate(i),l=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(s),M=new o.MercatorCoordinate(y.x-(n.x-l.x),y.y-(n.y-l.y));this.center=this.coordinateLocation(M),this._renderWorldCopies&&(this.center=this.center.wrap())},ji.prototype.locationPoint=function(s){return this.coordinatePoint(this.locationCoordinate(s))},ji.prototype.pointLocation=function(s){return this.coordinateLocation(this.pointCoordinate(s))},ji.prototype.locationCoordinate=function(s){return o.MercatorCoordinate.fromLngLat(s)},ji.prototype.coordinateLocation=function(s){return s.toLngLat()},ji.prototype.pointCoordinate=function(s){var i=[s.x,s.y,0,1],n=[s.x,s.y,1,1];o.transformMat4(i,i,this.pixelMatrixInverse),o.transformMat4(n,n,this.pixelMatrixInverse);var l=i[3],y=n[3],M=i[1]/l,L=n[1]/y,B=i[2]/l,oe=n[2]/y,Te=B===oe?0:(0-B)/(oe-B);return new o.MercatorCoordinate(o.number(i[0]/l,n[0]/y,Te)/this.worldSize,o.number(M,L,Te)/this.worldSize)},ji.prototype.coordinatePoint=function(s){var i=[s.x*this.worldSize,s.y*this.worldSize,0,1];return o.transformMat4(i,i,this.pixelMatrix),new o.Point(i[0]/i[3],i[1]/i[3])},ji.prototype.getBounds=function(){return new o.LngLatBounds().extend(this.pointLocation(new o.Point(0,0))).extend(this.pointLocation(new o.Point(this.width,0))).extend(this.pointLocation(new o.Point(this.width,this.height))).extend(this.pointLocation(new o.Point(0,this.height)))},ji.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},ji.prototype.setMaxBounds=function(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},ji.prototype.calculatePosMatrix=function(s,i){i===void 0&&(i=!1);var n=s.key,l=i?this._alignedPosMatrixCache:this._posMatrixCache;if(l[n])return l[n];var y=s.canonical,M=this.worldSize/this.zoomScale(y.z),L=y.x+Math.pow(2,y.z)*s.wrap,B=o.identity(new Float64Array(16));return o.translate(B,B,[L*M,y.y*M,0]),o.scale(B,B,[M/o.EXTENT,M/o.EXTENT,1]),o.multiply(B,i?this.alignedProjMatrix:this.projMatrix,B),l[n]=new Float32Array(B),l[n]},ji.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},ji.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var s,i,n,l,y=-90,M=90,L=-180,B=180,oe=this.size,Te=this._unmodified;if(this.latRange){var Ge=this.latRange;y=o.mercatorYfromLat(Ge[1])*this.worldSize,s=(M=o.mercatorYfromLat(Ge[0])*this.worldSize)-y<oe.y?oe.y/(M-y):0}if(this.lngRange){var Ke=this.lngRange;L=o.mercatorXfromLng(Ke[0])*this.worldSize,i=(B=o.mercatorXfromLng(Ke[1])*this.worldSize)-L<oe.x?oe.x/(B-L):0}var et=this.point,Ft=Math.max(i||0,s||0);if(Ft)return this.center=this.unproject(new o.Point(i?(B+L)/2:et.x,s?(M+y)/2:et.y)),this.zoom+=this.scaleZoom(Ft),this._unmodified=Te,void(this._constraining=!1);if(this.latRange){var Rt=et.y,Yt=oe.y/2;Rt-Yt<y&&(l=y+Yt),Rt+Yt>M&&(l=M-Yt)}if(this.lngRange){var zt=et.x,jt=oe.x/2;zt-jt<L&&(n=L+jt),zt+jt>B&&(n=B-jt)}n===void 0&&l===void 0||(this.center=this.unproject(new o.Point(n!==void 0?n:et.x,l!==void 0?l:et.y))),this._unmodified=Te,this._constraining=!1}},ji.prototype._calcMatrices=function(){if(this.height){var s=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var i=Math.PI/2+this._pitch,n=this._fov*(.5+s.y/this.height),l=Math.sin(n)*this.cameraToCenterDistance/Math.sin(o.clamp(Math.PI-i-n,.01,Math.PI-.01)),y=this.point,M=y.x,L=y.y,B=1.01*(Math.cos(Math.PI/2-this._pitch)*l+this.cameraToCenterDistance),oe=this.height/50,Te=new Float64Array(16);o.perspective(Te,this._fov,this.width/this.height,oe,B),Te[8]=2*-s.x/this.width,Te[9]=2*s.y/this.height,o.scale(Te,Te,[1,-1,1]),o.translate(Te,Te,[0,0,-this.cameraToCenterDistance]),o.rotateX(Te,Te,this._pitch),o.rotateZ(Te,Te,this.angle),o.translate(Te,Te,[-M,-L,0]),this.mercatorMatrix=o.scale([],Te,[this.worldSize,this.worldSize,this.worldSize]),o.scale(Te,Te,[1,1,o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Te,this.invProjMatrix=o.invert([],this.projMatrix);var Ge=this.width%2/2,Ke=this.height%2/2,et=Math.cos(this.angle),Ft=Math.sin(this.angle),Rt=M-Math.round(M)+et*Ge+Ft*Ke,Yt=L-Math.round(L)+et*Ke+Ft*Ge,zt=new Float64Array(Te);if(o.translate(zt,zt,[Rt>.5?Rt-1:Rt,Yt>.5?Yt-1:Yt,0]),this.alignedProjMatrix=zt,Te=o.create(),o.scale(Te,Te,[this.width/2,-this.height/2,1]),o.translate(Te,Te,[1,-1,0]),this.labelPlaneMatrix=Te,Te=o.create(),o.scale(Te,Te,[1,-1,1]),o.translate(Te,Te,[-1,-1,0]),o.scale(Te,Te,[2/this.width,2/this.height,1]),this.glCoordMatrix=Te,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Te=o.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Te,this._posMatrixCache={},this._alignedPosMatrixCache={}}},ji.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var s=this.pointCoordinate(new o.Point(0,0)),i=[s.x*this.worldSize,s.y*this.worldSize,0,1];return o.transformMat4(i,i,this.pixelMatrix)[3]/this.cameraToCenterDistance},ji.prototype.getCameraPoint=function(){var s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.Point(0,s))},ji.prototype.getCameraQueryGeometry=function(s){var i=this.getCameraPoint();if(s.length===1)return[s[0],i];for(var n=i.x,l=i.y,y=i.x,M=i.y,L=0,B=s;L<B.length;L+=1){var oe=B[L];n=Math.min(n,oe.x),l=Math.min(l,oe.y),y=Math.max(y,oe.x),M=Math.max(M,oe.y)}return[new o.Point(n,l),new o.Point(y,l),new o.Point(y,M),new o.Point(n,M),new o.Point(n,l)]},Object.defineProperties(ji.prototype,Da);var js=function(i){var n,l,y,M;this._hashName=i&&encodeURIComponent(i),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),l=!1,y=null,M=function(){y=null,l&&(n(),y=setTimeout(M,300),l=!1)},function(){return l=!0,y||M(),y})};js.prototype.addTo=function(s){return this._map=s,o.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},js.prototype.remove=function(){return o.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},js.prototype.getHashString=function(s){var i=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,l=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,l),M=Math.round(i.lng*y)/y,L=Math.round(i.lat*y)/y,B=this._map.getBearing(),oe=this._map.getPitch(),Te="";if(Te+=s?"/"+M+"/"+L+"/"+n:n+"/"+L+"/"+M,(B||oe)&&(Te+="/"+Math.round(10*B)/10),oe&&(Te+="/"+Math.round(oe)),this._hashName){var Ge=this._hashName,Ke=!1,et=o.window.location.hash.slice(1).split("&").map(function(Ft){var Rt=Ft.split("=")[0];return Rt===Ge?(Ke=!0,Rt+"="+Te):Ft}).filter(function(Ft){return Ft});return Ke||et.push(Ge+"="+Te),"#"+et.join("&")}return"#"+Te},js.prototype._getCurrentHash=function(){var s,i=this,n=o.window.location.hash.replace("#","");return this._hashName?(n.split("&").map(function(l){return l.split("=")}).forEach(function(l){l[0]===i._hashName&&(s=l)}),(s&&s[1]||"").split("/")):n.split("/")},js.prototype._onHashChange=function(){var s=this._getCurrentHash();if(s.length>=3&&!s.some(function(n){return isNaN(n)})){var i=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:i,pitch:+(s[4]||0)}),!0}return!1},js.prototype._updateHashUnthrottled=function(){var s=o.window.location.href.replace(/(#.+)?$/,this.getHashString());try{o.window.history.replaceState(o.window.history.state,null,s)}catch(i){}};var tu={linearity:.3,easing:o.bezier(0,0,.3,1)},Hl=o.extend({deceleration:2500,maxSpeed:1400},tu),uc=o.extend({deceleration:20,maxSpeed:1400},tu),wf=o.extend({deceleration:1e3,maxSpeed:360},tu),zo=o.extend({deceleration:1e3,maxSpeed:90},tu),Zl=function(i){this._map=i,this.clear()};function ya(s,i){(!s.duration||s.duration<i.duration)&&(s.duration=i.duration,s.easing=i.easing)}function Ki(s,i,n){var l=n.maxSpeed,y=n.linearity,M=n.deceleration,L=o.clamp(s*y/(i/1e3),-l,l),B=Math.abs(L)/(M*y);return{easing:n.easing,duration:1e3*B,amount:L*(B/2)}}Zl.prototype.clear=function(){this._inertiaBuffer=[]},Zl.prototype.record=function(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.browser.now(),settings:s})},Zl.prototype._drainInertiaBuffer=function(){for(var s=this._inertiaBuffer,i=o.browser.now();s.length>0&&i-s[0].time>160;)s.shift()},Zl.prototype._onMoveEnd=function(s){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var i={zoom:0,bearing:0,pitch:0,pan:new o.Point(0,0),pinchAround:void 0,around:void 0},n=0,l=this._inertiaBuffer;n<l.length;n+=1){var y=l[n].settings;i.zoom+=y.zoomDelta||0,i.bearing+=y.bearingDelta||0,i.pitch+=y.pitchDelta||0,y.panDelta&&i.pan._add(y.panDelta),y.around&&(i.around=y.around),y.pinchAround&&(i.pinchAround=y.pinchAround)}var M=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,L={};if(i.pan.mag()){var B=Ki(i.pan.mag(),M,o.extend({},Hl,s||{}));L.offset=i.pan.mult(B.amount/i.pan.mag()),L.center=this._map.transform.center,ya(L,B)}if(i.zoom){var oe=Ki(i.zoom,M,uc);L.zoom=this._map.transform.zoom+oe.amount,ya(L,oe)}if(i.bearing){var Te=Ki(i.bearing,M,wf);L.bearing=this._map.transform.bearing+o.clamp(Te.amount,-179,179),ya(L,Te)}if(i.pitch){var Ge=Ki(i.pitch,M,zo);L.pitch=this._map.transform.pitch+Ge.amount,ya(L,Ge)}if(L.zoom||L.bearing){var Ke=i.pinchAround===void 0?i.around:i.pinchAround;L.around=Ke?this._map.unproject(Ke):this._map.getCenter()}return this.clear(),o.extend(L,{noMoveStart:!0})}};var fo=function(s){function i(l,y,M,L){L===void 0&&(L={});var B=F.mousePos(y.getCanvasContainer(),M),oe=y.unproject(B);s.call(this,l,o.extend({point:B,lngLat:oe,originalEvent:M},L)),this._defaultPrevented=!1,this.target=y}s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i;var n={defaultPrevented:{configurable:!0}};return i.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,n),i}(o.Event),ys=function(s){function i(l,y,M){var L=l==="touchend"?M.changedTouches:M.touches,B=F.touchPos(y.getCanvasContainer(),L),oe=B.map(function(Ke){return y.unproject(Ke)}),Te=B.reduce(function(Ke,et,Ft,Rt){return Ke.add(et.div(Rt.length))},new o.Point(0,0)),Ge=y.unproject(Te);s.call(this,l,{points:B,point:Te,lngLats:oe,lngLat:Ge,originalEvent:M}),this._defaultPrevented=!1}s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i;var n={defaultPrevented:{configurable:!0}};return i.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,n),i}(o.Event),wl=function(s){function i(l,y,M){s.call(this,l,{originalEvent:M}),this._defaultPrevented=!1}s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i;var n={defaultPrevented:{configurable:!0}};return i.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(i.prototype,n),i}(o.Event),$a=function(i,n){this._map=i,this._clickTolerance=n.clickTolerance};$a.prototype.reset=function(){delete this._mousedownPos},$a.prototype.wheel=function(s){return this._firePreventable(new wl(s.type,this._map,s))},$a.prototype.mousedown=function(s,i){return this._mousedownPos=i,this._firePreventable(new fo(s.type,this._map,s))},$a.prototype.mouseup=function(s){this._map.fire(new fo(s.type,this._map,s))},$a.prototype.click=function(s,i){this._mousedownPos&&this._mousedownPos.dist(i)>=this._clickTolerance||this._map.fire(new fo(s.type,this._map,s))},$a.prototype.dblclick=function(s){return this._firePreventable(new fo(s.type,this._map,s))},$a.prototype.mouseover=function(s){this._map.fire(new fo(s.type,this._map,s))},$a.prototype.mouseout=function(s){this._map.fire(new fo(s.type,this._map,s))},$a.prototype.touchstart=function(s){return this._firePreventable(new ys(s.type,this._map,s))},$a.prototype.touchmove=function(s){this._map.fire(new ys(s.type,this._map,s))},$a.prototype.touchend=function(s){this._map.fire(new ys(s.type,this._map,s))},$a.prototype.touchcancel=function(s){this._map.fire(new ys(s.type,this._map,s))},$a.prototype._firePreventable=function(s){if(this._map.fire(s),s.defaultPrevented)return{}},$a.prototype.isEnabled=function(){return!0},$a.prototype.isActive=function(){return!1},$a.prototype.enable=function(){},$a.prototype.disable=function(){};var Mn=function(i){this._map=i};Mn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Mn.prototype.mousemove=function(s){this._map.fire(new fo(s.type,this._map,s))},Mn.prototype.mousedown=function(){this._delayContextMenu=!0},Mn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new fo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Mn.prototype.contextmenu=function(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new fo(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()},Mn.prototype.isEnabled=function(){return!0},Mn.prototype.isActive=function(){return!1},Mn.prototype.enable=function(){},Mn.prototype.disable=function(){};var zs=function(i,n){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=n.clickTolerance||1};function wc(s,i){for(var n={},l=0;l<s.length;l++)n[s[l].identifier]=i[l];return n}zs.prototype.isEnabled=function(){return!!this._enabled},zs.prototype.isActive=function(){return!!this._active},zs.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},zs.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},zs.prototype.mousedown=function(s,i){this.isEnabled()&&s.shiftKey&&s.button===0&&(F.disableDrag(),this._startPos=this._lastPos=i,this._active=!0)},zs.prototype.mousemoveWindow=function(s,i){if(this._active){var n=i;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var l=this._startPos;this._lastPos=n,this._box||(this._box=F.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));var y=Math.min(l.x,n.x),M=Math.max(l.x,n.x),L=Math.min(l.y,n.y),B=Math.max(l.y,n.y);F.setTransform(this._box,"translate("+y+"px,"+L+"px)"),this._box.style.width=M-y+"px",this._box.style.height=B-L+"px"}}},zs.prototype.mouseupWindow=function(s,i){var n=this;if(this._active&&s.button===0){var l=this._startPos,y=i;if(this.reset(),F.suppressClick(),l.x!==y.x||l.y!==y.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:s})),{cameraAnimation:function(L){return L.fitScreenCoordinates(l,y,n._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",s)}},zs.prototype.keydown=function(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))},zs.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(F.remove(this._box),this._box=null),F.enableDrag(),delete this._startPos,delete this._lastPos},zs.prototype._fireEvent=function(s,i){return this._map.fire(new o.Event(s,{originalEvent:i}))};var cl=function(i){this.reset(),this.numTouches=i.numTouches};cl.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},cl.prototype.touchstart=function(s,i,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),n.length===this.numTouches&&(this.centroid=function(l){for(var y=new o.Point(0,0),M=0,L=l;M<L.length;M+=1)y._add(L[M]);return y.div(l.length)}(i),this.touches=wc(n,i)))},cl.prototype.touchmove=function(s,i,n){if(!this.aborted&&this.centroid){var l=wc(n,i);for(var y in this.touches){var M=l[y];(!M||M.dist(this.touches[y])>30)&&(this.aborted=!0)}}},cl.prototype.touchend=function(s,i,n){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),n.length===0){var l=!this.aborted&&this.centroid;if(this.reset(),l)return l}};var vu=function(i){this.singleTap=new cl(i),this.numTaps=i.numTaps,this.reset()};vu.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},vu.prototype.touchstart=function(s,i,n){this.singleTap.touchstart(s,i,n)},vu.prototype.touchmove=function(s,i,n){this.singleTap.touchmove(s,i,n)},vu.prototype.touchend=function(s,i,n){var l=this.singleTap.touchend(s,i,n);if(l){var y=s.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(l)<30;if(y&&M||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}};var Us=function(){this._zoomIn=new vu({numTouches:1,numTaps:2}),this._zoomOut=new vu({numTouches:2,numTaps:1}),this.reset()};Us.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Us.prototype.touchstart=function(s,i,n){this._zoomIn.touchstart(s,i,n),this._zoomOut.touchstart(s,i,n)},Us.prototype.touchmove=function(s,i,n){this._zoomIn.touchmove(s,i,n),this._zoomOut.touchmove(s,i,n)},Us.prototype.touchend=function(s,i,n){var l=this,y=this._zoomIn.touchend(s,i,n),M=this._zoomOut.touchend(s,i,n);return y?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(B){return B.easeTo({duration:300,zoom:B.getZoom()+1,around:B.unproject(y)},{originalEvent:s})}}):M?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(B){return B.easeTo({duration:300,zoom:B.getZoom()-1,around:B.unproject(M)},{originalEvent:s})}}):void 0},Us.prototype.touchcancel=function(){this.reset()},Us.prototype.enable=function(){this._enabled=!0},Us.prototype.disable=function(){this._enabled=!1,this.reset()},Us.prototype.isEnabled=function(){return this._enabled},Us.prototype.isActive=function(){return this._active};var Ou={0:1,2:2},an=function(i){this.reset(),this._clickTolerance=i.clickTolerance||1};an.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},an.prototype._correctButton=function(s,i){return!1},an.prototype._move=function(s,i){return{}},an.prototype.mousedown=function(s,i){if(!this._lastPoint){var n=F.mouseButton(s);this._correctButton(s,n)&&(this._lastPoint=i,this._eventButton=n)}},an.prototype.mousemoveWindow=function(s,i){var n=this._lastPoint;if(n){if(s.preventDefault(),function(l,y){var M=Ou[y];return l.buttons===void 0||(l.buttons&M)!==M}(s,this._eventButton))this.reset();else if(this._moved||!(i.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=i,this._move(n,i)}},an.prototype.mouseupWindow=function(s){this._lastPoint&&F.mouseButton(s)===this._eventButton&&(this._moved&&F.suppressClick(),this.reset())},an.prototype.enable=function(){this._enabled=!0},an.prototype.disable=function(){this._enabled=!1,this.reset()},an.prototype.isEnabled=function(){return this._enabled},an.prototype.isActive=function(){return this._active};var Gc=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.mousedown=function(n,l){s.prototype.mousedown.call(this,n,l),this._lastPoint&&(this._active=!0)},i.prototype._correctButton=function(n,l){return l===0&&!n.ctrlKey},i.prototype._move=function(n,l){return{around:l,panDelta:l.sub(n)}},i}(an),lc=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},i.prototype._move=function(n,l){var y=.8*(l.x-n.x);if(y)return this._active=!0,{bearingDelta:y}},i.prototype.contextmenu=function(n){n.preventDefault()},i}(an),Wl=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},i.prototype._move=function(n,l){var y=-.5*(l.y-n.y);if(y)return this._active=!0,{pitchDelta:y}},i.prototype.contextmenu=function(n){n.preventDefault()},i}(an),mu=function(i){this._minTouches=1,this._clickTolerance=i.clickTolerance||1,this.reset()};mu.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new o.Point(0,0)},mu.prototype.touchstart=function(s,i,n){return this._calculateTransform(s,i,n)},mu.prototype.touchmove=function(s,i,n){if(this._active&&!(n.length<this._minTouches))return s.preventDefault(),this._calculateTransform(s,i,n)},mu.prototype.touchend=function(s,i,n){this._calculateTransform(s,i,n),this._active&&n.length<this._minTouches&&this.reset()},mu.prototype.touchcancel=function(){this.reset()},mu.prototype._calculateTransform=function(s,i,n){n.length>0&&(this._active=!0);var l=wc(n,i),y=new o.Point(0,0),M=new o.Point(0,0),L=0;for(var B in l){var oe=l[B],Te=this._touches[B];Te&&(y._add(oe),M._add(oe.sub(Te)),L++,l[B]=oe)}if(this._touches=l,!(L<this._minTouches)&&M.mag()){var Ge=M.div(L);if(this._sum._add(Ge),!(this._sum.mag()<this._clickTolerance))return{around:y.div(L),panDelta:Ge}}},mu.prototype.enable=function(){this._enabled=!0},mu.prototype.disable=function(){this._enabled=!1,this.reset()},mu.prototype.isEnabled=function(){return this._enabled},mu.prototype.isActive=function(){return this._active};var Gi=function(){this.reset()};function cf(s,i,n){for(var l=0;l<s.length;l++)if(s[l].identifier===n)return i[l]}function ff(s,i){return Math.log(s/i)/Math.LN2}Gi.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Gi.prototype._start=function(s){},Gi.prototype._move=function(s,i,n){return{}},Gi.prototype.touchstart=function(s,i,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([i[0],i[1]]))},Gi.prototype.touchmove=function(s,i,n){if(this._firstTwoTouches){s.preventDefault();var l=this._firstTwoTouches,y=l[1],M=cf(n,i,l[0]),L=cf(n,i,y);if(M&&L){var B=this._aroundCenter?null:M.add(L).div(2);return this._move([M,L],B,s)}}},Gi.prototype.touchend=function(s,i,n){if(this._firstTwoTouches){var l=this._firstTwoTouches,y=l[1],M=cf(n,i,l[0]),L=cf(n,i,y);M&&L||(this._active&&F.suppressClick(),this.reset())}},Gi.prototype.touchcancel=function(){this.reset()},Gi.prototype.enable=function(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"},Gi.prototype.disable=function(){this._enabled=!1,this.reset()},Gi.prototype.isEnabled=function(){return this._enabled},Gi.prototype.isActive=function(){return this._active};var Vs=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.reset=function(){s.prototype.reset.call(this),delete this._distance,delete this._startDistance},i.prototype._start=function(n){this._startDistance=this._distance=n[0].dist(n[1])},i.prototype._move=function(n,l){var y=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(ff(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ff(this._distance,y),pinchAround:l}},i}(Gi);function fl(s,i){return 180*s.angleWith(i)/Math.PI}var Hc=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.reset=function(){s.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},i.prototype._start=function(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])},i.prototype._move=function(n,l){var y=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:fl(this._vector,y),pinchAround:l}},i.prototype._isBelowThreshold=function(n){this._minDiameter=Math.min(this._minDiameter,n.mag());var l=25/(Math.PI*this._minDiameter)*360,y=fl(n,this._startVector);return Math.abs(y)<l},i}(Gi);function Xl(s){return Math.abs(s.y)>Math.abs(s.x)}var Ns=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.reset=function(){s.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},i.prototype._start=function(n){this._lastPoints=n,Xl(n[0].sub(n[1]))&&(this._valid=!1)},i.prototype._move=function(n,l,y){var M=n[0].sub(this._lastPoints[0]),L=n[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(M,L,y.timeStamp),this._valid)return this._lastPoints=n,this._active=!0,{pitchDelta:(M.y+L.y)/2*-.5}},i.prototype.gestureBeginsVertically=function(n,l,y){if(this._valid!==void 0)return this._valid;var M=n.mag()>=2,L=l.mag()>=2;if(M||L){if(!M||!L)return this._firstMove===void 0&&(this._firstMove=y),y-this._firstMove<100&&void 0;var B=n.y>0==l.y>0;return Xl(n)&&Xl(l)&&B}},i}(Gi),Ho={panStep:100,bearingStep:15,pitchStep:10},ss=function(){var i=Ho;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1};function us(s){return s*(2-s)}ss.prototype.reset=function(){this._active=!1},ss.prototype.keydown=function(s){var i=this;if(!(s.altKey||s.ctrlKey||s.metaKey)){var n=0,l=0,y=0,M=0,L=0;switch(s.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:s.shiftKey?l=-1:(s.preventDefault(),M=-1);break;case 39:s.shiftKey?l=1:(s.preventDefault(),M=1);break;case 38:s.shiftKey?y=1:(s.preventDefault(),L=-1);break;case 40:s.shiftKey?y=-1:(s.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(l=0,y=0),{cameraAnimation:function(oe){var Te=oe.getZoom();oe.easeTo({duration:300,easeId:"keyboardHandler",easing:us,zoom:n?Math.round(Te)+n*(s.shiftKey?2:1):Te,bearing:oe.getBearing()+l*i._bearingStep,pitch:oe.getPitch()+y*i._pitchStep,offset:[-M*i._panStep,-L*i._panStep],center:oe.getCenter()},{originalEvent:s})}}}},ss.prototype.enable=function(){this._enabled=!0},ss.prototype.disable=function(){this._enabled=!1,this.reset()},ss.prototype.isEnabled=function(){return this._enabled},ss.prototype.isActive=function(){return this._active},ss.prototype.disableRotation=function(){this._rotationDisabled=!0},ss.prototype.enableRotation=function(){this._rotationDisabled=!1};var Ti=function(i,n){this._map=i,this._el=i.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,o.bindAll(["_onTimeout"],this)};Ti.prototype.setZoomRate=function(s){this._defaultZoomRate=s},Ti.prototype.setWheelZoomRate=function(s){this._wheelZoomRate=s},Ti.prototype.isEnabled=function(){return!!this._enabled},Ti.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Ti.prototype.isZooming=function(){return!!this._zooming},Ti.prototype.enable=function(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=s&&s.around==="center")},Ti.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ti.prototype.wheel=function(s){if(this.isEnabled()){var i=s.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY,n=o.browser.now(),l=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,i!==0&&i%4.000244140625==0?this._type="wheel":i!==0&&Math.abs(i)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(l*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),s.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=s,this._delta-=i,this._active||this._start(s)),s.preventDefault()}},Ti.prototype._onTimeout=function(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)},Ti.prototype._start=function(s){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var i=F.mousePos(this._el,s);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(i)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Ti.prototype.renderFrame=function(){var s=this;if(this._frameId&&(this._frameId=null,this.isActive())){var i=this._map.transform;if(this._delta!==0){var n=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,l=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&l!==0&&(l=1/l);var y=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(y*l))),this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var M,L=typeof this._targetZoom=="number"?this._targetZoom:i.zoom,B=this._startZoom,oe=this._easing,Te=!1;if(this._type==="wheel"&&B&&oe){var Ge=Math.min((o.browser.now()-this._lastWheelEventTime)/200,1),Ke=oe(Ge);M=o.number(B,L,Ke),Ge<1?this._frameId||(this._frameId=!0):Te=!0}else M=L,Te=!0;return this._active=!0,Te&&(this._active=!1,this._finishTimeout=setTimeout(function(){s._zooming=!1,s._handler._triggerRenderFrame(),delete s._targetZoom,delete s._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Te,zoomDelta:M-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Ti.prototype._smoothOutEasing=function(s){var i=o.ease;if(this._prevEase){var n=this._prevEase,l=(o.browser.now()-n.start)/n.duration,y=n.easing(l+.01)-n.easing(l),M=.27/Math.sqrt(y*y+1e-4)*.01,L=Math.sqrt(.0729-M*M);i=o.bezier(M,L,.25,1)}return this._prevEase={start:o.browser.now(),duration:s,easing:i},i},Ti.prototype.reset=function(){this._active=!1};var Lu=function(i,n){this._clickZoom=i,this._tapZoom=n};Lu.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Lu.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Lu.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Lu.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Zo=function(){this.reset()};Zo.prototype.reset=function(){this._active=!1},Zo.prototype.dblclick=function(s,i){return s.preventDefault(),{cameraAnimation:function(l){l.easeTo({duration:300,zoom:l.getZoom()+(s.shiftKey?-1:1),around:l.unproject(i)},{originalEvent:s})}}},Zo.prototype.enable=function(){this._enabled=!0},Zo.prototype.disable=function(){this._enabled=!1,this.reset()},Zo.prototype.isEnabled=function(){return this._enabled},Zo.prototype.isActive=function(){return this._active};var ho=function(){this._tap=new vu({numTouches:1,numTaps:1}),this.reset()};ho.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ho.prototype.touchstart=function(s,i,n){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=i[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(s,i,n))},ho.prototype.touchmove=function(s,i,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var l=i[0],y=l.y-this._swipePoint.y;return this._swipePoint=l,s.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(s,i,n)},ho.prototype.touchend=function(s,i,n){this._tapTime?this._swipePoint&&n.length===0&&this.reset():this._tap.touchend(s,i,n)&&(this._tapTime=s.timeStamp)},ho.prototype.touchcancel=function(){this.reset()},ho.prototype.enable=function(){this._enabled=!0},ho.prototype.disable=function(){this._enabled=!1,this.reset()},ho.prototype.isEnabled=function(){return this._enabled},ho.prototype.isActive=function(){return this._active};var Ru=function(i,n,l){this._el=i,this._mousePan=n,this._touchPan=l};Ru.prototype.enable=function(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Ru.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Ru.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Ru.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Ju=function(i,n,l){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=n,this._mousePitch=l};Ju.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Ju.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Ju.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Ju.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var gu=function(i,n,l,y){this._el=i,this._touchZoom=n,this._touchRotate=l,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0};gu.prototype.enable=function(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},gu.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},gu.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},gu.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},gu.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},gu.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Ms=function(i){return i.zoom||i.drag||i.pitch||i.rotate},ru=function(s){function i(){s.apply(this,arguments)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i}(o.Event);function Jn(s){return s.panDelta&&s.panDelta.mag()||s.zoomDelta||s.bearingDelta||s.pitchDelta}var Bn=function(i,n){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Zl(i),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n),o.bindAll(["handleEvent","handleWindowEvent"],this);var l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[o.window,"blur",void 0]];for(var y=0,M=this._listeners;y<M.length;y+=1){var L=M[y],B=L[0];F.addEventListener(B,L[1],B===o.window.document?this.handleWindowEvent:this.handleEvent,L[2])}};Bn.prototype.destroy=function(){for(var s=0,i=this._listeners;s<i.length;s+=1){var n=i[s],l=n[0];F.removeEventListener(l,n[1],l===o.window.document?this.handleWindowEvent:this.handleEvent,n[2])}},Bn.prototype._addDefaultHandlers=function(s){var i=this._map,n=i.getCanvasContainer();this._add("mapEvent",new $a(i,s));var l=i.boxZoom=new zs(i,s);this._add("boxZoom",l);var y=new Us,M=new Zo;i.doubleClickZoom=new Lu(M,y),this._add("tapZoom",y),this._add("clickZoom",M);var L=new ho;this._add("tapDragZoom",L);var B=i.touchPitch=new Ns;this._add("touchPitch",B);var oe=new lc(s),Te=new Wl(s);i.dragRotate=new Ju(s,oe,Te),this._add("mouseRotate",oe,["mousePitch"]),this._add("mousePitch",Te,["mouseRotate"]);var Ge=new Gc(s),Ke=new mu(s);i.dragPan=new Ru(n,Ge,Ke),this._add("mousePan",Ge),this._add("touchPan",Ke,["touchZoom","touchRotate"]);var et=new Hc,Ft=new Vs;i.touchZoomRotate=new gu(n,Ft,et,L),this._add("touchRotate",et,["touchPan","touchZoom"]),this._add("touchZoom",Ft,["touchPan","touchRotate"]);var Rt=i.scrollZoom=new Ti(i,this);this._add("scrollZoom",Rt,["mousePan"]);var Yt=i.keyboard=new ss;this._add("keyboard",Yt),this._add("blockableMapEvent",new Mn(i));for(var zt=0,jt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];zt<jt.length;zt+=1){var rr=jt[zt];s.interactive&&s[rr]&&i[rr].enable(s[rr])}},Bn.prototype._add=function(s,i,n){this._handlers.push({handlerName:s,handler:i,allowed:n}),this._handlersById[s]=i},Bn.prototype.stop=function(s){if(!this._updatingCamera){for(var i=0,n=this._handlers;i<n.length;i+=1)n[i].handler.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}},Bn.prototype.isActive=function(){for(var s=0,i=this._handlers;s<i.length;s+=1)if(i[s].handler.isActive())return!0;return!1},Bn.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Bn.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Bn.prototype.isMoving=function(){return Boolean(Ms(this._eventsInProgress))||this.isZooming()},Bn.prototype._blockedByActive=function(s,i,n){for(var l in s)if(l!==n&&(!i||i.indexOf(l)<0))return!0;return!1},Bn.prototype.handleWindowEvent=function(s){this.handleEvent(s,s.type+"Window")},Bn.prototype._getMapTouches=function(s){for(var i=[],n=0,l=s;n<l.length;n+=1){var y=l[n];this._el.contains(y.target)&&i.push(y)}return i},Bn.prototype.handleEvent=function(s,i){if(s.type!=="blur"){this._updatingCamera=!0;for(var n=s.type==="renderFrame"?void 0:s,l={needsRenderFrame:!1},y={},M={},L=s.touches?this._getMapTouches(s.touches):void 0,B=L?F.touchPos(this._el,L):F.mousePos(this._el,s),oe=0,Te=this._handlers;oe<Te.length;oe+=1){var Ge=Te[oe],Ke=Ge.handlerName,et=Ge.handler,Ft=Ge.allowed;if(et.isEnabled()){var Rt=void 0;this._blockedByActive(M,Ft,Ke)?et.reset():et[i||s.type]&&(Rt=et[i||s.type](s,B,L),this.mergeHandlerResult(l,y,Rt,Ke,n),Rt&&Rt.needsRenderFrame&&this._triggerRenderFrame()),(Rt||et.isActive())&&(M[Ke]=et)}}var Yt={};for(var zt in this._previousActiveHandlers)M[zt]||(Yt[zt]=n);this._previousActiveHandlers=M,(Object.keys(Yt).length||Jn(l))&&(this._changes.push([l,y,Yt]),this._triggerRenderFrame()),(Object.keys(M).length||Jn(l))&&this._map._stop(!0),this._updatingCamera=!1;var jt=l.cameraAnimation;jt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],jt(this._map))}else this.stop(!0)},Bn.prototype.mergeHandlerResult=function(s,i,n,l,y){if(n){o.extend(s,n);var M={handlerName:l,originalEvent:n.originalEvent||y};n.zoomDelta!==void 0&&(i.zoom=M),n.panDelta!==void 0&&(i.drag=M),n.pitchDelta!==void 0&&(i.pitch=M),n.bearingDelta!==void 0&&(i.rotate=M)}},Bn.prototype._applyChanges=function(){for(var s={},i={},n={},l=0,y=this._changes;l<y.length;l+=1){var M=y[l],L=M[0],B=M[1],oe=M[2];L.panDelta&&(s.panDelta=(s.panDelta||new o.Point(0,0))._add(L.panDelta)),L.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+L.zoomDelta),L.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+L.bearingDelta),L.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+L.pitchDelta),L.around!==void 0&&(s.around=L.around),L.pinchAround!==void 0&&(s.pinchAround=L.pinchAround),L.noInertia&&(s.noInertia=L.noInertia),o.extend(i,B),o.extend(n,oe)}this._updateMapTransform(s,i,n),this._changes=[]},Bn.prototype._updateMapTransform=function(s,i,n){var l=this._map,y=l.transform;if(!Jn(s))return this._fireEvents(i,n,!0);var M=s.panDelta,L=s.zoomDelta,B=s.bearingDelta,oe=s.pitchDelta,Te=s.around,Ge=s.pinchAround;Ge!==void 0&&(Te=Ge),l._stop(!0),Te=Te||l.transform.centerPoint;var Ke=y.pointLocation(M?Te.sub(M):Te);B&&(y.bearing+=B),oe&&(y.pitch+=oe),L&&(y.zoom+=L),y.setLocationAtPoint(Ke,Te),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(i,n,!0)},Bn.prototype._fireEvents=function(s,i,n){var l=this,y=Ms(this._eventsInProgress),M=Ms(s),L={};for(var B in s)this._eventsInProgress[B]||(L[B+"start"]=s[B].originalEvent),this._eventsInProgress[B]=s[B];for(var oe in!y&&M&&this._fireEvent("movestart",M.originalEvent),L)this._fireEvent(oe,L[oe]);for(var Te in M&&this._fireEvent("move",M.originalEvent),s)this._fireEvent(Te,s[Te].originalEvent);var Ge,Ke={};for(var et in this._eventsInProgress){var Ft=this._eventsInProgress[et],Rt=Ft.handlerName,Yt=Ft.originalEvent;this._handlersById[Rt].isActive()||(delete this._eventsInProgress[et],Ke[et+"end"]=Ge=i[Rt]||Yt)}for(var zt in Ke)this._fireEvent(zt,Ke[zt]);var jt=Ms(this._eventsInProgress);if(n&&(y||M)&&!jt){this._updatingCamera=!0;var rr=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),nr=function(pr){return pr!==0&&-l._bearingSnap<pr&&pr<l._bearingSnap};rr?(nr(rr.bearing||this._map.getBearing())&&(rr.bearing=0),this._map.easeTo(rr,{originalEvent:Ge})):(this._map.fire(new o.Event("moveend",{originalEvent:Ge})),nr(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Bn.prototype._fireEvent=function(s,i){this._map.fire(new o.Event(s,i?{originalEvent:i}:{}))},Bn.prototype._requestFrame=function(){var s=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(i){delete s._frameId,s.handleEvent(new ru("renderFrame",{timeStamp:i})),s._applyChanges()})},Bn.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Pl=function(s){function i(n,l){s.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=l.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.getCenter=function(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)},i.prototype.setCenter=function(n,l){return this.jumpTo({center:n},l)},i.prototype.panBy=function(n,l,y){return n=o.Point.convert(n).mult(-1),this.panTo(this.transform.center,o.extend({offset:n},l),y)},i.prototype.panTo=function(n,l,y){return this.easeTo(o.extend({center:n},l),y)},i.prototype.getZoom=function(){return this.transform.zoom},i.prototype.setZoom=function(n,l){return this.jumpTo({zoom:n},l),this},i.prototype.zoomTo=function(n,l,y){return this.easeTo(o.extend({zoom:n},l),y)},i.prototype.zoomIn=function(n,l){return this.zoomTo(this.getZoom()+1,n,l),this},i.prototype.zoomOut=function(n,l){return this.zoomTo(this.getZoom()-1,n,l),this},i.prototype.getBearing=function(){return this.transform.bearing},i.prototype.setBearing=function(n,l){return this.jumpTo({bearing:n},l),this},i.prototype.getPadding=function(){return this.transform.padding},i.prototype.setPadding=function(n,l){return this.jumpTo({padding:n},l),this},i.prototype.rotateTo=function(n,l,y){return this.easeTo(o.extend({bearing:n},l),y)},i.prototype.resetNorth=function(n,l){return this.rotateTo(0,o.extend({duration:1e3},n),l),this},i.prototype.resetNorthPitch=function(n,l){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},n),l),this},i.prototype.snapToNorth=function(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this},i.prototype.getPitch=function(){return this.transform.pitch},i.prototype.setPitch=function(n,l){return this.jumpTo({pitch:n},l),this},i.prototype.cameraForBounds=function(n,l){n=o.LngLatBounds.convert(n);var y=l&&l.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),y,l)},i.prototype._cameraForBoxAndBearing=function(n,l,y,M){var L={top:0,bottom:0,right:0,left:0};if(typeof(M=o.extend({padding:L,offset:[0,0],maxZoom:this.transform.maxZoom},M)).padding=="number"){var B=M.padding;M.padding={top:B,bottom:B,right:B,left:B}}M.padding=o.extend(L,M.padding);var oe=this.transform,Te=oe.padding,Ge=oe.project(o.LngLat.convert(n)),Ke=oe.project(o.LngLat.convert(l)),et=Ge.rotate(-y*Math.PI/180),Ft=Ke.rotate(-y*Math.PI/180),Rt=new o.Point(Math.max(et.x,Ft.x),Math.max(et.y,Ft.y)),Yt=new o.Point(Math.min(et.x,Ft.x),Math.min(et.y,Ft.y)),zt=Rt.sub(Yt),jt=(oe.width-(Te.left+Te.right+M.padding.left+M.padding.right))/zt.x,rr=(oe.height-(Te.top+Te.bottom+M.padding.top+M.padding.bottom))/zt.y;if(!(rr<0||jt<0)){var nr=Math.min(oe.scaleZoom(oe.scale*Math.min(jt,rr)),M.maxZoom),zr=typeof M.offset.x=="number"?new o.Point(M.offset.x,M.offset.y):o.Point.convert(M.offset),pr=new o.Point((M.padding.left-M.padding.right)/2,(M.padding.top-M.padding.bottom)/2).rotate(y*Math.PI/180),Ar=zr.add(pr).mult(oe.scale/oe.zoomScale(nr));return{center:oe.unproject(Ge.add(Ke).div(2).sub(Ar)),zoom:nr,bearing:y}}o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},i.prototype.fitBounds=function(n,l,y){return this._fitInternal(this.cameraForBounds(n,l),l,y)},i.prototype.fitScreenCoordinates=function(n,l,y,M,L){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.Point.convert(n)),this.transform.pointLocation(o.Point.convert(l)),y,M),M,L)},i.prototype._fitInternal=function(n,l,y){return n?(delete(l=o.extend(n,l)).padding,l.linear?this.easeTo(l,y):this.flyTo(l,y)):this},i.prototype.jumpTo=function(n,l){this.stop();var y=this.transform,M=!1,L=!1,B=!1;return"zoom"in n&&y.zoom!==+n.zoom&&(M=!0,y.zoom=+n.zoom),n.center!==void 0&&(y.center=o.LngLat.convert(n.center)),"bearing"in n&&y.bearing!==+n.bearing&&(L=!0,y.bearing=+n.bearing),"pitch"in n&&y.pitch!==+n.pitch&&(B=!0,y.pitch=+n.pitch),n.padding==null||y.isPaddingEqual(n.padding)||(y.padding=n.padding),this.fire(new o.Event("movestart",l)).fire(new o.Event("move",l)),M&&this.fire(new o.Event("zoomstart",l)).fire(new o.Event("zoom",l)).fire(new o.Event("zoomend",l)),L&&this.fire(new o.Event("rotatestart",l)).fire(new o.Event("rotate",l)).fire(new o.Event("rotateend",l)),B&&this.fire(new o.Event("pitchstart",l)).fire(new o.Event("pitch",l)).fire(new o.Event("pitchend",l)),this.fire(new o.Event("moveend",l))},i.prototype.easeTo=function(n,l){var y=this;this._stop(!1,n.easeId),((n=o.extend({offset:[0,0],duration:500,easing:o.ease},n)).animate===!1||!n.essential&&o.browser.prefersReducedMotion)&&(n.duration=0);var M=this.transform,L=this.getZoom(),B=this.getBearing(),oe=this.getPitch(),Te=this.getPadding(),Ge="zoom"in n?+n.zoom:L,Ke="bearing"in n?this._normalizeBearing(n.bearing,B):B,et="pitch"in n?+n.pitch:oe,Ft="padding"in n?n.padding:M.padding,Rt=o.Point.convert(n.offset),Yt=M.centerPoint.add(Rt),zt=M.pointLocation(Yt),jt=o.LngLat.convert(n.center||zt);this._normalizeCenter(jt);var rr,nr,zr=M.project(zt),pr=M.project(jt).sub(zr),Ar=M.zoomScale(Ge-L);n.around&&(rr=o.LngLat.convert(n.around),nr=M.locationPoint(rr));var wr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Ge!==L,this._rotating=this._rotating||B!==Ke,this._pitching=this._pitching||et!==oe,this._padding=!M.isPaddingEqual(Ft),this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,wr),this._ease(function(sn){if(y._zooming&&(M.zoom=o.number(L,Ge,sn)),y._rotating&&(M.bearing=o.number(B,Ke,sn)),y._pitching&&(M.pitch=o.number(oe,et,sn)),y._padding&&(M.interpolatePadding(Te,Ft,sn),Yt=M.centerPoint.add(Rt)),rr)M.setLocationAtPoint(rr,nr);else{var $r=M.zoomScale(M.zoom-L),xn=Ge>L?Math.min(2,Ar):Math.max(.5,Ar),In=Math.pow(xn,1-sn),ei=M.unproject(zr.add(pr.mult(sn*In)).mult($r));M.setLocationAtPoint(M.renderWorldCopies?ei.wrap():ei,Yt)}y._fireMoveEvents(l)},function(sn){y._afterEase(l,sn)},n),this},i.prototype._prepareEase=function(n,l,y){y===void 0&&(y={}),this._moving=!0,l||y.moving||this.fire(new o.Event("movestart",n)),this._zooming&&!y.zooming&&this.fire(new o.Event("zoomstart",n)),this._rotating&&!y.rotating&&this.fire(new o.Event("rotatestart",n)),this._pitching&&!y.pitching&&this.fire(new o.Event("pitchstart",n))},i.prototype._fireMoveEvents=function(n){this.fire(new o.Event("move",n)),this._zooming&&this.fire(new o.Event("zoom",n)),this._rotating&&this.fire(new o.Event("rotate",n)),this._pitching&&this.fire(new o.Event("pitch",n))},i.prototype._afterEase=function(n,l){if(!this._easeId||!l||this._easeId!==l){delete this._easeId;var y=this._zooming,M=this._rotating,L=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new o.Event("zoomend",n)),M&&this.fire(new o.Event("rotateend",n)),L&&this.fire(new o.Event("pitchend",n)),this.fire(new o.Event("moveend",n))}},i.prototype.flyTo=function(n,l){var y=this;if(!n.essential&&o.browser.prefersReducedMotion){var M=o.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(M,l)}this.stop(),n=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},n);var L=this.transform,B=this.getZoom(),oe=this.getBearing(),Te=this.getPitch(),Ge=this.getPadding(),Ke="zoom"in n?o.clamp(+n.zoom,L.minZoom,L.maxZoom):B,et="bearing"in n?this._normalizeBearing(n.bearing,oe):oe,Ft="pitch"in n?+n.pitch:Te,Rt="padding"in n?n.padding:L.padding,Yt=L.zoomScale(Ke-B),zt=o.Point.convert(n.offset),jt=L.centerPoint.add(zt),rr=L.pointLocation(jt),nr=o.LngLat.convert(n.center||rr);this._normalizeCenter(nr);var zr=L.project(rr),pr=L.project(nr).sub(zr),Ar=n.curve,wr=Math.max(L.width,L.height),sn=wr/Yt,$r=pr.mag();if("minZoom"in n){var xn=o.clamp(Math.min(n.minZoom,B,Ke),L.minZoom,L.maxZoom),In=wr/L.zoomScale(xn-B);Ar=Math.sqrt(In/$r*2)}var ei=Ar*Ar;function si(ii){var Ni=(sn*sn-wr*wr+(ii?-1:1)*ei*ei*$r*$r)/(2*(ii?sn:wr)*ei*$r);return Math.log(Math.sqrt(Ni*Ni+1)-Ni)}function Ii(ii){return(Math.exp(ii)-Math.exp(-ii))/2}function $i(ii){return(Math.exp(ii)+Math.exp(-ii))/2}var wn=si(0),ui=function(Ni){return $i(wn)/$i(wn+Ar*Ni)},Si=function(Ni){return wr*(($i(wn)*(Ii(Hi=wn+Ar*Ni)/$i(Hi))-Ii(wn))/ei)/$r;var Hi},Hn=(si(1)-wn)/Ar;if(Math.abs($r)<1e-6||!isFinite(Hn)){if(Math.abs(wr-sn)<1e-6)return this.easeTo(n,l);var Ei=sn<wr?-1:1;Hn=Math.abs(Math.log(sn/wr))/Ar,Si=function(){return 0},ui=function(Ni){return Math.exp(Ei*Ar*Ni)}}return n.duration="duration"in n?+n.duration:1e3*Hn/("screenSpeed"in n?+n.screenSpeed/Ar:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=oe!==et,this._pitching=Ft!==Te,this._padding=!L.isPaddingEqual(Rt),this._prepareEase(l,!1),this._ease(function(ii){var Ni=ii*Hn,Hi=1/ui(Ni);L.zoom=ii===1?Ke:B+L.scaleZoom(Hi),y._rotating&&(L.bearing=o.number(oe,et,ii)),y._pitching&&(L.pitch=o.number(Te,Ft,ii)),y._padding&&(L.interpolatePadding(Ge,Rt,ii),jt=L.centerPoint.add(zt));var no=ii===1?nr:L.unproject(zr.add(pr.mult(Si(Ni))).mult(Hi));L.setLocationAtPoint(L.renderWorldCopies?no.wrap():no,jt),y._fireMoveEvents(l)},function(){return y._afterEase(l)},n),this},i.prototype.isEasing=function(){return!!this._easeFrameId},i.prototype.stop=function(){return this._stop()},i.prototype._stop=function(n,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,l)}if(!n){var M=this.handlers;M&&M.stop(!1)}return this},i.prototype._ease=function(n,l,y){y.animate===!1||y.duration===0?(n(1),l()):(this._easeStart=o.browser.now(),this._easeOptions=y,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},i.prototype._renderFrameCallback=function(){var n=Math.min((o.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},i.prototype._normalizeBearing=function(n,l){n=o.wrap(n,-180,180);var y=Math.abs(n-l);return Math.abs(n-360-l)<y&&(n-=360),Math.abs(n+360-l)<y&&(n+=360),n},i.prototype._normalizeCenter=function(n){var l=this.transform;if(l.renderWorldCopies&&!l.lngRange){var y=n.lng-l.center.lng;n.lng+=y>180?-360:y<-180?360:0}},i}(o.Evented),xs=function(i){i===void 0&&(i={}),this.options=i,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};xs.prototype.getDefaultPosition=function(){return"bottom-right"},xs.prototype.onAdd=function(s){var i=this.options&&this.options.compact;return this._map=s,this._container=F.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=F.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=F.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),i&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),i===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},xs.prototype.onRemove=function(){F.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},xs.prototype._setElementTitle=function(s,i){var n=this._map._getUIString("AttributionControl."+i);s.title=n,s.setAttribute("aria-label",n)},xs.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},xs.prototype._updateEditLink=function(){var s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));var i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(s){var n=i.reduce(function(l,y,M){return y.value&&(l+=y.key+"="+y.value+(M<i.length-1?"&":"")),l},"?");s.href=o.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(!0):""),s.rel="noopener nofollow",this._setElementTitle(s,"MapFeedback")}},xs.prototype._updateData=function(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},xs.prototype._updateAttributions=function(){if(this._map.style){var s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(function(B){return typeof B!="string"?"":B})):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){var i=this._map.style.stylesheet;this.styleOwner=i.owner,this.styleId=i.id}var n=this._map.style.sourceCaches;for(var l in n){var y=n[l];if(y.used){var M=y.getSource();M.attribution&&s.indexOf(M.attribution)<0&&s.push(M.attribution)}}s.sort(function(B,oe){return B.length-oe.length});var L=(s=s.filter(function(B,oe){for(var Te=oe+1;Te<s.length;Te++)if(s[Te].indexOf(B)>=0)return!1;return!0})).join(" | ");L!==this._attribHTML&&(this._attribHTML=L,s.length?(this._innerContainer.innerHTML=L,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},xs.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Wo=function(){o.bindAll(["_updateLogo"],this),o.bindAll(["_updateCompact"],this)};Wo.prototype.onAdd=function(s){this._map=s,this._container=F.create("div","mapboxgl-ctrl");var i=F.create("a","mapboxgl-ctrl-logo");return i.target="_blank",i.rel="noopener nofollow",i.href="https://www.mapbox.com/",i.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),i.setAttribute("rel","noopener nofollow"),this._container.appendChild(i),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Wo.prototype.onRemove=function(){F.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Wo.prototype.getDefaultPosition=function(){return"bottom-left"},Wo.prototype._updateLogo=function(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Wo.prototype._logoRequired=function(){if(this._map.style){var s=this._map.style.sourceCaches;for(var i in s)if(s[i].getSource().mapbox_logo)return!0;return!1}},Wo.prototype._updateCompact=function(){var s=this._container.children;if(s.length){var i=s[0];this._map.getCanvasContainer().offsetWidth<250?i.classList.add("mapboxgl-compact"):i.classList.remove("mapboxgl-compact")}};var No=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};No.prototype.add=function(s){var i=++this._id;return this._queue.push({callback:s,id:i,cancelled:!1}),i},No.prototype.remove=function(s){for(var i=this._currentlyRunning,n=0,l=i?this._queue.concat(i):this._queue;n<l.length;n+=1){var y=l[n];if(y.id===s)return void(y.cancelled=!0)}},No.prototype.run=function(s){s===void 0&&(s=0);var i=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,l=i;n<l.length;n+=1){var y=l[n];if(!y.cancelled&&(y.callback(s),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},No.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var nu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Du=o.window.HTMLImageElement,cc=o.window.HTMLElement,na=o.window.ImageBitmap,po={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},hl=function(s){function i(l){var y=this;if((l=o.extend({},po,l)).minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var M=new ji(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies);if(s.call(this,M,l),this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._renderTaskQueue=new No,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},nu,l.locale),this._clickTolerance=l.clickTolerance,this._requestManager=new o.RequestManager(l.transformRequest,l.accessToken),typeof l.container=="string"){if(this._container=o.window.document.getElementById(l.container),!this._container)throw new Error("Container '"+l.container+"' not found.")}else{if(!(l.container instanceof cc))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return y._update(!1)}),this.on("moveend",function(){return y._update(!1)}),this.on("zoom",function(){return y._update(!0)}),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Bn(this,l),this._hash=l.hash&&new js(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,o.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new xs({customAttribution:l.customAttribution})),this.addControl(new Wo,l.logoPosition),this.on("style.load",function(){y.transform.unmodified&&y.jumpTo(y.style.stylesheet)}),this.on("data",function(L){y._update(L.dataType==="style"),y.fire(new o.Event(L.dataType+"data",L))}),this.on("dataloading",function(L){y.fire(new o.Event(L.dataType+"dataloading",L))})}s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i;var n={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return i.prototype._getMapId=function(){return this._mapId},i.prototype.addControl=function(l,y){if(y===void 0&&(y=l.getDefaultPosition?l.getDefaultPosition():"top-right"),!l||!l.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var M=l.onAdd(this);this._controls.push(l);var L=this._controlPositions[y];return y.indexOf("bottom")!==-1?L.insertBefore(M,L.firstChild):L.appendChild(M),this},i.prototype.removeControl=function(l){if(!l||!l.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var y=this._controls.indexOf(l);return y>-1&&this._controls.splice(y,1),l.onRemove(this),this},i.prototype.hasControl=function(l){return this._controls.indexOf(l)>-1},i.prototype.resize=function(l){var y=this._containerDimensions(),M=y[0],L=y[1];this._resizeCanvas(M,L),this.transform.resize(M,L),this.painter.resize(M,L);var B=!this._moving;return B&&(this.stop(),this.fire(new o.Event("movestart",l)).fire(new o.Event("move",l))),this.fire(new o.Event("resize",l)),B&&this.fire(new o.Event("moveend",l)),this},i.prototype.getBounds=function(){return this.transform.getBounds()},i.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},i.prototype.setMaxBounds=function(l){return this.transform.setMaxBounds(o.LngLatBounds.convert(l)),this._update()},i.prototype.setMinZoom=function(l){if((l=l==null?-2:l)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l&&this.setZoom(l),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},i.prototype.getMinZoom=function(){return this.transform.minZoom},i.prototype.setMaxZoom=function(l){if((l=l==null?22:l)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l&&this.setZoom(l),this;throw new Error("maxZoom must be greater than the current minZoom")},i.prototype.getMaxZoom=function(){return this.transform.maxZoom},i.prototype.setMinPitch=function(l){if((l=l==null?0:l)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l&&this.setPitch(l),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},i.prototype.getMinPitch=function(){return this.transform.minPitch},i.prototype.setMaxPitch=function(l){if((l=l==null?60:l)>60)throw new Error("maxPitch must be less than or equal to 60");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l&&this.setPitch(l),this;throw new Error("maxPitch must be greater than the current minPitch")},i.prototype.getMaxPitch=function(){return this.transform.maxPitch},i.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},i.prototype.setRenderWorldCopies=function(l){return this.transform.renderWorldCopies=l,this._update()},i.prototype.project=function(l){return this.transform.locationPoint(o.LngLat.convert(l))},i.prototype.unproject=function(l){return this.transform.pointLocation(o.Point.convert(l))},i.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},i.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},i.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},i.prototype._createDelegatedListener=function(l,y,M){var L,B=this;if(l==="mouseenter"||l==="mouseover"){var oe=!1;return{layer:y,listener:M,delegates:{mousemove:function(Ke){var et=B.getLayer(y)?B.queryRenderedFeatures(Ke.point,{layers:[y]}):[];et.length?oe||(oe=!0,M.call(B,new fo(l,B,Ke.originalEvent,{features:et}))):oe=!1},mouseout:function(){oe=!1}}}}if(l==="mouseleave"||l==="mouseout"){var Te=!1;return{layer:y,listener:M,delegates:{mousemove:function(Ke){(B.getLayer(y)?B.queryRenderedFeatures(Ke.point,{layers:[y]}):[]).length?Te=!0:Te&&(Te=!1,M.call(B,new fo(l,B,Ke.originalEvent)))},mouseout:function(Ke){Te&&(Te=!1,M.call(B,new fo(l,B,Ke.originalEvent)))}}}}return{layer:y,listener:M,delegates:(L={},L[l]=function(Ge){var Ke=B.getLayer(y)?B.queryRenderedFeatures(Ge.point,{layers:[y]}):[];Ke.length&&(Ge.features=Ke,M.call(B,Ge),delete Ge.features)},L)}},i.prototype.on=function(l,y,M){if(M===void 0)return s.prototype.on.call(this,l,y);var L=this._createDelegatedListener(l,y,M);for(var B in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(L),L.delegates)this.on(B,L.delegates[B]);return this},i.prototype.once=function(l,y,M){if(M===void 0)return s.prototype.once.call(this,l,y);var L=this._createDelegatedListener(l,y,M);for(var B in L.delegates)this.once(B,L.delegates[B]);return this},i.prototype.off=function(l,y,M){var L=this;return M===void 0?s.prototype.off.call(this,l,y):(this._delegatedListeners&&this._delegatedListeners[l]&&function(B){for(var oe=B[l],Te=0;Te<oe.length;Te++){var Ge=oe[Te];if(Ge.layer===y&&Ge.listener===M){for(var Ke in Ge.delegates)L.off(Ke,Ge.delegates[Ke]);return oe.splice(Te,1),L}}}(this._delegatedListeners),this)},i.prototype.queryRenderedFeatures=function(l,y){if(!this.style)return[];var M;if(y!==void 0||l===void 0||l instanceof o.Point||Array.isArray(l)||(y=l,l=void 0),y=y||{},(l=l||[[0,0],[this.transform.width,this.transform.height]])instanceof o.Point||typeof l[0]=="number")M=[o.Point.convert(l)];else{var L=o.Point.convert(l[0]),B=o.Point.convert(l[1]);M=[L,new o.Point(B.x,L.y),B,new o.Point(L.x,B.y),L]}return this.style.queryRenderedFeatures(M,y,this.transform)},i.prototype.querySourceFeatures=function(l,y){return this.style.querySourceFeatures(l,y)},i.prototype.setStyle=function(l,y){return(y=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},y)).diff!==!1&&y.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&l?(this._diffStyle(l,y),this):(this._localIdeographFontFamily=y.localIdeographFontFamily,this._updateStyle(l,y))},i.prototype._getUIString=function(l){var y=this._locale[l];if(y==null)throw new Error("Missing UI string '"+l+"'");return y},i.prototype._updateStyle=function(l,y){return this.style&&(this.style.setEventedParent(null),this.style._remove()),l?(this.style=new wa(this,y||{}),this.style.setEventedParent(this,{style:this.style}),typeof l=="string"?this.style.loadURL(l):this.style.loadJSON(l),this):(delete this.style,this)},i.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new wa(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},i.prototype._diffStyle=function(l,y){var M=this;if(typeof l=="string"){var L=this._requestManager.normalizeStyleURL(l),B=this._requestManager.transformRequest(L,o.ResourceType.Style);o.getJSON(B,function(oe,Te){oe?M.fire(new o.ErrorEvent(oe)):Te&&M._updateDiff(Te,y)})}else typeof l=="object"&&this._updateDiff(l,y)},i.prototype._updateDiff=function(l,y){try{this.style.setState(l)&&this._update(!0)}catch(M){o.warnOnce("Unable to perform style diff: "+(M.message||M.error||M)+".  Rebuilding the style from scratch."),this._updateStyle(l,y)}},i.prototype.getStyle=function(){if(this.style)return this.style.serialize()},i.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")},i.prototype.addSource=function(l,y){return this._lazyInitEmptyStyle(),this.style.addSource(l,y),this._update(!0)},i.prototype.isSourceLoaded=function(l){var y=this.style&&this.style.sourceCaches[l];if(y!==void 0)return y.loaded();this.fire(new o.ErrorEvent(new Error("There is no source with ID '"+l+"'")))},i.prototype.areTilesLoaded=function(){var l=this.style&&this.style.sourceCaches;for(var y in l){var M=l[y]._tiles;for(var L in M){var B=M[L];if(B.state!=="loaded"&&B.state!=="errored")return!1}}return!0},i.prototype.addSourceType=function(l,y,M){return this._lazyInitEmptyStyle(),this.style.addSourceType(l,y,M)},i.prototype.removeSource=function(l){return this.style.removeSource(l),this._update(!0)},i.prototype.getSource=function(l){return this.style.getSource(l)},i.prototype.addImage=function(l,y,M){M===void 0&&(M={});var L=M.pixelRatio;L===void 0&&(L=1);var B=M.sdf;B===void 0&&(B=!1);var oe=M.stretchX,Te=M.stretchY,Ge=M.content;if(this._lazyInitEmptyStyle(),y instanceof Du||na&&y instanceof na){var Ke=o.browser.getImageData(y);this.style.addImage(l,{data:new o.RGBAImage({width:Ke.width,height:Ke.height},Ke.data),pixelRatio:L,stretchX:oe,stretchY:Te,content:Ge,sdf:B,version:0})}else{if(y.width===void 0||y.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var et=y;this.style.addImage(l,{data:new o.RGBAImage({width:y.width,height:y.height},new Uint8Array(y.data)),pixelRatio:L,stretchX:oe,stretchY:Te,content:Ge,sdf:B,version:0,userImage:et}),et.onAdd&&et.onAdd(this,l)}},i.prototype.updateImage=function(l,y){var M=this.style.getImage(l);if(!M)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var L=y instanceof Du||na&&y instanceof na?o.browser.getImageData(y):y,B=L.width,oe=L.height,Te=L.data;return B===void 0||oe===void 0?this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):B!==M.data.width||oe!==M.data.height?this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(M.data.replace(Te,!(y instanceof Du||na&&y instanceof na)),void this.style.updateImage(l,M))},i.prototype.hasImage=function(l){return l?!!this.style.getImage(l):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)},i.prototype.removeImage=function(l){this.style.removeImage(l)},i.prototype.loadImage=function(l,y){o.getImage(this._requestManager.transformRequest(l,o.ResourceType.Image),y)},i.prototype.listImages=function(){return this.style.listImages()},i.prototype.addLayer=function(l,y){return this._lazyInitEmptyStyle(),this.style.addLayer(l,y),this._update(!0)},i.prototype.moveLayer=function(l,y){return this.style.moveLayer(l,y),this._update(!0)},i.prototype.removeLayer=function(l){return this.style.removeLayer(l),this._update(!0)},i.prototype.getLayer=function(l){return this.style.getLayer(l)},i.prototype.setLayerZoomRange=function(l,y,M){return this.style.setLayerZoomRange(l,y,M),this._update(!0)},i.prototype.setFilter=function(l,y,M){return M===void 0&&(M={}),this.style.setFilter(l,y,M),this._update(!0)},i.prototype.getFilter=function(l){return this.style.getFilter(l)},i.prototype.setPaintProperty=function(l,y,M,L){return L===void 0&&(L={}),this.style.setPaintProperty(l,y,M,L),this._update(!0)},i.prototype.getPaintProperty=function(l,y){return this.style.getPaintProperty(l,y)},i.prototype.setLayoutProperty=function(l,y,M,L){return L===void 0&&(L={}),this.style.setLayoutProperty(l,y,M,L),this._update(!0)},i.prototype.getLayoutProperty=function(l,y){return this.style.getLayoutProperty(l,y)},i.prototype.setLight=function(l,y){return y===void 0&&(y={}),this._lazyInitEmptyStyle(),this.style.setLight(l,y),this._update(!0)},i.prototype.getLight=function(){return this.style.getLight()},i.prototype.setFeatureState=function(l,y){return this.style.setFeatureState(l,y),this._update()},i.prototype.removeFeatureState=function(l,y){return this.style.removeFeatureState(l,y),this._update()},i.prototype.getFeatureState=function(l){return this.style.getFeatureState(l)},i.prototype.getContainer=function(){return this._container},i.prototype.getCanvasContainer=function(){return this._canvasContainer},i.prototype.getCanvas=function(){return this._canvas},i.prototype._containerDimensions=function(){var l=0,y=0;return this._container&&(l=this._container.clientWidth||400,y=this._container.clientHeight||300),[l,y]},i.prototype._detectMissingCSS=function(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},i.prototype._setupContainer=function(){var l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=F.create("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();var y=this._canvasContainer=F.create("div","mapboxgl-canvas-container",l);this._interactive&&y.classList.add("mapboxgl-interactive"),this._canvas=F.create("canvas","mapboxgl-canvas",y),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var M=this._containerDimensions();this._resizeCanvas(M[0],M[1]);var L=this._controlContainer=F.create("div","mapboxgl-control-container",l),B=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(oe){B[oe]=F.create("div","mapboxgl-ctrl-"+oe,L)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},i.prototype._resizeCanvas=function(l,y){var M=o.browser.devicePixelRatio||1;this._canvas.width=M*l,this._canvas.height=M*y,this._canvas.style.width=l+"px",this._canvas.style.height=y+"px"},i.prototype._setupPainter=function(){var l=o.extend({},X.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),y=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);y?(this.painter=new Ra(y,this.transform),o.webpSupported.testSupport(y)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))},i.prototype._contextLost=function(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:l}))},i.prototype._contextRestored=function(l){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:l}))},i.prototype._onMapScroll=function(l){if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},i.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},i.prototype._update=function(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this},i.prototype._requestRenderFrame=function(l){return this._update(),this._renderTaskQueue.add(l)},i.prototype._cancelRenderFrame=function(l){this._renderTaskQueue.remove(l)},i.prototype._render=function(l){var y,M=this,L=0,B=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(y=B.createQueryEXT(),B.beginQueryEXT(B.TIME_ELAPSED_EXT,y),L=o.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(l),!this._removed){var oe=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Te=this.transform.zoom,Ge=o.browser.now();this.style.zoomHistory.update(Te,Ge);var Ke=new o.EvaluationParameters(Te,{now:Ge,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),et=Ke.crossFadingFactor();et===1&&et===this._crossFadingFactor||(oe=!0,this._crossFadingFactor=et),this.style.update(Ke)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||oe)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ft=o.browser.now()-L;B.endQueryEXT(B.TIME_ELAPSED_EXT,y),setTimeout(function(){var zt=B.getQueryObjectEXT(y,B.QUERY_RESULT_EXT)/1e6;B.deleteQueryEXT(y),M.fire(new o.Event("gpu-timing-frame",{cpuTime:Ft,gpuTime:zt}))},50)}if(this.listens("gpu-timing-layer")){var Rt=this.painter.collectGpuTimers();setTimeout(function(){var zt=M.painter.queryGpuTimers(Rt);M.fire(new o.Event("gpu-timing-layer",{layerTimes:zt}))},50)}var Yt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Yt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||Yt||(this._fullyLoaded=!0),this}},i.prototype.remove=function(){this._hash&&this._hash.remove();for(var l=0,y=this._controls;l<y.length;l+=1)y[l].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1));var M=this.painter.context.gl.getExtension("WEBGL_lose_context");M&&M.loseContext(),dl(this._canvasContainer),dl(this._controlContainer),dl(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new o.Event("remove"))},i.prototype.triggerRepaint=function(){var l=this;this.style&&!this._frame&&(this._frame=o.browser.frame(function(y){l._frame=null,l._render(y)}))},i.prototype._onWindowOnline=function(){this._update()},i.prototype._onWindowResize=function(l){this._trackResize&&this.resize({originalEvent:l})._update()},n.showTileBoundaries.get=function(){return!!this._showTileBoundaries},n.showTileBoundaries.set=function(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())},n.showPadding.get=function(){return!!this._showPadding},n.showPadding.set=function(l){this._showPadding!==l&&(this._showPadding=l,this._update())},n.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},n.showCollisionBoxes.set=function(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())},n.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},n.showOverdrawInspector.set=function(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())},n.repaint.get=function(){return!!this._repaint},n.repaint.set=function(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())},n.vertices.get=function(){return!!this._vertices},n.vertices.set=function(l){this._vertices=l,this._update()},i.prototype._setCacheLimits=function(l,y){o.setCacheLimits(l,y)},n.version.get=function(){return o.version},Object.defineProperties(i.prototype,n),i}(Pl);function dl(s){s.parentNode&&s.parentNode.removeChild(s)}var fc={showCompass:!0,showZoom:!0,visualizePitch:!1},zu=function(i){var n=this;this.options=o.extend({},fc,i),this._container=F.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(l){return l.preventDefault()}),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(l){return n._map.zoomIn({},{originalEvent:l})}),F.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(l){return n._map.zoomOut({},{originalEvent:l})}),F.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(l){n.options.visualizePitch?n._map.resetNorthPitch({},{originalEvent:l}):n._map.resetNorth({},{originalEvent:l})}),this._compassIcon=F.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};zu.prototype._updateZoomButtons=function(){var s=this._map.getZoom(),i=s===this._map.getMaxZoom(),n=s===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},zu.prototype._rotateCompassArrow=function(){var s=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=s},zu.prototype.onAdd=function(s){return this._map=s,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Is(this._map,this._compass,this.options.visualizePitch)),this._container},zu.prototype.onRemove=function(){F.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},zu.prototype._createButton=function(s,i){var n=F.create("button",s,this._container);return n.type="button",n.addEventListener("click",i),n},zu.prototype._setButtonTitle=function(s,i){var n=this._map._getUIString("NavigationControl."+i);s.title=n,s.setAttribute("aria-label",n)};var Is=function(i,n,l){l===void 0&&(l=!1),this._clickTolerance=10,this.element=n,this.mouseRotate=new lc({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,l&&(this.mousePitch=new Wl({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),F.addEventListener(n,"mousedown",this.mousedown),F.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),F.addEventListener(n,"touchmove",this.touchmove),F.addEventListener(n,"touchend",this.touchend),F.addEventListener(n,"touchcancel",this.reset)};function Yl(s,i,n){if(s=new o.LngLat(s.lng,s.lat),i){var l=new o.LngLat(s.lng-360,s.lat),y=new o.LngLat(s.lng+360,s.lat),M=n.locationPoint(s).distSqr(i);n.locationPoint(l).distSqr(i)<M?s=l:n.locationPoint(y).distSqr(i)<M&&(s=y)}for(;Math.abs(s.lng-n.center.lng)>180;){var L=n.locationPoint(s);if(L.x>=0&&L.y>=0&&L.x<=n.width&&L.y<=n.height)break;s.lng>n.center.lng?s.lng-=360:s.lng+=360}return s}Is.prototype.down=function(s,i){this.mouseRotate.mousedown(s,i),this.mousePitch&&this.mousePitch.mousedown(s,i),F.disableDrag()},Is.prototype.move=function(s,i){var n=this.map,l=this.mouseRotate.mousemoveWindow(s,i);if(l&&l.bearingDelta&&n.setBearing(n.getBearing()+l.bearingDelta),this.mousePitch){var y=this.mousePitch.mousemoveWindow(s,i);y&&y.pitchDelta&&n.setPitch(n.getPitch()+y.pitchDelta)}},Is.prototype.off=function(){var s=this.element;F.removeEventListener(s,"mousedown",this.mousedown),F.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),F.removeEventListener(s,"touchmove",this.touchmove),F.removeEventListener(s,"touchend",this.touchend),F.removeEventListener(s,"touchcancel",this.reset),this.offTemp()},Is.prototype.offTemp=function(){F.enableDrag(),F.removeEventListener(o.window,"mousemove",this.mousemove),F.removeEventListener(o.window,"mouseup",this.mouseup)},Is.prototype.mousedown=function(s){this.down(o.extend({},s,{ctrlKey:!0,preventDefault:function(){return s.preventDefault()}}),F.mousePos(this.element,s)),F.addEventListener(o.window,"mousemove",this.mousemove),F.addEventListener(o.window,"mouseup",this.mouseup)},Is.prototype.mousemove=function(s){this.move(s,F.mousePos(this.element,s))},Is.prototype.mouseup=function(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()},Is.prototype.touchstart=function(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=F.touchPos(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return s.preventDefault()}},this._startPos))},Is.prototype.touchmove=function(s){s.targetTouches.length!==1?this.reset():(this._lastPos=F.touchPos(this.element,s.targetTouches)[0],this.move({preventDefault:function(){return s.preventDefault()}},this._lastPos))},Is.prototype.touchend=function(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Is.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Gs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Pf(s,i,n){var l=s.classList;for(var y in Gs)l.remove("mapboxgl-"+n+"-anchor-"+y);l.add("mapboxgl-"+n+"-anchor-"+i)}var Kl,Zc=function(s){function i(n,l){if(s.call(this),(n instanceof o.window.HTMLElement||l)&&(n=o.extend({element:n},l)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=o.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=F.create("div"),this._element.setAttribute("aria-label","Map marker");var y=F.createNS("http://www.w3.org/2000/svg","svg");y.setAttributeNS(null,"display","block"),y.setAttributeNS(null,"height","41px"),y.setAttributeNS(null,"width","27px"),y.setAttributeNS(null,"viewBox","0 0 27 41");var M=F.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"stroke","none"),M.setAttributeNS(null,"stroke-width","1"),M.setAttributeNS(null,"fill","none"),M.setAttributeNS(null,"fill-rule","evenodd");var L=F.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill-rule","nonzero");var B=F.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"transform","translate(3.0, 29.0)"),B.setAttributeNS(null,"fill","#000000");for(var oe=0,Te=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];oe<Te.length;oe+=1){var Ge=Te[oe],Ke=F.createNS("http://www.w3.org/2000/svg","ellipse");Ke.setAttributeNS(null,"opacity","0.04"),Ke.setAttributeNS(null,"cx","10.5"),Ke.setAttributeNS(null,"cy","5.80029008"),Ke.setAttributeNS(null,"rx",Ge.rx),Ke.setAttributeNS(null,"ry",Ge.ry),B.appendChild(Ke)}var et=F.createNS("http://www.w3.org/2000/svg","g");et.setAttributeNS(null,"fill",this._color);var Ft=F.createNS("http://www.w3.org/2000/svg","path");Ft.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),et.appendChild(Ft);var Rt=F.createNS("http://www.w3.org/2000/svg","g");Rt.setAttributeNS(null,"opacity","0.25"),Rt.setAttributeNS(null,"fill","#000000");var Yt=F.createNS("http://www.w3.org/2000/svg","path");Yt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Rt.appendChild(Yt);var zt=F.createNS("http://www.w3.org/2000/svg","g");zt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),zt.setAttributeNS(null,"fill","#FFFFFF");var jt=F.createNS("http://www.w3.org/2000/svg","g");jt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var rr=F.createNS("http://www.w3.org/2000/svg","circle");rr.setAttributeNS(null,"fill","#000000"),rr.setAttributeNS(null,"opacity","0.25"),rr.setAttributeNS(null,"cx","5.5"),rr.setAttributeNS(null,"cy","5.5"),rr.setAttributeNS(null,"r","5.4999962");var nr=F.createNS("http://www.w3.org/2000/svg","circle");nr.setAttributeNS(null,"fill","#FFFFFF"),nr.setAttributeNS(null,"cx","5.5"),nr.setAttributeNS(null,"cy","5.5"),nr.setAttributeNS(null,"r","5.4999962"),jt.appendChild(rr),jt.appendChild(nr),L.appendChild(B),L.appendChild(et),L.appendChild(Rt),L.appendChild(zt),L.appendChild(jt),y.appendChild(L),y.setAttributeNS(null,"height",41*this._scale+"px"),y.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(y),this._offset=o.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(zr){zr.preventDefault()}),this._element.addEventListener("mousedown",function(zr){zr.preventDefault()}),Pf(this._element,this._anchor,"marker"),this._popup=null}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.addTo=function(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},i.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),F.remove(this._element),this._popup&&this._popup.remove(),this},i.prototype.getLngLat=function(){return this._lngLat},i.prototype.setLngLat=function(n){return this._lngLat=o.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},i.prototype.getElement=function(){return this._element},i.prototype.setPopup=function(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){var l=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(24.6+l)],"bottom-right":[-l,-1*(24.6+l)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},i.prototype._onKeyPress=function(n){var l=n.code,y=n.charCode||n.keyCode;l!=="Space"&&l!=="Enter"&&y!==32&&y!==13||this.togglePopup()},i.prototype._onMapClick=function(n){var l=n.originalEvent.target,y=this._element;this._popup&&(l===y||y.contains(l))&&this.togglePopup()},i.prototype.getPopup=function(){return this._popup},i.prototype.togglePopup=function(){var n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this},i.prototype._update=function(n){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Yl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var l="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?l="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(l="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y="rotateX("+this._map.getPitch()+"deg)"),n&&n.type!=="moveend"||(this._pos=this._pos.round()),F.setTransform(this._element,Gs[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+y+" "+l)}},i.prototype.getOffset=function(){return this._offset},i.prototype.setOffset=function(n){return this._offset=o.Point.convert(n),this._update(),this},i.prototype._onMove=function(n){if(!this._isDragging){var l=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))},i.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"},i.prototype._addDragHandler=function(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},i.prototype.setDraggable=function(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},i.prototype.isDraggable=function(){return this._draggable},i.prototype.setRotation=function(n){return this._rotation=n||0,this._update(),this},i.prototype.getRotation=function(){return this._rotation},i.prototype.setRotationAlignment=function(n){return this._rotationAlignment=n||"auto",this._update(),this},i.prototype.getRotationAlignment=function(){return this._rotationAlignment},i.prototype.setPitchAlignment=function(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this},i.prototype.getPitchAlignment=function(){return this._pitchAlignment},i}(o.Evented),_f={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},bs=0,Nu=!1,Wc=function(s){function i(n){s.call(this),this.options=o.extend({},_f,n),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.onAdd=function(n){var l;return this._map=n,this._container=F.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,Kl!==void 0?l(Kl):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(function(y){l(Kl=y.state!=="denied")}):l(Kl=!!o.window.navigator.geolocation),this._container},i.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),F.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,bs=0,Nu=!1},i.prototype._isOutOfMapMaxBounds=function(n){var l=this._map.getMaxBounds(),y=n.coords;return l&&(y.longitude<l.getWest()||y.longitude>l.getEast()||y.latitude<l.getSouth()||y.latitude>l.getNorth())},i.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},i.prototype._onSuccess=function(n){if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",n)),this._finish()}},i.prototype._updateCamera=function(n){var l=new o.LngLat(n.coords.longitude,n.coords.latitude),y=n.coords.accuracy,M=this._map.getBearing(),L=o.extend({bearing:M},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(y),L,{geolocateSource:!0})},i.prototype._updateMarker=function(n){if(n){var l=new o.LngLat(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},i.prototype._updateCircleRadius=function(){var n=this._map._container.clientHeight/2,l=this._map.unproject([0,n]),y=this._map.unproject([1,n]),M=l.distanceTo(y),L=Math.ceil(2*this._accuracy/M);this._circleElement.style.width=L+"px",this._circleElement.style.height=L+"px"},i.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},i.prototype._onError=function(n){if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&Nu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",n)),this._finish()}},i.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},i.prototype._setupUI=function(n){var l=this;if(this._container.addEventListener("contextmenu",function(L){return L.preventDefault()}),this._geolocateButton=F.create("button","mapboxgl-ctrl-geolocate",this._container),F.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",n===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var y=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=y,this._geolocateButton.setAttribute("aria-label",y)}else{var M=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=M,this._geolocateButton.setAttribute("aria-label",M)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=F.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Zc(this._dotElement),this._circleElement=F.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Zc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(L){L.geolocateSource||l._watchState!=="ACTIVE_LOCK"||L.originalEvent&&L.originalEvent.type==="resize"||(l._watchState="BACKGROUND",l._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),l._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),l.fire(new o.Event("trackuserlocationend")))})},i.prototype.trigger=function(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":bs--,Nu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var n;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++bs>1?(n={maximumAge:6e5,timeout:0},Nu=!0):(n=this.options.positionOptions,Nu=!1),this._geolocationWatchID=o.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,n)}}else o.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},i.prototype._clearWatch=function(){o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},i}(o.Evented),_l={maxWidth:100,unit:"metric"},Ml=function(i){this.options=o.extend({},_l,i),o.bindAll(["_onMove","setUnit"],this)};function hc(s,i,n){var l=n&&n.maxWidth||100,y=s._container.clientHeight/2,M=s.unproject([0,y]),L=s.unproject([l,y]),B=M.distanceTo(L);if(n&&n.unit==="imperial"){var oe=3.2808*B;oe>5280?Qu(i,l,oe/5280,s._getUIString("ScaleControl.Miles")):Qu(i,l,oe,s._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Qu(i,l,B/1852,s._getUIString("ScaleControl.NauticalMiles")):B>=1e3?Qu(i,l,B/1e3,s._getUIString("ScaleControl.Kilometers")):Qu(i,l,B,s._getUIString("ScaleControl.Meters"))}function Qu(s,i,n,l){var y,M,L,B=(y=n,(M=Math.pow(10,(""+Math.floor(y)).length-1))*(L=(L=y/M)>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function(oe){var Te=Math.pow(10,Math.ceil(-Math.log(oe)/Math.LN10));return Math.round(oe*Te)/Te}(L)));s.style.width=i*(B/n)+"px",s.innerHTML=B+"&nbsp;"+l}Ml.prototype.getDefaultPosition=function(){return"bottom-left"},Ml.prototype._onMove=function(){hc(this._map,this._container,this.options)},Ml.prototype.onAdd=function(s){return this._map=s,this._container=F.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",s.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ml.prototype.onRemove=function(){F.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ml.prototype.setUnit=function(s){this.options.unit=s,hc(this._map,this._container,this.options)};var Fs=function(i){this._fullscreen=!1,i&&i.container&&(i.container instanceof o.window.HTMLElement?this._container=i.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in o.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in o.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in o.window.document&&(this._fullscreenchange="MSFullscreenChange")};Fs.prototype.onAdd=function(s){return this._map=s,this._container||(this._container=this._map.getContainer()),this._controlContainer=F.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Fs.prototype.onRemove=function(){F.remove(this._controlContainer),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Fs.prototype._checkFullscreenSupport=function(){return!!(o.window.document.fullscreenEnabled||o.window.document.mozFullScreenEnabled||o.window.document.msFullscreenEnabled||o.window.document.webkitFullscreenEnabled)},Fs.prototype._setupUI=function(){var s=this._fullscreenButton=F.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);F.create("span","mapboxgl-ctrl-icon",s).setAttribute("aria-hidden",!0),s.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Fs.prototype._updateTitle=function(){var s=this._getTitle();this._fullscreenButton.setAttribute("aria-label",s),this._fullscreenButton.title=s},Fs.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Fs.prototype._isFullscreen=function(){return this._fullscreen},Fs.prototype._changeIcon=function(){(o.window.document.fullscreenElement||o.window.document.mozFullScreenElement||o.window.document.webkitFullscreenElement||o.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Fs.prototype._onClickFullscreen=function(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.mozCancelFullScreen?o.window.document.mozCancelFullScreen():o.window.document.msExitFullscreen?o.window.document.msExitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var dc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},pl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),vl=function(s){function i(n){s.call(this),this.options=o.extend(Object.create(dc),n),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return s&&(i.__proto__=s),(i.prototype=Object.create(s&&s.prototype)).constructor=i,i.prototype.addTo=function(n){return this._map&&this.remove(),this._map=n,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this},i.prototype.isOpen=function(){return!!this._map},i.prototype.remove=function(){return this._content&&F.remove(this._content),this._container&&(F.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this},i.prototype.getLngLat=function(){return this._lngLat},i.prototype.setLngLat=function(n){return this._lngLat=o.LngLat.convert(n),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},i.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},i.prototype.getElement=function(){return this._container},i.prototype.setText=function(n){return this.setDOMContent(o.window.document.createTextNode(n))},i.prototype.setHTML=function(n){var l,y=o.window.document.createDocumentFragment(),M=o.window.document.createElement("body");for(M.innerHTML=n;l=M.firstChild;)y.appendChild(l);return this.setDOMContent(y)},i.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},i.prototype.setMaxWidth=function(n){return this.options.maxWidth=n,this._update(),this},i.prototype.setDOMContent=function(n){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=F.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(n),this._createCloseButton(),this._update(),this._focusFirstElement(),this},i.prototype.addClassName=function(n){this._container&&this._container.classList.add(n)},i.prototype.removeClassName=function(n){this._container&&this._container.classList.remove(n)},i.prototype.setOffset=function(n){return this.options.offset=n,this._update(),this},i.prototype.toggleClassName=function(n){if(this._container)return this._container.classList.toggle(n)},i.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=F.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},i.prototype._onMouseUp=function(n){this._update(n.point)},i.prototype._onMouseMove=function(n){this._update(n.point)},i.prototype._onDrag=function(n){this._update(n.point)},i.prototype._update=function(n){var l=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=F.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=F.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Ke){return l._container.classList.add(Ke)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Yl(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||n)){var y=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat),M=this.options.anchor,L=function Ke(et){if(et){if(typeof et=="number"){var Ft=Math.round(Math.sqrt(.5*Math.pow(et,2)));return{center:new o.Point(0,0),top:new o.Point(0,et),"top-left":new o.Point(Ft,Ft),"top-right":new o.Point(-Ft,Ft),bottom:new o.Point(0,-et),"bottom-left":new o.Point(Ft,-Ft),"bottom-right":new o.Point(-Ft,-Ft),left:new o.Point(et,0),right:new o.Point(-et,0)}}if(et instanceof o.Point||Array.isArray(et)){var Rt=o.Point.convert(et);return{center:Rt,top:Rt,"top-left":Rt,"top-right":Rt,bottom:Rt,"bottom-left":Rt,"bottom-right":Rt,left:Rt,right:Rt}}return{center:o.Point.convert(et.center||[0,0]),top:o.Point.convert(et.top||[0,0]),"top-left":o.Point.convert(et["top-left"]||[0,0]),"top-right":o.Point.convert(et["top-right"]||[0,0]),bottom:o.Point.convert(et.bottom||[0,0]),"bottom-left":o.Point.convert(et["bottom-left"]||[0,0]),"bottom-right":o.Point.convert(et["bottom-right"]||[0,0]),left:o.Point.convert(et.left||[0,0]),right:o.Point.convert(et.right||[0,0])}}return Ke(new o.Point(0,0))}(this.options.offset);if(!M){var B,oe=this._container.offsetWidth,Te=this._container.offsetHeight;B=y.y+L.bottom.y<Te?["top"]:y.y>this._map.transform.height-Te?["bottom"]:[],y.x<oe/2?B.push("left"):y.x>this._map.transform.width-oe/2&&B.push("right"),M=B.length===0?"bottom":B.join("-")}var Ge=y.add(L[M]).round();F.setTransform(this._container,Gs[M]+" translate("+Ge.x+"px,"+Ge.y+"px)"),Pf(this._container,M,"popup")}},i.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var n=this._container.querySelector(pl);n&&n.focus()}},i.prototype._onClose=function(){this.remove()},i}(o.Evented),Il={version:o.version,supported:X,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:hl,NavigationControl:zu,GeolocateControl:Wc,AttributionControl:xs,ScaleControl:Ml,FullscreenControl:Fs,Popup:vl,Marker:Zc,Style:wa,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.Point,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,config:o.config,prewarm:function(){Cr().acquire(or)},clearPrewarmedResources:function(){var i=An;i&&(i.isPreloaded()&&i.numActive()===1?(i.release(or),An=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(s){o.config.ACCESS_TOKEN=s},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(s){o.config.API_URL=s},get workerCount(){return Vr.workerCount},set workerCount(s){Vr.workerCount=s},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(s){o.config.MAX_PARALLEL_IMAGE_REQUESTS=s},clearStorage:function(i){o.clearTileCache(i)},workerUrl:""};return Il}),Z})},"4cb6":function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.METADATA_KEY=void 0;var S=a("xfSm");x.METADATA_KEY=S;var v=a("9Fde");Object.defineProperty(x,"Container",{enumerable:!0,get:function(){return v.Container}});var Z=a("FV85");Object.defineProperty(x,"BindingScopeEnum",{enumerable:!0,get:function(){return Z.BindingScopeEnum}}),Object.defineProperty(x,"BindingTypeEnum",{enumerable:!0,get:function(){return Z.BindingTypeEnum}}),Object.defineProperty(x,"TargetTypeEnum",{enumerable:!0,get:function(){return Z.TargetTypeEnum}});var N=a("dxzI");Object.defineProperty(x,"AsyncContainerModule",{enumerable:!0,get:function(){return N.AsyncContainerModule}}),Object.defineProperty(x,"ContainerModule",{enumerable:!0,get:function(){return N.ContainerModule}});var o=a("cZ5Q");Object.defineProperty(x,"injectable",{enumerable:!0,get:function(){return o.injectable}});var X=a("0gSV");Object.defineProperty(x,"tagged",{enumerable:!0,get:function(){return X.tagged}});var F=a("ZzCi");Object.defineProperty(x,"named",{enumerable:!0,get:function(){return F.named}});var K=a("Yk9n");Object.defineProperty(x,"inject",{enumerable:!0,get:function(){return K.inject}}),Object.defineProperty(x,"LazyServiceIdentifer",{enumerable:!0,get:function(){return K.LazyServiceIdentifer}});var q=a("jYx5");Object.defineProperty(x,"optional",{enumerable:!0,get:function(){return q.optional}});var Ce=a("n2J3");Object.defineProperty(x,"unmanaged",{enumerable:!0,get:function(){return Ce.unmanaged}});var $=a("jIg/");Object.defineProperty(x,"multiInject",{enumerable:!0,get:function(){return $.multiInject}});var He=a("oaX6");Object.defineProperty(x,"targetName",{enumerable:!0,get:function(){return He.targetName}});var Be=a("Sk89");Object.defineProperty(x,"postConstruct",{enumerable:!0,get:function(){return Be.postConstruct}});var ce=a("wnjb");Object.defineProperty(x,"MetadataReader",{enumerable:!0,get:function(){return ce.MetadataReader}});var st=a("d9O0");Object.defineProperty(x,"id",{enumerable:!0,get:function(){return st.id}});var ut=a("Ztfv");Object.defineProperty(x,"decorate",{enumerable:!0,get:function(){return ut.decorate}});var Me=a("RR/i");Object.defineProperty(x,"traverseAncerstors",{enumerable:!0,get:function(){return Me.traverseAncerstors}}),Object.defineProperty(x,"taggedConstraint",{enumerable:!0,get:function(){return Me.taggedConstraint}}),Object.defineProperty(x,"namedConstraint",{enumerable:!0,get:function(){return Me.namedConstraint}}),Object.defineProperty(x,"typeConstraint",{enumerable:!0,get:function(){return Me.typeConstraint}});var bt=a("ujMp");Object.defineProperty(x,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return bt.getServiceIdentifierAsString}});var xt=a("78VC");Object.defineProperty(x,"multiBindToService",{enumerable:!0,get:function(){return xt.multiBindToService}})},"4kj+":function(we,x){},"4qC0":function(we,x,a){var S=a("NykK"),v=a("Z0cm"),Z=a("ExA7"),N="[object String]";function o(X){return typeof X=="string"||!v(X)&&Z(X)&&S(X)==N}we.exports=o},"5Tg0":function(we,x,a){(function(S){var v=a("Kz5y"),Z=x&&!x.nodeType&&x,N=Z&&typeof S=="object"&&S&&!S.nodeType&&S,o=N&&N.exports===Z,X=o?v.Buffer:void 0,F=X?X.allocUnsafe:void 0;function K(q,Ce){if(Ce)return q.slice();var $=q.length,He=F?F($):new q.constructor($);return q.copy(He),He}S.exports=K}).call(this,a("YuTi")(we))},"5gLl":function(we,x,a){"use strict";a.d(x,"a",function(){return H});var S=a("lSNA"),v=a.n(S),Z=a("LvWW"),N=a.n(Z),o=a("0wsv");function X(z){if(!z)throw new Error("coord is required");if(!Array.isArray(z)){if(z.type==="Feature"&&z.geometry!==null&&z.geometry.type==="Point")return z.geometry.coordinates;if(z.type==="Point")return z.coordinates}if(Array.isArray(z)&&z.length>=2&&!Array.isArray(z[0])&&!Array.isArray(z[1]))return z;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function F(z){if(Array.isArray(z))return z;if(z.type==="Feature"){if(z.geometry!==null)return z.geometry.coordinates}else if(z.coordinates)return z.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function K(z){if(z.length>1&&Object(o.c)(z[0])&&Object(o.c)(z[1]))return!0;if(Array.isArray(z[0])&&z[0].length)return K(z[0]);throw new Error("coordinates must only contain numbers")}function q(z,V,be){if(!V||!be)throw new Error("type and name required");if(!z||z.type!==V)throw new Error("Invalid input to "+be+": must be a "+V+", given "+z.type)}function Ce(z,V,be){if(!z)throw new Error("No feature passed");if(!be)throw new Error(".featureOf() requires a name");if(!z||z.type!=="Feature"||!z.geometry)throw new Error("Invalid input to "+be+", Feature with geometry required");if(!z.geometry||z.geometry.type!==V)throw new Error("Invalid input to "+be+": must be a "+V+", given "+z.geometry.type)}function $(z,V,be){if(!z)throw new Error("No featureCollection passed");if(!be)throw new Error(".collectionOf() requires a name");if(!z||z.type!=="FeatureCollection")throw new Error("Invalid input to "+be+", FeatureCollection required");for(var me=0,le=z.features;me<le.length;me++){var fe=le[me];if(!fe||fe.type!=="Feature"||!fe.geometry)throw new Error("Invalid input to "+be+", Feature with geometry required");if(!fe.geometry||fe.geometry.type!==V)throw new Error("Invalid input to "+be+": must be a "+V+", given "+fe.geometry.type)}}function He(z){return z.type==="Feature"?z.geometry:z}function Be(z,V){return z.type==="FeatureCollection"?"FeatureCollection":z.type==="GeometryCollection"?"GeometryCollection":z.type==="Feature"&&z.geometry!==null?z.geometry.type:z.type}function ce(z,V,be){if(z!==null)for(var me,le,fe,Ne,lt,rt,ue,ye=0,Ue=0,ft,Oe=z.type,Ve=Oe==="FeatureCollection",P=Oe==="Feature",R=Ve?z.features.length:1,J=0;J<R;J++){ue=Ve?z.features[J].geometry:P?z.geometry:z,ft=ue?ue.type==="GeometryCollection":!1,lt=ft?ue.geometries.length:1;for(var de=0;de<lt;de++){var je=0,We=0;if(Ne=ft?ue.geometries[de]:ue,Ne!==null){rt=Ne.coordinates;var gt=Ne.type;switch(ye=be&&(gt==="Polygon"||gt==="MultiPolygon")?1:0,gt){case null:break;case"Point":if(V(rt,Ue,J,je,We)===!1)return!1;Ue++,je++;break;case"LineString":case"MultiPoint":for(me=0;me<rt.length;me++){if(V(rt[me],Ue,J,je,We)===!1)return!1;Ue++,gt==="MultiPoint"&&je++}gt==="LineString"&&je++;break;case"Polygon":case"MultiLineString":for(me=0;me<rt.length;me++){for(le=0;le<rt[me].length-ye;le++){if(V(rt[me][le],Ue,J,je,We)===!1)return!1;Ue++}gt==="MultiLineString"&&je++,gt==="Polygon"&&We++}gt==="Polygon"&&je++;break;case"MultiPolygon":for(me=0;me<rt.length;me++){for(We=0,le=0;le<rt[me].length;le++){for(fe=0;fe<rt[me][le].length-ye;fe++){if(V(rt[me][le][fe],Ue,J,je,We)===!1)return!1;Ue++}We++}je++}break;case"GeometryCollection":for(me=0;me<Ne.geometries.length;me++)if(ce(Ne.geometries[me],V,be)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function st(z,V,be,me){var le=be;return ce(z,function(fe,Ne,lt,rt,ue){Ne===0&&be===void 0?le=fe:le=V(le,fe,Ne,lt,rt,ue)},me),le}function ut(z,V){var be;switch(z.type){case"FeatureCollection":for(be=0;be<z.features.length&&V(z.features[be].properties,be)!==!1;be++);break;case"Feature":V(z.properties,0);break}}function Me(z,V,be){var me=be;return ut(z,function(le,fe){fe===0&&be===void 0?me=le:me=V(me,le,fe)}),me}function bt(z,V){if(z.type==="Feature")V(z,0);else if(z.type==="FeatureCollection")for(var be=0;be<z.features.length&&V(z.features[be],be)!==!1;be++);}function xt(z,V,be){var me=be;return bt(z,function(le,fe){fe===0&&be===void 0?me=le:me=V(me,le,fe)}),me}function Mt(z){var V=[];return ce(z,function(be){V.push(be)}),V}function De(z,V){var be,me,le,fe,Ne,lt,rt,ue,ye,Ue,ft=0,Oe=z.type==="FeatureCollection",Ve=z.type==="Feature",P=Oe?z.features.length:1;for(be=0;be<P;be++){for(lt=Oe?z.features[be].geometry:Ve?z.geometry:z,ue=Oe?z.features[be].properties:Ve?z.properties:{},ye=Oe?z.features[be].bbox:Ve?z.bbox:void 0,Ue=Oe?z.features[be].id:Ve?z.id:void 0,rt=lt?lt.type==="GeometryCollection":!1,Ne=rt?lt.geometries.length:1,le=0;le<Ne;le++){if(fe=rt?lt.geometries[le]:lt,fe===null){if(V(null,ft,ue,ye,Ue)===!1)return!1;continue}switch(fe.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(V(fe,ft,ue,ye,Ue)===!1)return!1;break}case"GeometryCollection":{for(me=0;me<fe.geometries.length;me++)if(V(fe.geometries[me],ft,ue,ye,Ue)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}ft++}}function ar(z,V,be){var me=be;return De(z,function(le,fe,Ne,lt,rt){fe===0&&be===void 0?me=le:me=V(me,le,fe,Ne,lt,rt)}),me}function $t(z,V){De(z,function(be,me,le,fe,Ne){var lt=be===null?null:be.type;switch(lt){case null:case"Point":case"LineString":case"Polygon":return V(Object(o.b)(be,le,{bbox:fe,id:Ne}),me,0)===!1?!1:void 0}var rt;switch(lt){case"MultiPoint":rt="Point";break;case"MultiLineString":rt="LineString";break;case"MultiPolygon":rt="Polygon";break}for(var ue=0;ue<be.coordinates.length;ue++){var ye=be.coordinates[ue],Ue={type:rt,coordinates:ye};if(V(Object(o.b)(Ue,le),me,ue)===!1)return!1}})}function Ht(z,V,be){var me=be;return $t(z,function(le,fe,Ne){fe===0&&Ne===0&&be===void 0?me=le:me=V(me,le,fe,Ne)}),me}function vt(z,V){$t(z,function(be,me,le){var fe=0;if(!!be.geometry){var Ne=be.geometry.type;if(!(Ne==="Point"||Ne==="MultiPoint")){var lt,rt=0,ue=0,ye=0;if(ce(be,function(Ue,ft,Oe,Ve,P){if(lt===void 0||me>rt||Ve>ue||P>ye){lt=Ue,rt=me,ue=Ve,ye=P,fe=0;return}var R=Object(o.e)([lt,Ue],be.properties);if(V(R,me,le,P,fe)===!1)return!1;fe++,lt=Ue})===!1)return!1}}})}function Ze(z,V,be){var me=be,le=!1;return vt(z,function(fe,Ne,lt,rt,ue){le===!1&&be===void 0?me=fe:me=V(me,fe,Ne,lt,rt,ue),le=!0}),me}function Et(z,V){if(!z)throw new Error("geojson is required");$t(z,function(be,me,le){if(be.geometry!==null){var fe=be.geometry.type,Ne=be.geometry.coordinates;switch(fe){case"LineString":if(V(be,me,le,0,0)===!1)return!1;break;case"Polygon":for(var lt=0;lt<Ne.length;lt++)if(V(Object(o.e)(Ne[lt],be.properties),me,le,lt)===!1)return!1;break}}})}function Le(z,V,be){var me=be;return Et(z,function(le,fe,Ne,lt){fe===0&&be===void 0?me=le:me=V(me,le,fe,Ne,lt)}),me}function at(z,V){if(V=V||{},!Object(o.d)(V))throw new Error("options is invalid");var be=V.featureIndex||0,me=V.multiFeatureIndex||0,le=V.geometryIndex||0,fe=V.segmentIndex||0,Ne=V.properties,lt;switch(z.type){case"FeatureCollection":be<0&&(be=z.features.length+be),Ne=Ne||z.features[be].properties,lt=z.features[be].geometry;break;case"Feature":Ne=Ne||z.properties,lt=z.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":lt=z;break;default:throw new Error("geojson is invalid")}if(lt===null)return null;var rt=lt.coordinates;switch(lt.type){case"Point":case"MultiPoint":return null;case"LineString":return fe<0&&(fe=rt.length+fe-1),Object(o.e)([rt[fe],rt[fe+1]],Ne,V);case"Polygon":return le<0&&(le=rt.length+le),fe<0&&(fe=rt[le].length+fe-1),Object(o.e)([rt[le][fe],rt[le][fe+1]],Ne,V);case"MultiLineString":return me<0&&(me=rt.length+me),fe<0&&(fe=rt[me].length+fe-1),Object(o.e)([rt[me][fe],rt[me][fe+1]],Ne,V);case"MultiPolygon":return me<0&&(me=rt.length+me),le<0&&(le=rt[me].length+le),fe<0&&(fe=rt[me][le].length-fe-1),Object(o.e)([rt[me][le][fe],rt[me][le][fe+1]],Ne,V)}throw new Error("geojson is invalid")}function Wt(z,V){if(V=V||{},!Object(o.d)(V))throw new Error("options is invalid");var be=V.featureIndex||0,me=V.multiFeatureIndex||0,le=V.geometryIndex||0,fe=V.coordIndex||0,Ne=V.properties,lt;switch(z.type){case"FeatureCollection":be<0&&(be=z.features.length+be),Ne=Ne||z.features[be].properties,lt=z.features[be].geometry;break;case"Feature":Ne=Ne||z.properties,lt=z.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":lt=z;break;default:throw new Error("geojson is invalid")}if(lt===null)return null;var rt=lt.coordinates;switch(lt.type){case"Point":return Object(o.f)(rt,Ne,V);case"MultiPoint":return me<0&&(me=rt.length+me),Object(o.f)(rt[me],Ne,V);case"LineString":return fe<0&&(fe=rt.length+fe),Object(o.f)(rt[fe],Ne,V);case"Polygon":return le<0&&(le=rt.length+le),fe<0&&(fe=rt[le].length+fe),Object(o.f)(rt[le][fe],Ne,V);case"MultiLineString":return me<0&&(me=rt.length+me),fe<0&&(fe=rt[me].length+fe),Object(o.f)(rt[me][fe],Ne,V);case"MultiPolygon":return me<0&&(me=rt.length+me),le<0&&(le=rt[me].length+le),fe<0&&(fe=rt[me][le].length-fe),Object(o.f)(rt[me][le][fe],Ne,V)}throw new Error("geojson is invalid")}function St(z,V){var be=Object.keys(z);if(Object.getOwnPropertySymbols){var me=Object.getOwnPropertySymbols(z);V&&(me=me.filter(function(le){return Object.getOwnPropertyDescriptor(z,le).enumerable})),be.push.apply(be,me)}return be}function dt(z){for(var V=1;V<arguments.length;V++){var be=arguments[V]!=null?arguments[V]:{};V%2?St(Object(be),!0).forEach(function(me){v()(z,me,be[me])}):Object.getOwnPropertyDescriptors?Object.defineProperties(z,Object.getOwnPropertyDescriptors(be)):St(Object(be)).forEach(function(me){Object.defineProperty(z,me,Object.getOwnPropertyDescriptor(be,me))})}return z}function H(z,V){var be=[],me={};if(z.features=z.features.filter(function(fe){var Ne=fe.geometry;return fe!=null&&Ne&&Ne.type&&Ne.coordinates&&Ne.coordinates.length>0}),N()(z,!0),z.features.length===0)return{dataArray:[],featureKeys:me};var le=0;return $t(z,function(fe,Ne){var lt=F(fe),rt=Ne,ue=dt(dt({},fe.properties),{},{coordinates:lt,_id:rt});be.push(ue)}),{dataArray:be,featureKeys:me}}},"5ku3":function(we,x,a){"use strict";(function(S){a.d(x,"a",function(){return N});var v=a("U8pU"),Z=a("I0ug");function N(){var X=(typeof S=="undefined"?"undefined":Object(v.a)(S))==="object"&&String(S)==="[object process]"&&!S.browser;return!X||Object(Z.a)()}function o(){return N()&&typeof document!="undefined"}}).call(this,a("Q2Ig"))},"5zYK":function(we,x,a){"use strict";a.d(x,"a",function(){return q});var S=a("lSNA"),v=a.n(S),Z=a("RIqP"),N=a.n(Z),o=a("LvWW"),X=a.n(o);function F(Ce,$){var He=Object.keys(Ce);if(Object.getOwnPropertySymbols){var Be=Object.getOwnPropertySymbols(Ce);$&&(Be=Be.filter(function(ce){return Object.getOwnPropertyDescriptor(Ce,ce).enumerable})),He.push.apply(He,Be)}return He}function K(Ce){for(var $=1;$<arguments.length;$++){var He=arguments[$]!=null?arguments[$]:{};$%2?F(Object(He),!0).forEach(function(Be){v()(Ce,Be,He[Be])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ce,Object.getOwnPropertyDescriptors(He)):F(Object(He)).forEach(function(Be){Object.defineProperty(Ce,Be,Object.getOwnPropertyDescriptor(He,Be))})}return Ce}function q(Ce,$){var He=$.x,Be=$.y,ce=$.x1,st=$.y1,ut=$.coordinates,Me=[];return Ce.forEach(function(bt,xt){var Mt=[];if(He&&Be&&(Mt=[parseFloat(bt[He]),parseFloat(bt[Be])]),He&&Be&&ce&&st){var De=[parseFloat(bt[He]),parseFloat(bt[Be])],ar=[parseFloat(bt[ce]),parseFloat(bt[st])];Mt=[De,ar]}if(ut){var $t="Polygon";Array.isArray(ut[0])||($t="Point"),Array.isArray(ut[0])&&!Array.isArray(ut[0][0])&&($t="LineString");var Ht={type:$t,coordinates:N()(bt[ut])};X()(Ht,!0),Mt=Ht.coordinates}var vt=K(K({},bt),{},{_id:xt,coordinates:Mt});Me.push(vt)}),{dataArray:Me}}},"6AGu":function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.BindingInSyntax=void 0;var S=a("FV85"),v=a("LKzl"),Z=function(){function N(o){this._binding=o}return N.prototype.inRequestScope=function(){return this._binding.scope=S.BindingScopeEnum.Request,new v.BindingWhenOnSyntax(this._binding)},N.prototype.inSingletonScope=function(){return this._binding.scope=S.BindingScopeEnum.Singleton,new v.BindingWhenOnSyntax(this._binding)},N.prototype.inTransientScope=function(){return this._binding.scope=S.BindingScopeEnum.Transient,new v.BindingWhenOnSyntax(this._binding)},N}();x.BindingInSyntax=Z},"6D9b":function(we,x,a){we.exports={"ant-statistic":"ant-statistic","ant-statistic-title":"ant-statistic-title","ant-statistic-content":"ant-statistic-content","ant-statistic-content-value":"ant-statistic-content-value","ant-statistic-content-prefix":"ant-statistic-content-prefix","ant-statistic-content-suffix":"ant-statistic-content-suffix","ant-statistic-rtl":"ant-statistic-rtl"}},"6NqC":function(we,x){},"6acW":function(we,x,a){var S=a("dt0z"),v=a("gQMU");function Z(N){return v(S(N).toLowerCase())}we.exports=Z},"6nK8":function(we,x,a){var S=a("dVn5"),v=a("fo6e"),Z=a("dt0z"),N=a("9NmV");function o(X,F,K){return X=Z(X),F=K?void 0:F,F===void 0?v(X)?N(X):S(X):X.match(F)||[]}we.exports=o},"711d":function(we,x){function a(S){return function(v){return v==null?void 0:v[S]}}we.exports=a},"78VC":function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.multiBindToService=void 0,x.multiBindToService=function(S){return function(v){return function(){for(var Z=[],N=0;N<arguments.length;N++)Z[N]=arguments[N];return Z.forEach(function(o){return S.bind(o).toService(v)})}}}},"7Ix3":function(we,x){function a(S){var v=[];if(S!=null)for(var Z in Object(S))v.push(Z);return v}we.exports=a},"7W2i":function(we,x,a){var S=a("SksO");function v(Z,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function");Z.prototype=Object.create(N&&N.prototype,{constructor:{value:Z,writable:!0,configurable:!0}}),N&&S(Z,N)}we.exports=v},"7tbW":function(we,x,a){var S=a("LGYb");function v(Z){return Z&&Z.length?S(Z):[]}we.exports=v},"8/Fi":function(we,x,a){"use strict";var S=a("J4zp"),v=a.n(S),Z=a("9nhX"),N=a.n(Z),o=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"];function X(at){return o.indexOf(at)}var F=2,K=4,q=64,Ce=128,$=256,He=512,Be=8192,ce=16384,st=32768,ut=32768*2,Me=131072,bt=262144,xt=524288,Mt=1048576,De=2097152,ar=4194304,$t=8388608,Ht=16777216,vt=16777216*2;function Ze(at,Wt){return at=N()(Math.floor(at),0,255),Wt=N()(Math.floor(Wt),0,255),256*at+Wt}function Et(at){var Wt=at.color,St=at.radius,dt=at.tileX,H=at.tileY,z=at.shape,V=at.opacity,be=at.stroke,me=at.strokeWidth,le=at.strokeOpacity,fe=[],Ne=[],lt=[],rt=[Ze(Wt[0],Wt[1]),Ze(Wt[2],Wt[3])],ue=[Ze(be[0],be[1]),Ze(be[2],be[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(ye){var Ue=v()(ye,2),ft=Ue[0],Oe=Ue[1];fe.push([].concat(rt,[(ft+1)*$t+(Oe+1)*De+X(z)*Me+St,(dt+512)*xt+(H+512)*q])),Ne.push([].concat(ue,[me,le])),lt.push([V,0,0,0])}),{packedBuffer:fe,packedBuffer2:Ne,packedBuffer3:lt}}function Le(at,Wt){if(at===0&&!Wt)return 0;if(at===1&&Wt)return 4294967295;var St=Wt?1:0,dt=Math.floor(at*127);return dt*vt+St*Ht+dt*Me+St*ut+dt*He+St*$+dt*F+St}},"88Gu":function(we,x){var a=800,S=16,v=Date.now;function Z(N){var o=0,X=0;return function(){var F=v(),K=S-(F-X);if(X=F,K>0){if(++o>=a)return arguments[0]}else o=0;return N.apply(void 0,arguments)}}we.exports=Z},"8ml+":function(we,x,a){"use strict";var S=a("h1nZ");a.o(S,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return S.CityBuildingLayer}),a.o(S,"Control")&&a.d(x,"Control",function(){return S.Control}),a.o(S,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return S.HeatmapLayer}),a.o(S,"ImageLayer")&&a.d(x,"ImageLayer",function(){return S.ImageLayer}),a.o(S,"LineLayer")&&a.d(x,"LineLayer",function(){return S.LineLayer}),a.o(S,"Logo")&&a.d(x,"Logo",function(){return S.Logo}),a.o(S,"Marker")&&a.d(x,"Marker",function(){return S.Marker}),a.o(S,"PointLayer")&&a.d(x,"PointLayer",function(){return S.PointLayer}),a.o(S,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return S.PolygonLayer}),a.o(S,"Popup")&&a.d(x,"Popup",function(){return S.Popup}),a.o(S,"RasterLayer")&&a.d(x,"RasterLayer",function(){return S.RasterLayer}),a.o(S,"Scale")&&a.d(x,"Scale",function(){return S.Scale}),a.o(S,"Scene")&&a.d(x,"Scene",function(){return S.Scene}),a.o(S,"Zoom")&&a.d(x,"Zoom",function(){return S.Zoom});var v=a("kQ+U");a.d(x,"Scene",function(){return v.a});var Z=a("sxDa");a.d(x,"CityBuildingLayer",function(){return Z.a}),a.d(x,"HeatmapLayer",function(){return Z.b}),a.d(x,"ImageLayer",function(){return Z.c}),a.d(x,"LineLayer",function(){return Z.d}),a.d(x,"PointLayer",function(){return Z.e}),a.d(x,"PolygonLayer",function(){return Z.f}),a.d(x,"RasterLayer",function(){return Z.g});var N=a("k5/I");a.d(x,"Control",function(){return N.a}),a.d(x,"Logo",function(){return N.b}),a.d(x,"Marker",function(){return N.c}),a.d(x,"Popup",function(){return N.d}),a.d(x,"Scale",function(){return N.e}),a.d(x,"Zoom",function(){return N.f});var o=a("Hel2"),X=a("RL2/")},"8uyu":function(we,x){},"9Fde":function(we,x,a){"use strict";var S=this&&this.__awaiter||function(ut,Me,bt,xt){function Mt(De){return De instanceof bt?De:new bt(function(ar){ar(De)})}return new(bt||(bt=Promise))(function(De,ar){function $t(Ze){try{vt(xt.next(Ze))}catch(Et){ar(Et)}}function Ht(Ze){try{vt(xt.throw(Ze))}catch(Et){ar(Et)}}function vt(Ze){Ze.done?De(Ze.value):Mt(Ze.value).then($t,Ht)}vt((xt=xt.apply(ut,Me||[])).next())})},v=this&&this.__generator||function(ut,Me){var bt={label:0,sent:function(){if(De[0]&1)throw De[1];return De[1]},trys:[],ops:[]},xt,Mt,De,ar;return ar={next:$t(0),throw:$t(1),return:$t(2)},typeof Symbol=="function"&&(ar[Symbol.iterator]=function(){return this}),ar;function $t(vt){return function(Ze){return Ht([vt,Ze])}}function Ht(vt){if(xt)throw new TypeError("Generator is already executing.");for(;bt;)try{if(xt=1,Mt&&(De=vt[0]&2?Mt.return:vt[0]?Mt.throw||((De=Mt.return)&&De.call(Mt),0):Mt.next)&&!(De=De.call(Mt,vt[1])).done)return De;switch(Mt=0,De&&(vt=[vt[0]&2,De.value]),vt[0]){case 0:case 1:De=vt;break;case 4:return bt.label++,{value:vt[1],done:!1};case 5:bt.label++,Mt=vt[1],vt=[0];continue;case 7:vt=bt.ops.pop(),bt.trys.pop();continue;default:if(De=bt.trys,!(De=De.length>0&&De[De.length-1])&&(vt[0]===6||vt[0]===2)){bt=0;continue}if(vt[0]===3&&(!De||vt[1]>De[0]&&vt[1]<De[3])){bt.label=vt[1];break}if(vt[0]===6&&bt.label<De[1]){bt.label=De[1],De=vt;break}if(De&&bt.label<De[2]){bt.label=De[2],bt.ops.push(vt);break}De[2]&&bt.ops.pop(),bt.trys.pop();continue}vt=Me.call(ut,bt)}catch(Ze){vt=[6,Ze],Mt=0}finally{xt=De=0}if(vt[0]&5)throw vt[1];return{value:vt[0]?vt[1]:void 0,done:!0}}};Object.defineProperty(x,"__esModule",{value:!0}),x.Container=void 0;var Z=a("LgvC"),N=a("MON2"),o=a("FV85"),X=a("xfSm"),F=a("wnjb"),K=a("h7MG"),q=a("aPG5"),Ce=a("gzZq"),$=a("d9O0"),He=a("ujMp"),Be=a("HpQ9"),ce=a("AwBQ"),st=function(){function ut(Me){var bt=Me||{};if(typeof bt!="object")throw new Error(""+N.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(bt.defaultScope===void 0)bt.defaultScope=o.BindingScopeEnum.Transient;else if(bt.defaultScope!==o.BindingScopeEnum.Singleton&&bt.defaultScope!==o.BindingScopeEnum.Transient&&bt.defaultScope!==o.BindingScopeEnum.Request)throw new Error(""+N.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(bt.autoBindInjectable===void 0)bt.autoBindInjectable=!1;else if(typeof bt.autoBindInjectable!="boolean")throw new Error(""+N.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(bt.skipBaseClassChecks===void 0)bt.skipBaseClassChecks=!1;else if(typeof bt.skipBaseClassChecks!="boolean")throw new Error(""+N.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:bt.autoBindInjectable,defaultScope:bt.defaultScope,skipBaseClassChecks:bt.skipBaseClassChecks},this.id=$.id(),this._bindingDictionary=new ce.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new F.MetadataReader}return ut.merge=function(Me,bt){var xt=new ut,Mt=K.getBindingDictionary(xt),De=K.getBindingDictionary(Me),ar=K.getBindingDictionary(bt);function $t(Ht,vt){Ht.traverse(function(Ze,Et){Et.forEach(function(Le){vt.add(Le.serviceIdentifier,Le.clone())})})}return $t(De,Mt),$t(ar,Mt),xt},ut.prototype.load=function(){for(var Me=[],bt=0;bt<arguments.length;bt++)Me[bt]=arguments[bt];for(var xt=this._getContainerModuleHelpersFactory(),Mt=0,De=Me;Mt<De.length;Mt++){var ar=De[Mt],$t=xt(ar.id);ar.registry($t.bindFunction,$t.unbindFunction,$t.isboundFunction,$t.rebindFunction)}},ut.prototype.loadAsync=function(){for(var Me=[],bt=0;bt<arguments.length;bt++)Me[bt]=arguments[bt];return S(this,void 0,void 0,function(){var xt,Mt,De,ar,$t;return v(this,function(Ht){switch(Ht.label){case 0:xt=this._getContainerModuleHelpersFactory(),Mt=0,De=Me,Ht.label=1;case 1:return Mt<De.length?(ar=De[Mt],$t=xt(ar.id),[4,ar.registry($t.bindFunction,$t.unbindFunction,$t.isboundFunction,$t.rebindFunction)]):[3,4];case 2:Ht.sent(),Ht.label=3;case 3:return Mt++,[3,1];case 4:return[2]}})})},ut.prototype.unload=function(){for(var Me=this,bt=[],xt=0;xt<arguments.length;xt++)bt[xt]=arguments[xt];var Mt=function(ar){return function($t){return $t.moduleId===ar}};bt.forEach(function(De){var ar=Mt(De.id);Me._bindingDictionary.removeByCondition(ar)})},ut.prototype.bind=function(Me){var bt=this.options.defaultScope||o.BindingScopeEnum.Transient,xt=new Z.Binding(Me,bt);return this._bindingDictionary.add(Me,xt),new Ce.BindingToSyntax(xt)},ut.prototype.rebind=function(Me){return this.unbind(Me),this.bind(Me)},ut.prototype.unbind=function(Me){try{this._bindingDictionary.remove(Me)}catch(bt){throw new Error(N.CANNOT_UNBIND+" "+He.getServiceIdentifierAsString(Me))}},ut.prototype.unbindAll=function(){this._bindingDictionary=new ce.Lookup},ut.prototype.isBound=function(Me){var bt=this._bindingDictionary.hasKey(Me);return!bt&&this.parent&&(bt=this.parent.isBound(Me)),bt},ut.prototype.isBoundNamed=function(Me,bt){return this.isBoundTagged(Me,X.NAMED_TAG,bt)},ut.prototype.isBoundTagged=function(Me,bt,xt){var Mt=!1;if(this._bindingDictionary.hasKey(Me)){var De=this._bindingDictionary.get(Me),ar=K.createMockRequest(this,Me,bt,xt);Mt=De.some(function($t){return $t.constraint(ar)})}return!Mt&&this.parent&&(Mt=this.parent.isBoundTagged(Me,bt,xt)),Mt},ut.prototype.snapshot=function(){this._snapshots.push(Be.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},ut.prototype.restore=function(){var Me=this._snapshots.pop();if(Me===void 0)throw new Error(N.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Me.bindings,this._middleware=Me.middleware},ut.prototype.createChild=function(Me){var bt=new ut(Me||this.options);return bt.parent=this,bt},ut.prototype.applyMiddleware=function(){for(var Me=[],bt=0;bt<arguments.length;bt++)Me[bt]=arguments[bt];var xt=this._middleware?this._middleware:this._planAndResolve();this._middleware=Me.reduce(function(Mt,De){return De(Mt)},xt)},ut.prototype.applyCustomMetadataReader=function(Me){this._metadataReader=Me},ut.prototype.get=function(Me){return this._get(!1,!1,o.TargetTypeEnum.Variable,Me)},ut.prototype.getTagged=function(Me,bt,xt){return this._get(!1,!1,o.TargetTypeEnum.Variable,Me,bt,xt)},ut.prototype.getNamed=function(Me,bt){return this.getTagged(Me,X.NAMED_TAG,bt)},ut.prototype.getAll=function(Me){return this._get(!0,!0,o.TargetTypeEnum.Variable,Me)},ut.prototype.getAllTagged=function(Me,bt,xt){return this._get(!1,!0,o.TargetTypeEnum.Variable,Me,bt,xt)},ut.prototype.getAllNamed=function(Me,bt){return this.getAllTagged(Me,X.NAMED_TAG,bt)},ut.prototype.resolve=function(Me){var bt=this.createChild();return bt.bind(Me).toSelf(),bt.get(Me)},ut.prototype._getContainerModuleHelpersFactory=function(){var Me=this,bt=function(Ht,vt){Ht._binding.moduleId=vt},xt=function(Ht){return function(vt){var Ze=Me.bind.bind(Me),Et=Ze(vt);return bt(Et,Ht),Et}},Mt=function(Ht){return function(vt){var Ze=Me.unbind.bind(Me);Ze(vt)}},De=function(Ht){return function(vt){var Ze=Me.isBound.bind(Me);return Ze(vt)}},ar=function(Ht){return function(vt){var Ze=Me.rebind.bind(Me),Et=Ze(vt);return bt(Et,Ht),Et}};return function($t){return{bindFunction:xt($t),isboundFunction:De($t),rebindFunction:ar($t),unbindFunction:Mt($t)}}},ut.prototype._get=function(Me,bt,xt,Mt,De,ar){var $t=null,Ht={avoidConstraints:Me,contextInterceptor:function(Ze){return Ze},isMultiInject:bt,key:De,serviceIdentifier:Mt,targetType:xt,value:ar};if(this._middleware){if($t=this._middleware(Ht),$t==null)throw new Error(N.INVALID_MIDDLEWARE_RETURN)}else $t=this._planAndResolve()(Ht);return $t},ut.prototype._planAndResolve=function(){var Me=this;return function(bt){var xt=K.plan(Me._metadataReader,Me,bt.isMultiInject,bt.targetType,bt.serviceIdentifier,bt.key,bt.value,bt.avoidConstraints);xt=bt.contextInterceptor(xt);var Mt=q.resolve(xt);return Mt}},ut}();x.Container=st},"9NmV":function(we,x){var a="\\ud800-\\udfff",S="\\u0300-\\u036f",v="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",N=S+v+Z,o="\\u2700-\\u27bf",X="a-z\\xdf-\\xf6\\xf8-\\xff",F="\\xac\\xb1\\xd7\\xf7",K="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",q="\\u2000-\\u206f",Ce=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",$="A-Z\\xc0-\\xd6\\xd8-\\xde",He="\\ufe0e\\ufe0f",Be=F+K+q+Ce,ce="['\u2019]",st="["+Be+"]",ut="["+N+"]",Me="\\d+",bt="["+o+"]",xt="["+X+"]",Mt="[^"+a+Be+Me+o+X+$+"]",De="\\ud83c[\\udffb-\\udfff]",ar="(?:"+ut+"|"+De+")",$t="[^"+a+"]",Ht="(?:\\ud83c[\\udde6-\\uddff]){2}",vt="[\\ud800-\\udbff][\\udc00-\\udfff]",Ze="["+$+"]",Et="\\u200d",Le="(?:"+xt+"|"+Mt+")",at="(?:"+Ze+"|"+Mt+")",Wt="(?:"+ce+"(?:d|ll|m|re|s|t|ve))?",St="(?:"+ce+"(?:D|LL|M|RE|S|T|VE))?",dt=ar+"?",H="["+He+"]?",z="(?:"+Et+"(?:"+[$t,Ht,vt].join("|")+")"+H+dt+")*",V="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",be="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",me=H+dt+z,le="(?:"+[bt,Ht,vt].join("|")+")"+me,fe=RegExp([Ze+"?"+xt+"+"+Wt+"(?="+[st,Ze,"$"].join("|")+")",at+"+"+St+"(?="+[st,Ze+Le,"$"].join("|")+")",Ze+"?"+Le+"+"+Wt,Ze+"+"+St,be,V,Me,le].join("|"),"g");function Ne(lt){return lt.match(fe)||[]}we.exports=Ne},"9lTW":function(we,x,a){"use strict";(function(S){var v=a("MgzW");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function Z(Le,at){if(Le===at)return 0;for(var Wt=Le.length,St=at.length,dt=0,H=Math.min(Wt,St);dt<H;++dt)if(Le[dt]!==at[dt]){Wt=Le[dt],St=at[dt];break}return Wt<St?-1:St<Wt?1:0}function N(Le){return S.Buffer&&typeof S.Buffer.isBuffer=="function"?S.Buffer.isBuffer(Le):!!(Le!=null&&Le._isBuffer)}var o=a("MCLT"),X=Object.prototype.hasOwnProperty,F=Array.prototype.slice,K=function(){return function(){}.name==="foo"}();function q(Le){return Object.prototype.toString.call(Le)}function Ce(Le){return N(Le)||typeof S.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(Le):Le?!!(Le instanceof DataView||Le.buffer&&Le.buffer instanceof ArrayBuffer):!1}var $=we.exports=bt,He=/\s*function\s+([^\(\s]*)\s*/;function Be(Le){if(!!o.isFunction(Le)){if(K)return Le.name;var at=Le.toString(),Wt=at.match(He);return Wt&&Wt[1]}}$.AssertionError=function(at){this.name="AssertionError",this.actual=at.actual,this.expected=at.expected,this.operator=at.operator,at.message?(this.message=at.message,this.generatedMessage=!1):(this.message=ut(this),this.generatedMessage=!0);var Wt=at.stackStartFunction||Me;if(Error.captureStackTrace)Error.captureStackTrace(this,Wt);else{var St=new Error;if(St.stack){var dt=St.stack,H=Be(Wt),z=dt.indexOf(`
`+H);if(z>=0){var V=dt.indexOf(`
`,z+1);dt=dt.substring(V+1)}this.stack=dt}}},o.inherits($.AssertionError,Error);function ce(Le,at){return typeof Le=="string"?Le.length<at?Le:Le.slice(0,at):Le}function st(Le){if(K||!o.isFunction(Le))return o.inspect(Le);var at=Be(Le),Wt=at?": "+at:"";return"[Function"+Wt+"]"}function ut(Le){return ce(st(Le.actual),128)+" "+Le.operator+" "+ce(st(Le.expected),128)}function Me(Le,at,Wt,St,dt){throw new $.AssertionError({message:Wt,actual:Le,expected:at,operator:St,stackStartFunction:dt})}$.fail=Me;function bt(Le,at){Le||Me(Le,!0,at,"==",$.ok)}$.ok=bt,$.equal=function(at,Wt,St){at!=Wt&&Me(at,Wt,St,"==",$.equal)},$.notEqual=function(at,Wt,St){at==Wt&&Me(at,Wt,St,"!=",$.notEqual)},$.deepEqual=function(at,Wt,St){xt(at,Wt,!1)||Me(at,Wt,St,"deepEqual",$.deepEqual)},$.deepStrictEqual=function(at,Wt,St){xt(at,Wt,!0)||Me(at,Wt,St,"deepStrictEqual",$.deepStrictEqual)};function xt(Le,at,Wt,St){if(Le===at)return!0;if(N(Le)&&N(at))return Z(Le,at)===0;if(o.isDate(Le)&&o.isDate(at))return Le.getTime()===at.getTime();if(o.isRegExp(Le)&&o.isRegExp(at))return Le.source===at.source&&Le.global===at.global&&Le.multiline===at.multiline&&Le.lastIndex===at.lastIndex&&Le.ignoreCase===at.ignoreCase;if((Le===null||typeof Le!="object")&&(at===null||typeof at!="object"))return Wt?Le===at:Le==at;if(Ce(Le)&&Ce(at)&&q(Le)===q(at)&&!(Le instanceof Float32Array||Le instanceof Float64Array))return Z(new Uint8Array(Le.buffer),new Uint8Array(at.buffer))===0;if(N(Le)!==N(at))return!1;St=St||{actual:[],expected:[]};var dt=St.actual.indexOf(Le);return dt!==-1&&dt===St.expected.indexOf(at)?!0:(St.actual.push(Le),St.expected.push(at),De(Le,at,Wt,St))}function Mt(Le){return Object.prototype.toString.call(Le)=="[object Arguments]"}function De(Le,at,Wt,St){if(Le==null||at===null||at===void 0)return!1;if(o.isPrimitive(Le)||o.isPrimitive(at))return Le===at;if(Wt&&Object.getPrototypeOf(Le)!==Object.getPrototypeOf(at))return!1;var dt=Mt(Le),H=Mt(at);if(dt&&!H||!dt&&H)return!1;if(dt)return Le=F.call(Le),at=F.call(at),xt(Le,at,Wt);var z=Et(Le),V=Et(at),be,me;if(z.length!==V.length)return!1;for(z.sort(),V.sort(),me=z.length-1;me>=0;me--)if(z[me]!==V[me])return!1;for(me=z.length-1;me>=0;me--)if(be=z[me],!xt(Le[be],at[be],Wt,St))return!1;return!0}$.notDeepEqual=function(at,Wt,St){xt(at,Wt,!1)&&Me(at,Wt,St,"notDeepEqual",$.notDeepEqual)},$.notDeepStrictEqual=ar;function ar(Le,at,Wt){xt(Le,at,!0)&&Me(Le,at,Wt,"notDeepStrictEqual",ar)}$.strictEqual=function(at,Wt,St){at!==Wt&&Me(at,Wt,St,"===",$.strictEqual)},$.notStrictEqual=function(at,Wt,St){at===Wt&&Me(at,Wt,St,"!==",$.notStrictEqual)};function $t(Le,at){if(!Le||!at)return!1;if(Object.prototype.toString.call(at)=="[object RegExp]")return at.test(Le);try{if(Le instanceof at)return!0}catch(Wt){}return Error.isPrototypeOf(at)?!1:at.call({},Le)===!0}function Ht(Le){var at;try{Le()}catch(Wt){at=Wt}return at}function vt(Le,at,Wt,St){var dt;if(typeof at!="function")throw new TypeError('"block" argument must be a function');typeof Wt=="string"&&(St=Wt,Wt=null),dt=Ht(at),St=(Wt&&Wt.name?" ("+Wt.name+").":".")+(St?" "+St:"."),Le&&!dt&&Me(dt,Wt,"Missing expected exception"+St);var H=typeof St=="string",z=!Le&&o.isError(dt),V=!Le&&dt&&!Wt;if((z&&H&&$t(dt,Wt)||V)&&Me(dt,Wt,"Got unwanted exception"+St),Le&&dt&&Wt&&!$t(dt,Wt)||!Le&&dt)throw dt}$.throws=function(Le,at,Wt){vt(!0,Le,at,Wt)},$.doesNotThrow=function(Le,at,Wt){vt(!1,Le,at,Wt)},$.ifError=function(Le){if(Le)throw Le};function Ze(Le,at){Le||Me(Le,!0,at,"==",Ze)}$.strict=v(Ze,$,{equal:$.strictEqual,deepEqual:$.deepStrictEqual,notEqual:$.notStrictEqual,notDeepEqual:$.notDeepStrictEqual}),$.strict.strict=$.strict;var Et=Object.keys||function(Le){var at=[];for(var Wt in Le)X.call(Le,Wt)&&at.push(Wt);return at}}).call(this,a("yLpj"))},"9nhX":function(we,x,a){var S=a("g4R6"),v=a("tLB3");function Z(N,o,X){return X===void 0&&(X=o,o=void 0),X!==void 0&&(X=v(X),X=X===X?X:0),o!==void 0&&(o=v(o),o=o===o?o:0),S(v(N),o,X)}we.exports=Z},AFH1:function(we,x,a){"use strict";a.d(x,"a",function(){return S});var S;(function(v){v.TOPRIGHT="topright",v.TOPLEFT="topleft",v.BOTTOMRIGHT="bottomright",v.BOTTOMLEFT="bottomleft"})(S||(S={}))},APxj:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0});var S=a("Ucsi");function v(Z,N){N===void 0&&(N=!0);var o=S.makePropertyInjectDecorator(Z,N),X=S.makePropertyInjectNamedDecorator(Z,N),F=S.makePropertyInjectTaggedDecorator(Z,N),K=S.makePropertyMultiInjectDecorator(Z,N);return{lazyInject:o,lazyInjectNamed:X,lazyInjectTagged:F,lazyMultiInject:K}}x.default=v},AwBQ:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.Lookup=void 0;var S=a("MON2"),v=function(){function Z(){this._map=new Map}return Z.prototype.getMap=function(){return this._map},Z.prototype.add=function(N,o){if(N==null)throw new Error(S.NULL_ARGUMENT);if(o==null)throw new Error(S.NULL_ARGUMENT);var X=this._map.get(N);X!==void 0?(X.push(o),this._map.set(N,X)):this._map.set(N,[o])},Z.prototype.get=function(N){if(N==null)throw new Error(S.NULL_ARGUMENT);var o=this._map.get(N);if(o!==void 0)return o;throw new Error(S.KEY_NOT_FOUND)},Z.prototype.remove=function(N){if(N==null)throw new Error(S.NULL_ARGUMENT);if(!this._map.delete(N))throw new Error(S.KEY_NOT_FOUND)},Z.prototype.removeByCondition=function(N){var o=this;this._map.forEach(function(X,F){var K=X.filter(function(q){return!N(q)});K.length>0?o._map.set(F,K):o._map.delete(F)})},Z.prototype.hasKey=function(N){if(N==null)throw new Error(S.NULL_ARGUMENT);return this._map.has(N)},Z.prototype.clone=function(){var N=new Z;return this._map.forEach(function(o,X){o.forEach(function(F){return N.add(X,F.clone())})}),N},Z.prototype.traverse=function(N){this._map.forEach(function(o,X){N(X,o)})},Z}();x.Lookup=v},"B6l+":function(we,x,a){var S=a("Sq3C"),v=a("Z1HP"),Z=a("Sxd8"),N=a("dt0z");function o(X,F,K){X=N(X),F=Z(F);var q=F?v(X):0;return F&&q<F?X+S(F-q,K):X}we.exports=o},BGjm:function(we,x){we.exports=a;function a(S,v){v||(v=document);var Z=v.head||v.getElementsByTagName("head")[0];if(!Z){Z=v.createElement("head");var N=v.body||v.getElementsByTagName("body")[0];N?N.parentNode.insertBefore(Z,N):v.documentElement.appendChild(Z)}var o=v.createElement("style");return o.type="text/css",o.styleSheet?o.styleSheet.cssText=S:o.appendChild(v.createTextNode(S)),Z.appendChild(o),o}},BMrR:function(we,x,a){"use strict";var S=a("qrJ5");x.a=S.a},BkRI:function(we,x,a){var S=a("OBhP"),v=1,Z=4;function N(o){return S(o,v|Z)}we.exports=N},Bnag:function(we,x){function a(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}we.exports=a},BpBL:function(we,x,a){"use strict";a.d(x,"a",function(){return v});var S=a("Hel2");function v(N,o){var X=o.extent,F=new Promise(function(q){Z(N,function(Ce){q(Ce)})}),K={images:F,_id:1,dataArray:[{_id:0,coordinates:[[X[0],X[1]],[X[2],X[3]]]}]};return K}function Z(N,o){var X=N,F=[];if(typeof X=="string")Object(S.o)({url:X},function(Ce,$){F.push($),o(F)});else{var K=X.length,q=0;X.forEach(function(Ce){Object(S.o)({url:Ce},function($,He){q++,F.push(He),q===K&&o(F)})})}return v}},CIdX:function(we,x,a){we.exports={waterWave:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWave",text:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-text",waterWaveCanvasWrapper:"antd-pro-pages-dashboard-monitor-components-charts-water-wave-index-waterWaveCanvasWrapper"}},CZoQ:function(we,x){function a(S,v,Z){for(var N=Z-1,o=S.length;++N<o;)if(S[N]===v)return N;return-1}we.exports=a},"D+ow":function(we,x){},D9lx:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.BindingInWhenOnSyntax=void 0;var S=a("6AGu"),v=a("406g"),Z=a("z4Hk"),N=function(){function o(X){this._binding=X,this._bindingWhenSyntax=new Z.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new v.BindingOnSyntax(this._binding),this._bindingInSyntax=new S.BindingInSyntax(X)}return o.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},o.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},o.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},o.prototype.when=function(X){return this._bindingWhenSyntax.when(X)},o.prototype.whenTargetNamed=function(X){return this._bindingWhenSyntax.whenTargetNamed(X)},o.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},o.prototype.whenTargetTagged=function(X,F){return this._bindingWhenSyntax.whenTargetTagged(X,F)},o.prototype.whenInjectedInto=function(X){return this._bindingWhenSyntax.whenInjectedInto(X)},o.prototype.whenParentNamed=function(X){return this._bindingWhenSyntax.whenParentNamed(X)},o.prototype.whenParentTagged=function(X,F){return this._bindingWhenSyntax.whenParentTagged(X,F)},o.prototype.whenAnyAncestorIs=function(X){return this._bindingWhenSyntax.whenAnyAncestorIs(X)},o.prototype.whenNoAncestorIs=function(X){return this._bindingWhenSyntax.whenNoAncestorIs(X)},o.prototype.whenAnyAncestorNamed=function(X){return this._bindingWhenSyntax.whenAnyAncestorNamed(X)},o.prototype.whenAnyAncestorTagged=function(X,F){return this._bindingWhenSyntax.whenAnyAncestorTagged(X,F)},o.prototype.whenNoAncestorNamed=function(X){return this._bindingWhenSyntax.whenNoAncestorNamed(X)},o.prototype.whenNoAncestorTagged=function(X,F){return this._bindingWhenSyntax.whenNoAncestorTagged(X,F)},o.prototype.whenAnyAncestorMatches=function(X){return this._bindingWhenSyntax.whenAnyAncestorMatches(X)},o.prototype.whenNoAncestorMatches=function(X){return this._bindingWhenSyntax.whenNoAncestorMatches(X)},o.prototype.onActivation=function(X){return this._bindingOnSyntax.onActivation(X)},o}();x.BindingInWhenOnSyntax=N},DnfT:function(we,x,a){we.exports={"ant-pro-grid-content":"ant-pro-grid-content",wide:"wide"}},"Dw+G":function(we,x,a){var S=a("juv8"),v=a("mTTR");function Z(N,o){return N&&S(o,v(o),N)}we.exports=Z},DzJC:function(we,x,a){var S=a("sEfC"),v=a("GoyQ"),Z="Expected a function";function N(o,X,F){var K=!0,q=!0;if(typeof o!="function")throw new TypeError(Z);return v(F)&&(K="leading"in F?!!F.leading:K,q="trailing"in F?!!F.trailing:q),S(o,X,{leading:K,maxWait:X,trailing:q})}we.exports=N},EA7m:function(we,x,a){var S=a("zZ0H"),v=a("Ioao"),Z=a("wclG");function N(o,X){return Z(v(o,X,S),o+"")}we.exports=N},EEGq:function(we,x,a){var S=a("juv8"),v=a("oCl/");function Z(N,o){return S(N,v(N),o)}we.exports=Z},EbDI:function(we,x){function a(S){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(S))return Array.from(S)}we.exports=a},EfZ0:function(we,x,a){"use strict";a.d(x,"a",function(){return S});var S={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},Em2t:function(we,x,a){var S=a("bahg"),v=a("quyA"),Z=a("0JQy");function N(o){return v(o)?Z(o):S(o)}we.exports=N},FI6e:function(we,x){},FRQA:function(we,x,a){"use strict";var S=a("GNNt"),v=a("wEI+"),Z=a("DnfT"),N=a.n(Z),o=a("q1tI"),X=a.n(o),F=a("TSYQ"),K=a.n(F),q=a("jYQm"),Ce=function(He){var Be=Object(o.useContext)(q.a),ce=He.children,st=He.contentWidth,ut=He.className,Me=He.style,bt=Object(o.useContext)(v.b.ConfigContext),xt=bt.getPrefixCls,Mt=He.prefixCls||xt("pro"),De=st||Be.contentWidth,ar="".concat(Mt,"-grid-content");return X.a.createElement("div",{className:K()(ar,ut,{wide:De==="Fixed"}),style:Me},X.a.createElement("div",{className:"".concat(Mt,"-grid-content-children")},ce))};x.a=Ce},FV85:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.TargetTypeEnum=x.BindingTypeEnum=x.BindingScopeEnum=void 0;var S={Request:"Request",Singleton:"Singleton",Transient:"Transient"};x.BindingScopeEnum=S;var v={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};x.BindingTypeEnum=v;var Z={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};x.TargetTypeEnum=Z},FmoU:function(we,x,a){"use strict";a.d(x,"a",function(){return Mt}),a.d(x,"b",function(){return Ht});var S=function(z,V,be){z.prototype=V.prototype=be,be.constructor=z};function v(z,V){var be=Object.create(z.prototype);for(var me in V)be[me]=V[me];return be}function Z(){}var N=.7,o=1/N,X="\\s*([+-]?\\d+)\\s*",F="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",K="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",q=/^#([0-9a-f]{3,8})$/,Ce=new RegExp("^rgb\\("+[X,X,X]+"\\)$"),$=new RegExp("^rgb\\("+[K,K,K]+"\\)$"),He=new RegExp("^rgba\\("+[X,X,X,F]+"\\)$"),Be=new RegExp("^rgba\\("+[K,K,K,F]+"\\)$"),ce=new RegExp("^hsl\\("+[F,K,K]+"\\)$"),st=new RegExp("^hsla\\("+[F,K,K,F]+"\\)$"),ut={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};S(Z,Mt,{copy:function(V){return Object.assign(new this.constructor,this,V)},displayable:function(){return this.rgb().displayable()},hex:Me,formatHex:Me,formatHsl:bt,formatRgb:xt,toString:xt});function Me(){return this.rgb().formatHex()}function bt(){return Wt(this).formatHsl()}function xt(){return this.rgb().formatRgb()}function Mt(z){var V,be;return z=(z+"").trim().toLowerCase(),(V=q.exec(z))?(be=V[1].length,V=parseInt(V[1],16),be===6?De(V):be===3?new vt(V>>8&15|V>>4&240,V>>4&15|V&240,(V&15)<<4|V&15,1):be===8?ar(V>>24&255,V>>16&255,V>>8&255,(V&255)/255):be===4?ar(V>>12&15|V>>8&240,V>>8&15|V>>4&240,V>>4&15|V&240,((V&15)<<4|V&15)/255):null):(V=Ce.exec(z))?new vt(V[1],V[2],V[3],1):(V=$.exec(z))?new vt(V[1]*255/100,V[2]*255/100,V[3]*255/100,1):(V=He.exec(z))?ar(V[1],V[2],V[3],V[4]):(V=Be.exec(z))?ar(V[1]*255/100,V[2]*255/100,V[3]*255/100,V[4]):(V=ce.exec(z))?at(V[1],V[2]/100,V[3]/100,1):(V=st.exec(z))?at(V[1],V[2]/100,V[3]/100,V[4]):ut.hasOwnProperty(z)?De(ut[z]):z==="transparent"?new vt(NaN,NaN,NaN,0):null}function De(z){return new vt(z>>16&255,z>>8&255,z&255,1)}function ar(z,V,be,me){return me<=0&&(z=V=be=NaN),new vt(z,V,be,me)}function $t(z){return z instanceof Z||(z=Mt(z)),z?(z=z.rgb(),new vt(z.r,z.g,z.b,z.opacity)):new vt}function Ht(z,V,be,me){return arguments.length===1?$t(z):new vt(z,V,be,me==null?1:me)}function vt(z,V,be,me){this.r=+z,this.g=+V,this.b=+be,this.opacity=+me}S(vt,Ht,v(Z,{brighter:function(V){return V=V==null?o:Math.pow(o,V),new vt(this.r*V,this.g*V,this.b*V,this.opacity)},darker:function(V){return V=V==null?N:Math.pow(N,V),new vt(this.r*V,this.g*V,this.b*V,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ze,formatHex:Ze,formatRgb:Et,toString:Et}));function Ze(){return"#"+Le(this.r)+Le(this.g)+Le(this.b)}function Et(){var z=this.opacity;return z=isNaN(z)?1:Math.max(0,Math.min(1,z)),(z===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(z===1?")":", "+z+")")}function Le(z){return z=Math.max(0,Math.min(255,Math.round(z)||0)),(z<16?"0":"")+z.toString(16)}function at(z,V,be,me){return me<=0?z=V=be=NaN:be<=0||be>=1?z=V=NaN:V<=0&&(z=NaN),new dt(z,V,be,me)}function Wt(z){if(z instanceof dt)return new dt(z.h,z.s,z.l,z.opacity);if(z instanceof Z||(z=Mt(z)),!z)return new dt;if(z instanceof dt)return z;z=z.rgb();var V=z.r/255,be=z.g/255,me=z.b/255,le=Math.min(V,be,me),fe=Math.max(V,be,me),Ne=NaN,lt=fe-le,rt=(fe+le)/2;return lt?(V===fe?Ne=(be-me)/lt+(be<me)*6:be===fe?Ne=(me-V)/lt+2:Ne=(V-be)/lt+4,lt/=rt<.5?fe+le:2-fe-le,Ne*=60):lt=rt>0&&rt<1?0:Ne,new dt(Ne,lt,rt,z.opacity)}function St(z,V,be,me){return arguments.length===1?Wt(z):new dt(z,V,be,me==null?1:me)}function dt(z,V,be,me){this.h=+z,this.s=+V,this.l=+be,this.opacity=+me}S(dt,St,v(Z,{brighter:function(V){return V=V==null?o:Math.pow(o,V),new dt(this.h,this.s,this.l*V,this.opacity)},darker:function(V){return V=V==null?N:Math.pow(N,V),new dt(this.h,this.s,this.l*V,this.opacity)},rgb:function(){var V=this.h%360+(this.h<0)*360,be=isNaN(V)||isNaN(this.s)?0:this.s,me=this.l,le=me+(me<.5?me:1-me)*be,fe=2*me-le;return new vt(H(V>=240?V-240:V+120,fe,le),H(V,fe,le),H(V<120?V+240:V-120,fe,le),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var V=this.opacity;return V=isNaN(V)?1:Math.max(0,Math.min(1,V)),(V===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(V===1?")":", "+V+")")}}));function H(z,V,be){return(z<60?V+(be-V)*z/60:z<180?be:z<240?V+(be-V)*(240-z)/60:V)*255}},G6z8:function(we,x,a){var S=a("fR/l"),v=a("oCl/"),Z=a("mTTR");function N(o){return S(o,Z,v)}we.exports=N},GXnB:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.Metadata=void 0;var S=a("xfSm"),v=function(){function Z(N,o){this.key=N,this.value=o}return Z.prototype.toString=function(){return this.key===S.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},Z}();x.Metadata=v},Gi0A:function(we,x,a){var S=a("QqLw"),v=a("ExA7"),Z="[object Map]";function N(o){return v(o)&&S(o)==Z}we.exports=N},"H+7v":function(we,x,a){we.exports={activeChart:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChart",activeChartGrid:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartGrid",activeChartLegend:"antd-pro-pages-dashboard-monitor-components-active-chart-index-activeChartLegend",dashedLine:"antd-pro-pages-dashboard-monitor-components-active-chart-index-dashedLine",line:"antd-pro-pages-dashboard-monitor-components-active-chart-index-line"}},Hel2:function(we,x,a){"use strict";a.d(x,"o",function(){return ft}),a.d(x,"m",function(){return P}),a.d(x,"p",function(){return je}),a.d(x,"d",function(){return Y}),a.d(x,"q",function(){return re}),a.d(x,"r",function(){return Gt}),a.d(x,"j",function(){return ur}),a.d(x,"h",function(){return ct}),a.d(x,"b",function(){return ht}),a.d(x,"i",function(){return Pt}),a.d(x,"s",function(){return Pe}),a.d(x,"k",function(){return ot}),a.d(x,"l",function(){return $e}),a.d(x,"n",function(){return Vt}),a.d(x,"f",function(){return dr}),a.d(x,"e",function(){return Zr}),a.d(x,"g",function(){return cr}),a.d(x,"a",function(){return S}),a.d(x,"c",function(){return v});var S={};a.r(S),a.d(S,"getContainer",function(){return K}),a.d(S,"trim",function(){return q}),a.d(S,"splitWords",function(){return Ce}),a.d(S,"create",function(){return He}),a.d(S,"remove",function(){return Be}),a.d(S,"addClass",function(){return ce}),a.d(S,"removeClass",function(){return st}),a.d(S,"hasClass",function(){return ut}),a.d(S,"setClass",function(){return Me}),a.d(S,"getClass",function(){return bt}),a.d(S,"empty",function(){return xt}),a.d(S,"setTransform",function(){return De}),a.d(S,"triggerResize",function(){return ar}),a.d(S,"printCanvas",function(){return $t}),a.d(S,"getViewPortScale",function(){return Ht}),a.d(S,"DPR",function(){return vt});var v={};a.r(v),a.d(v,"sum",function(){return ni}),a.d(v,"max",function(){return Un}),a.d(v,"min",function(){return Sn}),a.d(v,"mean",function(){return fi}),a.d(v,"mode",function(){return Wn}),a.d(v,"statMap",function(){return Gn}),a.d(v,"getColumn",function(){return Ee}),a.d(v,"getSatByColumn",function(){return pe});function Z(W){var ae=131,Ie=137,qe=0;W+="x";for(var Ct=Math.floor(9007199254740991/Ie),Re=0;Re<W.length;Re++)qe>Ct&&(qe=Math.floor(qe/Ie)),qe=qe*ae+W.charCodeAt(Re);return qe}function N(W){W=W.toString();for(var ae=5381,Ie=W.length;Ie;)ae=ae*33^W.charCodeAt(--Ie);return ae>>>0}var o=a("J4zp"),X=a.n(o),F=window.document.documentElement.style;function K(W){var ae=W;return typeof W=="string"&&(ae=document.getElementById(W)),ae}function q(W){return W.trim?W.trim():W.replace(/^\s+|\s+$/g,"")}function Ce(W){return q(W).split(/\s+/)}function $(W){if(!F)return W[0];for(var ae in W)if(W[ae]&&W[ae]in F)return W[ae];return W[0]}function He(W,ae,Ie){var qe=document.createElement(W);return qe.className=ae||"",Ie&&Ie.appendChild(qe),qe}function Be(W){var ae=W.parentNode;ae&&ae.removeChild(W)}function ce(W,ae){if(W.classList!==void 0)for(var Ie=Ce(ae),qe=0,Ct=Ie.length;qe<Ct;qe++)W.classList.add(Ie[qe]);else if(!ut(W,ae)){var Re=bt(W);Me(W,(Re?Re+" ":"")+ae)}}function st(W,ae){W.classList!==void 0?W.classList.remove(ae):Me(W,q((" "+bt(W)+" ").replace(" "+ae+" "," ")))}function ut(W,ae){if(W.classList!==void 0)return W.classList.contains(ae);var Ie=bt(W);return Ie.length>0&&new RegExp("(^|\\s)"+ae+"(\\s|$)").test(Ie)}function Me(W,ae){W instanceof HTMLElement?W.className=ae:W.className.baseVal=ae}function bt(W){return W instanceof SVGElement&&(W=W.correspondingElement),W.className.baseVal===void 0?W.className:W.className.baseVal}function xt(W){for(;W&&W.firstChild;)W.removeChild(W.firstChild)}var Mt=$(["transform","WebkitTransform"]);function De(W,ae){W.style[Mt]=ae}function ar(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var W=window.document.createEvent("UIEvents");W.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(W)}}function $t(W){var ae=["padding: "+(W.height/2-8)+"px "+W.width/2+"px;","line-height: "+W.height+"px;","background-image: url("+W.toDataURL()+");"];console.log(`%c
`,ae.join(""))}function Ht(){var W,ae=document.querySelector('meta[name="viewport"]');if(!ae)return 1;var Ie=(W=ae.content)===null||W===void 0?void 0:W.split(","),qe=Ie.find(function(Ct){var Re=Ct.split("="),mt=X()(Re,2),Qt=mt[0],Br=mt[1];return Qt==="initial-scale"});return qe?qe.split("=")[1]*1:1}var vt=Ht()<1?1:window.devicePixelRatio,Ze=a("lwsE"),Et=a.n(Ze),Le=a("W8MJ"),at=a.n(Le),Wt=a("7W2i"),St=a.n(Wt),dt=a("a1gu"),H=a.n(dt),z=a("Nsbk"),V=a.n(z),be=a("oShl"),me=a.n(be);function le(W){var ae=fe();return function(){var qe=V()(W),Ct;if(ae){var Re=V()(this).constructor;Ct=Reflect.construct(qe,arguments,Re)}else Ct=qe.apply(this,arguments);return H()(this,Ct)}}function fe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(W){return!1}}var Ne=function(W){St()(Ie,W);var ae=le(Ie);function Ie(qe,Ct,Re){var mt;return Et()(this,Ie),mt=ae.call(this,qe),mt.status=void 0,mt.url=void 0,mt.status=Ct,mt.url=Re,mt.name=mt.constructor.name,mt.message=qe,mt}return at()(Ie,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),Ie}(me()(Error));function lt(W){var ae=new XMLHttpRequest;ae.open("GET",W.url,!0);for(var Ie in W.headers)W.headers.hasOwnProperty(Ie)&&ae.setRequestHeader(Ie,W.headers[Ie]);return ae.withCredentials=W.credentials==="include",ae}var rt=function(ae,Ie){var qe=lt(ae);return qe.setRequestHeader("Accept","application/json"),qe.onerror=function(){Ie(new Error(qe.statusText))},qe.onload=function(){if(qe.status>=200&&qe.status<300&&qe.response){var Ct;try{Ct=JSON.parse(qe.response)}catch(Re){return Ie(Re)}Ie(null,Ct)}else qe.status===401?Ie(new Ne("".concat(qe.statusText),qe.status,ae.url)):Ie(new Ne(qe.statusText,qe.status,ae.url))},qe.send(),qe},ue=function(ae,Ie){var qe=lt(ae);return qe.responseType="arraybuffer",qe.onerror=function(){Ie(new Error(qe.statusText))},qe.onload=function(){var Ct=qe.response;if(Ct.byteLength===0&&qe.status===200)return Ie(new Error("http status 200 returned without content."));qe.status>=200&&qe.status<300&&qe.response?Ie(null,{data:Ct,cacheControl:qe.getResponseHeader("Cache-Control"),expires:qe.getResponseHeader("Expires")}):Ie(new Ne(qe.statusText,qe.status,ae.url))},qe.send(),qe};function ye(W){var ae=window.document.createElement("a");return ae.href=W,ae.protocol===window.document.location.protocol&&ae.host===window.document.location.host}var Ue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",ft=function(ae,Ie){return ue(ae,function(qe,Ct){if(qe)Ie(qe);else if(Ct){var Re=new window.Image;Re.crossOrigin="anonymous";var mt=window.URL||window.webkitURL;Re.onload=function(){Ie(null,Re),mt.revokeObjectURL(Re.src)};var Qt=new window.Blob([new Uint8Array(Ct.data)],{type:"image/png"});Re.src=Ct.data.byteLength?mt.createObjectURL(Qt):Ue}})},Oe=a("0wsv"),Ve=2*Math.PI*6378137/2;function P(W){var ae=[Infinity,Infinity,-Infinity,-Infinity];return W.forEach(function(Ie){var qe=Ie.coordinates;R(ae,qe)}),ae}function R(W,ae){return Array.isArray(ae[0])?ae.forEach(function(Ie){R(W,Ie)}):(W[0]>ae[0]&&(W[0]=ae[0]),W[1]>ae[1]&&(W[1]=ae[1]),W[2]<ae[0]&&(W[2]=ae[0]),W[3]<ae[1]&&(W[3]=ae[1])),W}function J(W,ae){return de(W,ae)}function de(W,ae){return Array.isArray(W[0])?W.map(function(Ie){return de(Ie,ae)}):ae(W)}function je(W){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,Ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};W=Nt(W,ae);var qe=W[0],Ct=W[1],Re=qe*Ve/180,mt=Math.log(Math.tan((90+Ct)*Math.PI/360))/(Math.PI/180);return mt=mt*Ve/180,Ie.enable&&(Re=Number(Re.toFixed(Ie.decimal)),mt=Number(mt.toFixed(Ie.decimal))),W.length===3?[Re,mt,W[2]]:[Re,mt]}function We(W){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,Ie=W[0],qe=W[1],Ct=Ie/Ve*180,Re=qe/Ve*180;return Re=180/Math.PI*(2*Math.atan(Math.exp(Re*Math.PI/180))-Math.PI/2),ae!=null&&(Ct=Number(Ct.toFixed(ae)),Re=Number(Re.toFixed(ae))),W.length===3?[Ct,Re,W[2]]:[Ct,Re]}function gt(W){if(W==null)throw new Error("lng is required");return(W>180||W<-180)&&(W=W%360,W>180&&(W=-360+W),W<-180&&(W=360+W),W===0&&(W=0)),W}function nt(W){if(W==null)throw new Error("lat is required");return(W>90||W<-90)&&(W=W%180,W>90&&(W=-180+W),W<-90&&(W=180+W),W===0&&(W=0)),W}function Nt(W,ae){if(ae===!1)return W;var Ie=gt(W[0]),qe=nt(W[1]);return qe>85&&(qe=85),qe<-85&&(qe=-85),W.length===3?[Ie,qe,W[2]]:[Ie,qe]}function Y(W){var ae=85.0511287798,Ie=Math.max(Math.min(ae,W[1]),-ae),qe=256<<20,Ct=Math.PI/180,Re=W[0]*Ct,mt=Ie*Ct;mt=Math.log(Math.tan(Math.PI/4+mt/2));var Qt=.5/Math.PI,Br=.5,Ur=-.5/Math.PI;return Ct=.5,Re=qe*(Qt*Re+Br),mt=qe*(Ur*mt+Ct),[Math.floor(Re),Math.floor(mt)]}function Xe(W){var ae=.5/Math.PI,Ie=.5,qe=-.5/Math.PI,Ct=.5,Re=256<<20,mt=X()(W,2),Qt=mt[0],Br=mt[1];Qt=(Qt/Re-Ie)/ae,Br=(Br/Re-Ct)/qe,Br=(Math.atan(Math.pow(Math.E,Br))-Math.PI/4)*2,Ct=Math.PI/180;var Ur=Br/Ct,or=Qt/Ct;return[or,Ur]}function re(W,ae,Ie){var qe=Object(Oe.a)(ae[1]-W[1]),Ct=Object(Oe.a)(ae[0]-W[0]),Re=Object(Oe.a)(W[1]),mt=Object(Oe.a)(ae[1]),Qt=Math.pow(Math.sin(qe/2),2)+Math.pow(Math.sin(Ct/2),2)*Math.cos(Re)*Math.cos(mt);return Object(Oe.g)(2*Math.atan2(Math.sqrt(Qt),Math.sqrt(1-Qt)),Ie="meters")}function Je(W){var ae=Math.PI/180,Ie=85.0511287798,qe=6378137,Ct=Math.max(Math.min(Ie,W[1]),-Ie),Re=Math.sin(Ct*ae),mt=qe*W[0]*ae,Qt=qe*Math.log((1+Re)/(1-Re))/2;return[mt,Qt]}function Gt(W,ae){var Ie=Math.abs(W[1][1]-W[0][1])*ae,qe=Math.abs(W[1][0]-W[0][0])*ae;return[[W[0][0]-qe,W[0][1]-Ie],[W[1][0]+qe,W[1][1]+Ie]]}function ur(W,ae){return W[0][0]<=ae[0][0]&&W[0][1]<=ae[0][1]&&W[1][0]>=ae[1][0]&&W[1][1]>=ae[1][1]}function ct(W){return[[W[0],W[1]],[W[2],W[3]]]}var ht=function(){function W(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,Ie=arguments.length>1?arguments[1]:void 0;Et()(this,W),this.limit=void 0,this.cache=void 0,this.destroy=void 0,this.order=void 0,this.limit=ae,this.destroy=Ie||this.defaultDestroy,this.order=[],this.clear()}return at()(W,[{key:"clear",value:function(){var Ie=this;this.order.forEach(function(qe){Ie.delete(qe)}),this.cache={},this.order=[]}},{key:"get",value:function(Ie){var qe=this.cache[Ie];return qe&&(this.deleteOrder(Ie),this.appendOrder(Ie)),qe}},{key:"set",value:function(Ie,qe){this.cache[Ie]?(this.delete(Ie),this.cache[Ie]=qe,this.appendOrder(Ie)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[Ie]=qe,this.appendOrder(Ie))}},{key:"delete",value:function(Ie){var qe=this.cache[Ie];qe&&(this.deleteCache(Ie),this.deleteOrder(Ie),this.destroy(qe,Ie))}},{key:"deleteCache",value:function(Ie){delete this.cache[Ie]}},{key:"deleteOrder",value:function(Ie){var qe=this.order.findIndex(function(Ct){return Ct===Ie});qe>=0&&this.order.splice(qe,1)}},{key:"appendOrder",value:function(Ie){this.order.push(Ie)}},{key:"defaultDestroy",value:function(Ie,qe){return null}}]),W}();function Pt(W,ae){W.forEach(function(Ie){!ae[Ie]||(ae[Ie]=ae[Ie].bind(ae))})}var pt=a("FmoU");function Pe(W){var ae=pt.a(W),Ie=[0,0,0,0];return ae!=null&&(Ie[0]=ae.r/255,Ie[1]=ae.g/255,Ie[2]=ae.b/255,Ie[3]=ae.opacity),Ie}function ot(W){var ae=W&&W[0],Ie=W&&W[1],qe=W&&W[2],Ct=ae+Ie*256+qe*65536-1;return Ct}function $e(W){return[W+1&255,W+1>>8&255,W+1>>8>>8&255]}function Vt(W){var ae=document.createElement("canvas"),Ie=ae.getContext("2d");ae.width=256,ae.height=1;for(var qe=Ie.createLinearGradient(0,0,256,1),Ct=null,Re=W.positions[0],mt=W.positions[W.positions.length-1],Qt=0;Qt<W.colors.length;++Qt){var Br=(W.positions[Qt]-Re)/(mt-Re);qe.addColorStop(Br,W.colors[Qt])}return Ie.fillStyle=qe,Ie.fillRect(0,0,256,1),Ct=new Uint8ClampedArray(Ie.getImageData(0,0,256,1).data),new ImageData(Ct,256,1)}var dr;(function(W){W.CENTER="center",W.TOP="top",W["TOP-LEFT"]="top-left",W["TOP-RIGHT"]="top-right",W.BOTTOM="bottom",W["BOTTOM-LEFT"]="bottom-left",W.LEFT="left",W.RIGHT="right"})(dr||(dr={}));var Zr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function cr(W,ae,Ie){var qe=W.classList;for(var Ct in Zr)Zr.hasOwnProperty(Ct)&&qe.remove("l7-".concat(Ie,"-anchor-").concat(Ct));qe.add("l7-".concat(Ie,"-anchor-").concat(ae))}function Un(W){if(W.length===0)throw new Error("max requires at least one data point");for(var ae=W[0],Ie=1;Ie<W.length;Ie++)W[Ie]>ae&&(ae=W[Ie]);return ae*1}function Sn(W){if(W.length===0)throw new Error("min requires at least one data point");for(var ae=W[0],Ie=1;Ie<W.length;Ie++)W[Ie]<ae&&(ae=W[Ie]);return ae*1}function ni(W){if(W.length===0)return 0;for(var ae=W[0]*1,Ie=1;Ie<W.length;Ie++)ae+=W[Ie]*1;return ae}function fi(W){if(W.length===0)throw new Error("mean requires at least one data point");return ni(W)/W.length}function Wn(W){if(W.length===0)throw new Error("mean requires at least one data point");if(W.length<3)return W[0];W.sort();for(var ae=W[0],Ie=NaN,qe=0,Ct=1,Re=1;Re<W.length+1;Re++)W[Re]!==ae?(Ct>qe&&(qe=Ct,Ie=ae),Ct=1,ae=W[Re]):Ct++;return Ie*1}var Gn={min:Sn,max:Un,mean:fi,sum:ni,mode:Wn};function Ee(W,ae){return W.map(function(Ie){return Ie[ae]})}function pe(W,ae){return Gn[W](ae)}},HpQ9:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.ContainerSnapshot=void 0;var S=function(){function v(){}return v.of=function(Z,N){var o=new v;return o.bindings=Z,o.middleware=N,o},v}();x.ContainerSnapshot=S},HthE:function(we,x,a){"use strict";a.d(x,"a",function(){return S}),a.d(x,"b",function(){return v});var S;(function(Z){Z[Z.LNGLAT=1]="LNGLAT",Z[Z.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",Z[Z.VECTOR_TILE=3]="VECTOR_TILE",Z[Z.IDENTITY=4]="IDENTITY",Z[Z.P20=5]="P20",Z[Z.P20_OFFSET=6]="P20_OFFSET",Z[Z.METER_OFFSET=7]="METER_OFFSET"})(S||(S={}));var v={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"}},I0ug:function(we,x,a){"use strict";(function(S){a.d(x,"a",function(){return Z});var v=a("U8pU");function Z(N){if(typeof window!="undefined"&&Object(v.a)(window.process)==="object"&&window.process.type==="renderer"||typeof S!="undefined"&&Object(v.a)(S.versions)==="object"&&Boolean(S.versions.electron))return!0;var o=(typeof navigator=="undefined"?"undefined":Object(v.a)(navigator))==="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,X=N||o;return!!(X&&X.indexOf("Electron")>=0)}}).call(this,a("Q2Ig"))},IOcx:function(we,x,a){"use strict";a.d(x,"a",function(){return S}),a.d(x,"b",function(){return at}),a.d(x,"c",function(){return Wt}),a.d(x,"d",function(){return St}),a.d(x,"e",function(){return dt});var S={};a.r(S),a.d(S,"create",function(){return Z}),a.d(S,"clone",function(){return N}),a.d(S,"copy",function(){return o}),a.d(S,"identity",function(){return X}),a.d(S,"fromValues",function(){return F}),a.d(S,"set",function(){return K}),a.d(S,"transpose",function(){return q}),a.d(S,"invert",function(){return Ce}),a.d(S,"adjoint",function(){return $}),a.d(S,"determinant",function(){return He}),a.d(S,"multiply",function(){return Be}),a.d(S,"rotate",function(){return ce}),a.d(S,"scale",function(){return st}),a.d(S,"fromRotation",function(){return ut}),a.d(S,"fromScaling",function(){return Me}),a.d(S,"str",function(){return bt}),a.d(S,"frob",function(){return xt}),a.d(S,"LDU",function(){return Mt}),a.d(S,"add",function(){return De}),a.d(S,"subtract",function(){return ar}),a.d(S,"exactEquals",function(){return $t}),a.d(S,"equals",function(){return Ht}),a.d(S,"multiplyScalar",function(){return vt}),a.d(S,"multiplyScalarAndAdd",function(){return Ze}),a.d(S,"mul",function(){return Et}),a.d(S,"sub",function(){return Le});var v=a("yU0y");function Z(){var H=new v.a(4);return v.a!=Float32Array&&(H[1]=0,H[2]=0),H[0]=1,H[3]=1,H}function N(H){var z=new v.a(4);return z[0]=H[0],z[1]=H[1],z[2]=H[2],z[3]=H[3],z}function o(H,z){return H[0]=z[0],H[1]=z[1],H[2]=z[2],H[3]=z[3],H}function X(H){return H[0]=1,H[1]=0,H[2]=0,H[3]=1,H}function F(H,z,V,be){var me=new v.a(4);return me[0]=H,me[1]=z,me[2]=V,me[3]=be,me}function K(H,z,V,be,me){return H[0]=z,H[1]=V,H[2]=be,H[3]=me,H}function q(H,z){if(H===z){var V=z[1];H[1]=z[2],H[2]=V}else H[0]=z[0],H[1]=z[2],H[2]=z[1],H[3]=z[3];return H}function Ce(H,z){var V=z[0],be=z[1],me=z[2],le=z[3],fe=V*le-me*be;return fe?(fe=1/fe,H[0]=le*fe,H[1]=-be*fe,H[2]=-me*fe,H[3]=V*fe,H):null}function $(H,z){var V=z[0];return H[0]=z[3],H[1]=-z[1],H[2]=-z[2],H[3]=V,H}function He(H){return H[0]*H[3]-H[2]*H[1]}function Be(H,z,V){var be=z[0],me=z[1],le=z[2],fe=z[3],Ne=V[0],lt=V[1],rt=V[2],ue=V[3];return H[0]=be*Ne+le*lt,H[1]=me*Ne+fe*lt,H[2]=be*rt+le*ue,H[3]=me*rt+fe*ue,H}function ce(H,z,V){var be=z[0],me=z[1],le=z[2],fe=z[3],Ne=Math.sin(V),lt=Math.cos(V);return H[0]=be*lt+le*Ne,H[1]=me*lt+fe*Ne,H[2]=be*-Ne+le*lt,H[3]=me*-Ne+fe*lt,H}function st(H,z,V){var be=z[0],me=z[1],le=z[2],fe=z[3],Ne=V[0],lt=V[1];return H[0]=be*Ne,H[1]=me*Ne,H[2]=le*lt,H[3]=fe*lt,H}function ut(H,z){var V=Math.sin(z),be=Math.cos(z);return H[0]=be,H[1]=V,H[2]=-V,H[3]=be,H}function Me(H,z){return H[0]=z[0],H[1]=0,H[2]=0,H[3]=z[1],H}function bt(H){return"mat2("+H[0]+", "+H[1]+", "+H[2]+", "+H[3]+")"}function xt(H){return Math.hypot(H[0],H[1],H[2],H[3])}function Mt(H,z,V,be){return H[2]=be[2]/be[0],V[0]=be[0],V[1]=be[1],V[3]=be[3]-H[2]*V[1],[H,z,V]}function De(H,z,V){return H[0]=z[0]+V[0],H[1]=z[1]+V[1],H[2]=z[2]+V[2],H[3]=z[3]+V[3],H}function ar(H,z,V){return H[0]=z[0]-V[0],H[1]=z[1]-V[1],H[2]=z[2]-V[2],H[3]=z[3]-V[3],H}function $t(H,z){return H[0]===z[0]&&H[1]===z[1]&&H[2]===z[2]&&H[3]===z[3]}function Ht(H,z){var V=H[0],be=H[1],me=H[2],le=H[3],fe=z[0],Ne=z[1],lt=z[2],rt=z[3];return Math.abs(V-fe)<=v.b*Math.max(1,Math.abs(V),Math.abs(fe))&&Math.abs(be-Ne)<=v.b*Math.max(1,Math.abs(be),Math.abs(Ne))&&Math.abs(me-lt)<=v.b*Math.max(1,Math.abs(me),Math.abs(lt))&&Math.abs(le-rt)<=v.b*Math.max(1,Math.abs(le),Math.abs(rt))}function vt(H,z,V){return H[0]=z[0]*V,H[1]=z[1]*V,H[2]=z[2]*V,H[3]=z[3]*V,H}function Ze(H,z,V,be){return H[0]=z[0]+V[0]*be,H[1]=z[1]+V[1]*be,H[2]=z[2]+V[2]*be,H[3]=z[3]+V[3]*be,H}var Et=Be,Le=ar,at=a("ZaHm"),Wt=a("ZxFD"),St=a("n+fv"),dt=a("bl9R")},ISu3:function(we,x,a){"use strict";a.d(x,"a",function(){return Z}),a.d(x,"c",function(){return N}),a.d(x,"b",function(){return o}),a.d(x,"d",function(){return X});var S={},v={},Z=function(K){return v[K]},N=function(K,q){v[K]=q},o=function(K){return S[K]},X=function(K,q){S[K]=q}},Ijbi:function(we,x,a){var S=a("WkPL");function v(Z){if(Array.isArray(Z))return S(Z)}we.exports=v},Ioao:function(we,x,a){var S=a("heNW"),v=Math.max;function Z(N,o,X){return o=v(o===void 0?N.length-1:o,0),function(){for(var F=arguments,K=-1,q=v(F.length-o,0),Ce=Array(q);++K<q;)Ce[K]=F[o+K];K=-1;for(var $=Array(o+1);++K<o;)$[K]=F[K];return $[o]=X(Ce),S(N,this,$)}}we.exports=Z},J2iB:function(we,x){function a(S){return S==null}we.exports=a},J7lC:function(we,x){},JBE3:function(we,x,a){var S=a("+Qka"),v=a("LsHQ"),Z=v(function(N,o,X,F){S(N,o,X,F)});we.exports=Z},K9nA:function(we,x,a){"use strict";(function(S,v){a.d(x,"b",function(){return X}),a.d(x,"a",function(){return q});var Z=a("U8pU"),N={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,global:typeof S!="undefined"&&S,document:typeof document!="undefined"&&document,process:(typeof v=="undefined"?"undefined":Object(Z.a)(v))==="object"&&v},o=N.self||N.window||N.global,X=N.window||N.self||N.global,F=N.global||N.self||N.window,K=N.document||{},q=N.process||{},Ce=console}).call(this,a("yLpj"),a("Q2Ig"))},KKCa:function(we,x){typeof Object.create=="function"?we.exports=function(S,v){S.super_=v,S.prototype=Object.create(v.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}})}:we.exports=function(S,v){S.super_=v;var Z=function(){};Z.prototype=v.prototype,S.prototype=new Z,S.prototype.constructor=S}},KwMD:function(we,x){function a(S,v,Z,N){for(var o=S.length,X=Z+(N?1:-1);N?X--:++X<o;)if(v(S[X],X,S))return X;return-1}we.exports=a},KxBF:function(we,x){function a(S,v,Z){var N=-1,o=S.length;v<0&&(v=-v>o?0:o+v),Z=Z>o?o:Z,Z<0&&(Z+=o),o=v>Z?0:Z-v>>>0,v>>>=0;for(var X=Array(o);++N<o;)X[N]=S[N+v];return X}we.exports=a},L56e:function(we,x,a){"use strict";a.d(x,"a",function(){return S});var S=["mapload"]},LGYb:function(we,x,a){var S=a("1hJj"),v=a("jbM+"),Z=a("Xt/L"),N=a("xYSL"),o=a("dQpi"),X=a("rEGp"),F=200;function K(q,Ce,$){var He=-1,Be=v,ce=q.length,st=!0,ut=[],Me=ut;if($)st=!1,Be=Z;else if(ce>=F){var bt=Ce?null:o(q);if(bt)return X(bt);st=!1,Be=N,Me=new S}else Me=Ce?[]:ut;e:for(;++He<ce;){var xt=q[He],Mt=Ce?Ce(xt):xt;if(xt=$||xt!==0?xt:0,st&&Mt===Mt){for(var De=Me.length;De--;)if(Me[De]===Mt)continue e;Ce&&Me.push(Mt),ut.push(xt)}else Be(Me,Mt,$)||(Me!==ut&&Me.push(Mt),ut.push(xt))}return ut}we.exports=K},LKzl:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.BindingWhenOnSyntax=void 0;var S=a("406g"),v=a("z4Hk"),Z=function(){function N(o){this._binding=o,this._bindingWhenSyntax=new v.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new S.BindingOnSyntax(this._binding)}return N.prototype.when=function(o){return this._bindingWhenSyntax.when(o)},N.prototype.whenTargetNamed=function(o){return this._bindingWhenSyntax.whenTargetNamed(o)},N.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},N.prototype.whenTargetTagged=function(o,X){return this._bindingWhenSyntax.whenTargetTagged(o,X)},N.prototype.whenInjectedInto=function(o){return this._bindingWhenSyntax.whenInjectedInto(o)},N.prototype.whenParentNamed=function(o){return this._bindingWhenSyntax.whenParentNamed(o)},N.prototype.whenParentTagged=function(o,X){return this._bindingWhenSyntax.whenParentTagged(o,X)},N.prototype.whenAnyAncestorIs=function(o){return this._bindingWhenSyntax.whenAnyAncestorIs(o)},N.prototype.whenNoAncestorIs=function(o){return this._bindingWhenSyntax.whenNoAncestorIs(o)},N.prototype.whenAnyAncestorNamed=function(o){return this._bindingWhenSyntax.whenAnyAncestorNamed(o)},N.prototype.whenAnyAncestorTagged=function(o,X){return this._bindingWhenSyntax.whenAnyAncestorTagged(o,X)},N.prototype.whenNoAncestorNamed=function(o){return this._bindingWhenSyntax.whenNoAncestorNamed(o)},N.prototype.whenNoAncestorTagged=function(o,X){return this._bindingWhenSyntax.whenNoAncestorTagged(o,X)},N.prototype.whenAnyAncestorMatches=function(o){return this._bindingWhenSyntax.whenAnyAncestorMatches(o)},N.prototype.whenNoAncestorMatches=function(o){return this._bindingWhenSyntax.whenNoAncestorMatches(o)},N.prototype.onActivation=function(o){return this._bindingOnSyntax.onActivation(o)},N}();x.BindingWhenOnSyntax=Z},LcsW:function(we,x,a){var S=a("kekF"),v=S(Object.getPrototypeOf,Object);we.exports=v},LgvC:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.Binding=void 0;var S=a("FV85"),v=a("d9O0"),Z=function(){function N(o,X){this.id=v.id(),this.activated=!1,this.serviceIdentifier=o,this.scope=X,this.type=S.BindingTypeEnum.Invalid,this.constraint=function(F){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return N.prototype.clone=function(){var o=new N(this.serviceIdentifier,this.scope);return o.activated=!1,o.implementationType=this.implementationType,o.dynamicValue=this.dynamicValue,o.scope=this.scope,o.type=this.type,o.factory=this.factory,o.provider=this.provider,o.constraint=this.constraint,o.onActivation=this.onActivation,o.cache=this.cache,o},N}();x.Binding=Z},LsHQ:function(we,x,a){var S=a("EA7m"),v=a("mv/X");function Z(N){return S(function(o,X){var F=-1,K=X.length,q=K>1?X[K-1]:void 0,Ce=K>2?X[2]:void 0;for(q=N.length>3&&typeof q=="function"?(K--,q):void 0,Ce&&v(X[0],X[1],Ce)&&(q=K<3?void 0:q,K=1),o=Object(o);++F<K;){var $=X[F];$&&N(o,$,F,q)}return o})}we.exports=Z},LvWW:function(we,x,a){var S=a("mhV4");we.exports=v;function v(K,q){switch(K&&K.type||null){case"FeatureCollection":return K.features=K.features.map(Z(v,q)),K;case"GeometryCollection":return K.geometries=K.geometries.map(Z(v,q)),K;case"Feature":return K.geometry=v(K.geometry,q),K;case"Polygon":case"MultiPolygon":return N(K,q);default:return K}}function Z(K,q){return function(Ce){return K(Ce,q)}}function N(K,q){return K.type==="Polygon"?K.coordinates=o(K.coordinates,q):K.type==="MultiPolygon"&&(K.coordinates=K.coordinates.map(Z(o,q))),K}function o(K,q){q=!!q,K[0]=X(K[0],q);for(var Ce=1;Ce<K.length;Ce++)K[Ce]=X(K[Ce],!q);return K}function X(K,q){return F(K)===q?K:K.reverse()}function F(K){return S.ring(K)>=0}},MCLT:function(we,x,a){(function(S){var v=Object.getOwnPropertyDescriptors||function(fe){for(var Ne=Object.keys(fe),lt={},rt=0;rt<Ne.length;rt++)lt[Ne[rt]]=Object.getOwnPropertyDescriptor(fe,Ne[rt]);return lt},Z=/%[sdj%]/g;x.format=function(le){if(!De(le)){for(var fe=[],Ne=0;Ne<arguments.length;Ne++)fe.push(X(arguments[Ne]));return fe.join(" ")}for(var Ne=1,lt=arguments,rt=lt.length,ue=String(le).replace(Z,function(Ue){if(Ue==="%%")return"%";if(Ne>=rt)return Ue;switch(Ue){case"%s":return String(lt[Ne++]);case"%d":return Number(lt[Ne++]);case"%j":try{return JSON.stringify(lt[Ne++])}catch(ft){return"[Circular]"}default:return Ue}}),ye=lt[Ne];Ne<rt;ye=lt[++Ne])bt(ye)||!vt(ye)?ue+=" "+ye:ue+=" "+X(ye);return ue},x.deprecate=function(le,fe){if(typeof S!="undefined"&&S.noDeprecation===!0)return le;if(typeof S=="undefined")return function(){return x.deprecate(le,fe).apply(this,arguments)};var Ne=!1;function lt(){if(!Ne){if(S.throwDeprecation)throw new Error(fe);S.traceDeprecation?console.trace(fe):console.error(fe),Ne=!0}return le.apply(this,arguments)}return lt};var N={},o;x.debuglog=function(le){if($t(o)&&(o=Object({NODE_ENV:"production"}).NODE_DEBUG||""),le=le.toUpperCase(),!N[le])if(new RegExp("\\b"+le+"\\b","i").test(o)){var fe=S.pid;N[le]=function(){var Ne=x.format.apply(x,arguments);console.error("%s %d: %s",le,fe,Ne)}}else N[le]=function(){};return N[le]};function X(le,fe){var Ne={seen:[],stylize:K};return arguments.length>=3&&(Ne.depth=arguments[2]),arguments.length>=4&&(Ne.colors=arguments[3]),Me(fe)?Ne.showHidden=fe:fe&&x._extend(Ne,fe),$t(Ne.showHidden)&&(Ne.showHidden=!1),$t(Ne.depth)&&(Ne.depth=2),$t(Ne.colors)&&(Ne.colors=!1),$t(Ne.customInspect)&&(Ne.customInspect=!0),Ne.colors&&(Ne.stylize=F),Ce(Ne,le,Ne.depth)}x.inspect=X,X.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},X.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function F(le,fe){var Ne=X.styles[fe];return Ne?"["+X.colors[Ne][0]+"m"+le+"["+X.colors[Ne][1]+"m":le}function K(le,fe){return le}function q(le){var fe={};return le.forEach(function(Ne,lt){fe[Ne]=!0}),fe}function Ce(le,fe,Ne){if(le.customInspect&&fe&&Le(fe.inspect)&&fe.inspect!==x.inspect&&!(fe.constructor&&fe.constructor.prototype===fe)){var lt=fe.inspect(Ne,le);return De(lt)||(lt=Ce(le,lt,Ne)),lt}var rt=$(le,fe);if(rt)return rt;var ue=Object.keys(fe),ye=q(ue);if(le.showHidden&&(ue=Object.getOwnPropertyNames(fe)),Et(fe)&&(ue.indexOf("message")>=0||ue.indexOf("description")>=0))return He(fe);if(ue.length===0){if(Le(fe)){var Ue=fe.name?": "+fe.name:"";return le.stylize("[Function"+Ue+"]","special")}if(Ht(fe))return le.stylize(RegExp.prototype.toString.call(fe),"regexp");if(Ze(fe))return le.stylize(Date.prototype.toString.call(fe),"date");if(Et(fe))return He(fe)}var ft="",Oe=!1,Ve=["{","}"];if(ut(fe)&&(Oe=!0,Ve=["[","]"]),Le(fe)){var P=fe.name?": "+fe.name:"";ft=" [Function"+P+"]"}if(Ht(fe)&&(ft=" "+RegExp.prototype.toString.call(fe)),Ze(fe)&&(ft=" "+Date.prototype.toUTCString.call(fe)),Et(fe)&&(ft=" "+He(fe)),ue.length===0&&(!Oe||fe.length==0))return Ve[0]+ft+Ve[1];if(Ne<0)return Ht(fe)?le.stylize(RegExp.prototype.toString.call(fe),"regexp"):le.stylize("[Object]","special");le.seen.push(fe);var R;return Oe?R=Be(le,fe,Ne,ye,ue):R=ue.map(function(J){return ce(le,fe,Ne,ye,J,Oe)}),le.seen.pop(),st(R,ft,Ve)}function $(le,fe){if($t(fe))return le.stylize("undefined","undefined");if(De(fe)){var Ne="'"+JSON.stringify(fe).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return le.stylize(Ne,"string")}if(Mt(fe))return le.stylize(""+fe,"number");if(Me(fe))return le.stylize(""+fe,"boolean");if(bt(fe))return le.stylize("null","null")}function He(le){return"["+Error.prototype.toString.call(le)+"]"}function Be(le,fe,Ne,lt,rt){for(var ue=[],ye=0,Ue=fe.length;ye<Ue;++ye)z(fe,String(ye))?ue.push(ce(le,fe,Ne,lt,String(ye),!0)):ue.push("");return rt.forEach(function(ft){ft.match(/^\d+$/)||ue.push(ce(le,fe,Ne,lt,ft,!0))}),ue}function ce(le,fe,Ne,lt,rt,ue){var ye,Ue,ft;if(ft=Object.getOwnPropertyDescriptor(fe,rt)||{value:fe[rt]},ft.get?ft.set?Ue=le.stylize("[Getter/Setter]","special"):Ue=le.stylize("[Getter]","special"):ft.set&&(Ue=le.stylize("[Setter]","special")),z(lt,rt)||(ye="["+rt+"]"),Ue||(le.seen.indexOf(ft.value)<0?(bt(Ne)?Ue=Ce(le,ft.value,null):Ue=Ce(le,ft.value,Ne-1),Ue.indexOf(`
`)>-1&&(ue?Ue=Ue.split(`
`).map(function(Oe){return"  "+Oe}).join(`
`).substr(2):Ue=`
`+Ue.split(`
`).map(function(Oe){return"   "+Oe}).join(`
`))):Ue=le.stylize("[Circular]","special")),$t(ye)){if(ue&&rt.match(/^\d+$/))return Ue;ye=JSON.stringify(""+rt),ye.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(ye=ye.substr(1,ye.length-2),ye=le.stylize(ye,"name")):(ye=ye.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),ye=le.stylize(ye,"string"))}return ye+": "+Ue}function st(le,fe,Ne){var lt=0,rt=le.reduce(function(ue,ye){return lt++,ye.indexOf(`
`)>=0&&lt++,ue+ye.replace(/\u001b\[\d\d?m/g,"").length+1},0);return rt>60?Ne[0]+(fe===""?"":fe+`
 `)+" "+le.join(`,
  `)+" "+Ne[1]:Ne[0]+fe+" "+le.join(", ")+" "+Ne[1]}function ut(le){return Array.isArray(le)}x.isArray=ut;function Me(le){return typeof le=="boolean"}x.isBoolean=Me;function bt(le){return le===null}x.isNull=bt;function xt(le){return le==null}x.isNullOrUndefined=xt;function Mt(le){return typeof le=="number"}x.isNumber=Mt;function De(le){return typeof le=="string"}x.isString=De;function ar(le){return typeof le=="symbol"}x.isSymbol=ar;function $t(le){return le===void 0}x.isUndefined=$t;function Ht(le){return vt(le)&&Wt(le)==="[object RegExp]"}x.isRegExp=Ht;function vt(le){return typeof le=="object"&&le!==null}x.isObject=vt;function Ze(le){return vt(le)&&Wt(le)==="[object Date]"}x.isDate=Ze;function Et(le){return vt(le)&&(Wt(le)==="[object Error]"||le instanceof Error)}x.isError=Et;function Le(le){return typeof le=="function"}x.isFunction=Le;function at(le){return le===null||typeof le=="boolean"||typeof le=="number"||typeof le=="string"||typeof le=="symbol"||typeof le=="undefined"}x.isPrimitive=at,x.isBuffer=a("1gqn");function Wt(le){return Object.prototype.toString.call(le)}function St(le){return le<10?"0"+le.toString(10):le.toString(10)}var dt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function H(){var le=new Date,fe=[St(le.getHours()),St(le.getMinutes()),St(le.getSeconds())].join(":");return[le.getDate(),dt[le.getMonth()],fe].join(" ")}x.log=function(){console.log("%s - %s",H(),x.format.apply(x,arguments))},x.inherits=a("KKCa"),x._extend=function(le,fe){if(!fe||!vt(fe))return le;for(var Ne=Object.keys(fe),lt=Ne.length;lt--;)le[Ne[lt]]=fe[Ne[lt]];return le};function z(le,fe){return Object.prototype.hasOwnProperty.call(le,fe)}var V=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;x.promisify=function(fe){if(typeof fe!="function")throw new TypeError('The "original" argument must be of type Function');if(V&&fe[V]){var Ne=fe[V];if(typeof Ne!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(Ne,V,{value:Ne,enumerable:!1,writable:!1,configurable:!0}),Ne}function Ne(){for(var lt,rt,ue=new Promise(function(ft,Oe){lt=ft,rt=Oe}),ye=[],Ue=0;Ue<arguments.length;Ue++)ye.push(arguments[Ue]);ye.push(function(ft,Oe){ft?rt(ft):lt(Oe)});try{fe.apply(this,ye)}catch(ft){rt(ft)}return ue}return Object.setPrototypeOf(Ne,Object.getPrototypeOf(fe)),V&&Object.defineProperty(Ne,V,{value:Ne,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(Ne,v(fe))},x.promisify.custom=V;function be(le,fe){if(!le){var Ne=new Error("Promise was rejected with a falsy value");Ne.reason=le,le=Ne}return fe(le)}function me(le){if(typeof le!="function")throw new TypeError('The "original" argument must be of type Function');function fe(){for(var Ne=[],lt=0;lt<arguments.length;lt++)Ne.push(arguments[lt]);var rt=Ne.pop();if(typeof rt!="function")throw new TypeError("The last argument must be of type Function");var ue=this,ye=function(){return rt.apply(ue,arguments)};le.apply(this,Ne).then(function(Ue){S.nextTick(ye,null,Ue)},function(Ue){S.nextTick(be,Ue,ye)})}return Object.setPrototypeOf(fe,Object.getPrototypeOf(le)),Object.defineProperties(fe,v(le)),fe}x.callbackify=me}).call(this,a("Q2Ig"))},MON2:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.STACK_OVERFLOW=x.CIRCULAR_DEPENDENCY_IN_FACTORY=x.POST_CONSTRUCT_ERROR=x.MULTIPLE_POST_CONSTRUCT_METHODS=x.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=x.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=x.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=x.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=x.ARGUMENTS_LENGTH_MISMATCH=x.INVALID_DECORATOR_OPERATION=x.INVALID_TO_SELF_VALUE=x.INVALID_FUNCTION_BINDING=x.INVALID_MIDDLEWARE_RETURN=x.NO_MORE_SNAPSHOTS_AVAILABLE=x.INVALID_BINDING_TYPE=x.NOT_IMPLEMENTED=x.CIRCULAR_DEPENDENCY=x.UNDEFINED_INJECT_ANNOTATION=x.MISSING_INJECT_ANNOTATION=x.MISSING_INJECTABLE_ANNOTATION=x.NOT_REGISTERED=x.CANNOT_UNBIND=x.AMBIGUOUS_MATCH=x.KEY_NOT_FOUND=x.NULL_ARGUMENT=x.DUPLICATED_METADATA=x.DUPLICATED_INJECTABLE_DECORATOR=void 0,x.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",x.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",x.NULL_ARGUMENT="NULL argument",x.KEY_NOT_FOUND="Key Not Found",x.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",x.CANNOT_UNBIND="Could not unbind serviceIdentifier:",x.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",x.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",x.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",x.UNDEFINED_INJECT_ANNOTATION=function(S){return"@inject called with undefined this could mean that the class "+S+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},x.CIRCULAR_DEPENDENCY="Circular dependency found:",x.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",x.INVALID_BINDING_TYPE="Invalid binding type:",x.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",x.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",x.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",x.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",x.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",x.ARGUMENTS_LENGTH_MISMATCH=function(){for(var S=[],v=0;v<arguments.length;v++)S[v]=arguments[v];return"The number of constructor arguments in the derived class "+(S[0]+" must be >= than the number of constructor arguments of its base class.")},x.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",x.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",x.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",x.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",x.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",x.POST_CONSTRUCT_ERROR=function(){for(var S=[],v=0;v<arguments.length;v++)S[v]=arguments[v];return"@postConstruct error in class "+S[0]+": "+S[1]},x.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var S=[],v=0;v<arguments.length;v++)S[v]=arguments[v];return"It looks like there is a circular dependency "+("in one of the '"+S[0]+"' bindings. Please investigate bindings with")+("service identifier '"+S[1]+"'.")},x.STACK_OVERFLOW="Maximum call stack size exceeded"},MrPd:function(we,x,a){var S=a("hypo"),v=a("ljhN"),Z=Object.prototype,N=Z.hasOwnProperty;function o(X,F,K){var q=X[F];(!(N.call(X,F)&&v(q,K))||K===void 0&&!(F in X))&&S(X,F,K)}we.exports=o},Nsbk:function(we,x){function a(S){return we.exports=a=Object.setPrototypeOf?Object.getPrototypeOf:function(Z){return Z.__proto__||Object.getPrototypeOf(Z)},a(S)}we.exports=a},O0oS:function(we,x,a){var S=a("Cwc5"),v=function(){try{var Z=S(Object,"defineProperty");return Z({},"",{}),Z}catch(N){}}();we.exports=v},O1je:function(we,x){},OBhP:function(we,x,a){var S=a("fmRc"),v=a("gFfm"),Z=a("MrPd"),N=a("WwFo"),o=a("Dw+G"),X=a("5Tg0"),F=a("Q1l4"),K=a("VOtZ"),q=a("EEGq"),Ce=a("qZTm"),$=a("G6z8"),He=a("QqLw"),Be=a("yHx3"),ce=a("wrZu"),st=a("+iFO"),ut=a("Z0cm"),Me=a("DSRE"),bt=a("zEVN"),xt=a("GoyQ"),Mt=a("1+5i"),De=a("7GkX"),ar=a("mTTR"),$t=1,Ht=2,vt=4,Ze="[object Arguments]",Et="[object Array]",Le="[object Boolean]",at="[object Date]",Wt="[object Error]",St="[object Function]",dt="[object GeneratorFunction]",H="[object Map]",z="[object Number]",V="[object Object]",be="[object RegExp]",me="[object Set]",le="[object String]",fe="[object Symbol]",Ne="[object WeakMap]",lt="[object ArrayBuffer]",rt="[object DataView]",ue="[object Float32Array]",ye="[object Float64Array]",Ue="[object Int8Array]",ft="[object Int16Array]",Oe="[object Int32Array]",Ve="[object Uint8Array]",P="[object Uint8ClampedArray]",R="[object Uint16Array]",J="[object Uint32Array]",de={};de[Ze]=de[Et]=de[lt]=de[rt]=de[Le]=de[at]=de[ue]=de[ye]=de[Ue]=de[ft]=de[Oe]=de[H]=de[z]=de[V]=de[be]=de[me]=de[le]=de[fe]=de[Ve]=de[P]=de[R]=de[J]=!0,de[Wt]=de[St]=de[Ne]=!1;function je(We,gt,nt,Nt,Y,Xe){var re,Je=gt&$t,Gt=gt&Ht,ur=gt&vt;if(nt&&(re=Y?nt(We,Nt,Y,Xe):nt(We)),re!==void 0)return re;if(!xt(We))return We;var ct=ut(We);if(ct){if(re=Be(We),!Je)return F(We,re)}else{var ht=He(We),Pt=ht==St||ht==dt;if(Me(We))return X(We,Je);if(ht==V||ht==Ze||Pt&&!Y){if(re=Gt||Pt?{}:st(We),!Je)return Gt?q(We,o(re,We)):K(We,N(re,We))}else{if(!de[ht])return Y?We:{};re=ce(We,ht,Je)}}Xe||(Xe=new S);var pt=Xe.get(We);if(pt)return pt;Xe.set(We,re),Mt(We)?We.forEach(function($e){re.add(je($e,gt,nt,$e,We,Xe))}):bt(We)&&We.forEach(function($e,Vt){re.set(Vt,je($e,gt,nt,Vt,We,Xe))});var Pe=ur?Gt?$:Ce:Gt?ar:De,ot=ct?void 0:Pe(We);return v(ot||We,function($e,Vt){ot&&(Vt=$e,$e=We[Vt]),Z(re,Vt,je($e,gt,nt,Vt,We,Xe))}),re}we.exports=je},PJYZ:function(we,x){function a(S){if(S===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S}we.exports=a},PSsN:function(we,x){},PUg6:function(we,x,a){"use strict";a.d(x,"a",function(){return S});var S;(function(v){v.normal="normal",v.additive="additive",v.subtractive="subtractive",v.min="min",v.max="max",v.none="none"})(S||(S={}))},Q1l4:function(we,x){function a(S,v){var Z=-1,N=S.length;for(v||(v=Array(N));++Z<N;)v[Z]=S[Z];return v}we.exports=a},QGbF:function(we,x){},"QQZ/":function(we,x,a){var S=a("Sq3C"),v=a("Z1HP"),Z=a("Sxd8"),N=a("dt0z");function o(X,F,K){X=N(X),F=Z(F);var q=F?v(X):0;return F&&q<F?S(F-q,K)+X:X}we.exports=o},QcOe:function(we,x,a){var S=a("GoyQ"),v=a("6sVZ"),Z=a("7Ix3"),N=Object.prototype,o=N.hasOwnProperty;function X(F){if(!S(F))return Z(F);var K=v(F),q=[];for(var Ce in F)Ce=="constructor"&&(K||!o.call(F,Ce))||q.push(Ce);return q}we.exports=X},QkVN:function(we,x,a){var S=a("+Qka"),v=a("LsHQ"),Z=v(function(N,o,X){S(N,o,X)});we.exports=Z},"R/W3":function(we,x,a){var S=a("KwMD"),v=a("2ajD"),Z=a("CZoQ");function N(o,X,F){return X===X?Z(o,X,F):S(o,v,F)}we.exports=N},RIqP:function(we,x,a){var S=a("Ijbi"),v=a("EbDI"),Z=a("ZhPi"),N=a("Bnag");function o(X){return S(X)||v(X)||Z(X)||N()}we.exports=o},"RL2/":function(we,x,a){"use strict";var S="2.3.7"},RMtq:function(we,x){},"RR/i":function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.typeConstraint=x.namedConstraint=x.taggedConstraint=x.traverseAncerstors=void 0;var S=a("xfSm"),v=a("GXnB"),Z=function F(K,q){var Ce=K.parentRequest;return Ce!==null?q(Ce)?!0:F(Ce,q):!1};x.traverseAncerstors=Z;var N=function(K){return function(q){var Ce=function(He){return He!==null&&He.target!==null&&He.target.matchesTag(K)(q)};return Ce.metaData=new v.Metadata(K,q),Ce}};x.taggedConstraint=N;var o=N(S.NAMED_TAG);x.namedConstraint=o;var X=function(K){return function(q){var Ce=null;if(q!==null)if(Ce=q.bindings[0],typeof K=="string"){var $=Ce.serviceIdentifier;return $===K}else{var He=q.bindings[0].implementationType;return K===He}return!1}};x.typeConstraint=X},Sk89:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.postConstruct=void 0;var S=a("MON2"),v=a("xfSm"),Z=a("GXnB");function N(){return function(o,X,F){var K=new Z.Metadata(v.POST_CONSTRUCT,X);if(Reflect.hasOwnMetadata(v.POST_CONSTRUCT,o.constructor))throw new Error(S.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(v.POST_CONSTRUCT,K,o.constructor)}}x.postConstruct=N},SksO:function(we,x){function a(S,v){return we.exports=a=Object.setPrototypeOf||function(N,o){return N.__proto__=o,N},a(S,v)}we.exports=a},Sq3C:function(we,x,a){var S=a("sKgW"),v=a("zoYe"),Z=a("wy8a"),N=a("quyA"),o=a("Z1HP"),X=a("Em2t"),F=Math.ceil;function K(q,Ce){Ce=Ce===void 0?" ":v(Ce);var $=Ce.length;if($<2)return $?S(Ce,q):Ce;var He=S(Ce,F(q/o(Ce)));return N(Ce)?Z(X(He),0,q).join(""):He.slice(0,q)}we.exports=K},Sxd8:function(we,x,a){var S=a("ZCgT");function v(Z){var N=S(Z),o=N%1;return N===N?o?N-o:N:0}we.exports=v},T1AV:function(we,x,a){var S=a("t2Dn"),v=a("5Tg0"),Z=a("yP5f"),N=a("Q1l4"),o=a("+iFO"),X=a("03A+"),F=a("Z0cm"),K=a("3L66"),q=a("DSRE"),Ce=a("lSCD"),$=a("GoyQ"),He=a("YO3V"),Be=a("c6wG"),ce=a("itsj"),st=a("jeLo");function ut(Me,bt,xt,Mt,De,ar,$t){var Ht=ce(Me,xt),vt=ce(bt,xt),Ze=$t.get(vt);if(Ze){S(Me,xt,Ze);return}var Et=ar?ar(Ht,vt,xt+"",Me,bt,$t):void 0,Le=Et===void 0;if(Le){var at=F(vt),Wt=!at&&q(vt),St=!at&&!Wt&&Be(vt);Et=vt,at||Wt||St?F(Ht)?Et=Ht:K(Ht)?Et=N(Ht):Wt?(Le=!1,Et=v(vt,!0)):St?(Le=!1,Et=Z(vt,!0)):Et=[]:He(vt)||X(vt)?(Et=Ht,X(Ht)?Et=st(Ht):(!$(Ht)||Ce(Ht))&&(Et=o(vt))):Le=!1}Le&&($t.set(vt,Et),De(Et,vt,Mt,ar,$t),$t.delete(vt)),S(Me,xt,Et)}we.exports=ut},TKrE:function(we,x,a){var S=a("qRkn"),v=a("dt0z"),Z=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,N="\\u0300-\\u036f",o="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",F=N+o+X,K="["+F+"]",q=RegExp(K,"g");function Ce($){return $=v($),$&&$.replace(Z,S).replace(q,"")}we.exports=Ce},"U+yc":function(we,x){function a(S,v,Z,N,o){var X={};return Object.keys(N).forEach(function(F){X[F]=N[F]}),X.enumerable=!!X.enumerable,X.configurable=!!X.configurable,("value"in X||X.initializer)&&(X.writable=!0),X=Z.slice().reverse().reduce(function(F,K){return K(S,v,F)||F},X),o&&X.initializer!==void 0&&(X.value=X.initializer?X.initializer.call(o):void 0,X.initializer=void 0),X.initializer===void 0&&(Object.defineProperty(S,v,X),X=null),X}we.exports=a},U1ZX:function(we,x){},UB5X:function(we,x,a){var S=a("NykK"),v=a("ExA7"),Z="[object Number]";function N(o){return typeof o=="number"||v(o)&&S(o)==Z}we.exports=N},Ucsi:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0});var S=Symbol.for("INJECTION");function v(F,K,q,Ce){function $(){return Ce&&!Reflect.hasMetadata(S,this,K)&&Reflect.defineMetadata(S,q(),this,K),Reflect.hasMetadata(S,this,K)?Reflect.getMetadata(S,this,K):q()}function He(Be){Reflect.defineMetadata(S,Be,this,K)}Object.defineProperty(F,K,{configurable:!0,enumerable:!0,get:$,set:He})}function Z(F,K){return function(q){return function(Ce,$){var He=function(){return F.get(q)};v(Ce,$,He,K)}}}x.makePropertyInjectDecorator=Z;function N(F,K){return function(q,Ce){return function($,He){var Be=function(){return F.getNamed(q,Ce)};v($,He,Be,K)}}}x.makePropertyInjectNamedDecorator=N;function o(F,K){return function(q,Ce,$){return function(He,Be){var ce=function(){return F.getTagged(q,Ce,$)};v(He,Be,ce,K)}}}x.makePropertyInjectTaggedDecorator=o;function X(F,K){return function(q){return function(Ce,$){var He=function(){return F.getAll(q)};v(Ce,$,He,K)}}}x.makePropertyMultiInjectDecorator=X},V1cb:function(we,x,a){"use strict";a.d(x,"a",function(){return S});var S;(function(v){v.Hover="hover",v.Click="click",v.Select="select",v.Active="active",v.Drag="drag"})(S||(S={}))},VIsB:function(we,x,a){"use strict";a.d(x,"a",function(){return X});var S=a("Hel2");function v(He,Be){var ce;if(typeof Symbol=="undefined"||He[Symbol.iterator]==null){if(Array.isArray(He)||(ce=Z(He))||Be&&He&&typeof He.length=="number"){ce&&(He=ce);var st=0,ut=function(){};return{s:ut,n:function(){return st>=He.length?{done:!0}:{done:!1,value:He[st++]}},e:function(De){throw De},f:ut}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Me=!0,bt=!1,xt;return{s:function(){ce=He[Symbol.iterator]()},n:function(){var De=ce.next();return Me=De.done,De},e:function(De){bt=!0,xt=De},f:function(){try{!Me&&ce.return!=null&&ce.return()}finally{if(bt)throw xt}}}}function Z(He,Be){if(!!He){if(typeof He=="string")return N(He,Be);var ce=Object.prototype.toString.call(He).slice(8,-1);if(ce==="Object"&&He.constructor&&(ce=He.constructor.name),ce==="Map"||ce==="Set")return Array.from(He);if(ce==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ce))return N(He,Be)}}function N(He,Be){(Be==null||Be>He.length)&&(Be=He.length);for(var ce=0,st=new Array(Be);ce<Be;ce++)st[ce]=He[ce];return st}var o=6378e3;function X(He,Be){var ce=He.dataArray,st=Be.size,ut=st===void 0?10:st,Me=ut/(2*Math.PI*o)*(256<<20)/2,bt=F(ce,ut),xt=bt.gridHash,Mt=bt.gridOffset,De=$(xt,Mt,Be);return{yOffset:Me,xOffset:Me,radius:Me,type:"grid",dataArray:De}}function F(He,Be){var ce=Infinity,st=-Infinity,ut,Me=v(He),bt;try{for(Me.s();!(bt=Me.n()).done;){var xt=bt.value;ut=xt.coordinates[1],Number.isFinite(ut)&&(ce=ut<ce?ut:ce,st=ut>st?ut:st)}}catch(St){Me.e(St)}finally{Me.f()}var Mt=(ce+st)/2,De=K(Be,Mt);if(De.xOffset<=0||De.yOffset<=0)return{gridHash:{},gridOffset:De};var ar={},$t=v(He),Ht;try{for($t.s();!(Ht=$t.n()).done;){var vt=Ht.value,Ze=vt.coordinates[1],Et=vt.coordinates[0];if(Number.isFinite(Ze)&&Number.isFinite(Et)){var Le=Math.floor((Ze+90)/De.yOffset),at=Math.floor((Et+180)/De.xOffset),Wt="".concat(Le,"-").concat(at);ar[Wt]=ar[Wt]||{count:0,points:[]},ar[Wt].count+=1,ar[Wt].points.push(vt)}}}catch(St){$t.e(St)}finally{$t.f()}return{gridHash:ar,gridOffset:De}}function K(He,Be){var ce=q(He),st=Ce(Be,He);return{yOffset:ce,xOffset:st}}function q(He){return He/o*(180/Math.PI)}function Ce(He,Be){return Be/o*(180/Math.PI)/Math.cos(He*Math.PI/180)}function $(He,Be,ce){return Object.keys(He).reduce(function(st,ut,Me){var bt=ut.split("-"),xt=parseInt(bt[0],10),Mt=parseInt(bt[1],10),De={};if(ce.field&&ce.method){var ar=S.c.getColumn(He[ut].points,ce.field);De[ce.method]=S.c.statMap[ce.method](ar)}return Object.assign(De,{_id:Me,coordinates:Object(S.d)([-180+Be.xOffset*(Mt+.5),-90+Be.yOffset*(xt+.5)]),rawData:He[ut].points,count:He[ut].count}),st.push(De),st},[])}},VOtZ:function(we,x,a){var S=a("juv8"),v=a("MvSz");function Z(N,o){return S(N,v(N),o)}we.exports=Z},VmRL:function(we,x,a){"use strict";we.exports=S,we.exports.default=S;function S(H,z,V){V=V||2;var be=z&&z.length,me=be?z[0]*V:H.length,le=v(H,0,me,V,!0),fe=[];if(!le||le.next===le.prev)return fe;var Ne,lt,rt,ue,ye,Ue,ft;if(be&&(le=q(H,z,le,V)),H.length>80*V){Ne=rt=H[0],lt=ue=H[1];for(var Oe=V;Oe<me;Oe+=V)ye=H[Oe],Ue=H[Oe+1],ye<Ne&&(Ne=ye),Ue<lt&&(lt=Ue),ye>rt&&(rt=ye),Ue>ue&&(ue=Ue);ft=Math.max(rt-Ne,ue-lt),ft=ft!==0?1/ft:0}return N(le,fe,V,Ne,lt,ft),fe}function v(H,z,V,be,me){var le,fe;if(me===dt(H,z,V,be)>0)for(le=z;le<V;le+=be)fe=at(le,H[le],H[le+1],fe);else for(le=V-be;le>=z;le-=be)fe=at(le,H[le],H[le+1],fe);return fe&&De(fe,fe.next)&&(Wt(fe),fe=fe.next),fe}function Z(H,z){if(!H)return H;z||(z=H);var V=H,be;do if(be=!1,!V.steiner&&(De(V,V.next)||Mt(V.prev,V,V.next)===0)){if(Wt(V),V=z=V.prev,V===V.next)break;be=!0}else V=V.next;while(be||V!==z);return z}function N(H,z,V,be,me,le,fe){if(!!H){!fe&&le&&ce(H,be,me,le);for(var Ne=H,lt,rt;H.prev!==H.next;){if(lt=H.prev,rt=H.next,le?X(H,be,me,le):o(H)){z.push(lt.i/V),z.push(H.i/V),z.push(rt.i/V),Wt(H),H=rt.next,Ne=rt.next;continue}if(H=rt,H===Ne){fe?fe===1?(H=F(Z(H),z,V),N(H,z,V,be,me,le,2)):fe===2&&K(H,z,V,be,me,le):N(Z(H),z,V,be,me,le,1);break}}}}function o(H){var z=H.prev,V=H,be=H.next;if(Mt(z,V,be)>=0)return!1;for(var me=H.next.next;me!==H.prev;){if(bt(z.x,z.y,V.x,V.y,be.x,be.y,me.x,me.y)&&Mt(me.prev,me,me.next)>=0)return!1;me=me.next}return!0}function X(H,z,V,be){var me=H.prev,le=H,fe=H.next;if(Mt(me,le,fe)>=0)return!1;for(var Ne=me.x<le.x?me.x<fe.x?me.x:fe.x:le.x<fe.x?le.x:fe.x,lt=me.y<le.y?me.y<fe.y?me.y:fe.y:le.y<fe.y?le.y:fe.y,rt=me.x>le.x?me.x>fe.x?me.x:fe.x:le.x>fe.x?le.x:fe.x,ue=me.y>le.y?me.y>fe.y?me.y:fe.y:le.y>fe.y?le.y:fe.y,ye=ut(Ne,lt,z,V,be),Ue=ut(rt,ue,z,V,be),ft=H.prevZ,Oe=H.nextZ;ft&&ft.z>=ye&&Oe&&Oe.z<=Ue;){if(ft!==H.prev&&ft!==H.next&&bt(me.x,me.y,le.x,le.y,fe.x,fe.y,ft.x,ft.y)&&Mt(ft.prev,ft,ft.next)>=0||(ft=ft.prevZ,Oe!==H.prev&&Oe!==H.next&&bt(me.x,me.y,le.x,le.y,fe.x,fe.y,Oe.x,Oe.y)&&Mt(Oe.prev,Oe,Oe.next)>=0))return!1;Oe=Oe.nextZ}for(;ft&&ft.z>=ye;){if(ft!==H.prev&&ft!==H.next&&bt(me.x,me.y,le.x,le.y,fe.x,fe.y,ft.x,ft.y)&&Mt(ft.prev,ft,ft.next)>=0)return!1;ft=ft.prevZ}for(;Oe&&Oe.z<=Ue;){if(Oe!==H.prev&&Oe!==H.next&&bt(me.x,me.y,le.x,le.y,fe.x,fe.y,Oe.x,Oe.y)&&Mt(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.nextZ}return!0}function F(H,z,V){var be=H;do{var me=be.prev,le=be.next.next;!De(me,le)&&ar(me,be,be.next,le)&&Ze(me,le)&&Ze(le,me)&&(z.push(me.i/V),z.push(be.i/V),z.push(le.i/V),Wt(be),Wt(be.next),be=H=le),be=be.next}while(be!==H);return Z(be)}function K(H,z,V,be,me,le){var fe=H;do{for(var Ne=fe.next.next;Ne!==fe.prev;){if(fe.i!==Ne.i&&xt(fe,Ne)){var lt=Le(fe,Ne);fe=Z(fe,fe.next),lt=Z(lt,lt.next),N(fe,z,V,be,me,le),N(lt,z,V,be,me,le);return}Ne=Ne.next}fe=fe.next}while(fe!==H)}function q(H,z,V,be){var me=[],le,fe,Ne,lt,rt;for(le=0,fe=z.length;le<fe;le++)Ne=z[le]*be,lt=le<fe-1?z[le+1]*be:H.length,rt=v(H,Ne,lt,be,!1),rt===rt.next&&(rt.steiner=!0),me.push(Me(rt));for(me.sort(Ce),le=0;le<me.length;le++)$(me[le],V),V=Z(V,V.next);return V}function Ce(H,z){return H.x-z.x}function $(H,z){if(z=He(H,z),z){var V=Le(z,H);Z(z,z.next),Z(V,V.next)}}function He(H,z){var V=z,be=H.x,me=H.y,le=-Infinity,fe;do{if(me<=V.y&&me>=V.next.y&&V.next.y!==V.y){var Ne=V.x+(me-V.y)*(V.next.x-V.x)/(V.next.y-V.y);if(Ne<=be&&Ne>le){if(le=Ne,Ne===be){if(me===V.y)return V;if(me===V.next.y)return V.next}fe=V.x<V.next.x?V:V.next}}V=V.next}while(V!==z);if(!fe)return null;if(be===le)return fe;var lt=fe,rt=fe.x,ue=fe.y,ye=Infinity,Ue;V=fe;do be>=V.x&&V.x>=rt&&be!==V.x&&bt(me<ue?be:le,me,rt,ue,me<ue?le:be,me,V.x,V.y)&&(Ue=Math.abs(me-V.y)/(be-V.x),Ze(V,H)&&(Ue<ye||Ue===ye&&(V.x>fe.x||V.x===fe.x&&Be(fe,V)))&&(fe=V,ye=Ue)),V=V.next;while(V!==lt);return fe}function Be(H,z){return Mt(H.prev,H,z.prev)<0&&Mt(z.next,H,H.next)<0}function ce(H,z,V,be){var me=H;do me.z===null&&(me.z=ut(me.x,me.y,z,V,be)),me.prevZ=me.prev,me.nextZ=me.next,me=me.next;while(me!==H);me.prevZ.nextZ=null,me.prevZ=null,st(me)}function st(H){var z,V,be,me,le,fe,Ne,lt,rt=1;do{for(V=H,H=null,le=null,fe=0;V;){for(fe++,be=V,Ne=0,z=0;z<rt&&(Ne++,be=be.nextZ,!!be);z++);for(lt=rt;Ne>0||lt>0&&be;)Ne!==0&&(lt===0||!be||V.z<=be.z)?(me=V,V=V.nextZ,Ne--):(me=be,be=be.nextZ,lt--),le?le.nextZ=me:H=me,me.prevZ=le,le=me;V=be}le.nextZ=null,rt*=2}while(fe>1);return H}function ut(H,z,V,be,me){return H=32767*(H-V)*me,z=32767*(z-be)*me,H=(H|H<<8)&16711935,H=(H|H<<4)&252645135,H=(H|H<<2)&858993459,H=(H|H<<1)&1431655765,z=(z|z<<8)&16711935,z=(z|z<<4)&252645135,z=(z|z<<2)&858993459,z=(z|z<<1)&1431655765,H|z<<1}function Me(H){var z=H,V=H;do(z.x<V.x||z.x===V.x&&z.y<V.y)&&(V=z),z=z.next;while(z!==H);return V}function bt(H,z,V,be,me,le,fe,Ne){return(me-fe)*(z-Ne)-(H-fe)*(le-Ne)>=0&&(H-fe)*(be-Ne)-(V-fe)*(z-Ne)>=0&&(V-fe)*(le-Ne)-(me-fe)*(be-Ne)>=0}function xt(H,z){return H.next.i!==z.i&&H.prev.i!==z.i&&!vt(H,z)&&(Ze(H,z)&&Ze(z,H)&&Et(H,z)&&(Mt(H.prev,H,z.prev)||Mt(H,z.prev,z))||De(H,z)&&Mt(H.prev,H,H.next)>0&&Mt(z.prev,z,z.next)>0)}function Mt(H,z,V){return(z.y-H.y)*(V.x-z.x)-(z.x-H.x)*(V.y-z.y)}function De(H,z){return H.x===z.x&&H.y===z.y}function ar(H,z,V,be){var me=Ht(Mt(H,z,V)),le=Ht(Mt(H,z,be)),fe=Ht(Mt(V,be,H)),Ne=Ht(Mt(V,be,z));return!!(me!==le&&fe!==Ne||me===0&&$t(H,V,z)||le===0&&$t(H,be,z)||fe===0&&$t(V,H,be)||Ne===0&&$t(V,z,be))}function $t(H,z,V){return z.x<=Math.max(H.x,V.x)&&z.x>=Math.min(H.x,V.x)&&z.y<=Math.max(H.y,V.y)&&z.y>=Math.min(H.y,V.y)}function Ht(H){return H>0?1:H<0?-1:0}function vt(H,z){var V=H;do{if(V.i!==H.i&&V.next.i!==H.i&&V.i!==z.i&&V.next.i!==z.i&&ar(V,V.next,H,z))return!0;V=V.next}while(V!==H);return!1}function Ze(H,z){return Mt(H.prev,H,H.next)<0?Mt(H,z,H.next)>=0&&Mt(H,H.prev,z)>=0:Mt(H,z,H.prev)<0||Mt(H,H.next,z)<0}function Et(H,z){var V=H,be=!1,me=(H.x+z.x)/2,le=(H.y+z.y)/2;do V.y>le!=V.next.y>le&&V.next.y!==V.y&&me<(V.next.x-V.x)*(le-V.y)/(V.next.y-V.y)+V.x&&(be=!be),V=V.next;while(V!==H);return be}function Le(H,z){var V=new St(H.i,H.x,H.y),be=new St(z.i,z.x,z.y),me=H.next,le=z.prev;return H.next=z,z.prev=H,V.next=me,me.prev=V,be.next=V,V.prev=be,le.next=be,be.prev=le,be}function at(H,z,V,be){var me=new St(H,z,V);return be?(me.next=be.next,me.prev=be,be.next.prev=me,be.next=me):(me.prev=me,me.next=me),me}function Wt(H){H.next.prev=H.prev,H.prev.next=H.next,H.prevZ&&(H.prevZ.nextZ=H.nextZ),H.nextZ&&(H.nextZ.prevZ=H.prevZ)}function St(H,z,V){this.i=H,this.x=z,this.y=V,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}S.deviation=function(H,z,V,be){var me=z&&z.length,le=me?z[0]*V:H.length,fe=Math.abs(dt(H,0,le,V));if(me)for(var Ne=0,lt=z.length;Ne<lt;Ne++){var rt=z[Ne]*V,ue=Ne<lt-1?z[Ne+1]*V:H.length;fe-=Math.abs(dt(H,rt,ue,V))}var ye=0;for(Ne=0;Ne<be.length;Ne+=3){var Ue=be[Ne]*V,ft=be[Ne+1]*V,Oe=be[Ne+2]*V;ye+=Math.abs((H[Ue]-H[Oe])*(H[ft+1]-H[Ue+1])-(H[Ue]-H[ft])*(H[Oe+1]-H[Ue+1]))}return fe===0&&ye===0?0:Math.abs((ye-fe)/fe)};function dt(H,z,V,be){for(var me=0,le=z,fe=V-be;le<V;le+=be)me+=(H[fe]-H[le])*(H[le+1]+H[fe+1]),fe=le;return me}S.flatten=function(H){for(var z=H[0][0].length,V={vertices:[],holes:[],dimensions:z},be=0,me=0;me<H.length;me++){for(var le=0;le<H[me].length;le++)for(var fe=0;fe<z;fe++)V.vertices.push(H[me][le][fe]);me>0&&(be+=H[me-1].length,V.holes.push(be))}return V}},W8MJ:function(we,x){function a(v,Z){for(var N=0;N<Z.length;N++){var o=Z[N];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(v,o.key,o)}}function S(v,Z,N){return Z&&a(v.prototype,Z),N&&a(v,N),v}we.exports=S},WFAs:function(we,x){var a=Array.isArray;we.exports=a},Wnft:function(we,x,a){we.exports={mapChart:"antd-pro-pages-dashboard-monitor-style-mapChart",pieCard:"antd-pro-pages-dashboard-monitor-style-pieCard"}},WwFo:function(we,x,a){var S=a("juv8"),v=a("7GkX");function Z(N,o){return N&&S(o,v(o),N)}we.exports=Z},XYm9:function(we,x,a){var S=a("+K+b");function v(Z,N){var o=N?S(Z.buffer):Z.buffer;return new Z.constructor(o,Z.byteOffset,Z.byteLength)}we.exports=v},"Xt/L":function(we,x){function a(S,v,Z){for(var N=-1,o=S==null?0:S.length;++N<o;)if(Z(v,S[N]))return!0;return!1}we.exports=a},Y8BV:function(we,x,a){"use strict";a.d(x,"a",function(){return S});function S(v,Z){var N=Z.callback;return N&&(v.dataArray=v.dataArray.filter(N)),v}},YO3V:function(we,x,a){var S=a("NykK"),v=a("LcsW"),Z=a("ExA7"),N="[object Object]",o=Function.prototype,X=Object.prototype,F=o.toString,K=X.hasOwnProperty,q=F.call(Object);function Ce($){if(!Z($)||S($)!=N)return!1;var He=v($);if(He===null)return!0;var Be=K.call(He,"constructor")&&He.constructor;return typeof Be=="function"&&Be instanceof Be&&F.call(Be)==q}we.exports=Ce},Yk9n:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.inject=x.LazyServiceIdentifer=void 0;var S=a("MON2"),v=a("xfSm"),Z=a("GXnB"),N=a("Ztfv"),o=function(){function F(K){this._cb=K}return F.prototype.unwrap=function(){return this._cb()},F}();x.LazyServiceIdentifer=o;function X(F){return function(K,q,Ce){if(F===void 0)throw new Error(S.UNDEFINED_INJECT_ANNOTATION(K.name));var $=new Z.Metadata(v.INJECT_TAG,F);typeof Ce=="number"?N.tagParameter(K,q,Ce,$):N.tagProperty(K,q,$)}}x.inject=X},Z1HP:function(we,x,a){var S=a("ycre"),v=a("quyA"),Z=a("q4HE");function N(o){return v(o)?Z(o):S(o)}we.exports=N},ZCgT:function(we,x,a){var S=a("tLB3"),v=1/0,Z=17976931348623157e292;function N(o){if(!o)return o===0?o:0;if(o=S(o),o===v||o===-v){var X=o<0?-1:1;return X*Z}return o===o?o:0}we.exports=N},ZK94:function(we,x){we.exports.RADIUS=6378137,we.exports.FLATTENING=1/298.257223563,we.exports.POLAR_RADIUS=63567523142e-4},ZaHm:function(we,x,a){"use strict";a.r(x),a.d(x,"create",function(){return v}),a.d(x,"clone",function(){return Z}),a.d(x,"copy",function(){return N}),a.d(x,"fromValues",function(){return o}),a.d(x,"set",function(){return X}),a.d(x,"identity",function(){return F}),a.d(x,"transpose",function(){return K}),a.d(x,"invert",function(){return q}),a.d(x,"adjoint",function(){return Ce}),a.d(x,"determinant",function(){return $}),a.d(x,"multiply",function(){return He}),a.d(x,"translate",function(){return Be}),a.d(x,"scale",function(){return ce}),a.d(x,"rotate",function(){return st}),a.d(x,"rotateX",function(){return ut}),a.d(x,"rotateY",function(){return Me}),a.d(x,"rotateZ",function(){return bt}),a.d(x,"fromTranslation",function(){return xt}),a.d(x,"fromScaling",function(){return Mt}),a.d(x,"fromRotation",function(){return De}),a.d(x,"fromXRotation",function(){return ar}),a.d(x,"fromYRotation",function(){return $t}),a.d(x,"fromZRotation",function(){return Ht}),a.d(x,"fromRotationTranslation",function(){return vt}),a.d(x,"fromQuat2",function(){return Ze}),a.d(x,"getTranslation",function(){return Et}),a.d(x,"getScaling",function(){return Le}),a.d(x,"getRotation",function(){return at}),a.d(x,"fromRotationTranslationScale",function(){return Wt}),a.d(x,"fromRotationTranslationScaleOrigin",function(){return St}),a.d(x,"fromQuat",function(){return dt}),a.d(x,"frustum",function(){return H}),a.d(x,"perspective",function(){return z}),a.d(x,"perspectiveFromFieldOfView",function(){return V}),a.d(x,"ortho",function(){return be}),a.d(x,"lookAt",function(){return me}),a.d(x,"targetTo",function(){return le}),a.d(x,"str",function(){return fe}),a.d(x,"frob",function(){return Ne}),a.d(x,"add",function(){return lt}),a.d(x,"subtract",function(){return rt}),a.d(x,"multiplyScalar",function(){return ue}),a.d(x,"multiplyScalarAndAdd",function(){return ye}),a.d(x,"exactEquals",function(){return Ue}),a.d(x,"equals",function(){return ft}),a.d(x,"mul",function(){return Oe}),a.d(x,"sub",function(){return Ve});var S=a("yU0y");function v(){var P=new S.a(16);return S.a!=Float32Array&&(P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[11]=0,P[12]=0,P[13]=0,P[14]=0),P[0]=1,P[5]=1,P[10]=1,P[15]=1,P}function Z(P){var R=new S.a(16);return R[0]=P[0],R[1]=P[1],R[2]=P[2],R[3]=P[3],R[4]=P[4],R[5]=P[5],R[6]=P[6],R[7]=P[7],R[8]=P[8],R[9]=P[9],R[10]=P[10],R[11]=P[11],R[12]=P[12],R[13]=P[13],R[14]=P[14],R[15]=P[15],R}function N(P,R){return P[0]=R[0],P[1]=R[1],P[2]=R[2],P[3]=R[3],P[4]=R[4],P[5]=R[5],P[6]=R[6],P[7]=R[7],P[8]=R[8],P[9]=R[9],P[10]=R[10],P[11]=R[11],P[12]=R[12],P[13]=R[13],P[14]=R[14],P[15]=R[15],P}function o(P,R,J,de,je,We,gt,nt,Nt,Y,Xe,re,Je,Gt,ur,ct){var ht=new S.a(16);return ht[0]=P,ht[1]=R,ht[2]=J,ht[3]=de,ht[4]=je,ht[5]=We,ht[6]=gt,ht[7]=nt,ht[8]=Nt,ht[9]=Y,ht[10]=Xe,ht[11]=re,ht[12]=Je,ht[13]=Gt,ht[14]=ur,ht[15]=ct,ht}function X(P,R,J,de,je,We,gt,nt,Nt,Y,Xe,re,Je,Gt,ur,ct,ht){return P[0]=R,P[1]=J,P[2]=de,P[3]=je,P[4]=We,P[5]=gt,P[6]=nt,P[7]=Nt,P[8]=Y,P[9]=Xe,P[10]=re,P[11]=Je,P[12]=Gt,P[13]=ur,P[14]=ct,P[15]=ht,P}function F(P){return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=1,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=1,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P}function K(P,R){if(P===R){var J=R[1],de=R[2],je=R[3],We=R[6],gt=R[7],nt=R[11];P[1]=R[4],P[2]=R[8],P[3]=R[12],P[4]=J,P[6]=R[9],P[7]=R[13],P[8]=de,P[9]=We,P[11]=R[14],P[12]=je,P[13]=gt,P[14]=nt}else P[0]=R[0],P[1]=R[4],P[2]=R[8],P[3]=R[12],P[4]=R[1],P[5]=R[5],P[6]=R[9],P[7]=R[13],P[8]=R[2],P[9]=R[6],P[10]=R[10],P[11]=R[14],P[12]=R[3],P[13]=R[7],P[14]=R[11],P[15]=R[15];return P}function q(P,R){var J=R[0],de=R[1],je=R[2],We=R[3],gt=R[4],nt=R[5],Nt=R[6],Y=R[7],Xe=R[8],re=R[9],Je=R[10],Gt=R[11],ur=R[12],ct=R[13],ht=R[14],Pt=R[15],pt=J*nt-de*gt,Pe=J*Nt-je*gt,ot=J*Y-We*gt,$e=de*Nt-je*nt,Vt=de*Y-We*nt,dr=je*Y-We*Nt,Zr=Xe*ct-re*ur,cr=Xe*ht-Je*ur,Un=Xe*Pt-Gt*ur,Sn=re*ht-Je*ct,ni=re*Pt-Gt*ct,fi=Je*Pt-Gt*ht,Wn=pt*fi-Pe*ni+ot*Sn+$e*Un-Vt*cr+dr*Zr;return Wn?(Wn=1/Wn,P[0]=(nt*fi-Nt*ni+Y*Sn)*Wn,P[1]=(je*ni-de*fi-We*Sn)*Wn,P[2]=(ct*dr-ht*Vt+Pt*$e)*Wn,P[3]=(Je*Vt-re*dr-Gt*$e)*Wn,P[4]=(Nt*Un-gt*fi-Y*cr)*Wn,P[5]=(J*fi-je*Un+We*cr)*Wn,P[6]=(ht*ot-ur*dr-Pt*Pe)*Wn,P[7]=(Xe*dr-Je*ot+Gt*Pe)*Wn,P[8]=(gt*ni-nt*Un+Y*Zr)*Wn,P[9]=(de*Un-J*ni-We*Zr)*Wn,P[10]=(ur*Vt-ct*ot+Pt*pt)*Wn,P[11]=(re*ot-Xe*Vt-Gt*pt)*Wn,P[12]=(nt*cr-gt*Sn-Nt*Zr)*Wn,P[13]=(J*Sn-de*cr+je*Zr)*Wn,P[14]=(ct*Pe-ur*$e-ht*pt)*Wn,P[15]=(Xe*$e-re*Pe+Je*pt)*Wn,P):null}function Ce(P,R){var J=R[0],de=R[1],je=R[2],We=R[3],gt=R[4],nt=R[5],Nt=R[6],Y=R[7],Xe=R[8],re=R[9],Je=R[10],Gt=R[11],ur=R[12],ct=R[13],ht=R[14],Pt=R[15];return P[0]=nt*(Je*Pt-Gt*ht)-re*(Nt*Pt-Y*ht)+ct*(Nt*Gt-Y*Je),P[1]=-(de*(Je*Pt-Gt*ht)-re*(je*Pt-We*ht)+ct*(je*Gt-We*Je)),P[2]=de*(Nt*Pt-Y*ht)-nt*(je*Pt-We*ht)+ct*(je*Y-We*Nt),P[3]=-(de*(Nt*Gt-Y*Je)-nt*(je*Gt-We*Je)+re*(je*Y-We*Nt)),P[4]=-(gt*(Je*Pt-Gt*ht)-Xe*(Nt*Pt-Y*ht)+ur*(Nt*Gt-Y*Je)),P[5]=J*(Je*Pt-Gt*ht)-Xe*(je*Pt-We*ht)+ur*(je*Gt-We*Je),P[6]=-(J*(Nt*Pt-Y*ht)-gt*(je*Pt-We*ht)+ur*(je*Y-We*Nt)),P[7]=J*(Nt*Gt-Y*Je)-gt*(je*Gt-We*Je)+Xe*(je*Y-We*Nt),P[8]=gt*(re*Pt-Gt*ct)-Xe*(nt*Pt-Y*ct)+ur*(nt*Gt-Y*re),P[9]=-(J*(re*Pt-Gt*ct)-Xe*(de*Pt-We*ct)+ur*(de*Gt-We*re)),P[10]=J*(nt*Pt-Y*ct)-gt*(de*Pt-We*ct)+ur*(de*Y-We*nt),P[11]=-(J*(nt*Gt-Y*re)-gt*(de*Gt-We*re)+Xe*(de*Y-We*nt)),P[12]=-(gt*(re*ht-Je*ct)-Xe*(nt*ht-Nt*ct)+ur*(nt*Je-Nt*re)),P[13]=J*(re*ht-Je*ct)-Xe*(de*ht-je*ct)+ur*(de*Je-je*re),P[14]=-(J*(nt*ht-Nt*ct)-gt*(de*ht-je*ct)+ur*(de*Nt-je*nt)),P[15]=J*(nt*Je-Nt*re)-gt*(de*Je-je*re)+Xe*(de*Nt-je*nt),P}function $(P){var R=P[0],J=P[1],de=P[2],je=P[3],We=P[4],gt=P[5],nt=P[6],Nt=P[7],Y=P[8],Xe=P[9],re=P[10],Je=P[11],Gt=P[12],ur=P[13],ct=P[14],ht=P[15],Pt=R*gt-J*We,pt=R*nt-de*We,Pe=R*Nt-je*We,ot=J*nt-de*gt,$e=J*Nt-je*gt,Vt=de*Nt-je*nt,dr=Y*ur-Xe*Gt,Zr=Y*ct-re*Gt,cr=Y*ht-Je*Gt,Un=Xe*ct-re*ur,Sn=Xe*ht-Je*ur,ni=re*ht-Je*ct;return Pt*ni-pt*Sn+Pe*Un+ot*cr-$e*Zr+Vt*dr}function He(P,R,J){var de=R[0],je=R[1],We=R[2],gt=R[3],nt=R[4],Nt=R[5],Y=R[6],Xe=R[7],re=R[8],Je=R[9],Gt=R[10],ur=R[11],ct=R[12],ht=R[13],Pt=R[14],pt=R[15],Pe=J[0],ot=J[1],$e=J[2],Vt=J[3];return P[0]=Pe*de+ot*nt+$e*re+Vt*ct,P[1]=Pe*je+ot*Nt+$e*Je+Vt*ht,P[2]=Pe*We+ot*Y+$e*Gt+Vt*Pt,P[3]=Pe*gt+ot*Xe+$e*ur+Vt*pt,Pe=J[4],ot=J[5],$e=J[6],Vt=J[7],P[4]=Pe*de+ot*nt+$e*re+Vt*ct,P[5]=Pe*je+ot*Nt+$e*Je+Vt*ht,P[6]=Pe*We+ot*Y+$e*Gt+Vt*Pt,P[7]=Pe*gt+ot*Xe+$e*ur+Vt*pt,Pe=J[8],ot=J[9],$e=J[10],Vt=J[11],P[8]=Pe*de+ot*nt+$e*re+Vt*ct,P[9]=Pe*je+ot*Nt+$e*Je+Vt*ht,P[10]=Pe*We+ot*Y+$e*Gt+Vt*Pt,P[11]=Pe*gt+ot*Xe+$e*ur+Vt*pt,Pe=J[12],ot=J[13],$e=J[14],Vt=J[15],P[12]=Pe*de+ot*nt+$e*re+Vt*ct,P[13]=Pe*je+ot*Nt+$e*Je+Vt*ht,P[14]=Pe*We+ot*Y+$e*Gt+Vt*Pt,P[15]=Pe*gt+ot*Xe+$e*ur+Vt*pt,P}function Be(P,R,J){var de=J[0],je=J[1],We=J[2],gt,nt,Nt,Y,Xe,re,Je,Gt,ur,ct,ht,Pt;return R===P?(P[12]=R[0]*de+R[4]*je+R[8]*We+R[12],P[13]=R[1]*de+R[5]*je+R[9]*We+R[13],P[14]=R[2]*de+R[6]*je+R[10]*We+R[14],P[15]=R[3]*de+R[7]*je+R[11]*We+R[15]):(gt=R[0],nt=R[1],Nt=R[2],Y=R[3],Xe=R[4],re=R[5],Je=R[6],Gt=R[7],ur=R[8],ct=R[9],ht=R[10],Pt=R[11],P[0]=gt,P[1]=nt,P[2]=Nt,P[3]=Y,P[4]=Xe,P[5]=re,P[6]=Je,P[7]=Gt,P[8]=ur,P[9]=ct,P[10]=ht,P[11]=Pt,P[12]=gt*de+Xe*je+ur*We+R[12],P[13]=nt*de+re*je+ct*We+R[13],P[14]=Nt*de+Je*je+ht*We+R[14],P[15]=Y*de+Gt*je+Pt*We+R[15]),P}function ce(P,R,J){var de=J[0],je=J[1],We=J[2];return P[0]=R[0]*de,P[1]=R[1]*de,P[2]=R[2]*de,P[3]=R[3]*de,P[4]=R[4]*je,P[5]=R[5]*je,P[6]=R[6]*je,P[7]=R[7]*je,P[8]=R[8]*We,P[9]=R[9]*We,P[10]=R[10]*We,P[11]=R[11]*We,P[12]=R[12],P[13]=R[13],P[14]=R[14],P[15]=R[15],P}function st(P,R,J,de){var je=de[0],We=de[1],gt=de[2],nt=Math.hypot(je,We,gt),Nt,Y,Xe,re,Je,Gt,ur,ct,ht,Pt,pt,Pe,ot,$e,Vt,dr,Zr,cr,Un,Sn,ni,fi,Wn,Gn;return nt<S.b?null:(nt=1/nt,je*=nt,We*=nt,gt*=nt,Nt=Math.sin(J),Y=Math.cos(J),Xe=1-Y,re=R[0],Je=R[1],Gt=R[2],ur=R[3],ct=R[4],ht=R[5],Pt=R[6],pt=R[7],Pe=R[8],ot=R[9],$e=R[10],Vt=R[11],dr=je*je*Xe+Y,Zr=We*je*Xe+gt*Nt,cr=gt*je*Xe-We*Nt,Un=je*We*Xe-gt*Nt,Sn=We*We*Xe+Y,ni=gt*We*Xe+je*Nt,fi=je*gt*Xe+We*Nt,Wn=We*gt*Xe-je*Nt,Gn=gt*gt*Xe+Y,P[0]=re*dr+ct*Zr+Pe*cr,P[1]=Je*dr+ht*Zr+ot*cr,P[2]=Gt*dr+Pt*Zr+$e*cr,P[3]=ur*dr+pt*Zr+Vt*cr,P[4]=re*Un+ct*Sn+Pe*ni,P[5]=Je*Un+ht*Sn+ot*ni,P[6]=Gt*Un+Pt*Sn+$e*ni,P[7]=ur*Un+pt*Sn+Vt*ni,P[8]=re*fi+ct*Wn+Pe*Gn,P[9]=Je*fi+ht*Wn+ot*Gn,P[10]=Gt*fi+Pt*Wn+$e*Gn,P[11]=ur*fi+pt*Wn+Vt*Gn,R!==P&&(P[12]=R[12],P[13]=R[13],P[14]=R[14],P[15]=R[15]),P)}function ut(P,R,J){var de=Math.sin(J),je=Math.cos(J),We=R[4],gt=R[5],nt=R[6],Nt=R[7],Y=R[8],Xe=R[9],re=R[10],Je=R[11];return R!==P&&(P[0]=R[0],P[1]=R[1],P[2]=R[2],P[3]=R[3],P[12]=R[12],P[13]=R[13],P[14]=R[14],P[15]=R[15]),P[4]=We*je+Y*de,P[5]=gt*je+Xe*de,P[6]=nt*je+re*de,P[7]=Nt*je+Je*de,P[8]=Y*je-We*de,P[9]=Xe*je-gt*de,P[10]=re*je-nt*de,P[11]=Je*je-Nt*de,P}function Me(P,R,J){var de=Math.sin(J),je=Math.cos(J),We=R[0],gt=R[1],nt=R[2],Nt=R[3],Y=R[8],Xe=R[9],re=R[10],Je=R[11];return R!==P&&(P[4]=R[4],P[5]=R[5],P[6]=R[6],P[7]=R[7],P[12]=R[12],P[13]=R[13],P[14]=R[14],P[15]=R[15]),P[0]=We*je-Y*de,P[1]=gt*je-Xe*de,P[2]=nt*je-re*de,P[3]=Nt*je-Je*de,P[8]=We*de+Y*je,P[9]=gt*de+Xe*je,P[10]=nt*de+re*je,P[11]=Nt*de+Je*je,P}function bt(P,R,J){var de=Math.sin(J),je=Math.cos(J),We=R[0],gt=R[1],nt=R[2],Nt=R[3],Y=R[4],Xe=R[5],re=R[6],Je=R[7];return R!==P&&(P[8]=R[8],P[9]=R[9],P[10]=R[10],P[11]=R[11],P[12]=R[12],P[13]=R[13],P[14]=R[14],P[15]=R[15]),P[0]=We*je+Y*de,P[1]=gt*je+Xe*de,P[2]=nt*je+re*de,P[3]=Nt*je+Je*de,P[4]=Y*je-We*de,P[5]=Xe*je-gt*de,P[6]=re*je-nt*de,P[7]=Je*je-Nt*de,P}function xt(P,R){return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=1,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=1,P[11]=0,P[12]=R[0],P[13]=R[1],P[14]=R[2],P[15]=1,P}function Mt(P,R){return P[0]=R[0],P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=R[1],P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=R[2],P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P}function De(P,R,J){var de=J[0],je=J[1],We=J[2],gt=Math.hypot(de,je,We),nt,Nt,Y;return gt<S.b?null:(gt=1/gt,de*=gt,je*=gt,We*=gt,nt=Math.sin(R),Nt=Math.cos(R),Y=1-Nt,P[0]=de*de*Y+Nt,P[1]=je*de*Y+We*nt,P[2]=We*de*Y-je*nt,P[3]=0,P[4]=de*je*Y-We*nt,P[5]=je*je*Y+Nt,P[6]=We*je*Y+de*nt,P[7]=0,P[8]=de*We*Y+je*nt,P[9]=je*We*Y-de*nt,P[10]=We*We*Y+Nt,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P)}function ar(P,R){var J=Math.sin(R),de=Math.cos(R);return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=de,P[6]=J,P[7]=0,P[8]=0,P[9]=-J,P[10]=de,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P}function $t(P,R){var J=Math.sin(R),de=Math.cos(R);return P[0]=de,P[1]=0,P[2]=-J,P[3]=0,P[4]=0,P[5]=1,P[6]=0,P[7]=0,P[8]=J,P[9]=0,P[10]=de,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P}function Ht(P,R){var J=Math.sin(R),de=Math.cos(R);return P[0]=de,P[1]=J,P[2]=0,P[3]=0,P[4]=-J,P[5]=de,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=1,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P}function vt(P,R,J){var de=R[0],je=R[1],We=R[2],gt=R[3],nt=de+de,Nt=je+je,Y=We+We,Xe=de*nt,re=de*Nt,Je=de*Y,Gt=je*Nt,ur=je*Y,ct=We*Y,ht=gt*nt,Pt=gt*Nt,pt=gt*Y;return P[0]=1-(Gt+ct),P[1]=re+pt,P[2]=Je-Pt,P[3]=0,P[4]=re-pt,P[5]=1-(Xe+ct),P[6]=ur+ht,P[7]=0,P[8]=Je+Pt,P[9]=ur-ht,P[10]=1-(Xe+Gt),P[11]=0,P[12]=J[0],P[13]=J[1],P[14]=J[2],P[15]=1,P}function Ze(P,R){var J=new S.a(3),de=-R[0],je=-R[1],We=-R[2],gt=R[3],nt=R[4],Nt=R[5],Y=R[6],Xe=R[7],re=de*de+je*je+We*We+gt*gt;return re>0?(J[0]=(nt*gt+Xe*de+Nt*We-Y*je)*2/re,J[1]=(Nt*gt+Xe*je+Y*de-nt*We)*2/re,J[2]=(Y*gt+Xe*We+nt*je-Nt*de)*2/re):(J[0]=(nt*gt+Xe*de+Nt*We-Y*je)*2,J[1]=(Nt*gt+Xe*je+Y*de-nt*We)*2,J[2]=(Y*gt+Xe*We+nt*je-Nt*de)*2),vt(P,R,J),P}function Et(P,R){return P[0]=R[12],P[1]=R[13],P[2]=R[14],P}function Le(P,R){var J=R[0],de=R[1],je=R[2],We=R[4],gt=R[5],nt=R[6],Nt=R[8],Y=R[9],Xe=R[10];return P[0]=Math.hypot(J,de,je),P[1]=Math.hypot(We,gt,nt),P[2]=Math.hypot(Nt,Y,Xe),P}function at(P,R){var J=new S.a(3);Le(J,R);var de=1/J[0],je=1/J[1],We=1/J[2],gt=R[0]*de,nt=R[1]*je,Nt=R[2]*We,Y=R[4]*de,Xe=R[5]*je,re=R[6]*We,Je=R[8]*de,Gt=R[9]*je,ur=R[10]*We,ct=gt+Xe+ur,ht=0;return ct>0?(ht=Math.sqrt(ct+1)*2,P[3]=.25*ht,P[0]=(re-Gt)/ht,P[1]=(Je-Nt)/ht,P[2]=(nt-Y)/ht):gt>Xe&&gt>ur?(ht=Math.sqrt(1+gt-Xe-ur)*2,P[3]=(re-Gt)/ht,P[0]=.25*ht,P[1]=(nt+Y)/ht,P[2]=(Je+Nt)/ht):Xe>ur?(ht=Math.sqrt(1+Xe-gt-ur)*2,P[3]=(Je-Nt)/ht,P[0]=(nt+Y)/ht,P[1]=.25*ht,P[2]=(re+Gt)/ht):(ht=Math.sqrt(1+ur-gt-Xe)*2,P[3]=(nt-Y)/ht,P[0]=(Je+Nt)/ht,P[1]=(re+Gt)/ht,P[2]=.25*ht),P}function Wt(P,R,J,de){var je=R[0],We=R[1],gt=R[2],nt=R[3],Nt=je+je,Y=We+We,Xe=gt+gt,re=je*Nt,Je=je*Y,Gt=je*Xe,ur=We*Y,ct=We*Xe,ht=gt*Xe,Pt=nt*Nt,pt=nt*Y,Pe=nt*Xe,ot=de[0],$e=de[1],Vt=de[2];return P[0]=(1-(ur+ht))*ot,P[1]=(Je+Pe)*ot,P[2]=(Gt-pt)*ot,P[3]=0,P[4]=(Je-Pe)*$e,P[5]=(1-(re+ht))*$e,P[6]=(ct+Pt)*$e,P[7]=0,P[8]=(Gt+pt)*Vt,P[9]=(ct-Pt)*Vt,P[10]=(1-(re+ur))*Vt,P[11]=0,P[12]=J[0],P[13]=J[1],P[14]=J[2],P[15]=1,P}function St(P,R,J,de,je){var We=R[0],gt=R[1],nt=R[2],Nt=R[3],Y=We+We,Xe=gt+gt,re=nt+nt,Je=We*Y,Gt=We*Xe,ur=We*re,ct=gt*Xe,ht=gt*re,Pt=nt*re,pt=Nt*Y,Pe=Nt*Xe,ot=Nt*re,$e=de[0],Vt=de[1],dr=de[2],Zr=je[0],cr=je[1],Un=je[2],Sn=(1-(ct+Pt))*$e,ni=(Gt+ot)*$e,fi=(ur-Pe)*$e,Wn=(Gt-ot)*Vt,Gn=(1-(Je+Pt))*Vt,Ee=(ht+pt)*Vt,pe=(ur+Pe)*dr,W=(ht-pt)*dr,ae=(1-(Je+ct))*dr;return P[0]=Sn,P[1]=ni,P[2]=fi,P[3]=0,P[4]=Wn,P[5]=Gn,P[6]=Ee,P[7]=0,P[8]=pe,P[9]=W,P[10]=ae,P[11]=0,P[12]=J[0]+Zr-(Sn*Zr+Wn*cr+pe*Un),P[13]=J[1]+cr-(ni*Zr+Gn*cr+W*Un),P[14]=J[2]+Un-(fi*Zr+Ee*cr+ae*Un),P[15]=1,P}function dt(P,R){var J=R[0],de=R[1],je=R[2],We=R[3],gt=J+J,nt=de+de,Nt=je+je,Y=J*gt,Xe=de*gt,re=de*nt,Je=je*gt,Gt=je*nt,ur=je*Nt,ct=We*gt,ht=We*nt,Pt=We*Nt;return P[0]=1-re-ur,P[1]=Xe+Pt,P[2]=Je-ht,P[3]=0,P[4]=Xe-Pt,P[5]=1-Y-ur,P[6]=Gt+ct,P[7]=0,P[8]=Je+ht,P[9]=Gt-ct,P[10]=1-Y-re,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P}function H(P,R,J,de,je,We,gt){var nt=1/(J-R),Nt=1/(je-de),Y=1/(We-gt);return P[0]=We*2*nt,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=We*2*Nt,P[6]=0,P[7]=0,P[8]=(J+R)*nt,P[9]=(je+de)*Nt,P[10]=(gt+We)*Y,P[11]=-1,P[12]=0,P[13]=0,P[14]=gt*We*2*Y,P[15]=0,P}function z(P,R,J,de,je){var We=1/Math.tan(R/2),gt;return P[0]=We/J,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=We,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[11]=-1,P[12]=0,P[13]=0,P[15]=0,je!=null&&je!==Infinity?(gt=1/(de-je),P[10]=(je+de)*gt,P[14]=2*je*de*gt):(P[10]=-1,P[14]=-2*de),P}function V(P,R,J,de){var je=Math.tan(R.upDegrees*Math.PI/180),We=Math.tan(R.downDegrees*Math.PI/180),gt=Math.tan(R.leftDegrees*Math.PI/180),nt=Math.tan(R.rightDegrees*Math.PI/180),Nt=2/(gt+nt),Y=2/(je+We);return P[0]=Nt,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=Y,P[6]=0,P[7]=0,P[8]=-((gt-nt)*Nt*.5),P[9]=(je-We)*Y*.5,P[10]=de/(J-de),P[11]=-1,P[12]=0,P[13]=0,P[14]=de*J/(J-de),P[15]=0,P}function be(P,R,J,de,je,We,gt){var nt=1/(R-J),Nt=1/(de-je),Y=1/(We-gt);return P[0]=-2*nt,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=-2*Nt,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=2*Y,P[11]=0,P[12]=(R+J)*nt,P[13]=(je+de)*Nt,P[14]=(gt+We)*Y,P[15]=1,P}function me(P,R,J,de){var je,We,gt,nt,Nt,Y,Xe,re,Je,Gt,ur=R[0],ct=R[1],ht=R[2],Pt=de[0],pt=de[1],Pe=de[2],ot=J[0],$e=J[1],Vt=J[2];return Math.abs(ur-ot)<S.b&&Math.abs(ct-$e)<S.b&&Math.abs(ht-Vt)<S.b?F(P):(Xe=ur-ot,re=ct-$e,Je=ht-Vt,Gt=1/Math.hypot(Xe,re,Je),Xe*=Gt,re*=Gt,Je*=Gt,je=pt*Je-Pe*re,We=Pe*Xe-Pt*Je,gt=Pt*re-pt*Xe,Gt=Math.hypot(je,We,gt),Gt?(Gt=1/Gt,je*=Gt,We*=Gt,gt*=Gt):(je=0,We=0,gt=0),nt=re*gt-Je*We,Nt=Je*je-Xe*gt,Y=Xe*We-re*je,Gt=Math.hypot(nt,Nt,Y),Gt?(Gt=1/Gt,nt*=Gt,Nt*=Gt,Y*=Gt):(nt=0,Nt=0,Y=0),P[0]=je,P[1]=nt,P[2]=Xe,P[3]=0,P[4]=We,P[5]=Nt,P[6]=re,P[7]=0,P[8]=gt,P[9]=Y,P[10]=Je,P[11]=0,P[12]=-(je*ur+We*ct+gt*ht),P[13]=-(nt*ur+Nt*ct+Y*ht),P[14]=-(Xe*ur+re*ct+Je*ht),P[15]=1,P)}function le(P,R,J,de){var je=R[0],We=R[1],gt=R[2],nt=de[0],Nt=de[1],Y=de[2],Xe=je-J[0],re=We-J[1],Je=gt-J[2],Gt=Xe*Xe+re*re+Je*Je;Gt>0&&(Gt=1/Math.sqrt(Gt),Xe*=Gt,re*=Gt,Je*=Gt);var ur=Nt*Je-Y*re,ct=Y*Xe-nt*Je,ht=nt*re-Nt*Xe;return Gt=ur*ur+ct*ct+ht*ht,Gt>0&&(Gt=1/Math.sqrt(Gt),ur*=Gt,ct*=Gt,ht*=Gt),P[0]=ur,P[1]=ct,P[2]=ht,P[3]=0,P[4]=re*ht-Je*ct,P[5]=Je*ur-Xe*ht,P[6]=Xe*ct-re*ur,P[7]=0,P[8]=Xe,P[9]=re,P[10]=Je,P[11]=0,P[12]=je,P[13]=We,P[14]=gt,P[15]=1,P}function fe(P){return"mat4("+P[0]+", "+P[1]+", "+P[2]+", "+P[3]+", "+P[4]+", "+P[5]+", "+P[6]+", "+P[7]+", "+P[8]+", "+P[9]+", "+P[10]+", "+P[11]+", "+P[12]+", "+P[13]+", "+P[14]+", "+P[15]+")"}function Ne(P){return Math.hypot(P[0],P[1],P[2],P[3],P[4],P[5],P[6],P[7],P[8],P[9],P[10],P[11],P[12],P[13],P[14],P[15])}function lt(P,R,J){return P[0]=R[0]+J[0],P[1]=R[1]+J[1],P[2]=R[2]+J[2],P[3]=R[3]+J[3],P[4]=R[4]+J[4],P[5]=R[5]+J[5],P[6]=R[6]+J[6],P[7]=R[7]+J[7],P[8]=R[8]+J[8],P[9]=R[9]+J[9],P[10]=R[10]+J[10],P[11]=R[11]+J[11],P[12]=R[12]+J[12],P[13]=R[13]+J[13],P[14]=R[14]+J[14],P[15]=R[15]+J[15],P}function rt(P,R,J){return P[0]=R[0]-J[0],P[1]=R[1]-J[1],P[2]=R[2]-J[2],P[3]=R[3]-J[3],P[4]=R[4]-J[4],P[5]=R[5]-J[5],P[6]=R[6]-J[6],P[7]=R[7]-J[7],P[8]=R[8]-J[8],P[9]=R[9]-J[9],P[10]=R[10]-J[10],P[11]=R[11]-J[11],P[12]=R[12]-J[12],P[13]=R[13]-J[13],P[14]=R[14]-J[14],P[15]=R[15]-J[15],P}function ue(P,R,J){return P[0]=R[0]*J,P[1]=R[1]*J,P[2]=R[2]*J,P[3]=R[3]*J,P[4]=R[4]*J,P[5]=R[5]*J,P[6]=R[6]*J,P[7]=R[7]*J,P[8]=R[8]*J,P[9]=R[9]*J,P[10]=R[10]*J,P[11]=R[11]*J,P[12]=R[12]*J,P[13]=R[13]*J,P[14]=R[14]*J,P[15]=R[15]*J,P}function ye(P,R,J,de){return P[0]=R[0]+J[0]*de,P[1]=R[1]+J[1]*de,P[2]=R[2]+J[2]*de,P[3]=R[3]+J[3]*de,P[4]=R[4]+J[4]*de,P[5]=R[5]+J[5]*de,P[6]=R[6]+J[6]*de,P[7]=R[7]+J[7]*de,P[8]=R[8]+J[8]*de,P[9]=R[9]+J[9]*de,P[10]=R[10]+J[10]*de,P[11]=R[11]+J[11]*de,P[12]=R[12]+J[12]*de,P[13]=R[13]+J[13]*de,P[14]=R[14]+J[14]*de,P[15]=R[15]+J[15]*de,P}function Ue(P,R){return P[0]===R[0]&&P[1]===R[1]&&P[2]===R[2]&&P[3]===R[3]&&P[4]===R[4]&&P[5]===R[5]&&P[6]===R[6]&&P[7]===R[7]&&P[8]===R[8]&&P[9]===R[9]&&P[10]===R[10]&&P[11]===R[11]&&P[12]===R[12]&&P[13]===R[13]&&P[14]===R[14]&&P[15]===R[15]}function ft(P,R){var J=P[0],de=P[1],je=P[2],We=P[3],gt=P[4],nt=P[5],Nt=P[6],Y=P[7],Xe=P[8],re=P[9],Je=P[10],Gt=P[11],ur=P[12],ct=P[13],ht=P[14],Pt=P[15],pt=R[0],Pe=R[1],ot=R[2],$e=R[3],Vt=R[4],dr=R[5],Zr=R[6],cr=R[7],Un=R[8],Sn=R[9],ni=R[10],fi=R[11],Wn=R[12],Gn=R[13],Ee=R[14],pe=R[15];return Math.abs(J-pt)<=S.b*Math.max(1,Math.abs(J),Math.abs(pt))&&Math.abs(de-Pe)<=S.b*Math.max(1,Math.abs(de),Math.abs(Pe))&&Math.abs(je-ot)<=S.b*Math.max(1,Math.abs(je),Math.abs(ot))&&Math.abs(We-$e)<=S.b*Math.max(1,Math.abs(We),Math.abs($e))&&Math.abs(gt-Vt)<=S.b*Math.max(1,Math.abs(gt),Math.abs(Vt))&&Math.abs(nt-dr)<=S.b*Math.max(1,Math.abs(nt),Math.abs(dr))&&Math.abs(Nt-Zr)<=S.b*Math.max(1,Math.abs(Nt),Math.abs(Zr))&&Math.abs(Y-cr)<=S.b*Math.max(1,Math.abs(Y),Math.abs(cr))&&Math.abs(Xe-Un)<=S.b*Math.max(1,Math.abs(Xe),Math.abs(Un))&&Math.abs(re-Sn)<=S.b*Math.max(1,Math.abs(re),Math.abs(Sn))&&Math.abs(Je-ni)<=S.b*Math.max(1,Math.abs(Je),Math.abs(ni))&&Math.abs(Gt-fi)<=S.b*Math.max(1,Math.abs(Gt),Math.abs(fi))&&Math.abs(ur-Wn)<=S.b*Math.max(1,Math.abs(ur),Math.abs(Wn))&&Math.abs(ct-Gn)<=S.b*Math.max(1,Math.abs(ct),Math.abs(Gn))&&Math.abs(ht-Ee)<=S.b*Math.max(1,Math.abs(ht),Math.abs(Ee))&&Math.abs(Pt-pe)<=S.b*Math.max(1,Math.abs(Pt),Math.abs(pe))}var Oe=He,Ve=rt},Ztfv:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.tagProperty=x.tagParameter=x.decorate=void 0;var S=a("MON2"),v=a("xfSm");function Z(q,Ce,$,He){var Be=v.TAGGED;o(Be,q,Ce,He,$)}x.tagParameter=Z;function N(q,Ce,$){var He=v.TAGGED_PROP;o(He,q.constructor,Ce,$)}x.tagProperty=N;function o(q,Ce,$,He,Be){var ce={},st=typeof Be=="number",ut=Be!==void 0&&st?Be.toString():$;if(st&&$!==void 0)throw new Error(S.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(q,Ce)&&(ce=Reflect.getMetadata(q,Ce));var Me=ce[ut];if(!Array.isArray(Me))Me=[];else for(var bt=0,xt=Me;bt<xt.length;bt++){var Mt=xt[bt];if(Mt.key===He.key)throw new Error(S.DUPLICATED_METADATA+" "+Mt.key.toString())}Me.push(He),ce[ut]=Me,Reflect.defineMetadata(q,ce,Ce)}function X(q,Ce){Reflect.decorate(q,Ce)}function F(q,Ce){return function($,He){Ce($,He,q)}}function K(q,Ce,$){typeof $=="number"?X([F($,q)],Ce):typeof $=="string"?Reflect.decorate([q],Ce,$):X([q],Ce)}x.decorate=K},ZxFD:function(we,x,a){"use strict";a.r(x),a.d(x,"create",function(){return v}),a.d(x,"clone",function(){return Z}),a.d(x,"fromValues",function(){return N}),a.d(x,"copy",function(){return o}),a.d(x,"set",function(){return X}),a.d(x,"add",function(){return F}),a.d(x,"subtract",function(){return K}),a.d(x,"multiply",function(){return q}),a.d(x,"divide",function(){return Ce}),a.d(x,"ceil",function(){return $}),a.d(x,"floor",function(){return He}),a.d(x,"min",function(){return Be}),a.d(x,"max",function(){return ce}),a.d(x,"round",function(){return st}),a.d(x,"scale",function(){return ut}),a.d(x,"scaleAndAdd",function(){return Me}),a.d(x,"distance",function(){return bt}),a.d(x,"squaredDistance",function(){return xt}),a.d(x,"length",function(){return Mt}),a.d(x,"squaredLength",function(){return De}),a.d(x,"negate",function(){return ar}),a.d(x,"inverse",function(){return $t}),a.d(x,"normalize",function(){return Ht}),a.d(x,"dot",function(){return vt}),a.d(x,"cross",function(){return Ze}),a.d(x,"lerp",function(){return Et}),a.d(x,"random",function(){return Le}),a.d(x,"transformMat2",function(){return at}),a.d(x,"transformMat2d",function(){return Wt}),a.d(x,"transformMat3",function(){return St}),a.d(x,"transformMat4",function(){return dt}),a.d(x,"rotate",function(){return H}),a.d(x,"angle",function(){return z}),a.d(x,"zero",function(){return V}),a.d(x,"str",function(){return be}),a.d(x,"exactEquals",function(){return me}),a.d(x,"equals",function(){return le}),a.d(x,"len",function(){return fe}),a.d(x,"sub",function(){return Ne}),a.d(x,"mul",function(){return lt}),a.d(x,"div",function(){return rt}),a.d(x,"dist",function(){return ue}),a.d(x,"sqrDist",function(){return ye}),a.d(x,"sqrLen",function(){return Ue}),a.d(x,"forEach",function(){return ft});var S=a("yU0y");function v(){var Oe=new S.a(2);return S.a!=Float32Array&&(Oe[0]=0,Oe[1]=0),Oe}function Z(Oe){var Ve=new S.a(2);return Ve[0]=Oe[0],Ve[1]=Oe[1],Ve}function N(Oe,Ve){var P=new S.a(2);return P[0]=Oe,P[1]=Ve,P}function o(Oe,Ve){return Oe[0]=Ve[0],Oe[1]=Ve[1],Oe}function X(Oe,Ve,P){return Oe[0]=Ve,Oe[1]=P,Oe}function F(Oe,Ve,P){return Oe[0]=Ve[0]+P[0],Oe[1]=Ve[1]+P[1],Oe}function K(Oe,Ve,P){return Oe[0]=Ve[0]-P[0],Oe[1]=Ve[1]-P[1],Oe}function q(Oe,Ve,P){return Oe[0]=Ve[0]*P[0],Oe[1]=Ve[1]*P[1],Oe}function Ce(Oe,Ve,P){return Oe[0]=Ve[0]/P[0],Oe[1]=Ve[1]/P[1],Oe}function $(Oe,Ve){return Oe[0]=Math.ceil(Ve[0]),Oe[1]=Math.ceil(Ve[1]),Oe}function He(Oe,Ve){return Oe[0]=Math.floor(Ve[0]),Oe[1]=Math.floor(Ve[1]),Oe}function Be(Oe,Ve,P){return Oe[0]=Math.min(Ve[0],P[0]),Oe[1]=Math.min(Ve[1],P[1]),Oe}function ce(Oe,Ve,P){return Oe[0]=Math.max(Ve[0],P[0]),Oe[1]=Math.max(Ve[1],P[1]),Oe}function st(Oe,Ve){return Oe[0]=Math.round(Ve[0]),Oe[1]=Math.round(Ve[1]),Oe}function ut(Oe,Ve,P){return Oe[0]=Ve[0]*P,Oe[1]=Ve[1]*P,Oe}function Me(Oe,Ve,P,R){return Oe[0]=Ve[0]+P[0]*R,Oe[1]=Ve[1]+P[1]*R,Oe}function bt(Oe,Ve){var P=Ve[0]-Oe[0],R=Ve[1]-Oe[1];return Math.hypot(P,R)}function xt(Oe,Ve){var P=Ve[0]-Oe[0],R=Ve[1]-Oe[1];return P*P+R*R}function Mt(Oe){var Ve=Oe[0],P=Oe[1];return Math.hypot(Ve,P)}function De(Oe){var Ve=Oe[0],P=Oe[1];return Ve*Ve+P*P}function ar(Oe,Ve){return Oe[0]=-Ve[0],Oe[1]=-Ve[1],Oe}function $t(Oe,Ve){return Oe[0]=1/Ve[0],Oe[1]=1/Ve[1],Oe}function Ht(Oe,Ve){var P=Ve[0],R=Ve[1],J=P*P+R*R;return J>0&&(J=1/Math.sqrt(J)),Oe[0]=Ve[0]*J,Oe[1]=Ve[1]*J,Oe}function vt(Oe,Ve){return Oe[0]*Ve[0]+Oe[1]*Ve[1]}function Ze(Oe,Ve,P){var R=Ve[0]*P[1]-Ve[1]*P[0];return Oe[0]=Oe[1]=0,Oe[2]=R,Oe}function Et(Oe,Ve,P,R){var J=Ve[0],de=Ve[1];return Oe[0]=J+R*(P[0]-J),Oe[1]=de+R*(P[1]-de),Oe}function Le(Oe,Ve){Ve=Ve||1;var P=S.c()*2*Math.PI;return Oe[0]=Math.cos(P)*Ve,Oe[1]=Math.sin(P)*Ve,Oe}function at(Oe,Ve,P){var R=Ve[0],J=Ve[1];return Oe[0]=P[0]*R+P[2]*J,Oe[1]=P[1]*R+P[3]*J,Oe}function Wt(Oe,Ve,P){var R=Ve[0],J=Ve[1];return Oe[0]=P[0]*R+P[2]*J+P[4],Oe[1]=P[1]*R+P[3]*J+P[5],Oe}function St(Oe,Ve,P){var R=Ve[0],J=Ve[1];return Oe[0]=P[0]*R+P[3]*J+P[6],Oe[1]=P[1]*R+P[4]*J+P[7],Oe}function dt(Oe,Ve,P){var R=Ve[0],J=Ve[1];return Oe[0]=P[0]*R+P[4]*J+P[12],Oe[1]=P[1]*R+P[5]*J+P[13],Oe}function H(Oe,Ve,P,R){var J=Ve[0]-P[0],de=Ve[1]-P[1],je=Math.sin(R),We=Math.cos(R);return Oe[0]=J*We-de*je+P[0],Oe[1]=J*je+de*We+P[1],Oe}function z(Oe,Ve){var P=Oe[0],R=Oe[1],J=Ve[0],de=Ve[1],je=Math.sqrt(P*P+R*R)*Math.sqrt(J*J+de*de),We=je&&(P*J+R*de)/je;return Math.acos(Math.min(Math.max(We,-1),1))}function V(Oe){return Oe[0]=0,Oe[1]=0,Oe}function be(Oe){return"vec2("+Oe[0]+", "+Oe[1]+")"}function me(Oe,Ve){return Oe[0]===Ve[0]&&Oe[1]===Ve[1]}function le(Oe,Ve){var P=Oe[0],R=Oe[1],J=Ve[0],de=Ve[1];return Math.abs(P-J)<=S.b*Math.max(1,Math.abs(P),Math.abs(J))&&Math.abs(R-de)<=S.b*Math.max(1,Math.abs(R),Math.abs(de))}var fe=Mt,Ne=K,lt=q,rt=Ce,ue=bt,ye=xt,Ue=De,ft=function(){var Oe=v();return function(Ve,P,R,J,de,je){var We,gt;for(P||(P=2),R||(R=0),J?gt=Math.min(J*P+R,Ve.length):gt=Ve.length,We=R;We<gt;We+=P)Oe[0]=Ve[We],Oe[1]=Ve[We+1],de(Oe,Oe,je),Ve[We]=Oe[0],Ve[We+1]=Oe[1];return Ve}}()},ZzCi:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.named=void 0;var S=a("xfSm"),v=a("GXnB"),Z=a("Ztfv");function N(o){return function(X,F,K){var q=new v.Metadata(S.NAMED_TAG,o);typeof K=="number"?Z.tagParameter(X,F,K,q):Z.tagProperty(X,F,q)}}x.named=N},a1gu:function(we,x,a){var S=a("cDf5"),v=a("PJYZ");function Z(N,o){return o&&(S(o)==="object"||typeof o=="function")?o:v(N)}we.exports=Z},a5Wf:function(we,x,a){"use strict";a.r(x);var S=a("IzEo"),v=a("bx4M"),Z=a("14J3"),N=a("BMrR"),o=a("jCWc"),X=a("kPKH"),F=a("fWQN"),K=a("mtLc"),q=a("yKVA"),Ce=a("879j"),$=a("aHsQ"),He=a("sGsY"),Be=a("9kvl"),ce=a("q1tI"),st=a.n(ce),ut=a("FRQA"),Me=a("ZhIB"),bt=a.n(Me),xt=a("yP6+"),Mt=a("k1fw"),De=a("nKUr");function ar(b){var p=b.style;p.height="100%";var c=parseInt("".concat(getComputedStyle(b).height),10),f=parseInt("".concat(getComputedStyle(b).paddingTop),10)+parseInt("".concat(getComputedStyle(b).paddingBottom),10);return c-f}function $t(b){if(!b)return 0;var p=b,c=ar(p),f=p.parentNode;return f&&(c=ar(f)),c}function Ht(){return function(b){var p=function(c){Object(q.a)(m,c);var f=Object(Ce.a)(m);function m(){var _;Object(F.a)(this,m);for(var k=arguments.length,te=new Array(k),se=0;se<k;se++)te[se]=arguments[se];return _=f.call.apply(f,[this].concat(te)),_.state={computedHeight:0},_.root=null,_.handleRoot=function(he){_.root=he},_}return Object(K.a)(m,[{key:"componentDidMount",value:function(){var k=this.props.height;if(!k&&this.root){var te=$t(this.root);this.setState({computedHeight:te}),te<1&&(te=$t(this.root),this.setState({computedHeight:te}))}}},{key:"render",value:function(){var k=this.props.height,te=this.state.computedHeight,se=k||te;return Object(De.jsx)("div",{ref:this.handleRoot,children:se>0&&Object(De.jsx)(b,Object(Mt.a)(Object(Mt.a)({},this.props),{},{height:se}))})}}]),m}(st.a.Component);return p}}var vt=Ht,Ze=xt.Guide.Arc,Et=xt.Guide.Html,Le=xt.Guide.Line,at=function(p){switch(p){case"2":return"\u5DEE";case"4":return"\u4E2D";case"6":return"\u826F";case"8":return"\u4F18";default:return""}};xt.Shape.registerShape&&xt.Shape.registerShape("point","pointer",{drawShape:function(p,c){var f=p.points[0];f=this.parsePoint(f);var m=this.parsePoint({x:0,y:0});return c.addShape("line",{attrs:{x1:m.x,y1:m.y,x2:f.x,y2:f.y,stroke:p.color,lineWidth:2,lineCap:"round"}}),c.addShape("circle",{attrs:{x:m.x,y:m.y,r:6,stroke:p.color,lineWidth:3,fill:"#fff"}})}});var Wt=function(p){var c=p.title,f=p.height,m=f===void 0?1:f,_=p.percent,k=p.forceFit,te=k===void 0?!0:k,se=p.formatter,he=se===void 0?at:se,Ye=p.color,Lt=Ye===void 0?"#2F9CFF":Ye,Bt=p.bgColor,mr=Bt===void 0?"#F0F2F5":Bt,yr={value:{type:"linear",min:0,max:10,tickCount:6,nice:!0}},Ir=[{value:_/10}],Xr=function(){return`
  <div style="width: 300px;text-align: center;font-size: 12px!important;">
    <div style="font-size: 14px; color: rgba(0,0,0,0.43);margin: 0;">`.concat(c,`</div>
    <div style="font-size: 24px;color: rgba(0,0,0,0.85);margin: 0;">
      `).concat((Ir[0].value*10).toFixed(2),`%
    </div>
  </div>`)},Jr={fontSize:12,fill:"rgba(0, 0, 0, 0.65)",textAlign:"center"};return Object(De.jsxs)(xt.Chart,{height:m,data:Ir,scale:yr,padding:[-16,0,16,0],forceFit:te,children:[Object(De.jsx)(xt.Coord,{type:"polar",startAngle:-1.25*Math.PI,endAngle:.25*Math.PI,radius:.8}),Object(De.jsx)(xt.Axis,{name:"1",line:void 0}),Object(De.jsx)(xt.Axis,{line:void 0,tickLine:void 0,subTickLine:void 0,name:"value",zIndex:2,label:{offset:-12,formatter:he,textStyle:Jr}}),Object(De.jsxs)(xt.Guide,{children:[Object(De.jsx)(Le,{start:[3,.905],end:[3,.85],lineStyle:{stroke:Lt,lineDash:void 0,lineWidth:2}}),Object(De.jsx)(Le,{start:[5,.905],end:[5,.85],lineStyle:{stroke:Lt,lineDash:void 0,lineWidth:3}}),Object(De.jsx)(Le,{start:[7,.905],end:[7,.85],lineStyle:{stroke:Lt,lineDash:void 0,lineWidth:3}}),Object(De.jsx)(Ze,{start:[0,.965],end:[10,.965],style:{stroke:mr,lineWidth:10}}),Object(De.jsx)(Ze,{start:[0,.965],end:[Ir[0].value,.965],style:{stroke:Lt,lineWidth:10}}),Object(De.jsx)(Et,{position:["50%","95%"],html:Xr()})]}),Object(De.jsx)(xt.Geom,{line:!1,type:"point",position:"value*1",shape:"pointer",color:Lt,active:!1})]})},St=vt()(Wt),dt=a("iz+Y"),H=a.n(dt),z=function(p){var c=p.height,f=c===void 0?1:c,m=p.data,_=m===void 0?[]:m,k=p.forceFit,te=k===void 0?!0:k,se=p.color,he=se===void 0?"rgba(24, 144, 255, 0.2)":se,Ye=p.borderColor,Lt=Ye===void 0?"#1089ff":Ye,Bt=p.scale,mr=Bt===void 0?{x:{},y:{}}:Bt,yr=p.borderWidth,Ir=yr===void 0?2:yr,Xr=p.line,Jr=p.xAxis,jn=p.yAxis,Zn=p.animate,Ci=Zn===void 0?!0:Zn,mi=[36,5,30,5],la={x:Object(Mt.a)({type:"cat",range:[0,1]},mr.x),y:Object(Mt.a)({min:0},mr.y)},Bi=["x*y",function(Ia,ka){return{name:Ia,value:ka}}],Yi=f+54;return Object(De.jsx)("div",{className:H.a.miniChart,style:{height:f},children:Object(De.jsx)("div",{className:H.a.chartContent,children:f>0&&Object(De.jsxs)(xt.Chart,{animate:Ci,scale:la,height:Yi,forceFit:te,data:_,padding:mi,children:[Object(De.jsx)(xt.Axis,Object(Mt.a)({name:"x",label:null,line:null,tickLine:null,grid:null},Jr),"axis-x"),Object(De.jsx)(xt.Axis,Object(Mt.a)({name:"y",label:null,line:null,tickLine:null,grid:null},jn),"axis-y"),Object(De.jsx)(xt.Tooltip,{showTitle:!1,crosshairs:!1}),Object(De.jsx)(xt.Geom,{type:"area",position:"x*y",color:he,tooltip:Bi,shape:"smooth",style:{fillOpacity:1}}),Xr?Object(De.jsx)(xt.Geom,{type:"line",position:"x*y",shape:"smooth",color:Lt,size:Ir,tooltip:!1}):Object(De.jsx)("span",{style:{display:"none"}})]})})})},V=vt()(z),be=a("/zsF"),me=a("PArb"),le=a("jrin"),fe=a("cQSq"),Ne=a.n(fe),lt=a("9/5/"),rt=a.n(lt),ue=a("Jssm"),ye=a.n(ue),Ue=a("TSYQ"),ft=a.n(Ue),Oe=a("d9mD"),Ve=a.n(Oe),P=function(b){Object(q.a)(c,b);var p=Object(Ce.a)(c);function c(){var f;Object(F.a)(this,c);for(var m=arguments.length,_=new Array(m),k=0;k<m;k++)_[k]=arguments[k];return f=p.call.apply(p,[this].concat(_)),f.state={legendData:[],legendBlock:!1},f.chart=void 0,f.root=void 0,f.requestRef=0,f.resize=rt()(function(){var te=f.props.hasLegend,se=f.state.legendBlock;if(!te||!f.root){window.removeEventListener("resize",f.resize);return}f.root&&f.root.parentNode&&f.root.parentNode.clientWidth<=380?se||f.setState({legendBlock:!0}):se&&f.setState({legendBlock:!1})},300),f.getG2Instance=function(te){f.chart=te,requestAnimationFrame(function(){f.getLegendData(),f.resize()})},f.getLegendData=function(){if(!!f.chart){var te=f.chart.getAllGeoms()[0];if(!!te){var se=te.get("dataArray")||[],he=se.map(function(Ye){var Lt=Ye[0]._origin;return Lt.color=Ye[0].color,Lt.checked=!0,Lt});f.setState({legendData:he})}}},f.handleRoot=function(te){f.root=te},f.handleLegendClick=function(te,se){var he=te;he.checked=!he.checked;var Ye=f.state.legendData;Ye[se]=he;var Lt=Ye.filter(function(Bt){return Bt.checked}).map(function(Bt){return Bt.x});f.chart&&f.chart.filter("x",function(Bt){return Lt.indexOf("".concat(Bt))>-1}),f.setState({legendData:Ye})},f}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var m=this;window.addEventListener("resize",function(){m.requestRef=requestAnimationFrame(function(){return m.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(m){var _=this.props.data;_!==m.data&&this.getLegendData()}},{key:"componentWillUnmount",value:function(){this.requestRef&&window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize),this.resize&&this.resize.cancel()}},{key:"render",value:function(){var m,_=this,k=this.props,te=k.valueFormat,se=k.subTitle,he=k.total,Ye=k.hasLegend,Lt=Ye===void 0?!1:Ye,Bt=k.className,mr=k.style,yr=k.height,Ir=yr===void 0?0:yr,Xr=k.forceFit,Jr=Xr===void 0?!0:Xr,jn=k.percent,Zn=k.color,Ci=k.inner,mi=Ci===void 0?.75:Ci,la=k.animate,Bi=la===void 0?!0:la,Yi=k.colors,Ia=k.lineWidth,ka=Ia===void 0?1:Ia,jo=this.state,Dl=jo.legendData,Ha=jo.legendBlock,ia=ft()(Ve.a.pie,Bt,(m={},Object(le.a)(m,Ve.a.hasLegend,!!Lt),Object(le.a)(m,Ve.a.legendBlock,Ha),m)),rc=this.props,Uf=rc.data,Jc=rc.selected,mf=Jc===void 0?!0:Jc,tl=rc.tooltip,gf=tl===void 0?!0:tl,rl=Uf||[],su=mf,Rc=gf,Uo=Yi;rl=rl||[],su=su||!0,Rc=Rc||!0;var qa,ks={x:{type:"cat",range:[0,1]},y:{min:0}};(jn||jn===0)&&(su=!1,Rc=!1,qa=function(yc){return yc==="\u5360\u6BD4"?Zn||"rgba(24, 144, 255, 0.85)":"#F0F2F5"},rl=[{x:"\u5360\u6BD4",y:parseFloat("".concat(jn))},{x:"\u53CD\u6BD4",y:100-parseFloat("".concat(jn))}]);var th=["x*percent",function(nl,yc){return{name:nl,value:"".concat((yc*100).toFixed(2),"%")}}],rh=[12,0,12,0],Mh=new fe.DataView;return Mh.source(rl).transform({type:"percent",field:"y",dimension:"x",as:"percent"}),Object(De.jsxs)("div",{ref:this.handleRoot,className:ia,style:mr,children:[Object(De.jsx)(ye.a,{maxFontSize:25,children:Object(De.jsxs)("div",{className:Ve.a.chart,children:[Object(De.jsxs)(xt.Chart,{scale:ks,height:Ir,forceFit:Jr,data:Mh,padding:rh,animate:Bi,onGetG2Instance:this.getG2Instance,children:[!!Rc&&Object(De.jsx)(xt.Tooltip,{showTitle:!1}),Object(De.jsx)(xt.Coord,{type:"theta",innerRadius:mi}),Object(De.jsx)(xt.Geom,{style:{lineWidth:ka,stroke:"#fff"},tooltip:Rc?th:void 0,type:"intervalStack",position:"percent",color:["x",jn||jn===0?qa:Uo],selected:su})]}),(se||he)&&Object(De.jsxs)("div",{className:Ve.a.total,children:[se&&Object(De.jsx)("h4",{className:"pie-sub-title",children:se}),he&&Object(De.jsx)("div",{className:"pie-stat",children:typeof he=="function"?he():he})]})]})}),Lt&&Object(De.jsx)("ul",{className:Ve.a.legend,children:Dl.map(function(nl,yc){return Object(De.jsxs)("li",{onClick:function(){return _.handleLegendClick(nl,yc)},children:[Object(De.jsx)("span",{className:Ve.a.dot,style:{backgroundColor:nl.checked?nl.color:"#aaa"}}),Object(De.jsx)("span",{className:Ve.a.legendTitle,children:nl.x}),Object(De.jsx)(me.a,{type:"vertical"}),Object(De.jsx)("span",{className:Ve.a.percent,children:"".concat((Number.isNaN(nl.percent)?0:nl.percent*100).toFixed(2),"%")}),Object(De.jsx)("span",{className:Ve.a.value,children:te?te(nl.y):nl.y})]},nl.x)})})]})}}]),c}(ce.Component),R=vt()(P),J=a("tJVT"),de=a("1XEM"),je=a.n(de),We="https://gw.alipayobjects.com/zos/rmsportal/gWyeGLCdFFRavBGIDzWk.png",gt=function(b){Object(q.a)(c,b);var p=Object(Ce.a)(c);function c(){var f;Object(F.a)(this,c);for(var m=arguments.length,_=new Array(m),k=0;k<m;k++)_[k]=arguments[k];return f=p.call.apply(p,[this].concat(_)),f.state={dv:null,height:0,width:0},f.requestRef=0,f.isUnmount=!1,f.root=void 0,f.imageMask=void 0,f.resize=function(){f.requestRef=requestAnimationFrame(function(){f.renderChart(f.props)})},f.saveRootRef=function(te){f.root=te},f.initTagCloud=function(){function te(se){return Object(Mt.a)(Object(Mt.a)({},se.style),{},{fillOpacity:se.opacity,fontSize:se.origin._origin.size,rotate:se.origin._origin.rotate,text:se.origin._origin.text,textAlign:"center",fontFamily:se.origin._origin.font,fill:se.color,textBaseline:"Alphabetic"})}xt.Shape.registerShape("point","cloud",{drawShape:function(he,Ye){var Lt=te(he);return Ye.addShape("text",{attrs:Object(Mt.a)(Object(Mt.a)({},Lt),{},{x:he.x,y:he.y})})}})},f.renderChart=rt()(function(te){var se=te||f.props,he=se.data,Ye=se.height;if(!(he.length<1||!f.root)){var Lt=Ye,Bt=f.root.offsetWidth,mr=function(){var Ir=new Ne.a.View().source(he),Xr=Ir.range("value"),Jr=Object(J.a)(Xr,2),jn=Jr[0],Zn=Jr[1];Ir.transform({type:"tag-cloud",fields:["name","value"],imageMask:f.imageMask,font:"Verdana",size:[Bt,Lt],padding:0,timeInterval:5e3,rotate:function(){return 0},fontSize:function(mi){var la=Math.pow((mi.value-jn)/(Zn-jn),2);return la*(17.5-5)+5}}),!f.isUnmount&&f.setState({dv:Ir,width:Bt,height:Lt})};f.imageMask?mr():(f.imageMask=new Image,f.imageMask.crossOrigin="",f.imageMask.src=We,f.imageMask.onload=mr)}},200),f}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var m=this;requestAnimationFrame(function(){m.initTagCloud(),m.renderChart(m.props)}),window.addEventListener("resize",this.resize,{passive:!0})}},{key:"componentDidUpdate",value:function(m){var _=this.props.data;m&&JSON.stringify(m.data)!==JSON.stringify(_)&&this.renderChart(this.props)}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var m=this.props,_=m.className,k=m.height,te=this.state,se=te.dv,he=te.width,Ye=te.height;return Object(De.jsx)("div",{className:ft()(je.a.tagCloud,_),style:{width:"100%",height:k},ref:this.saveRootRef,children:se&&Object(De.jsxs)(xt.Chart,{width:he,height:Ye,data:se,padding:0,scale:{x:{nice:!1},y:{nice:!1}},children:[Object(De.jsx)(xt.Tooltip,{showTitle:!1}),Object(De.jsx)(xt.Coord,{reflect:"y"}),Object(De.jsx)(xt.Geom,{type:"point",position:"x*y",color:"text",shape:"cloud",tooltip:["text*value",function(Bt,mr){return{name:Bt,value:mr}}]})]})})}}]),c}(ce.Component),nt=vt()(gt),Nt=a("CIdX"),Y=a.n(Nt),Xe=function(b){Object(q.a)(c,b);var p=Object(Ce.a)(c);function c(){var f;Object(F.a)(this,c);for(var m=arguments.length,_=new Array(m),k=0;k<m;k++)_[k]=arguments[k];return f=p.call.apply(p,[this].concat(_)),f.state={radio:1},f.timer=0,f.root=null,f.node=null,f.resize=function(){if(f.root){var te=f.props.height,se=te===void 0?1:te,he=f.root.parentNode,Ye=he.offsetWidth;f.setState({radio:Ye<se?Ye/se:1})}},f}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var m=this;this.renderChart(),this.resize(),window.addEventListener("resize",function(){requestAnimationFrame(function(){return m.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(m){var _=this.props.percent;m.percent!==_&&this.renderChart("update")}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.timer),this.node&&(this.node.innerHTML=""),window.removeEventListener("resize",this.resize)}},{key:"renderChart",value:function(m){var _=this.props,k=_.percent,te=_.color,se=te===void 0?"#1890FF":te,he=k/100,Ye=this;if(cancelAnimationFrame(this.timer),!this.node||he!==0&&!he)return;var Lt=this.node,Bt=Lt.getContext("2d");if(!Bt)return;var mr=Lt.width,yr=Lt.height,Ir=mr/2,Xr=2,Jr=Ir-Xr;Bt.beginPath(),Bt.lineWidth=Xr*2;for(var jn=mr-Xr,Zn=jn/8,Ci=.2,mi=Ci,la=Xr,Bi=0,Yi=0,Ia=.005,ka=[],jo=Ir-Xr,Dl=-(Math.PI/2),Ha=!0,ia=Dl;ia<Dl+2*Math.PI;ia+=1/(8*Math.PI))ka.push([Ir+jo*Math.cos(ia),Ir+jo*Math.sin(ia)]);var rc=ka.shift();Bt.strokeStyle=se,Bt.moveTo(rc[0],rc[1]);function Uf(){if(!!Bt){Bt.beginPath(),Bt.save();for(var mf=[],tl=la;tl<=la+jn;tl+=20/jn){var gf=Bi+(la+tl)/Zn,rl=Math.sin(gf)*mi,su=tl,Rc=2*Jr*(1-Yi)+(Ir-Jr)-Zn*rl;Bt.lineTo(su,Rc),mf.push([su,Rc])}var Uo=mf.shift();Bt.lineTo(la+jn,yr),Bt.lineTo(la,yr),Bt.lineTo(Uo[0],Uo[1]);var qa=Bt.createLinearGradient(0,0,0,yr);qa.addColorStop(0,"#ffffff"),qa.addColorStop(1,se),Bt.fillStyle=qa,Bt.fill(),Bt.restore()}}function Jc(){if(!!Bt){if(Bt.clearRect(0,0,mr,yr),Ha&&m!=="update")if(ka.length){var mf=ka.shift();Bt.lineTo(mf[0],mf[1]),Bt.stroke()}else Ha=!1,Bt.lineTo(rc[0],rc[1]),Bt.stroke(),ka=[],Bt.globalCompositeOperation="destination-over",Bt.beginPath(),Bt.lineWidth=Xr,Bt.arc(Ir,Ir,jo,0,2*Math.PI,!0),Bt.beginPath(),Bt.save(),Bt.arc(Ir,Ir,Ir-3*Xr,0,2*Math.PI,!0),Bt.restore(),Bt.clip(),Bt.fillStyle=se;else{if(he>=.85){if(mi>Ci/4){var tl=Ci*.01;mi-=tl}}else if(he<=.1){if(mi<Ci*1.5){var gf=Ci*.01;mi+=gf}}else{if(mi<=Ci){var rl=Ci*.01;mi+=rl}if(mi>=Ci){var su=Ci*.01;mi-=su}}he-Yi>0&&(Yi+=Ia),he-Yi<0&&(Yi-=Ia),Bi+=.07,Uf()}Ye.timer=requestAnimationFrame(Jc)}}Jc()}},{key:"render",value:function(){var m=this,_=this.state.radio,k=this.props,te=k.percent,se=k.title,he=k.height,Ye=he===void 0?1:he;return Object(De.jsxs)("div",{className:Y.a.waterWave,ref:function(Bt){return m.root=Bt},style:{transform:"scale(".concat(_,")")},children:[Object(De.jsx)("div",{style:{width:Ye,height:Ye,overflow:"hidden"},children:Object(De.jsx)("canvas",{className:Y.a.waterWaveCanvasWrapper,ref:function(Bt){return m.node=Bt},width:Ye*2,height:Ye*2})}),Object(De.jsxs)("div",{className:Y.a.text,style:{width:Ye},children:[se&&Object(De.jsx)("span",{children:se}),Object(De.jsxs)("h4",{children:[te,"%"]})]})]})}}]),c}(ce.Component),re=vt()(Xe),Je=a("WmNS"),Gt=a.n(Je),ur=a("9og8"),ct=Object(ce.createContext)({});function ht(){return Object(ce.useContext)(ct)}var Pt=a("8ml+"),pt=a("lwsE"),Pe=a.n(pt),ot=a("W8MJ"),$e=a.n(ot),Vt=a("7W2i"),dr=a.n(Vt),Zr=a("a1gu"),cr=a.n(Zr),Un=a("Nsbk"),Sn=a.n(Un),ni=a("lSNA"),fi=a.n(ni),Wn=a("yG8O"),Gn=a.n(Wn),Ee=a("U+yc"),pe=a.n(Ee),W=a("1ABj"),ae=a("h1nZ"),Ie,qe,Ct,Re,mt,Qt;function Br(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(b);p&&(f=f.filter(function(m){return Object.getOwnPropertyDescriptor(b,m).enumerable})),c.push.apply(c,f)}return c}function Ur(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?Br(Object(c),!0).forEach(function(f){fi()(b,f,c[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):Br(Object(c)).forEach(function(f){Object.defineProperty(b,f,Object.getOwnPropertyDescriptor(c,f))})}return b}var or=(Ie=Object(ae.lazyInject)(ae.TYPES.ILogService),qe=Object(ae.lazyInject)(ae.TYPES.IGlobalConfigService),Ct=(Qt=function(){function b(p){Pe()(this,b),Gn()(this,"logger",Re,this),Gn()(this,"configService",mt,this),this.config=void 0,this.config=p}return $e()(b,[{key:"setContainer",value:function(c,f){c.bind(ae.TYPES.MapConfig).toConstantValue(Ur(Ur({},this.config),{},{id:f})),c.bind(ae.TYPES.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),b}(),Qt),Re=pe()(Ct.prototype,"logger",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mt=pe()(Ct.prototype,"configService",[qe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ct),Vr=a("o0o1"),An=a.n(Vr),dn=a("QILm"),Cr=a.n(dn),Tn=a("yXPU"),fn=a.n(Tn),En=a("hi0z"),Cn=a.n(En),pn=a("Hel2"),Lr=a("IOcx"),hi=a("4cb6"),xi={dark:"amap://styles/2a09079c3daac9420ee53b67307a8006?isPublic=true",light:"amap://styles/1fd9f8ef9751298f11f5c56968312c70?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},ki=a("J4zp"),_i=a.n(ki),eo=Math.PI/180,pi=function(){function b(){Pe()(this,b),this.projectionMatrix=Lr.b.create(),this.viewMatrix=Lr.b.create(),this.viewProjectionMatrix=Lr.b.create(),this.ViewProjectionMatrixUncentered=Lr.b.create(),this.viewUncenteredMatrix=Lr.b.create(),this.zoom=void 0,this.center=void 0}return $e()(b,[{key:"syncWithMapCamera",value:function(c){var f=c.zoom,m=f===void 0?1:f,_=c.pitch,k=_===void 0?0:_,te=c.bearing,se=te===void 0?0:te,he=c.center,Ye=he===void 0?[0,0]:he,Lt=c.offsetOrigin,Bt=Lt===void 0?[0,0]:Lt,mr=c.cameraHeight,yr=mr===void 0?1:mr,Ir=c.aspect,Xr=Ir===void 0?1:Ir,Jr=c.near,jn=Jr===void 0?.1:Jr,Zn=c.far,Ci=Zn===void 0?1e3:Zn,mi=c.fov,la=mi===void 0?0:mi;this.zoom=m,this.center=Ye;var Bi=k*eo,Yi=(360-se)*eo;Lr.b.perspective(this.projectionMatrix,la,Xr,jn,Ci);var Ia=Lr.d.fromValues(yr*Math.sin(Bi)*Math.sin(Yi),-yr*Math.sin(Bi)*Math.cos(Yi),yr*Math.cos(Bi)),ka=Lr.d.fromValues(-Math.cos(Bi)*Math.sin(Yi),Math.cos(Bi)*Math.cos(Yi),Math.sin(Bi));Lr.b.lookAt(this.viewMatrix,Ia,Lr.d.fromValues(0,0,0),ka),this.viewUncenteredMatrix=Lr.b.clone(this.viewMatrix),Lr.b.translate(this.viewMatrix,this.viewMatrix,Lr.d.fromValues(-Bt[0],Bt[1],0)),Lr.b.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),Lr.b.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var c=_i()(this.center,2),f=c[0],m=c[1];return[f,m]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,f){var m=85.0511287798,_=Math.max(Math.min(m,c[1]),-m),k=256<<20,te=Math.PI/180,se=c[0]*te,he=_*te;he=Math.log(Math.tan(Math.PI/4+he/2));var Ye=.5/Math.PI,Lt=.5,Bt=-.5/Math.PI;return te=.5,se=k*(Ye*se+Lt)-215440491,he=-(k*(Bt*he+te)-106744817),[se,he]}}]),b}(),Ta,Di,bi,ci,ja,ps,to,lo,Gu,qi,Oa,is,ca,Ya;function qo(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(b);p&&(f=f.filter(function(m){return Object.getOwnPropertyDescriptor(b,m).enumerable})),c.push.apply(c,f)}return c}function sa(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?qo(Object(c),!0).forEach(function(f){fi()(b,f,c[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):qo(Object(c)).forEach(function(f){Object.defineProperty(b,f,Object.getOwnPropertyDescriptor(c,f))})}return b}a("BGjm")(`/* @antv/l7-maps */
.amap-logo{
 display: none !important;
}
`);var yo=0;window.forceWebGL=!0;var co="15cd8a57710d40c9b7c0e3cc120f1200",Tu="1.4.15",as="amap-script",bl=!1,_s=[],Lo=12,kt=(Ta=Object(hi.injectable)(),Di=Object(hi.inject)(ae.TYPES.IGlobalConfigService),bi=Object(hi.inject)(ae.TYPES.ILogService),ci=Object(hi.inject)(ae.TYPES.MapConfig),ja=Object(hi.inject)(ae.TYPES.ICoordinateSystemService),ps=Object(hi.inject)(ae.TYPES.IEventEmitter),Ta(to=(lo=(Ya=function(){function b(){var p=this;Pe()(this,b),this.map=void 0,Gn()(this,"configService",Gu,this),Gn()(this,"logger",qi,this),Gn()(this,"config",Oa,this),Gn()(this,"coordinateSystemService",is,this),Gn()(this,"eventEmitter",ca,this),this.markerContainer=void 0,this.$mapContainer=void 0,this.viewport=void 0,this.cameraChangedCallback=void 0,this.handleCameraChanged=function(c){var f=c.camera,m=f.fov,_=f.near,k=f.far,te=f.height,se=f.pitch,he=f.rotation,Ye=f.aspect,Lt=f.position,Bt=p.getCenter(),mr=Bt.lng,yr=Bt.lat;p.cameraChangedCallback&&(p.viewport.syncWithMapCamera({aspect:Ye,bearing:360-he,far:k,fov:m,cameraHeight:te,near:_,pitch:se,zoom:p.map.getZoom()-1,center:[mr,yr],offsetOrigin:[Lt.x,Lt.y]}),p.viewport.getZoom()>Lo?p.coordinateSystemService.setCoordinateSystem(ae.CoordinateSystem.P20_OFFSET):p.coordinateSystemService.setCoordinateSystem(ae.CoordinateSystem.P20),p.cameraChangedCallback(p.viewport))}}return $e()(b,[{key:"addMarkerContainer",value:function(){var c=this.map.getContainer();if(c!==null){var f=c.getElementsByClassName("amap-maps")[0];this.markerContainer=pn.a.create("div","l7-marker-container",f)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,f){ae.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,f):this.map.on(c,f)}},{key:"off",value:function(c,f){ae.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.off(c,f):this.map.off(c,f)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var c;return(c=this.map.getContainer())===null||c===void 0?void 0:c.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var c=this.map.getSize();return[c.getWidth(),c.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){var c=this.map.getCenter();return{lng:c.getLng(),lat:c.getLat()}}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var c=this.map.getBounds().toBounds(),f=c.getNorthEast(),m=c.getSouthWest(),_=this.getCenter(),k=_.lng>f.getLng()||_.lng<m.getLng()?180-f.getLng():f.getLng(),te=_.lng<m.getLng()?m.getLng()-180:m.getLng();return[[te,m.getLat()],[k,f.getLat()]]}},{key:"getMinZoom",value:function(){var c=this.map.get("zooms");return c[0]-1}},{key:"getMaxZoom",value:function(){var c=this.map.get("zooms");return c[1]-1}},{key:"setRotation",value:function(c){return this.map.setRotation(c)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.map.panTo(c)}},{key:"fitBounds",value:function(c){this.map.setBounds(new AMap.Bounds([c[0][0],c[0][1],c[1][0],c[1][1]]))}},{key:"setZoomAndCenter",value:function(c,f){this.map.setZoomAndCenter(c,f)}},{key:"setMapStyle",value:function(c){this.map.setMapStyle(this.getMapStyle(c))}},{key:"setMapStatus",value:function(c){this.map.setStatus(c)}},{key:"pixelToLngLat",value:function(c){var f=this.map.pixelToLngLat(new AMap.Pixel(c[0],c[1]));return{lng:f.getLng(),lat:f.getLat()}}},{key:"lngLatToPixel",value:function(c){var f=this.map.lnglatToPixel(new AMap.LngLat(c[0],c[1]));return{x:f.getX(),y:f.getY()}}},{key:"containerToLngLat",value:function(c){var f=new AMap.Pixel(c[0],c[1]),m=this.map.containerToLngLat(f);return{lng:m==null?void 0:m.getLng(),lat:m==null?void 0:m.getLat()}}},{key:"lngLatToContainer",value:function(c){var f=new AMap.LngLat(c[0],c[1]),m=this.map.lngLatToContainer(f);return{x:m.getX(),y:m.getY()}}},{key:"lngLatToMercator",value:function(c,f){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(c,f,m){var _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],k=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},te=this.viewport.projectFlat(c),se=Lr.b.create();return Lr.b.translate(se,se,Lr.d.fromValues(te[0],te[1],f)),Lr.b.scale(se,se,Lr.d.fromValues(_[0],_[1],_[2])),Lr.b.rotateX(se,se,m[0]),Lr.b.rotateY(se,se,m[1]),Lr.b.rotateZ(se,se,m[2]),se}},{key:"init",value:function(){var p=fn()(An.a.mark(function f(){var m=this,_,k,te,se,he,Ye,Lt,Bt,mr,yr,Ir,Xr,Jr,jn;return An.a.wrap(function(Ci){for(;;)switch(Ci.prev=Ci.next){case 0:return _=this.config,k=_.id,te=_.style,se=te===void 0?"light":te,he=_.minZoom,Ye=he===void 0?0:he,Lt=_.maxZoom,Bt=Lt===void 0?18:Lt,mr=_.token,yr=mr===void 0?co:mr,Ir=_.mapInstance,Xr=_.plugin,Jr=Xr===void 0?[]:Xr,jn=Cr()(_,["id","style","minZoom","maxZoom","token","mapInstance","plugin"]),Ci.next=3,new Promise(function(mi){var la=function(){if(Ir)m.map=Ir,m.$mapContainer=m.map.getContainer(),setTimeout(function(){m.map.on("camerachange",m.handleCameraChanged),mi()},30);else{m.$mapContainer=m.creatAmapContainer(k);var Yi=new AMap.Map(m.$mapContainer,sa({mapStyle:m.getMapStyle(se),zooms:[Ye,Bt],viewMode:"3D"},jn));Yi.on("camerachange",m.handleCameraChanged),m.map=Yi,setTimeout(function(){mi()},10)}};!bl&&!Ir?(yr===co&&m.logger.warn(m.configService.getSceneWarninfo("MapToken")),bl=!0,Jr.push("Map3D"),Cn.a.load({key:yr,version:Tu,plugins:Jr}).then(function(Bi){la(),_s.length&&(_s.forEach(function(Yi){return Yi()}),_s=[])}).catch(function(Bi){throw new Error(Bi)})):bl&&window.AMap||Ir?la():_s.push(la)});case 3:this.viewport=new pi;case 4:case"end":return Ci.stop()}},f,this)}));function c(){return p.apply(this,arguments)}return c}()},{key:"exportMap",value:function(c){var f,m=(f=this.getContainer())===null||f===void 0?void 0:f.getElementsByClassName("amap-layer")[0],_=c==="jpg"?m==null?void 0:m.toDataURL("image/jpeg"):m==null?void 0:m.toDataURL("image/png");return _}},{key:"emit",value:function(c){for(var f,m=arguments.length,_=new Array(m>1?m-1:0),k=1;k<m;k++)_[k-1]=arguments[k];(f=this.eventEmitter).emit.apply(f,[c].concat(_))}},{key:"once",value:function(c){for(var f,m=arguments.length,_=new Array(m>1?m-1:0),k=1;k<m;k++)_[k-1]=arguments[k];(f=this.eventEmitter).once.apply(f,[c].concat(_))}},{key:"destroy",value:function(){this.map.destroy(),delete window.initAMap;var c=document.getElementById(as);c&&document.head.removeChild(c)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"getMapStyle",value:function(c){return xi[c]?xi[c]:c}},{key:"creatAmapContainer",value:function(c){var f=c;typeof c=="string"&&(f=document.getElementById(c));var m=document.createElement("div");return m.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,m.id="l7_amap_div"+yo++,f.appendChild(m),m}}]),b}(),Ya),Gu=pe()(lo.prototype,"configService",[Di],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qi=pe()(lo.prototype,"logger",[bi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oa=pe()(lo.prototype,"config",[ci],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),is=pe()(lo.prototype,"coordinateSystemService",[ja],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ca=pe()(lo.prototype,"eventEmitter",[ps],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lo))||to);function ze(b){var p=It();return function(){var f=Sn()(b),m;if(p){var _=Sn()(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return cr()(this,m)}}function It(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var fr=function(b){dr()(c,b);var p=ze(c);function c(){return Pe()(this,c),p.apply(this,arguments)}return $e()(c,[{key:"getServiceConstructor",value:function(){return kt}}]),c}(or);function nn(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(b);p&&(f=f.filter(function(m){return Object.getOwnPropertyDescriptor(b,m).enumerable})),c.push.apply(c,f)}return c}function yn(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?nn(Object(c),!0).forEach(function(f){Vn(b,f,c[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):nn(Object(c)).forEach(function(f){Object.defineProperty(b,f,Object.getOwnPropertyDescriptor(c,f))})}return b}function Vn(b,p,c){return p in b?Object.defineProperty(b,p,{value:c,enumerable:!0,configurable:!0,writable:!0}):b[p]=c,b}function Ua(b,p){return zl(b)||Hu(b,p)||_o(b,p)||xo()}function xo(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _o(b,p){if(!!b){if(typeof b=="string")return Ro(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Ro(b,p)}}function Ro(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,f=new Array(p);c<p;c++)f[c]=b[c];return f}function Hu(b,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))){var c=[],f=!0,m=!1,_=void 0;try{for(var k=b[Symbol.iterator](),te;!(f=(te=k.next()).done)&&(c.push(te.value),!(p&&c.length===p));f=!0);}catch(se){m=!0,_=se}finally{try{!f&&k.return!=null&&k.return()}finally{if(m)throw _}}return c}}function zl(b){if(Array.isArray(b))return b}var Ks=st.a.memo(function(b){var p=b.style,c=b.className,f=b.map,m=b.option,_=b.onSceneLoaded,k=b.children,te=Object(ce.useRef)(null),se=Object(ce.useState)(),he=Ua(se,2),Ye=he[0],Lt=he[1];return Object(ce.useEffect)(function(){var Bt=new Pt.Scene(yn(yn({id:te.current},m),{},{map:new fr(f)}));return Bt.on("loaded",function(){Lt(Bt),_&&_(Bt)}),function(){Bt.destroy()}},[]),Object(ce.useEffect)(function(){Ye&&f.style&&Ye.setMapStyle(f.style)},[JSON.stringify(f.style)]),Object(ce.useEffect)(function(){Ye&&f.zoom&&Ye.setZoom(f.zoom)},[f.zoom]),Object(ce.useEffect)(function(){Ye&&f.center&&Ye.setCenter(f.center)},[JSON.stringify(f.center)]),Object(ce.useEffect)(function(){Ye&&f.pitch&&Ye.setPitch(f.pitch)},[f.pitch]),Object(ce.useEffect)(function(){Ye&&f.rotation&&Ye.setRotation(f.rotation)},[f.rotation]),st.a.createElement(ct.Provider,{value:Ye},st.a.createElement("div",{ref:te,className:c,style:p},Ye&&k))}),nf=Ks,Nl=a("4ZJM"),vs=a.n(Nl),fu=a("1OyB"),bo=a("vuIU"),$s=a("md7G"),Zu=a("foSv"),Js=a("Ji7U"),Wu=a("JX7q"),wa=a("ODXe"),Ka=a("bl9R");function hu(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Xu(b,p){var c=Ka.transformMat4([],p,b);return Ka.scale(c,c,1/c[3]),c}function nc(b,p){var c=b%p;return c<0?p+c:c}function Ot(b,p,c){return c*p+(1-c)*b}var tr=a("ZaHm"),Mr=a("ZxFD"),Xn=a("n+fv");function Wi(b,p){if(!b)throw new Error(p||"viewport-mercator-project: assertion failed.")}var oa=Math.PI,Xa=oa/4,zi=oa/180,La=180/oa,Do=512,ms=4003e4,Aa=1.5;function Sl(b){return Math.pow(2,b)}function du(b){return Math.log2(b)}function os(b,p){var c=Object(wa.a)(b,2),f=c[0],m=c[1];Wi(Number.isFinite(f)&&Number.isFinite(p)),Wi(Number.isFinite(m)&&m>=-90&&m<=90,"invalid latitude"),p*=Do;var _=f*zi,k=m*zi,te=p*(_+oa)/(2*oa),se=p*(oa-Math.log(Math.tan(Xa+k*.5)))/(2*oa);return[te,se]}function Yu(b,p){var c=Object(wa.a)(b,2),f=c[0],m=c[1];p*=Do;var _=f/p*(2*oa)-oa,k=2*(Math.atan(Math.exp(oa-m/p*(2*oa)))-Xa);return[_*La,k*La]}function Au(b){var p=b.latitude;Wi(Number.isFinite(p));var c=Math.cos(p*zi);return du(ms*c)-9}function Ku(b){var p=b.latitude,c=b.longitude,f=b.zoom,m=b.scale,_=b.highPrecision,k=_===void 0?!1:_;m=m!==void 0?m:Sl(f),Wi(Number.isFinite(p)&&Number.isFinite(c)&&Number.isFinite(m));var te={},se=Do*m,he=Math.cos(p*zi),Ye=se/360,Lt=Ye/he,Bt=se/ms/he;if(te.pixelsPerMeter=[Bt,-Bt,Bt],te.metersPerPixel=[1/Bt,-1/Bt,1/Bt],te.pixelsPerDegree=[Ye,-Lt,Bt],te.degreesPerPixel=[1/Ye,-1/Lt,1/Bt],k){var mr=zi*Math.tan(p*zi)/he,yr=Ye*mr/2,Ir=se/ms*mr,Xr=Ir/Lt*Bt;te.pixelsPerDegree2=[0,-yr,Ir],te.pixelsPerMeter2=[Xr,0,Xr]}return te}function Cu(b,p){var c=Object(wa.a)(b,3),f=c[0],m=c[1],_=c[2],k=Object(wa.a)(p,3),te=k[0],se=k[1],he=k[2],Ye=1,Lt=Ku({longitude:f,latitude:m,scale:Ye,highPrecision:!0}),Bt=Lt.pixelsPerMeter,mr=Lt.pixelsPerMeter2,yr=os(b,Ye);yr[0]+=te*(Bt[0]+mr[0]*se),yr[1]+=se*(Bt[1]+mr[1]*se);var Ir=Yu(yr,Ye),Xr=(_||0)+(he||0);return Number.isFinite(_)||Number.isFinite(he)?[Ir[0],Ir[1],Xr]:Ir}function ol(b){var p=b.height,c=b.pitch,f=b.bearing,m=b.altitude,_=b.center,k=_===void 0?null:_,te=b.flipY,se=te===void 0?!1:te,he=hu();return tr.translate(he,he,[0,0,-m]),tr.scale(he,he,[1,1,1/p]),tr.rotateX(he,he,-c*zi),tr.rotateZ(he,he,f*zi),se&&tr.scale(he,he,[1,-1,1]),k&&tr.translate(he,he,Xn.negate([],k)),he}function pu(b){var p=b.width,c=b.height,f=b.altitude,m=f===void 0?Aa:f,_=b.pitch,k=_===void 0?0:_,te=b.nearZMultiplier,se=te===void 0?1:te,he=b.farZMultiplier,Ye=he===void 0?1:he,Lt=k*zi,Bt=Math.atan(.5/m),mr=Math.sin(Bt)*m/Math.sin(Math.PI/2-Lt-Bt),yr=Math.cos(Math.PI/2-Lt)*mr+m;return{fov:2*Math.atan(c/2/m),aspect:p/c,focalDistance:m,near:se,far:yr*Ye}}function af(b){var p=b.width,c=b.height,f=b.pitch,m=b.altitude,_=b.nearZMultiplier,k=b.farZMultiplier,te=pu({width:p,height:c,altitude:m,pitch:f,nearZMultiplier:_,farZMultiplier:k}),se=te.fov,he=te.aspect,Ye=te.near,Lt=te.far,Bt=tr.perspective([],se,he,Ye,Lt);return Bt}function Nf(b,p){var c=Object(wa.a)(b,3),f=c[0],m=c[1],_=c[2],k=_===void 0?0:_;return Wi(Number.isFinite(f)&&Number.isFinite(m)&&Number.isFinite(k)),Xu(p,[f,m,k,1])}function ba(b,p){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,f=Object(wa.a)(b,3),m=f[0],_=f[1],k=f[2];if(Wi(Number.isFinite(m)&&Number.isFinite(_),"invalid pixel coordinate"),Number.isFinite(k)){var te=Xu(p,[m,_,k,1]);return te}var se=Xu(p,[m,_,0,1]),he=Xu(p,[m,_,1,1]),Ye=se[2],Lt=he[2],Bt=Ye===Lt?0:((c||0)-Ye)/(Lt-Ye);return Mr.lerp([],se,he,Bt)}var Nc=hu(),Fc=function(){function b(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=p.width,f=p.height,m=p.viewMatrix,_=m===void 0?Nc:m,k=p.projectionMatrix,te=k===void 0?Nc:k;Object(fu.a)(this,b),this.width=c||1,this.height=f||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=_,this.projectionMatrix=te;var se=hu();tr.multiply(se,se,this.projectionMatrix),tr.multiply(se,se,this.viewMatrix),this.viewProjectionMatrix=se;var he=hu();tr.scale(he,he,[this.width/2,-this.height/2,1]),tr.translate(he,he,[1,-1,0]),tr.multiply(he,he,this.viewProjectionMatrix);var Ye=tr.invert(hu(),he);if(!Ye)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=he,this.pixelUnprojectionMatrix=Ye,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(bo.a)(b,[{key:"equals",value:function(c){return c instanceof b?c.width===this.width&&c.height===this.height&&tr.equals(c.projectionMatrix,this.projectionMatrix)&&tr.equals(c.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},m=f.topLeft,_=m===void 0?!0:m,k=this.projectPosition(c),te=Nf(k,this.pixelProjectionMatrix),se=Object(wa.a)(te,2),he=se[0],Ye=se[1],Lt=_?Ye:this.height-Ye;return c.length===2?[he,Lt]:[he,Lt,te[2]]}},{key:"unproject",value:function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},m=f.topLeft,_=m===void 0?!0:m,k=f.targetZ,te=Object(wa.a)(c,3),se=te[0],he=te[1],Ye=te[2],Lt=_?he:this.height-he,Bt=k&&k*this.pixelsPerMeter,mr=ba([se,Lt,Ye],this.pixelUnprojectionMatrix,Bt),yr=this.unprojectPosition(mr),Ir=Object(wa.a)(yr,3),Xr=Ir[0],Jr=Ir[1],jn=Ir[2];return Number.isFinite(Ye)?[Xr,Jr,jn]:Number.isFinite(k)?[Xr,Jr,k]:[Xr,Jr]}},{key:"projectPosition",value:function(c){var f=this.projectFlat(c),m=Object(wa.a)(f,2),_=m[0],k=m[1],te=(c[2]||0)*this.pixelsPerMeter;return[_,k,te]}},{key:"unprojectPosition",value:function(c){var f=this.unprojectFlat(c),m=Object(wa.a)(f,2),_=m[0],k=m[1],te=(c[2]||0)/this.pixelsPerMeter;return[_,k,te]}},{key:"projectFlat",value:function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}},{key:"unprojectFlat",value:function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}}]),b}();function bf(b){var p=b.width,c=b.height,f=b.bounds,m=b.minExtent,_=m===void 0?0:m,k=b.maxZoom,te=k===void 0?24:k,se=b.padding,he=se===void 0?0:se,Ye=b.offset,Lt=Ye===void 0?[0,0]:Ye,Bt=Object(wa.a)(f,2),mr=Object(wa.a)(Bt[0],2),yr=mr[0],Ir=mr[1],Xr=Object(wa.a)(Bt[1],2),Jr=Xr[0],jn=Xr[1];if(Number.isFinite(he)){var Zn=he;he={top:Zn,bottom:Zn,left:Zn,right:Zn}}else Wi(Number.isFinite(he.top)&&Number.isFinite(he.bottom)&&Number.isFinite(he.left)&&Number.isFinite(he.right));var Ci=new Bc({width:p,height:c,longitude:0,latitude:0,zoom:0}),mi=Ci.project([yr,jn]),la=Ci.project([Jr,Ir]),Bi=[Math.max(Math.abs(la[0]-mi[0]),_),Math.max(Math.abs(la[1]-mi[1]),_)],Yi=[p-he.left-he.right-Math.abs(Lt[0])*2,c-he.top-he.bottom-Math.abs(Lt[1])*2];Wi(Yi[0]>0&&Yi[1]>0);var Ia=Yi[0]/Bi[0],ka=Yi[1]/Bi[1],jo=(he.right-he.left)/2/Ia,Dl=(he.bottom-he.top)/2/ka,Ha=[(la[0]+mi[0])/2+jo,(la[1]+mi[1])/2+Dl],ia=Ci.unproject(Ha),rc=Ci.zoom+Math.log2(Math.abs(Math.min(Ia,ka)));return{longitude:ia[0],latitude:ia[1],zoom:Math.min(rc,te)}}var Bc=function(b){Object(Js.a)(p,b);function p(){var c,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},m=f.width,_=f.height,k=f.latitude,te=k===void 0?0:k,se=f.longitude,he=se===void 0?0:se,Ye=f.zoom,Lt=Ye===void 0?0:Ye,Bt=f.pitch,mr=Bt===void 0?0:Bt,yr=f.bearing,Ir=yr===void 0?0:yr,Xr=f.altitude,Jr=Xr===void 0?1.5:Xr,jn=f.nearZMultiplier,Zn=f.farZMultiplier;Object(fu.a)(this,p),m=m||1,_=_||1;var Ci=Sl(Lt);Jr=Math.max(.75,Jr);var mi=os([he,te],Ci);mi[2]=0;var la=af({width:m,height:_,pitch:mr,bearing:Ir,altitude:Jr,nearZMultiplier:jn||1/_,farZMultiplier:Zn||1.01}),Bi=ol({height:_,center:mi,pitch:mr,bearing:Ir,altitude:Jr,flipY:!0});return c=Object($s.a)(this,Object(Zu.a)(p).call(this,{width:m,height:_,viewMatrix:Bi,projectionMatrix:la})),c.latitude=te,c.longitude=he,c.zoom=Lt,c.pitch=mr,c.bearing=Ir,c.altitude=Jr,c.scale=Ci,c.center=mi,c.pixelsPerMeter=Ku(Object(Wu.a)(Object(Wu.a)(c))).pixelsPerMeter[2],Object.freeze(Object(Wu.a)(Object(Wu.a)(c))),c}return Object(bo.a)(p,[{key:"projectFlat",value:function(f){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return os(f,m)}},{key:"unprojectFlat",value:function(f){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Yu(f,m)}},{key:"getMapCenterByLngLatPosition",value:function(f){var m=f.lngLat,_=f.pos,k=ba(_,this.pixelUnprojectionMatrix),te=os(m,this.scale),se=Mr.add([],te,Mr.negate([],k)),he=Mr.add([],this.center,se);return Yu(he,this.scale)}},{key:"getLocationAtPoint",value:function(f){var m=f.lngLat,_=f.pos;return this.getMapCenterByLngLatPosition({lngLat:m,pos:_})}},{key:"fitBounds",value:function(f){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=this.width,k=this.height,te=bf(Object.assign({width:_,height:k,bounds:f},m)),se=te.longitude,he=te.latitude,Ye=te.zoom;return new p({width:_,height:k,longitude:se,latitude:he,zoom:Ye})}}]),p}(Fc),Sf=function(){function b(){Pe()(this,b),this.viewport=void 0}return $e()(b,[{key:"syncWithMapCamera",value:function(c){var f=c.center,m=c.zoom,_=c.pitch,k=c.bearing,te=c.viewportHeight,se=c.viewportWidth;this.viewport=new Bc({width:se,height:te,longitude:f&&f[0],latitude:f&&f[1],zoom:m,pitch:_,bearing:k})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,f){return this.viewport.projectFlat(c,f)}}]),b}(),ro={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},wu,El,gs,kc,bc,Tl,sl,$u,Qs,Pu,jc,Fl,Pa,Uc;function Ef(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(b);p&&(f=f.filter(function(m){return Object.getOwnPropertyDescriptor(b,m).enumerable})),c.push.apply(c,f)}return c}function Sc(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?Ef(Object(c),!0).forEach(function(f){fi()(b,f,c[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):Ef(Object(c)).forEach(function(f){Object.defineProperty(b,f,Object.getOwnPropertyDescriptor(c,f))})}return b}a("BGjm")(`/* @antv/l7-maps */
.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:0;margin:10px;position:relative;background-color:#fff;border-radius:3px 12px 12px 3px}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 24px 2px 4px;visibility:visible;margin-top:6px}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 4px 2px 24px;border-radius:12px 3px 3px 12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact:after{content:"";cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-flex-direction:column;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-flex-direction:column-reverse;-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-flex-direction:row-reverse;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=vs.a;var Ec={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},ic=0,ul=12,_u="pk.eyJ1IjoibHp4dWUiLCJhIjoiYnhfTURyRSJ9.Ugm314vAKPHBzcPmY1p4KQ",Bl=(wu=Object(hi.injectable)(),El=Object(hi.inject)(ae.TYPES.MapConfig),gs=Object(hi.inject)(ae.TYPES.IGlobalConfigService),kc=Object(hi.inject)(ae.TYPES.ILogService),bc=Object(hi.inject)(ae.TYPES.ICoordinateSystemService),Tl=Object(hi.inject)(ae.TYPES.IEventEmitter),wu(sl=($u=(Uc=function(){function b(){var p=this;Pe()(this,b),this.map=void 0,Gn()(this,"config",Qs,this),Gn()(this,"configService",Pu,this),Gn()(this,"logger",jc,this),Gn()(this,"coordinateSystemService",Fl,this),Gn()(this,"eventEmitter",Pa,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=p.map.getCenter().wrap(),f=c.lat,m=c.lng;p.viewport.syncWithMapCamera({bearing:p.map.getBearing(),center:[m,f],viewportHeight:p.map.transform.height,pitch:p.map.getPitch(),viewportWidth:p.map.transform.width,zoom:p.map.getZoom(),cameraHeight:0}),p.viewport.getZoom()>ul?p.coordinateSystemService.setCoordinateSystem(ae.CoordinateSystem.LNGLAT_OFFSET):p.coordinateSystemService.setCoordinateSystem(ae.CoordinateSystem.LNGLAT),p.cameraChangedCallback(p.viewport)}}return $e()(b,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=pn.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,f){ae.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,f):this.map.on(Ec[c]||c,f)}},{key:"off",value:function(c,f){this.map.off(Ec[c]||c,f)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,f){this.map.zoomIn(c,f)}},{key:"zoomOut",value:function(c,f){this.map.zoomOut(c,f)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,f){this.map.fitBounds(c,f)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.rotateEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,f){this.map.flyTo({zoom:c,center:f})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,f){var m=window.mapboxgl.MercatorCoordinate.fromLngLat(c,f),_=m.x,k=_===void 0?0:_,te=m.y,se=te===void 0?0:te,he=m.z,Ye=he===void 0?0:he;return{x:k,y:se,z:Ye}}},{key:"getModelMatrix",value:function(c,f,m){var _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],k=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},te=window.mapboxgl.MercatorCoordinate.fromLngLat(c,f),se=te.meterInMercatorCoordinateUnits(),he=Lr.b.create();return Lr.b.translate(he,he,Lr.d.fromValues(te.x-k.x,te.y-k.y,te.z||0-k.z)),Lr.b.scale(he,he,Lr.d.fromValues(se*_[0],-se*_[1],se*_[2])),Lr.b.rotateX(he,he,m[0]),Lr.b.rotateY(he,he,m[1]),Lr.b.rotateZ(he,he,m[2]),he}},{key:"init",value:function(){var p=fn()(An.a.mark(function f(){var m,_,k,te,se,he,Ye,Lt,Bt,mr,yr,Ir,Xr;return An.a.wrap(function(jn){for(;;)switch(jn.prev=jn.next){case 0:m=this.config,_=m.id,k=_===void 0?"map":_,te=m.attributionControl,se=te===void 0?!1:te,he=m.style,Ye=he===void 0?"light":he,Lt=m.token,Bt=Lt===void 0?_u:Lt,mr=m.rotation,yr=mr===void 0?0:mr,Ir=m.mapInstance,Xr=Cr()(m,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new Sf,!Ir&&!window.mapboxgl&&this.logger.error(this.configService.getSceneWarninfo("SDK")),Bt===_u&&Ye!=="blank"&&!window.mapboxgl.accessToken&&!Ir&&this.logger.warn(this.configService.getSceneWarninfo("MapToken")),!Ir&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=Bt),Ir?(this.map=Ir,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(k),this.map=new window.mapboxgl.Map(Sc({container:this.$mapContainer,style:this.getMapStyle(Ye),attributionControl:se,bearing:yr},Xr))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return jn.stop()}},f,this)}));function c(){return p.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var f,m=arguments.length,_=new Array(m>1?m-1:0),k=1;k<m;k++)_[k-1]=arguments[k];(f=this.eventEmitter).emit.apply(f,[c].concat(_))}},{key:"once",value:function(c){for(var f,m=arguments.length,_=new Array(m>1?m-1:0),k=1;k<m;k++)_[k-1]=arguments[k];(f=this.eventEmitter).once.apply(f,[c].concat(_))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var f=this.map.getCanvas(),m=c==="jpg"?f==null?void 0:f.toDataURL("image/jpeg"):f==null?void 0:f.toDataURL("image/png");return m}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var f=c;typeof c=="string"&&(f=document.getElementById(c));var m=document.createElement("div");return m.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,m.id="l7_mapbox_div"+ic++,f.appendChild(m),m}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:ro[c]?ro[c]:c}}]),b}(),Uc),Qs=pe()($u.prototype,"config",[El],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pu=pe()($u.prototype,"configService",[gs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jc=pe()($u.prototype,"logger",[kc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fl=pe()($u.prototype,"coordinateSystemService",[bc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pa=pe()($u.prototype,"eventEmitter",[Tl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$u))||sl);function Vo(b){var p=ac();return function(){var f=Sn()(b),m;if(p){var _=Sn()(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return cr()(this,m)}}function ac(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}a("BGjm")(`/* @antv/l7-maps */
.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var kl=function(b){dr()(c,b);var p=Vo(c);function c(){return Pe()(this,c),p.apply(this,arguments)}return $e()(c,[{key:"getServiceConstructor",value:function(){return Bl}}]),c}(or);function Al(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(b);p&&(f=f.filter(function(m){return Object.getOwnPropertyDescriptor(b,m).enumerable})),c.push.apply(c,f)}return c}function Tc(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?Al(Object(c),!0).forEach(function(f){jl(b,f,c[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):Al(Object(c)).forEach(function(f){Object.defineProperty(b,f,Object.getOwnPropertyDescriptor(c,f))})}return b}function jl(b,p,c){return p in b?Object.defineProperty(b,p,{value:c,enumerable:!0,configurable:!0,writable:!0}):b[p]=c,b}function qs(b,p){return oc(b)||Cl(b,p)||Af(b,p)||Tf()}function Tf(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Af(b,p){if(!!b){if(typeof b=="string")return of(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return of(b,p)}}function of(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,f=new Array(p);c<p;c++)f[c]=b[c];return f}function Cl(b,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))){var c=[],f=!0,m=!1,_=void 0;try{for(var k=b[Symbol.iterator](),te;!(f=(te=k.next()).done)&&(c.push(te.value),!(p&&c.length===p));f=!0);}catch(se){m=!0,_=se}finally{try{!f&&k.return!=null&&k.return()}finally{if(m)throw _}}return c}}function oc(b){if(Array.isArray(b))return b}var ll=st.a.memo(function(b){var p=b.style,c=b.className,f=b.map,m=b.option,_=b.onSceneLoaded,k=Object(ce.createRef)(),te=Object(ce.useState)(),se=qs(te,2),he=se[0],Ye=se[1];return Object(ce.useEffect)(function(){var Lt=new Pt.Scene(Tc(Tc({id:k.current},m),{},{map:new kl(f)}));return Lt.on("loaded",function(){Ye(Lt),_&&_(Lt)}),function(){Lt.destroy()}},[]),Object(ce.useEffect)(function(){he&&f.style&&he.setMapStyle(f.style)},[JSON.stringify(f.style)]),Object(ce.useEffect)(function(){he&&f.zoom&&he.setZoom(f.zoom)},[f.zoom]),Object(ce.useEffect)(function(){he&&f.center&&he.setCenter(f.center)},[JSON.stringify(f.center)]),Object(ce.useEffect)(function(){he&&f.pitch!==void 0&&he.setPitch(f.pitch||0)},[f.pitch]),Object(ce.useEffect)(function(){he&&f.rotation&&he.setRotation(f.rotation)},[f.rotation]),st.a.createElement(ct.Provider,{value:he},Object(ce.createElement)("div",{ref:k,style:p,className:c},he&&b.children))}),Ul=ll,Ac=a("PJYZ"),Cc=a.n(Ac),Vl=a("QkVN"),So=a.n(Vl),Ff=a("uhBA"),Cf=a("cDf5"),sc=a.n(Cf),Vc=a("zvhG"),sf=a.n(Vc);function uf(b,p){var c;if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(c=Gl(b))||p&&b&&typeof b.length=="number"){c&&(b=c);var f=0,m=function(){};return{s:m,n:function(){return f>=b.length?{done:!0}:{done:!1,value:b[f++]}},e:function(he){throw he},f:m}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _=!0,k=!1,te;return{s:function(){c=b[Symbol.iterator]()},n:function(){var he=c.next();return _=he.done,he},e:function(he){k=!0,te=he},f:function(){try{!_&&c.return!=null&&c.return()}finally{if(k)throw te}}}}function Gl(b,p){if(!!b){if(typeof b=="string")return lf(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return lf(b,p)}}function lf(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,f=new Array(p);c<p;c++)f[c]=b[c];return f}var Mu;function Ra(b,p,c){var f=c-p,m=((b-p)%f+f)%f+p;return m===p?c:m}function eu(b,p,c){return Math.min(c,Math.max(p,b))}function Go(b,p,c){return b*(1-c)+p*c}function Iu(b,p,c,f){var m=new sf.a(b,p,c,f);return function(_){return m.solve(_)}}var ji=Iu(.25,.1,.25,1);function Da(){return window.matchMedia?(Mu==null&&(Mu=window.matchMedia("(prefers-reduced-motion: reduce)")),Mu.matches):!1}function js(b,p){var c={},f=uf(p),m;try{for(f.s();!(m=f.n()).done;){var _=m.value;_ in b&&(c[_]=b[_])}}catch(k){f.e(k)}finally{f.f()}return c}var tu=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date),Hl=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,uc=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;function wf(b){var p=Hl(b);return{cancel:function(){return uc(p)}}}var zo=function(){$e()(b,null,[{key:"convert",value:function(c){return c instanceof b?c:new b(c)}}]);function b(p,c){Pe()(this,b),this.ne=void 0,this.sw=void 0,p&&(c?this.setSouthWest(p).setNorthEast(c):p.length===4?this.setSouthWest([p[0],p[1]]).setNorthEast([p[2],p[3]]):this.setSouthWest(p[0]).setNorthEast(p[1]))}return $e()(b,[{key:"setNorthEast",value:function(c){return this.ne=c instanceof ya?new ya(c.lng,c.lat):ya.convert(c),this}},{key:"setSouthWest",value:function(c){return this.sw=c instanceof ya?new ya(c.lng,c.lat):ya.convert(c),this}},{key:"extend",value:function(c){var f=this.sw,m=this.ne,_,k;if(c instanceof ya)_=c,k=c;else if(c instanceof b){if(_=c.sw,k=c.ne,!_||!k)return this}else{if(Array.isArray(c))if(c.length===4||c.every(Array.isArray)){var te=c;return this.extend(b.convert(te))}else{var se=c;return this.extend(ya.convert(se))}return this}return!f&&!m?(this.sw=new ya(_.lng,_.lat),this.ne=new ya(k.lng,k.lat)):(f.lng=Math.min(_.lng,f.lng),f.lat=Math.min(_.lat,f.lat),m.lng=Math.max(k.lng,m.lng),m.lat=Math.max(k.lat,m.lat)),this}},{key:"getCenter",value:function(){return new ya((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)}},{key:"getSouthWest",value:function(){return this.sw}},{key:"getNorthEast",value:function(){return this.ne}},{key:"getNorthWest",value:function(){return new ya(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new ya(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this.sw.lng}},{key:"getSouth",value:function(){return this.sw.lat}},{key:"getEast",value:function(){return this.ne.lng}},{key:"getNorth",value:function(){return this.ne.lat}},{key:"toArray",value:function(){return[this.sw.toArray(),this.ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this.sw.toString(),", ").concat(this.ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this.sw&&this.ne)}},{key:"contains",value:function(c){var f=ya.convert(c),m=f.lng,_=f.lat,k=this.sw.lat<=_&&_<=this.ne.lat,te=this.sw.lng<=m&&m<=this.ne.lng;return this.sw.lng>this.ne.lng&&(te=this.sw.lng>=m&&m>=this.ne.lng),k&&te}}]),b}(),Zl=63710088e-1,ya=function(){$e()(b,null,[{key:"convert",value:function(c){if(c instanceof b)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new b(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&sc()(c)==="object"&&c!==null){var f="lng"in c?c.lng:c.lon;return new b(Number(f),Number(c.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]);function b(p,c){if(Pe()(this,b),this.lng=void 0,this.lat=void 0,isNaN(p)||isNaN(c))throw new Error("Invalid LngLat object: (".concat(p,", ").concat(c,")"));if(this.lng=+p,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return $e()(b,[{key:"wrap",value:function(){return new b(Ra(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toBounds",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,f=40075017,m=360*c/f,_=m/Math.cos(Math.PI/180*this.lat);return new zo(new b(this.lng-_,this.lat-m),new b(this.lng+_,this.lat+m))}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(c){var f=Math.PI/180,m=this.lat*f,_=c.lat*f,k=Math.sin(m)*Math.sin(_)+Math.cos(m)*Math.cos(_)*Math.cos((c.lng-this.lng)*f),te=Zl*Math.acos(Math.min(k,1));return te}}]),b}(),Ki=function(){$e()(b,null,[{key:"convert",value:function(c){return c instanceof b?c:Array.isArray(c)?new b(c[0],c[1]):c}}]);function b(p,c){Pe()(this,b),this.x=void 0,this.y=void 0,this.x=p,this.y=c}return $e()(b,[{key:"clone",value:function(){return new b(this.x,this.y)}},{key:"_add",value:function(c){return this.x+=c.x,this.y+=c.y,this}},{key:"add",value:function(c){return this.clone()._add(c)}},{key:"_sub",value:function(c){return this.x-=c.x,this.y-=c.y,this}},{key:"sub",value:function(c){return this.clone()._sub(c)}},{key:"_multByPoint",value:function(c){return this.x*=c.x,this.y*=c.y,this}},{key:"multByPoint",value:function(c){return this.clone()._multByPoint(c)}},{key:"_divByPoint",value:function(c){return this.x/=c.x,this.y/=c.y,this}},{key:"divByPoint",value:function(c){return this.clone()._divByPoint(c)}},{key:"_mult",value:function(c){return this.x*=c,this.y*=c,this}},{key:"mult",value:function(c){return this.clone()._mult(c)}},{key:"_div",value:function(c){return this.x/=c,this.y/=c,this}},{key:"div",value:function(c){return this.clone()._div(c)}},{key:"_rotate",value:function(c){var f=Math.cos(c),m=Math.sin(c),_=f*this.x-m*this.y,k=m*this.x+f*this.y;return this.x=_,this.y=k,this}},{key:"rotate",value:function(c){return this.clone()._rotate(c)}},{key:"_rotateAround",value:function(c,f){var m=Math.cos(c),_=Math.sin(c),k=f.x+m*(this.x-f.x)-_*(this.y-f.y),te=f.y+_*(this.x-f.x)+m*(this.y-f.y);return this.x=k,this.y=te,this}},{key:"roateAround",value:function(c,f){return this.clone()._rotateAround(c,f)}},{key:"_matMult",value:function(c){var f=c[0]*this.x+c[1]*this.y,m=c[2]*this.x+c[3]*this.y;return this.x=f,this.y=m,this}},{key:"matMult",value:function(c){return this.clone()._matMult(c)}},{key:"_unit",value:function(){return this.div(this.mag()),this}},{key:"unit",value:function(){return this.clone()._unit()}},{key:"_perp",value:function(){var c=this.y;return this.y=this.x,this.x=-c,this}},{key:"perp",value:function(){return this.clone()._perp()}},{key:"_round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"round",value:function(){return this.clone()._round()}},{key:"mag",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(c){return this.x===c.x&&this.y===c.y}},{key:"dist",value:function(c){return Math.sqrt(this.distSqr(c))}},{key:"distSqr",value:function(c){var f=c.x-this.x,m=c.y-this.y;return f*f+m*m}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"angleTo",value:function(c){return Math.atan2(this.y-c.y,this.x-c.x)}},{key:"angleWith",value:function(c){return this.angleWithSep(c.x,c.y)}},{key:"angleWithSep",value:function(c,f){return Math.atan2(this.x*f-this.y*c,this.x*c+this.y*f)}}]),b}(),fo=function(){function b(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(Pe()(this,b),this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,isNaN(p)||p<0||isNaN(c)||c<0||isNaN(f)||f<0||isNaN(m)||m<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=p,this.bottom=c,this.left=f,this.right=m}return $e()(b,[{key:"interpolate",value:function(c,f,m){return f.top!=null&&c.top!=null&&(this.top=Go(c.top,f.top,m)),f.bottom!=null&&c.bottom!=null&&(this.bottom=Go(c.bottom,f.bottom,m)),f.left!=null&&c.left!=null&&(this.left=Go(c.left,f.left,m)),f.right!=null&&c.right!=null&&(this.right=Go(c.right,f.right,m)),this}},{key:"getCenter",value:function(c,f){var m=eu((this.left+c-this.right)/2,0,c),_=eu((this.top+f-this.bottom)/2,0,f);return new Ki(m,_)}},{key:"equals",value:function(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}},{key:"clone",value:function(){return new b(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),b}(),ys=2*Math.PI*Zl;function wl(b){return ys*Math.cos(b*Math.PI/180)}function $a(b){return(180+b)/360}function Mn(b){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+b*Math.PI/360)))/360}function zs(b,p){return b/wl(p)}function wc(b){return b*360-180}function cl(b){var p=180-b*360;return 360/Math.PI*Math.atan(Math.exp(p*Math.PI/180))-90}function vu(b,p){return b*wl(cl(p))}function Us(b){return 1/Math.cos(b*Math.PI/180)}var Ou=function(){$e()(b,null,[{key:"fromLngLat",value:function(c){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,m=ya.convert(c);return new b($a(m.lng),Mn(m.lat),zs(f,m.lat))}}]);function b(p,c){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;Pe()(this,b),this.x=void 0,this.y=void 0,this.z=void 0,this.x=+p,this.y=+c,this.z=+f}return $e()(b,[{key:"toLngLat",value:function(){return new ya(wc(this.x),cl(this.y))}},{key:"toAltitude",value:function(){return vu(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/ys*Us(cl(this.y))}}]),b}();function an(b,p){var c;if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(c=Gc(b))||p&&b&&typeof b.length=="number"){c&&(b=c);var f=0,m=function(){};return{s:m,n:function(){return f>=b.length?{done:!0}:{done:!1,value:b[f++]}},e:function(he){throw he},f:m}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _=!0,k=!1,te;return{s:function(){c=b[Symbol.iterator]()},n:function(){var he=c.next();return _=he.done,he},e:function(he){k=!0,te=he},f:function(){try{!_&&c.return!=null&&c.return()}finally{if(k)throw te}}}}function Gc(b,p){if(!!b){if(typeof b=="string")return lc(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return lc(b,p)}}function lc(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,f=new Array(p);c<p;c++)f[c]=b[c];return f}var Wl=8192,mu=function(){$e()(b,[{key:"minZoom",get:function(){return this._minZoom},set:function(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}},{key:"minPitch",get:function(){return this._minPitch},set:function(c){this._minPitch!==c&&(this._minPitch=c,this._pitch=Math.max(this._pitch,c))}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(c){this._maxPitch!==c&&(this._maxPitch=c,this._pitch=Math.min(this._pitch,c))}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new Ki(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(c){var f=-Ra(c,-180,180)*Math.PI/180;this.angle!==f&&(this.unmodified=!1,this.angle=f,this.calcMatrices(),this.rotationMatrix=Lr.a.create(),Lr.a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(c){var f=eu(c,this._minPitch,this._maxPitch)/180*Math.PI;this._pitch!==f&&(this.unmodified=!1,this._pitch=f,this.calcMatrices())}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this.unmodified=!1,this._fov=c/180*Math.PI,this.calcMatrices())}},{key:"zoom",get:function(){return this._zoom},set:function(c){var f=Math.min(Math.max(c,this._minZoom),this._maxZoom);this._zoom!==f&&(this.unmodified=!1,this._zoom=f,this.scale=this.zoomScale(f),this.tileZoom=Math.floor(f),this.zoomFraction=f-this.tileZoom,this.constrain(),this.calcMatrices())}},{key:"center",get:function(){return this._center},set:function(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this.unmodified=!1,this._center=c,this.constrain(),this.calcMatrices())}},{key:"padding",get:function(){return this.edgeInsets.toJSON()},set:function(c){this.edgeInsets.equals(c)||(this.unmodified=!1,this.edgeInsets.interpolate(this.edgeInsets,c,1),this.calcMatrices())}},{key:"centerPoint",get:function(){return this.edgeInsets.getCenter(this.width,this.height)}},{key:"point",get:function(){return this.project(this.center)}}]);function b(p,c,f,m,_){Pe()(this,b),this.tileSize=void 0,this.tileZoom=void 0,this.lngRange=void 0,this.latRange=void 0,this.maxValidLatitude=void 0,this.scale=void 0,this.width=void 0,this.height=void 0,this.angle=void 0,this.rotationMatrix=void 0,this.pixelsToGLUnits=void 0,this.cameraToCenterDistance=void 0,this.mercatorMatrix=void 0,this.projMatrix=void 0,this.invProjMatrix=void 0,this.alignedProjMatrix=void 0,this.pixelMatrix=void 0,this.pixelMatrixInverse=void 0,this.glCoordMatrix=void 0,this.labelPlaneMatrix=void 0,this._fov=void 0,this._pitch=void 0,this._zoom=void 0,this._renderWorldCopies=void 0,this._minZoom=void 0,this._maxZoom=void 0,this._minPitch=void 0,this._maxPitch=void 0,this._center=void 0,this.zoomFraction=void 0,this.unmodified=void 0,this.edgeInsets=void 0,this.constraining=void 0,this.posMatrixCache=void 0,this.alignedPosMatrixCache=void 0,this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=_===void 0?!0:_,this._minZoom=p||0,this._maxZoom=c||22,this._minPitch=f==null?0:f,this._maxPitch=m==null?60:m,this.setMaxBounds(),this.width=0,this.height=0,this._center=new ya(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this.unmodified=!0,this.edgeInsets=new fo,this.posMatrixCache={},this.alignedPosMatrixCache={}}return $e()(b,[{key:"clone",value:function(){var c=new b(this._minZoom,this._maxZoom,this._minPitch,this._maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c.center=this._center,c.zoom=this.zoom,c.angle=this.angle,c.fov=this._fov,c.pitch=this._pitch,c.unmodified=this.unmodified,c.edgeInsets=this.edgeInsets.clone(),c.calcMatrices(),c}},{key:"isPaddingEqual",value:function(c){return this.edgeInsets.equals(c)}},{key:"interpolatePadding",value:function(c,f,m){this.unmodified=!1,this.edgeInsets.interpolate(c,f,m),this.constrain(),this.calcMatrices()}},{key:"coveringZoomLevel",value:function(c){var f=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,f)}},{key:"resize",value:function(c,f){this.width=c,this.height=f,this.pixelsToGLUnits=[2/c,-2/f],this.constrain(),this.calcMatrices()}},{key:"zoomScale",value:function(c){return Math.pow(2,c)}},{key:"scaleZoom",value:function(c){return Math.log(c)/Math.LN2}},{key:"project",value:function(c){var f=eu(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new Ki($a(c.lng)*this.worldSize,Mn(f)*this.worldSize)}},{key:"unproject",value:function(c){return new Ou(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(c,f){var m=this.pointCoordinate(f),_=this.pointCoordinate(this.centerPoint),k=this.locationCoordinate(c),te=new Ou(k.x-(m.x-_.x),k.y-(m.y-_.y));this.center=this.coordinateLocation(te),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"pointCoordinate",value:function(c){var f=0,m=new Float32Array([c.x,c.y,0,1]),_=new Float32Array([c.x,c.y,1,1]);Lr.e.transformMat4(m,m,this.pixelMatrixInverse),Lr.e.transformMat4(_,_,this.pixelMatrixInverse);var k=m[3],te=_[3],se=m[0]/k,he=_[0]/te,Ye=m[1]/k,Lt=_[1]/te,Bt=m[2]/k,mr=_[2]/te,yr=Bt===mr?0:(f-Bt)/(mr-Bt);return new Ou(Go(se,he,yr)/this.worldSize,Go(Ye,Lt,yr)/this.worldSize)}},{key:"getBounds",value:function(){return new zo().extend(this.pointLocation(new Ki(0,0))).extend(this.pointLocation(new Ki(this.width,0))).extend(this.pointLocation(new Ki(this.width,this.height))).extend(this.pointLocation(new Ki(0,this.height)))}},{key:"getMaxBounds",value:function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new zo([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}},{key:"setMaxBounds",value:function(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this.constrain()):(this.lngRange=void 0,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var c=this.pointCoordinate(new Ki(0,0)),f=new Float32Array([c.x*this.worldSize,c.y*this.worldSize,0,1]),m=Lr.e.transformMat4(f,f,this.pixelMatrix);return m[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var c=this._pitch,f=Math.tan(c)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Ki(0,f))}},{key:"getCameraQueryGeometry",value:function(c){var f=this.getCameraPoint();if(c.length===1)return[c[0],f];var m=f.x,_=f.y,k=f.x,te=f.y,se=an(c),he;try{for(se.s();!(he=se.n()).done;){var Ye=he.value;m=Math.min(m,Ye.x),_=Math.min(_,Ye.y),k=Math.max(k,Ye.x),te=Math.max(te,Ye.y)}}catch(Lt){se.e(Lt)}finally{se.f()}return[new Ki(m,_),new Ki(k,_),new Ki(k,te),new Ki(m,te),new Ki(m,_)]}},{key:"coordinatePoint",value:function(c){var f=Lr.e.fromValues(c.x*this.worldSize,c.y*this.worldSize,0,1);return Lr.e.transformMat4(f,f,this.pixelMatrix),new Ki(f[0]/f[3],f[1]/f[3])}},{key:"locationPoint",value:function(c){return this.coordinatePoint(this.locationCoordinate(c))}},{key:"pointLocation",value:function(c){return this.coordinateLocation(this.pointCoordinate(c))}},{key:"locationCoordinate",value:function(c){return Ou.fromLngLat(c)}},{key:"coordinateLocation",value:function(c){return c.toLngLat()}},{key:"getProjectionMatrix",value:function(){return this.projMatrix}},{key:"constrain",value:function(){if(!(!this.center||!this.width||!this.height||this.constraining)){this.constraining=!0;var c=-90,f=90,m=-180,_=180,k,te,se,he,Ye=this.size,Lt=this.unmodified;if(this.latRange){var Bt=this.latRange;c=Mn(Bt[1])*this.worldSize,f=Mn(Bt[0])*this.worldSize,k=f-c<Ye.y?Ye.y/(f-c):0}if(this.lngRange){var mr=this.lngRange;m=$a(mr[0])*this.worldSize,_=$a(mr[1])*this.worldSize,te=_-m<Ye.x?Ye.x/(_-m):0}var yr=this.point,Ir=Math.max(te||0,k||0);if(Ir){this.center=this.unproject(new Ki(te?(_+m)/2:yr.x,k?(f+c)/2:yr.y)),this.zoom+=this.scaleZoom(Ir),this.unmodified=Lt,this.constraining=!1;return}if(this.latRange){var Xr=yr.y,Jr=Ye.y/2;Xr-Jr<c&&(he=c+Jr),Xr+Jr>f&&(he=f-Jr)}if(this.lngRange){var jn=yr.x,Zn=Ye.x/2;jn-Zn<m&&(se=m+Zn),jn+Zn>_&&(se=_-Zn)}(se!==void 0||he!==void 0)&&(this.center=this.unproject(new Ki(se!==void 0?se:yr.x,he!==void 0?he:yr.y))),this.unmodified=Lt,this.constraining=!1}}},{key:"calcMatrices",value:function(){if(!!this.height){var c=this._fov/2,f=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(c)*this.height;var m=Math.PI/2+this._pitch,_=this._fov*(.5+f.y/this.height),k=Math.sin(_)*this.cameraToCenterDistance/Math.sin(eu(Math.PI-m-_,.01,Math.PI-.01)),te=this.point,se=te.x,he=te.y,Ye=Math.cos(Math.PI/2-this._pitch)*k+this.cameraToCenterDistance,Lt=Ye*1.01,Bt=this.height/50,mr=Lr.b.create();Lr.b.perspective(mr,this._fov,this.width/this.height,Bt,Lt),mr[8]=-f.x*2/this.width,mr[9]=f.y*2/this.height,Lr.b.scale(mr,mr,[1,-1,1]),Lr.b.translate(mr,mr,[0,0,-this.cameraToCenterDistance]),Lr.b.rotateX(mr,mr,this._pitch),Lr.b.rotateZ(mr,mr,this.angle),Lr.b.translate(mr,mr,[-se,-he,0]),this.mercatorMatrix=Lr.b.scale(Lr.b.create(),mr,[this.worldSize,this.worldSize,this.worldSize]),Lr.b.scale(mr,mr,Lr.d.fromValues(1,1,zs(1,this.center.lat)*this.worldSize)),this.projMatrix=mr,this.invProjMatrix=Lr.b.invert(Lr.b.create(),this.projMatrix);var yr=this.width%2/2,Ir=this.height%2/2,Xr=Math.cos(this.angle),Jr=Math.sin(this.angle),jn=se-Math.round(se)+Xr*yr+Jr*Ir,Zn=he-Math.round(he)+Xr*Ir+Jr*yr,Ci=Lr.b.clone(mr);if(Lr.b.translate(Ci,Ci,[jn>.5?jn-1:jn,Zn>.5?Zn-1:Zn,0]),this.alignedProjMatrix=Ci,mr=Lr.b.create(),Lr.b.scale(mr,mr,[this.width/2,-this.height/2,1]),Lr.b.translate(mr,mr,[1,-1,0]),this.labelPlaneMatrix=mr,mr=Lr.b.create(),Lr.b.scale(mr,mr,[1,-1,1]),Lr.b.translate(mr,mr,[-1,-1,0]),Lr.b.scale(mr,mr,[2/this.width,2/this.height,1]),this.glCoordMatrix=mr,this.pixelMatrix=Lr.b.multiply(Lr.b.create(),this.labelPlaneMatrix,this.projMatrix),mr=Lr.b.invert(Lr.b.create(),this.pixelMatrix),!mr)throw new Error("failed to invert matrix");this.pixelMatrixInverse=mr,this.posMatrixCache={},this.alignedPosMatrixCache={}}}}]),b}(),Gi=function b(p){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Pe()(this,b),this.type=void 0,So()(this,c),this.type=p};function cf(b){var p=ff();return function(){var f=Sn()(b),m;if(p){var _=Sn()(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return cr()(this,m)}}function ff(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var Vs=function(b){dr()(c,b);var p=cf(c);function c(f){var m;Pe()(this,c),m=p.call(this),m.transform=void 0,m.options=void 0,m.moving=void 0,m.zooming=void 0,m.rotating=void 0,m.pitching=void 0,m.padding=void 0,m.bearingSnap=void 0,m.easeEndTimeoutID=void 0,m.easeStart=void 0,m.easeOptions=void 0,m.easeId=void 0,m.onEaseFrame=void 0,m.onEaseEnd=void 0,m.easeFrameId=void 0,m.renderFrameCallback=function(){var Ye=Math.min((tu()-m.easeStart)/m.easeOptions.duration,1);m.onEaseFrame(m.easeOptions.easing(Ye)),Ye<1?m.easeFrameId=m.requestRenderFrame(m.renderFrameCallback):m.stop()},m.options=f;var _=f.minZoom,k=f.maxZoom,te=f.minPitch,se=f.maxPitch,he=f.renderWorldCopies;return m.moving=!1,m.zooming=!1,m.bearingSnap=f.bearingSnap,m.transform=new mu(_,k,te,se,he),m}return $e()(c,[{key:"requestRenderFrame",value:function(m){return 0}},{key:"cancelRenderFrame",value:function(m){}},{key:"getCenter",value:function(){var m=this.transform.center,_=m.lng,k=m.lat;return new ya(_,k)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setCenter",value:function(m,_){return this.jumpTo({center:m},_)}},{key:"setPitch",value:function(m,_){return this.jumpTo({pitch:m},_),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"panTo",value:function(m,_,k){return this.easeTo(So()({center:m},_),k)}},{key:"zoomOut",value:function(m,_){return this.zoomTo(this.getZoom()-1,m,_),this}},{key:"setBearing",value:function(m,_){return this.jumpTo({bearing:m},_),this}},{key:"setZoom",value:function(m,_){return this.jumpTo({zoom:m},_),this}},{key:"zoomIn",value:function(m,_){return this.zoomTo(this.getZoom()+1,m,_),this}},{key:"zoomTo",value:function(m,_,k){return this.easeTo(So()({zoom:m},_),k)}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(m,_){return this.jumpTo({padding:m},_),this}},{key:"rotateTo",value:function(m,_,k){return this.easeTo(So()({bearing:m},_),k)}},{key:"resetNorth",value:function(m,_){return this.rotateTo(0,So()({duration:1e3},m),_),this}},{key:"resetNorthPitch",value:function(m,_){return this.easeTo(So()({bearing:0,pitch:0,duration:1e3},m),_),this}},{key:"fitBounds",value:function(m,_,k){return this.fitInternal(this.cameraForBounds(m,_),_,k)}},{key:"cameraForBounds",value:function(m,_){return m=zo.convert(m),this.cameraForBoxAndBearing(m.getNorthWest(),m.getSouthEast(),0,_)}},{key:"snapToNorth",value:function(m,_){return Math.abs(this.getBearing())<this.bearingSnap?this.resetNorth(m,_):this}},{key:"jumpTo",value:function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=arguments.length>1?arguments[1]:void 0;this.stop();var k=this.transform,te=!1,se=!1,he=!1;return m.zoom&&k.zoom!==+m.zoom&&(te=!0,k.zoom=+m.zoom),m.center!==void 0&&(k.center=ya.convert(m.center)),m.bearing&&k.bearing!==+m.bearing&&(se=!0,k.bearing=+m.bearing),m.pitch&&k.pitch!==+m.pitch&&(he=!0,k.pitch=+m.pitch),m.padding!=null&&!k.isPaddingEqual(m.padding)&&(k.padding=m.padding),this.emit("movestart",new Gi("movestart",_)),this.emit("move",new Gi("move",_)),te&&(this.emit("zoomstart",new Gi("zoomstart",_)),this.emit("zoom",new Gi("zoom",_)),this.emit("zoomend",new Gi("zoomend",_))),se&&(this.emit("rotatestart",new Gi("rotatestart",_)),this.emit("rotate",new Gi("rotate",_)),this.emit("rotateend",new Gi("rotateend",_))),he&&(this.emit("pitchstart",new Gi("pitchstart",_)),this.emit("pitch",new Gi("pitch",_)),this.emit("pitchend",new Gi("pitchend",_))),this.emit("moveend",new Gi("moveend",_))}},{key:"easeTo",value:function(){var m=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},k=arguments.length>1?arguments[1]:void 0;_=So()({offset:[0,0],duration:500,easing:ji},_),(_.animate===!1||!_.essential&&Da())&&(_.duration=0);var te=this.transform,se=this.getZoom(),he=this.getBearing(),Ye=this.getPitch(),Lt=this.getPadding(),Bt=_.zoom?+_.zoom:se,mr=_.bearing?this.normalizeBearing(_.bearing,he):he,yr=_.pitch?+_.pitch:Ye,Ir=_.padding?_.padding:te.padding,Xr=Ki.convert(_.offset),Jr=te.centerPoint.add(Xr),jn=te.pointLocation(Jr),Zn=ya.convert(_.center||jn);this.normalizeCenter(Zn);var Ci=te.project(jn),mi=te.project(Zn).sub(Ci),la=te.zoomScale(Bt-se),Bi,Yi;_.around&&(Bi=ya.convert(_.around),Yi=te.locationPoint(Bi));var Ia={moving:this.moving,zooming:this.zooming,rotating:this.rotating,pitching:this.pitching};return this.zooming=this.zooming||Bt!==se,this.rotating=this.rotating||he!==mr,this.pitching=this.pitching||yr!==Ye,this.padding=!te.isPaddingEqual(Ir),this.easeId=_.easeId,this.prepareEase(k,_.noMoveStart,Ia),clearTimeout(this.easeEndTimeoutID),this.ease(function(ka){if(m.zooming&&(te.zoom=Go(se,Bt,ka)),m.rotating&&(te.bearing=Go(he,mr,ka)),m.pitching&&(te.pitch=Go(Ye,yr,ka)),m.padding&&(te.interpolatePadding(Lt,Ir,ka),Jr=te.centerPoint.add(Xr)),Bi)te.setLocationAtPoint(Bi,Yi);else{var jo=te.zoomScale(te.zoom-se),Dl=Bt>se?Math.min(2,la):Math.max(.5,la),Ha=Math.pow(Dl,1-ka),ia=te.unproject(Ci.add(mi.mult(ka*Ha)).mult(jo));te.setLocationAtPoint(te.renderWorldCopies?ia.wrap():ia,Jr)}m.fireMoveEvents(k)},function(ka){m.afterEase(k,ka)},_),this}},{key:"flyTo",value:function(){var m=this,_=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},k=arguments.length>1?arguments[1]:void 0;if(!_.essential&&Da()){var te=js(_,["center","zoom","bearing","pitch","around"]);return this.jumpTo(te,k)}this.stop(),_=So()({offset:[0,0],speed:1.2,curve:1.42,easing:ji},_);var se=this.transform,he=this.getZoom(),Ye=this.getBearing(),Lt=this.getPitch(),Bt=this.getPadding(),mr=_.zoom?eu(+_.zoom,se.minZoom,se.maxZoom):he,yr=_.bearing?this.normalizeBearing(_.bearing,Ye):Ye,Ir=_.pitch?+_.pitch:Lt,Xr="padding"in _?_.padding:se.padding,Jr=se.zoomScale(mr-he),jn=Ki.convert(_.offset),Zn=se.centerPoint.add(jn),Ci=se.pointLocation(Zn),mi=ya.convert(_.center||Ci);this.normalizeCenter(mi);var la=se.project(Ci),Bi=se.project(mi).sub(la),Yi=_.curve,Ia=Math.max(se.width,se.height),ka=Ia/Jr,jo=Bi.mag();if("minZoom"in _){var Dl=eu(Math.min(_.minZoom,he,mr),se.minZoom,se.maxZoom),Ha=Ia/se.zoomScale(Dl-he);Yi=Math.sqrt(Ha/jo*2)}var ia=Yi*Yi;function rc(qa){var ks=(ka*ka-Ia*Ia+(qa?-1:1)*ia*ia*jo*jo)/(2*(qa?ka:Ia)*ia*jo);return Math.log(Math.sqrt(ks*ks+1)-ks)}function Uf(qa){return(Math.exp(qa)-Math.exp(-qa))/2}function Jc(qa){return(Math.exp(qa)+Math.exp(-qa))/2}function mf(qa){return Uf(qa)/Jc(qa)}var tl=rc(0),gf=function(ks){return Jc(tl)/Jc(tl+Yi*ks)},rl=function(ks){return Ia*((Jc(tl)*mf(tl+Yi*ks)-Uf(tl))/ia)/jo},su=(rc(1)-tl)/Yi;if(Math.abs(jo)<1e-6||!isFinite(su)){if(Math.abs(Ia-ka)<1e-6)return this.easeTo(_,k);var Rc=ka<Ia?-1:1;su=Math.abs(Math.log(ka/Ia))/Yi,rl=function(){return 0},gf=function(ks){return Math.exp(Rc*Yi*ks)}}if("duration"in _)_.duration=+_.duration;else{var Uo="screenSpeed"in _?+_.screenSpeed/Yi:+_.speed;_.duration=1e3*su/Uo}return _.maxDuration&&_.duration>_.maxDuration&&(_.duration=0),this.zooming=!0,this.rotating=Ye!==yr,this.pitching=Ir!==Lt,this.padding=!se.isPaddingEqual(Xr),this.prepareEase(k,!1),this.ease(function(qa){var ks=qa*su,th=1/gf(ks);se.zoom=qa===1?mr:he+se.scaleZoom(th),m.rotating&&(se.bearing=Go(Ye,yr,qa)),m.pitching&&(se.pitch=Go(Lt,Ir,qa)),m.padding&&(se.interpolatePadding(Bt,Xr,qa),Zn=se.centerPoint.add(jn));var rh=qa===1?mi:se.unproject(la.add(Bi.mult(rl(ks))).mult(th));se.setLocationAtPoint(se.renderWorldCopies?rh.wrap():rh,Zn),m.fireMoveEvents(k)},function(){return m.afterEase(k)},_),this}},{key:"fitScreenCoordinates",value:function(m,_,k,te,se){return this.fitInternal(this.cameraForBoxAndBearing(this.transform.pointLocation(Ki.convert(m)),this.transform.pointLocation(Ki.convert(_)),k,te),te,se)}},{key:"stop",value:function(m,_){if(this.easeFrameId&&(this.cancelRenderFrame(this.easeFrameId),delete this.easeFrameId,delete this.onEaseFrame),this.onEaseEnd){var k=this.onEaseEnd;delete this.onEaseEnd,k.call(this,_)}return this}},{key:"normalizeBearing",value:function(m,_){m=Ra(m,-180,180);var k=Math.abs(m-_);return Math.abs(m-360-_)<k&&(m-=360),Math.abs(m+360-_)<k&&(m+=360),m}},{key:"normalizeCenter",value:function(m){var _=this.transform;if(!(!_.renderWorldCopies||_.lngRange)){var k=m.lng-_.center.lng;m.lng+=k>180?-360:k<-180?360:0}}},{key:"fireMoveEvents",value:function(m){this.emit("move",new Gi("move",m)),this.zooming&&this.emit("zoom",new Gi("zoom",m)),this.rotating&&this.emit("rotate",new Gi("rotate",m)),this.pitching&&this.emit("rotate",new Gi("pitch",m))}},{key:"prepareEase",value:function(m){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.moving=!0,!_&&!k.moving&&this.emit("movestart",new Gi("movestart",m)),this.zooming&&!k.zooming&&this.emit("zoomstart",new Gi("zoomstart",m)),this.rotating&&!k.rotating&&this.emit("rotatestart",new Gi("rotatestart",m)),this.pitching&&!k.pitching&&this.emit("pitchstart",new Gi("pitchstart",m))}},{key:"afterEase",value:function(m,_){if(!(this.easeId&&_&&this.easeId===_)){delete this.easeId;var k=this.zooming,te=this.rotating,se=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.padding=!1,k&&this.emit("zoomend",new Gi("zoomend",m)),te&&this.emit("rotateend",new Gi("rotateend",m)),se&&this.emit("pitchend",new Gi("pitchend",m)),this.emit("moveend",new Gi("moveend",m))}}},{key:"ease",value:function(m,_,k){k.animate===!1||k.duration===0?(m(1),_()):(this.easeStart=tu(),this.easeOptions=k,this.onEaseFrame=m,this.onEaseEnd=_,this.easeFrameId=this.requestRenderFrame(this.renderFrameCallback))}},{key:"cameraForBoxAndBearing",value:function(m,_,k,te){var se={top:0,bottom:0,right:0,left:0};if(te=So()({padding:se,offset:[0,0],maxZoom:this.transform.maxZoom},te),typeof te.padding=="number"){var he=te.padding;te.padding={top:he,bottom:he,right:he,left:he}}te.padding=So()(se,te.padding);var Ye=this.transform,Lt=Ye.padding,Bt=Ye.project(ya.convert(m)),mr=Ye.project(ya.convert(_)),yr=Bt.rotate(-k*Math.PI/180),Ir=mr.rotate(-k*Math.PI/180),Xr=new Ki(Math.max(yr.x,Ir.x),Math.max(yr.y,Ir.y)),Jr=new Ki(Math.min(yr.x,Ir.x),Math.min(yr.y,Ir.y)),jn=Xr.sub(Jr),Zn=(Ye.width-(Lt.left+Lt.right+te.padding.left+te.padding.right))/jn.x,Ci=(Ye.height-(Lt.top+Lt.bottom+te.padding.top+te.padding.bottom))/jn.y;if(!(Ci<0||Zn<0)){var mi=Math.min(Ye.scaleZoom(Ye.scale*Math.min(Zn,Ci)),te.maxZoom),la=Ki.convert(te.offset),Bi=(te.padding.left-te.padding.right)/2,Yi=(te.padding.top-te.padding.bottom)/2,Ia=new Ki(la.x+Bi,la.y+Yi),ka=Ia.mult(Ye.scale/Ye.zoomScale(mi)),jo=Ye.unproject(Bt.add(mr).div(2).sub(ka));return{center:jo,zoom:mi,bearing:k}}}},{key:"fitInternal",value:function(m,_,k){return m?(_=So()(m,_),delete _.padding,_.linear?this.easeTo(_,k):this.flyTo(_,k)):this}}]),c}(Ff.EventEmitter);function fl(b,p){var c;if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(c=Hc(b))||p&&b&&typeof b.length=="number"){c&&(b=c);var f=0,m=function(){};return{s:m,n:function(){return f>=b.length?{done:!0}:{done:!1,value:b[f++]}},e:function(he){throw he},f:m}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _=!0,k=!1,te;return{s:function(){c=b[Symbol.iterator]()},n:function(){var he=c.next();return _=he.done,he},e:function(he){k=!0,te=he},f:function(){try{!_&&c.return!=null&&c.return()}finally{if(k)throw te}}}}function Hc(b,p){if(!!b){if(typeof b=="string")return Xl(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Xl(b,p)}}function Xl(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,f=new Array(p);c<p;c++)f[c]=b[c];return f}var Ns={},Ho=Ns;Ns.create=function(b,p,c){var f=window.document.createElement(b);return p!==void 0&&(f.className=p),c&&c.appendChild(f),f},Ns.createNS=function(b,p){var c=window.document.createElementNS(b,p);return c};var ss=window.document&&window.document.documentElement.style;function us(b){if(!ss)return b[0];var p=fl(b),c;try{for(p.s();!(c=p.n()).done;){var f=c.value;if(f in ss)return f}}catch(m){p.e(m)}finally{p.f()}return b[0]}var Ti=us(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),Lu;Ns.disableDrag=function(){ss&&Ti&&(Lu=ss[Ti],ss[Ti]="none")},Ns.enableDrag=function(){ss&&Ti&&(ss[Ti]=Lu)};var Zo=us(["transform","WebkitTransform"]);Ns.setTransform=function(b,p){b.style[Zo]=p};var ho=!1;try{var Ru=Object.defineProperty({},"passive",{get:function(){ho=!0}});window.addEventListener("test",Ru,Ru),window.removeEventListener("test",Ru,Ru)}catch(b){ho=!1}Ns.addEventListener=function(b,p,c){var f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in f&&ho?b.addEventListener(p,c,f):b.addEventListener(p,c,f.capture)},Ns.removeEventListener=function(b,p,c){var f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in f&&ho?b.removeEventListener(p,c,f):b.removeEventListener(p,c,f.capture)};var Ju=function b(p){p.preventDefault(),p.stopPropagation(),window.removeEventListener("click",b,!0)};Ns.suppressClick=function(){window.addEventListener("click",Ju,!0),window.setTimeout(function(){window.removeEventListener("click",Ju,!0)},0)},Ns.mousePos=function(b,p){var c=b.getBoundingClientRect();return new Ki(p.clientX-c.left-b.clientLeft,p.clientY-c.top-b.clientTop)},Ns.touchPos=function(b,p){var c=b.getBoundingClientRect(),f=[],m=fl(p),_;try{for(m.s();!(_=m.n()).done;){var k=_.value;f.push(new Ki(k.clientX-c.left-b.clientLeft,k.clientY-c.top-b.clientTop))}}catch(te){m.e(te)}finally{m.f()}return f},Ns.mouseButton=function(b){return typeof window.InstallTrigger!="undefined"&&b.button===2&&b.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:b.button},Ns.remove=function(b){b.parentNode&&b.parentNode.removeChild(b)};function gu(b){var p=Ms();return function(){var f=Sn()(b),m;if(p){var _=Sn()(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return cr()(this,m)}}function Ms(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var ru=function(b){dr()(c,b);var p=gu(c);function c(f,m,_){var k,te=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Pe()(this,c);var se=Ho.mousePos(m.getCanvasContainer(),_),he=m.unproject(se);return k=p.call(this,f,So()({point:se,lngLat:he,originalEvent:_},te)),k.type=void 0,k.target=void 0,k.originalEvent=void 0,k.point=void 0,k.lngLat=void 0,k.defaultPrevented=void 0,k.defaultPrevented=!1,k.target=m,k}return $e()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(Gi);function Jn(b){var p=Bn();return function(){var f=Sn()(b),m;if(p){var _=Sn()(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return cr()(this,m)}}function Bn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var Pl=function(b){dr()(c,b);var p=Jn(c);function c(f,m,_){var k;Pe()(this,c);var te=f==="touchend"?_.changedTouches:_.touches,se=Ho.touchPos(m.getCanvasContainer(),te),he=se.map(function(Bt){return m.unproject(Bt)}),Ye=se.reduce(function(Bt,mr,yr,Ir){return Bt.add(mr.div(Ir.length))},new Ki(0,0)),Lt=m.unproject(Ye);return k=p.call(this,f,{points:se,point:Ye,lngLats:he,lngLat:Lt,originalEvent:_}),k.type=void 0,k.target=void 0,k.originalEvent=void 0,k.lngLat=void 0,k.point=void 0,k.points=void 0,k.lngLats=void 0,k.defaultPrevented=void 0,k.defaultPrevented=!1,k}return $e()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(Gi);function xs(b){var p=Wo();return function(){var f=Sn()(b),m;if(p){var _=Sn()(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return cr()(this,m)}}function Wo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var No=function(b){dr()(c,b);var p=xs(c);function c(f,m,_){var k;return Pe()(this,c),k=p.call(this,f,{originalEvent:_}),k.type=void 0,k.originalEvent=void 0,k.defaultPrevented=void 0,k.target=void 0,k.defaultPrevented=!1,k}return $e()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(Gi),nu=function(){function b(p){Pe()(this,b),this.map=void 0,this.delayContextMenu=void 0,this.contextMenuEvent=void 0,this.map=p}return $e()(b,[{key:"reset",value:function(){this.delayContextMenu=!1,delete this.contextMenuEvent}},{key:"mousemove",value:function(c){this.map.emit(c.type,new ru(c.type,this.map,c))}},{key:"mousedown",value:function(){this.delayContextMenu=!0}},{key:"mouseup",value:function(){this.delayContextMenu=!1,this.contextMenuEvent&&(this.map.emit("contextmenu",new ru("contextmenu",this.map,this.contextMenuEvent)),delete this.contextMenuEvent)}},{key:"contextmenu",value:function(c){this.delayContextMenu?this.contextMenuEvent=c:this.map.emit(c.type,new ru(c.type,this.map,c)),this.map.listeners("contextmenu")&&c.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!1}}]),b}(),Du=function(){function b(p,c){Pe()(this,b),this.map=void 0,this.el=void 0,this.container=void 0,this.enabled=void 0,this.active=void 0,this.startPos=void 0,this.lastPos=void 0,this.box=void 0,this.clickTolerance=void 0,this.map=p,this.el=p.getCanvasContainer(),this.container=p.getContainer(),this.clickTolerance=c.clickTolerance||1}return $e()(b,[{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active}},{key:"enable",value:function(){this.isEnabled()||(this.enabled=!0)}},{key:"disable",value:function(){!this.isEnabled()||(this.enabled=!1)}},{key:"mousedown",value:function(c,f){!this.isEnabled()||!(c.shiftKey&&c.button===0)||(Ho.disableDrag(),this.startPos=this.lastPos=f,this.active=!0)}},{key:"mousemoveWindow",value:function(c,f){if(!!this.active){var m=f;if(!(this.lastPos.equals(m)||!this.box&&m.dist(this.startPos)<this.clickTolerance)){var _=this.startPos;this.lastPos=m,this.box||(this.box=Ho.create("div","l7-boxzoom",this.container),this.container.classList.add("l7-crosshair"),this.fireEvent("boxzoomstart",c));var k=Math.min(_.x,m.x),te=Math.max(_.x,m.x),se=Math.min(_.y,m.y),he=Math.max(_.y,m.y);Ho.setTransform(this.box,"translate(".concat(k,"px,").concat(se,"px)")),this.box&&(this.box.style.width="".concat(te-k,"px"),this.box.style.height="".concat(he-se,"px"))}}}},{key:"mouseupWindow",value:function(c,f){var m=this;if(!!this.active&&c.button===0){var _=this.startPos,k=f;if(this.reset(),Ho.suppressClick(),_.x===k.x&&_.y===k.y)this.fireEvent("boxzoomcancel",c);else return this.map.emit("boxzoomend",new Gi("boxzoomend",{originalEvent:c})),{cameraAnimation:function(se){return se.fitScreenCoordinates(_,k,m.map.getBearing(),{linear:!0})}}}}},{key:"keydown",value:function(c){!this.active||c.keyCode===27&&(this.reset(),this.fireEvent("boxzoomcancel",c))}},{key:"reset",value:function(){this.active=!1,this.container.classList.remove("l7-crosshair"),this.box&&(Ho.remove(this.box),this.box=null),Ho.enableDrag(),delete this.startPos,delete this.lastPos}},{key:"fireEvent",value:function(c,f){return this.map.emit(c,new Gi(c,{originalEvent:f}))}}]),b}(),cc=Du,na=function(){function b(){Pe()(this,b),this.enabled=void 0,this.active=void 0,this.reset()}return $e()(b,[{key:"reset",value:function(){this.active=!1}},{key:"dblclick",value:function(c,f){return c.preventDefault(),{cameraAnimation:function(_){_.easeTo({duration:300,zoom:_.getZoom()+(c.shiftKey?-1:1),around:_.unproject(f)},{originalEvent:c})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),b}();function po(b){var p=hl();return function(){var f=Sn()(b),m;if(p){var _=Sn()(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return cr()(this,m)}}function hl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var dl=function(b){dr()(c,b);var p=po(c);function c(){var f;Pe()(this,c);for(var m=arguments.length,_=new Array(m),k=0;k<m;k++)_[k]=arguments[k];return f=p.call.apply(p,[this].concat(_)),f.type="renderFrame",f.timeStamp=void 0,f}return c}(Gi);function fc(b,p){var c;if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(c=zu(b))||p&&b&&typeof b.length=="number"){c&&(b=c);var f=0,m=function(){};return{s:m,n:function(){return f>=b.length?{done:!0}:{done:!1,value:b[f++]}},e:function(he){throw he},f:m}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _=!0,k=!1,te;return{s:function(){c=b[Symbol.iterator]()},n:function(){var he=c.next();return _=he.done,he},e:function(he){k=!0,te=he},f:function(){try{!_&&c.return!=null&&c.return()}finally{if(k)throw te}}}}function zu(b,p){if(!!b){if(typeof b=="string")return Is(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Is(b,p)}}function Is(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,f=new Array(p);c<p;c++)f[c]=b[c];return f}var Yl={linearity:.3,easing:Iu(0,0,.3,1)},Gs=So()({deceleration:2500,maxSpeed:1400},Yl),Pf=So()({deceleration:20,maxSpeed:1400},Yl),Kl=So()({deceleration:1e3,maxSpeed:360},Yl),Zc=So()({deceleration:1e3,maxSpeed:90},Yl),_f=function(){function b(p){Pe()(this,b),this.map=void 0,this.inertiaBuffer=void 0,this.map=p,this.clear()}return $e()(b,[{key:"clear",value:function(){this.inertiaBuffer=[]}},{key:"record",value:function(c){this.drainInertiaBuffer(),this.inertiaBuffer.push({time:tu(),settings:c})}},{key:"drainInertiaBuffer",value:function(){for(var c=this.inertiaBuffer,f=tu(),m=160;c.length>0&&f-c[0].time>m;)c.shift()}},{key:"onMoveEnd",value:function(c){if(this.drainInertiaBuffer(),!(this.inertiaBuffer.length<2)){var f={zoom:0,bearing:0,pitch:0,pan:new Ki(0,0),pinchAround:void 0,around:void 0},m=fc(this.inertiaBuffer),_;try{for(m.s();!(_=m.n()).done;){var k=_.value.settings;f.zoom+=k.zoomDelta||0,f.bearing+=k.bearingDelta||0,f.pitch+=k.pitchDelta||0,k.panDelta&&f.pan._add(k.panDelta),k.around&&(f.around=k.around),k.pinchAround&&(f.pinchAround=k.pinchAround)}}catch(Ir){m.e(Ir)}finally{m.f()}var te=this.inertiaBuffer[this.inertiaBuffer.length-1],se=te.time-this.inertiaBuffer[0].time,he={};if(f.pan.mag()){var Ye=Nu(f.pan.mag(),se,So()({},Gs,c||{}));he.offset=f.pan.mult(Ye.amount/f.pan.mag()),he.center=this.map.transform.center,bs(he,Ye)}if(f.zoom){var Lt=Nu(f.zoom,se,Pf);he.zoom=this.map.transform.zoom+Lt.amount,bs(he,Lt)}if(f.bearing){var Bt=Nu(f.bearing,se,Kl);he.bearing=this.map.transform.bearing+eu(Bt.amount,-179,179),bs(he,Bt)}if(f.pitch){var mr=Nu(f.pitch,se,Zc);he.pitch=this.map.transform.pitch+mr.amount,bs(he,mr)}if(he.zoom||he.bearing){var yr=f.pinchAround===void 0?f.around:f.pinchAround;he.around=yr?this.map.unproject(yr):this.map.getCenter()}return this.clear(),So()(he,{noMoveStart:!0})}}}]),b}();function bs(b,p){(!b.duration||b.duration<p.duration)&&(b.duration=p.duration,b.easing=p.easing)}function Nu(b,p,c){var f=c.maxSpeed,m=c.linearity,_=c.deceleration,k=eu(b*m/(p/1e3),-f,f),te=Math.abs(k)/(_*m);return{easing:c.easing,duration:te*1e3,amount:k*(te/2)}}var Wc={panStep:100,bearingStep:15,pitchStep:10},_l=function(){function b(){Pe()(this,b),this.enabled=void 0,this.active=void 0,this.panStep=void 0,this.bearingStep=void 0,this.pitchStep=void 0;var p=Wc;this.panStep=p.panStep,this.bearingStep=p.bearingStep,this.pitchStep=p.pitchStep}return $e()(b,[{key:"reset",value:function(){this.active=!1}},{key:"keydown",value:function(c){var f=this;if(!(c.altKey||c.ctrlKey||c.metaKey)){var m=0,_=0,k=0,te=0,se=0;switch(c.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:c.shiftKey?_=-1:(c.preventDefault(),te=-1);break;case 39:c.shiftKey?_=1:(c.preventDefault(),te=1);break;case 38:c.shiftKey?k=1:(c.preventDefault(),se=-1);break;case 40:c.shiftKey?k=-1:(c.preventDefault(),se=1);break;default:return}return{cameraAnimation:function(Ye){var Lt=Ye.getZoom();Ye.easeTo({duration:300,easeId:"keyboardHandler",easing:Ml,zoom:m?Math.round(Lt)+m*(c.shiftKey?2:1):Lt,bearing:Ye.getBearing()+_*f.bearingStep,pitch:Ye.getPitch()+k*f.pitchStep,offset:[-te*f.panStep,-se*f.panStep],center:Ye.getCenter()},{originalEvent:c})}}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),b}();function Ml(b){return b*(2-b)}var hc=_l,Qu=function(){function b(p,c){Pe()(this,b),this.mousedownPos=void 0,this.clickTolerance=void 0,this.map=void 0,this.map=p,this.clickTolerance=c.clickTolerance}return $e()(b,[{key:"reset",value:function(){delete this.mousedownPos}},{key:"wheel",value:function(c){return this.firePreventable(new No(c.type,this.map,c))}},{key:"mousedown",value:function(c,f){return this.mousedownPos=f,this.firePreventable(new ru(c.type,this.map,c))}},{key:"mouseup",value:function(c){this.map.emit(c.type,new ru(c.type,this.map,c))}},{key:"click",value:function(c,f){this.mousedownPos&&this.mousedownPos.dist(f)>=this.clickTolerance||this.map.emit(c.type,new ru(c.type,this.map,c))}},{key:"dblclick",value:function(c){return this.firePreventable(new ru(c.type,this.map,c))}},{key:"mouseover",value:function(c){this.map.emit(c.type,new ru(c.type,this.map,c))}},{key:"mouseout",value:function(c){this.map.emit(c.type,new ru(c.type,this.map,c))}},{key:"touchstart",value:function(c){return this.firePreventable(new Pl(c.type,this.map,c))}},{key:"touchmove",value:function(c){this.map.emit(c.type,new Pl(c.type,this.map,c))}},{key:"touchend",value:function(c){this.map.emit(c.type,new Pl(c.type,this.map,c))}},{key:"touchcancel",value:function(c){this.map.emit(c.type,new Pl(c.type,this.map,c))}},{key:"firePreventable",value:function(c){if(this.map.emit(c.type,c),c.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!1}},{key:"disable",value:function(){return!1}}]),b}(),Fs=a("iWIM"),dc=a.n(Fs),pl,vl=0,Il=2,s=(pl={},fi()(pl,vl,1),fi()(pl,Il,2),pl);function i(b,p){var c=s[p];return b.buttons===void 0||(b.buttons&c)!==c}var n=function(){function b(p){Pe()(this,b),this.enabled=void 0,this.active=void 0,this.lastPoint=void 0,this.eventButton=void 0,this.moved=void 0,this.clickTolerance=void 0,this.reset(),this.clickTolerance=p.clickTolerance||1}return $e()(b,[{key:"reset",value:function(){this.active=!1,this.moved=!1,delete this.lastPoint,delete this.eventButton}},{key:"mousedown",value:function(c,f){if(!this.lastPoint){var m=Ho.mouseButton(c);!this.correctButton(c,m)||(this.lastPoint=f,this.eventButton=m)}}},{key:"mousemoveWindow",value:function(c,f){var m=this.lastPoint;if(!!m){if(c.preventDefault(),i(c,this.eventButton)){this.reset();return}if(!(!this.moved&&f.dist(m)<this.clickTolerance))return this.moved=!0,this.lastPoint=f,this.move(m,f)}}},{key:"mouseupWindow",value:function(c){if(!!this.lastPoint){var f=Ho.mouseButton(c);f===this.eventButton&&(this.moved&&Ho.suppressClick(),this.reset())}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"correctButton",value:function(c,f){return!1}},{key:"move",value:function(c,f){}}]),b}();function l(b){var p=y();return function(){var f=Sn()(b),m;if(p){var _=Sn()(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return cr()(this,m)}}function y(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var M=function(b){dr()(c,b);var p=l(c);function c(){return Pe()(this,c),p.apply(this,arguments)}return $e()(c,[{key:"mousedown",value:function(m,_){dc()(Sn()(c.prototype),"mousedown",this).call(this,m,_),this.lastPoint&&(this.active=!0)}},{key:"move",value:function(m,_){return{around:_,panDelta:_.sub(m)}}},{key:"correctButton",value:function(m,_){return _===vl&&!m.ctrlKey}}]),c}(n);function L(b){var p=B();return function(){var f=Sn()(b),m;if(p){var _=Sn()(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return cr()(this,m)}}function B(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var oe=function(b){dr()(c,b);var p=L(c);function c(){return Pe()(this,c),p.apply(this,arguments)}return $e()(c,[{key:"correctButton",value:function(m,_){return _===vl&&m.ctrlKey||_===Il}},{key:"move",value:function(m,_){var k=-.5,te=(_.y-m.y)*k;if(te)return this.active=!0,{pitchDelta:te}}},{key:"contextmenu",value:function(m){m.preventDefault()}}]),c}(n);function Te(b){var p=Ge();return function(){var f=Sn()(b),m;if(p){var _=Sn()(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return cr()(this,m)}}function Ge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var Ke=function(b){dr()(c,b);var p=Te(c);function c(){return Pe()(this,c),p.apply(this,arguments)}return $e()(c,[{key:"contextmenu",value:function(m){m.preventDefault()}},{key:"correctButton",value:function(m,_){return _===vl&&m.ctrlKey||_===Il}},{key:"move",value:function(m,_){var k=.8,te=(_.x-m.x)*k;if(te)return this.active=!0,{bearingDelta:te}}}]),c}(n),et=4.000244140625,Ft=1/100,Rt=1/450,Yt=2,zt=function(){function b(p,c){var f=this;Pe()(this,b),this.map=void 0,this.el=void 0,this.enabled=void 0,this.active=void 0,this.zooming=void 0,this.aroundCenter=void 0,this.around=void 0,this.aroundPoint=void 0,this.type=void 0,this.lastValue=void 0,this.timeout=void 0,this.finishTimeout=void 0,this.lastWheelEvent=void 0,this.lastWheelEventTime=void 0,this.startZoom=void 0,this.targetZoom=void 0,this.delta=void 0,this.easing=void 0,this.prevEase=void 0,this.frameId=void 0,this.handler=void 0,this.defaultZoomRate=void 0,this.wheelZoomRate=void 0,this.onScrollFrame=function(){if(!!f.frameId&&(f.frameId=null,!!f.isActive())){var m=f.map.transform;if(f.delta!==0){var _=f.type==="wheel"&&Math.abs(f.delta)>et?f.wheelZoomRate:f.defaultZoomRate,k=Yt/(1+Math.exp(-Math.abs(f.delta*_)));f.delta<0&&k!==0&&(k=1/k);var te=typeof f.targetZoom=="number"?m.zoomScale(f.targetZoom):m.scale;f.targetZoom=Math.min(m.maxZoom,Math.max(m.minZoom,m.scaleZoom(te*k))),f.type==="wheel"&&(f.startZoom=m.zoom,f.easing=f.smoothOutEasing(200)),f.delta=0}var se=typeof f.targetZoom=="number"?f.targetZoom:m.zoom,he=f.startZoom,Ye=f.easing,Lt=!1,Bt;if(f.type==="wheel"&&he&&Ye){var mr=Math.min((tu()-f.lastWheelEventTime)/200,1),yr=Ye(mr);Bt=Go(he,se,yr),mr<1?f.frameId||(f.frameId=!0):Lt=!0}else Bt=se,Lt=!0;return f.active=!0,Lt&&(f.active=!1,f.finishTimeout=setTimeout(function(){f.zooming=!1,f.handler.triggerRenderFrame(),delete f.targetZoom,delete f.finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Lt,zoomDelta:Bt-m.zoom,around:f.aroundPoint,originalEvent:f.lastWheelEvent}}},this.map=p,this.el=p.getCanvasContainer(),this.handler=c,this.delta=0,this.defaultZoomRate=Ft,this.wheelZoomRate=Rt}return $e()(b,[{key:"setZoomRate",value:function(c){this.defaultZoomRate=c}},{key:"setWheelZoomRate",value:function(c){this.wheelZoomRate=c}},{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active||this.finishTimeout!==void 0}},{key:"isZooming",value:function(){return!!this.zooming}},{key:"enable",value:function(c){this.isEnabled()||(this.enabled=!0,this.aroundCenter=c&&c.around==="center")}},{key:"disable",value:function(){!this.isEnabled()||(this.enabled=!1)}},{key:"wheel",value:function(c){if(!!this.isEnabled()){var f=c.deltaMode===window.WheelEvent.DOM_DELTA_LINE?c.deltaY*40:c.deltaY,m=tu(),_=m-(this.lastWheelEventTime||0);this.lastWheelEventTime=m,f!==0&&f%et==0?this.type="wheel":f!==0&&Math.abs(f)<4?this.type="trackpad":_>400?(this.type=null,this.lastValue=f,this.timeout=setTimeout(this.onTimeout,40,c)):this.type||(this.type=Math.abs(_*f)<200?"trackpad":"wheel",this.timeout&&(clearTimeout(this.timeout),this.timeout=null,f+=this.lastValue)),c.shiftKey&&f&&(f=f/4),this.type&&(this.lastWheelEvent=c,this.delta-=f,this.active||this.start(c)),c.preventDefault()}}},{key:"renderFrame",value:function(){return this.onScrollFrame()}},{key:"reset",value:function(){this.active=!1}},{key:"onTimeout",value:function(c){this.type="wheel",this.delta-=this.lastValue,this.active||this.start(c)}},{key:"start",value:function(c){if(!!this.delta){this.frameId&&(this.frameId=null),this.active=!0,this.isZooming()||(this.zooming=!0),this.finishTimeout&&(clearTimeout(this.finishTimeout),delete this.finishTimeout);var f=Ho.mousePos(this.el,c);this.around=ya.convert(this.aroundCenter?this.map.getCenter():this.map.unproject(f)),this.aroundPoint=this.map.transform.locationPoint(this.around),this.frameId||(this.frameId=!0,this.handler.triggerRenderFrame())}}},{key:"smoothOutEasing",value:function(c){var f=ji;if(this.prevEase){var m=this.prevEase,_=(tu()-m.start)/m.duration,k=m.easing(_+.01)-m.easing(_),te=.27/Math.sqrt(k*k+1e-4)*.01,se=Math.sqrt(.27*.27-te*te);f=Iu(te,se,.25,1)}return this.prevEase={start:tu(),duration:c,easing:f},f}}]),b}(),jt=zt,rr=function(){function b(p,c){Pe()(this,b),this.clickZoom=void 0,this.tapZoom=void 0,this.clickZoom=p,this.tapZoom=c}return $e()(b,[{key:"enable",value:function(){this.clickZoom.enable(),this.tapZoom.enable()}},{key:"disable",value:function(){this.clickZoom.disable(),this.tapZoom.disable()}},{key:"isEnabled",value:function(){return this.clickZoom.isEnabled()&&this.tapZoom.isEnabled()}},{key:"isActive",value:function(){return this.clickZoom.isActive()||this.tapZoom.isActive()}}]),b}(),nr=function(){function b(p,c,f){Pe()(this,b),this.inertiaOptions=void 0,this.el=void 0,this.mousePan=void 0,this.touchPan=void 0,this.el=p,this.mousePan=c,this.touchPan=f}return $e()(b,[{key:"enable",value:function(c){this.inertiaOptions=c||{},this.mousePan.enable(),this.touchPan.enable(),this.el.classList.add("l7-touch-drag-pan")}},{key:"disable",value:function(){this.mousePan.disable(),this.touchPan.disable(),this.el.classList.remove("l7-touch-drag-pan")}},{key:"isEnabled",value:function(){return this.mousePan.isEnabled()&&this.touchPan.isEnabled()}},{key:"isActive",value:function(){return this.mousePan.isActive()||this.touchPan.isActive()}}]),b}(),zr=function(){function b(p,c,f){Pe()(this,b),this.mouseRotate=void 0,this.mousePitch=void 0,this.pitchWithRotate=void 0,this.pitchWithRotate=p.pitchWithRotate,this.mouseRotate=c,this.mousePitch=f}return $e()(b,[{key:"enable",value:function(){this.mouseRotate.enable(),this.pitchWithRotate&&this.mousePitch.enable()}},{key:"disable",value:function(){this.mouseRotate.disable(),this.mousePitch.disable()}},{key:"isEnabled",value:function(){return this.mouseRotate.isEnabled()&&(!this.pitchWithRotate||this.mousePitch.isEnabled())}},{key:"isActive",value:function(){return this.mouseRotate.isActive()||this.mousePitch.isActive()}}]),b}(),pr=function(){function b(p,c,f,m){Pe()(this,b),this.el=void 0,this.touchZoom=void 0,this.touchRotate=void 0,this.tapDragZoom=void 0,this.rotationDisabled=void 0,this.enabled=void 0,this.el=p,this.touchZoom=c,this.touchRotate=f,this.tapDragZoom=m,this.rotationDisabled=!1,this.enabled=!0}return $e()(b,[{key:"enable",value:function(c){this.touchZoom.enable(c),this.rotationDisabled||this.touchRotate.enable(c),this.tapDragZoom.enable(),this.el.classList.add("l7-touch-zoom-rotate")}},{key:"disable",value:function(){this.touchZoom.disable(),this.touchRotate.disable(),this.tapDragZoom.disable(),this.el.classList.remove("l7-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this.touchZoom.isEnabled()&&(this.rotationDisabled||this.touchRotate.isEnabled())&&this.tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this.touchZoom.isActive()||this.touchRotate.isActive()||this.tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this.rotationDisabled=!0,this.touchRotate.disable()}},{key:"enableRotation",value:function(){this.rotationDisabled=!1,this.touchZoom.isEnabled()&&this.touchRotate.enable()}}]),b}();function Ar(b,p){for(var c={},f=0;f<b.length;f++)c[b[f].identifier]=p[f];return c}function wr(b,p){var c;if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(c=sn(b))||p&&b&&typeof b.length=="number"){c&&(b=c);var f=0,m=function(){};return{s:m,n:function(){return f>=b.length?{done:!0}:{done:!1,value:b[f++]}},e:function(he){throw he},f:m}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _=!0,k=!1,te;return{s:function(){c=b[Symbol.iterator]()},n:function(){var he=c.next();return _=he.done,he},e:function(he){k=!0,te=he},f:function(){try{!_&&c.return!=null&&c.return()}finally{if(k)throw te}}}}function sn(b,p){if(!!b){if(typeof b=="string")return $r(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return $r(b,p)}}function $r(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,f=new Array(p);c<p;c++)f[c]=b[c];return f}function xn(b){var p=new Ki(0,0),c=wr(b),f;try{for(c.s();!(f=c.n()).done;){var m=f.value;p._add(m)}}catch(_){c.e(_)}finally{c.f()}return p.div(b.length)}var In=500,ei=500,si=30,Ii=function(){function b(p){Pe()(this,b),this.numTouches=void 0,this.centroid=void 0,this.startTime=void 0,this.aborted=void 0,this.touches=void 0,this.reset(),this.numTouches=p.numTouches}return $e()(b,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(c,f,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=c.timeStamp),m.length===this.numTouches&&(this.centroid=xn(f),this.touches=Ar(m,f)))}},{key:"touchmove",value:function(c,f,m){if(!(this.aborted||!this.centroid)){var _=Ar(m,f);for(var k in this.touches)if(this.touches[k]){var te=this.touches[k],se=_[k];(!se||se.dist(te)>si)&&(this.aborted=!0)}}}},{key:"touchend",value:function(c,f,m){if((!this.centroid||c.timeStamp-this.startTime>ei)&&(this.aborted=!0),m.length===0){var _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}]),b}(),$i=function(){function b(p){Pe()(this,b),this.singleTap=void 0,this.numTaps=void 0,this.lastTime=void 0,this.lastTap=void 0,this.count=void 0,this.singleTap=new Ii(p),this.numTaps=p.numTaps,this.reset()}return $e()(b,[{key:"reset",value:function(){this.lastTime=Infinity,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(c,f,m){this.singleTap.touchstart(c,f,m)}},{key:"touchmove",value:function(c,f,m){this.singleTap.touchmove(c,f,m)}},{key:"touchend",value:function(c,f,m){var _=this.singleTap.touchend(c,f,m);if(_){var k=c.timeStamp-this.lastTime<In,te=!this.lastTap||this.lastTap.dist(_)<si;if((!k||!te)&&this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}]),b}(),wn=function(){function b(){Pe()(this,b),this.enabled=void 0,this.active=void 0,this.swipePoint=void 0,this.swipeTouch=void 0,this.tapTime=void 0,this.tap=void 0,this.tap=new $i({numTouches:1,numTaps:1}),this.reset()}return $e()(b,[{key:"reset",value:function(){this.active=!1,delete this.swipePoint,delete this.swipeTouch,delete this.tapTime,this.tap.reset()}},{key:"touchstart",value:function(c,f,m){this.swipePoint||(this.tapTime&&c.timeStamp-this.tapTime>In&&this.reset(),this.tapTime?m.length>0&&(this.swipePoint=f[0],this.swipeTouch=m[0].identifier):this.tap.touchstart(c,f,m))}},{key:"touchmove",value:function(c,f,m){if(!this.tapTime)this.tap.touchmove(c,f,m);else if(this.swipePoint){if(m[0].identifier!==this.swipeTouch)return;var _=f[0],k=_.y-this.swipePoint.y;return this.swipePoint=_,c.preventDefault(),this.active=!0,{zoomDelta:k/128}}}},{key:"touchend",value:function(c,f,m){if(this.tapTime)this.swipePoint&&m.length===0&&this.reset();else{var _=this.tap.touchend(c,f,m);_&&(this.tapTime=c.timeStamp)}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),b}(),ui=function(){function b(){Pe()(this,b),this.enabled=void 0,this.active=void 0,this.zoomIn=void 0,this.zoomOut=void 0,this.zoomIn=new $i({numTouches:1,numTaps:2}),this.zoomOut=new $i({numTouches:2,numTaps:1}),this.reset()}return $e()(b,[{key:"reset",value:function(){this.active=!1,this.zoomIn.reset(),this.zoomOut.reset()}},{key:"touchstart",value:function(c,f,m){this.zoomIn.touchstart(c,f,m),this.zoomOut.touchstart(c,f,m)}},{key:"touchmove",value:function(c,f,m){this.zoomIn.touchmove(c,f,m),this.zoomOut.touchmove(c,f,m)}},{key:"touchend",value:function(c,f,m){var _=this,k=this.zoomIn.touchend(c,f,m),te=this.zoomOut.touchend(c,f,m);if(k)return this.active=!0,c.preventDefault(),setTimeout(function(){return _.reset()},0),{cameraAnimation:function(he){return he.easeTo({duration:300,zoom:he.getZoom()+1,around:he.unproject(k)},{originalEvent:c})}};if(te)return this.active=!0,c.preventDefault(),setTimeout(function(){return _.reset()},0),{cameraAnimation:function(he){return he.easeTo({duration:300,zoom:he.getZoom()-1,around:he.unproject(te)},{originalEvent:c})}}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),b}(),Si=function(){function b(p){Pe()(this,b),this.enabled=void 0,this.active=void 0,this.touches=void 0,this.minTouches=void 0,this.clickTolerance=void 0,this.sum=void 0,this.minTouches=1,this.clickTolerance=p.clickTolerance||1,this.reset()}return $e()(b,[{key:"reset",value:function(){this.active=!1,this.touches={},this.sum=new Ki(0,0)}},{key:"touchstart",value:function(c,f,m){return this.calculateTransform(c,f,m)}},{key:"touchmove",value:function(c,f,m){if(!!this.active)return c.preventDefault(),this.calculateTransform(c,f,m)}},{key:"touchend",value:function(c,f,m){this.calculateTransform(c,f,m),this.active&&m.length<this.minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"calculateTransform",value:function(c,f,m){m.length>0&&(this.active=!0);var _=Ar(m,f),k=new Ki(0,0),te=new Ki(0,0),se=0;for(var he in _)if(_[he]){var Ye=_[he],Lt=this.touches[he];Lt&&(k._add(Ye),te._add(Ye.sub(Lt)),se++,_[he]=Ye)}if(this.touches=_,!(se<this.minTouches||!te.mag())){var Bt=te.div(se);if(this.sum._add(Bt),!(this.sum.mag()<this.clickTolerance)){var mr=k.div(se);return{around:mr,panDelta:Bt}}}}}]),b}(),Hn=function(){function b(){Pe()(this,b),this.enabled=void 0,this.active=void 0,this.firstTwoTouches=void 0,this.vector=void 0,this.startVector=void 0,this.aroundCenter=void 0,this.reset()}return $e()(b,[{key:"reset",value:function(){this.active=!1,delete this.firstTwoTouches}},{key:"start",value:function(c){}},{key:"move",value:function(c,f,m){}},{key:"touchstart",value:function(c,f,m){this.firstTwoTouches||m.length<2||(this.firstTwoTouches=[m[0].identifier,m[1].identifier],this.start([f[0],f[1]]))}},{key:"touchmove",value:function(c,f,m){if(!!this.firstTwoTouches){c.preventDefault();var _=_i()(this.firstTwoTouches,2),k=_[0],te=_[1],se=Ei(m,f,k),he=Ei(m,f,te);if(!(!se||!he)){var Ye=this.aroundCenter?null:se.add(he).div(2);return this.move([se,he],Ye,c)}}}},{key:"touchend",value:function(c,f,m){if(!!this.firstTwoTouches){var _=_i()(this.firstTwoTouches,2),k=_[0],te=_[1],se=Ei(m,f,k),he=Ei(m,f,te);se&&he||(this.active&&Ho.suppressClick(),this.reset())}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(c){this.enabled=!0,this.aroundCenter=!!c&&c.around==="center"}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),b}();function Ei(b,p,c){for(var f=0;f<b.length;f++)if(b[f].identifier===c)return p[f]}function ii(b){var p=Ni();return function(){var f=Sn()(b),m;if(p){var _=Sn()(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return cr()(this,m)}}function Ni(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}function Hi(b){return Math.abs(b.y)>Math.abs(b.x)}var no=100,za=function(b){dr()(c,b);var p=ii(c);function c(){var f;Pe()(this,c);for(var m=arguments.length,_=new Array(m),k=0;k<m;k++)_[k]=arguments[k];return f=p.call.apply(p,[this].concat(_)),f.valid=void 0,f.firstMove=void 0,f.lastPoints=void 0,f}return $e()(c,[{key:"reset",value:function(){dc()(Sn()(c.prototype),"reset",this).call(this),this.valid=void 0,delete this.firstMove,delete this.lastPoints}},{key:"start",value:function(m){this.lastPoints=m,Hi(m[0].sub(m[1]))&&(this.valid=!1)}},{key:"move",value:function(m,_,k){var te=m[0].sub(this.lastPoints[0]),se=m[1].sub(this.lastPoints[1]);if(this.valid=this.gestureBeginsVertically(te,se,k.timeStamp),!!this.valid){this.lastPoints=m,this.active=!0;var he=(te.y+se.y)/2,Ye=-.5;return{pitchDelta:he*Ye}}}},{key:"gestureBeginsVertically",value:function(m,_,k){if(this.valid!==void 0)return this.valid;var te=2,se=m.mag()>=te,he=_.mag()>=te;if(!(!se&&!he)){if(!se||!he)return this.firstMove===void 0&&(this.firstMove=k),k-this.firstMove<no?void 0:!1;var Ye=m.y>0==_.y>0;return Hi(m)&&Hi(_)&&Ye}}}]),c}(Hn);function Mo(b){var p=_a();return function(){var f=Sn()(b),m;if(p){var _=Sn()(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return cr()(this,m)}}function _a(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var Ja=25;function Os(b,p){return b.angleWith(p)*180/Math.PI}var Ls=function(b){dr()(c,b);var p=Mo(c);function c(){var f;Pe()(this,c);for(var m=arguments.length,_=new Array(m),k=0;k<m;k++)_[k]=arguments[k];return f=p.call.apply(p,[this].concat(_)),f.minDiameter=void 0,f}return $e()(c,[{key:"reset",value:function(){dc()(Sn()(c.prototype),"reset",this).call(this),delete this.minDiameter,delete this.startVector,delete this.vector}},{key:"start",value:function(m){this.startVector=this.vector=m[0].sub(m[1]),this.minDiameter=m[0].dist(m[1])}},{key:"move",value:function(m,_){var k=this.vector;if(this.vector=m[0].sub(m[1]),!(!this.active&&this.isBelowThreshold(this.vector)))return this.active=!0,{bearingDelta:Os(this.vector,k),pinchAround:_}}},{key:"isBelowThreshold",value:function(m){this.minDiameter=Math.min(this.minDiameter,m.mag());var _=Math.PI*this.minDiameter,k=Ja/_*360,te=Os(m,this.startVector);return Math.abs(te)<k}}]),c}(Hn);function yu(b){var p=Fu();return function(){var f=Sn()(b),m;if(p){var _=Sn()(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return cr()(this,m)}}function Fu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var Ss=.1;function Bs(b,p){return Math.log(b/p)/Math.LN2}var Bu=function(b){dr()(c,b);var p=yu(c);function c(){var f;Pe()(this,c);for(var m=arguments.length,_=new Array(m),k=0;k<m;k++)_[k]=arguments[k];return f=p.call.apply(p,[this].concat(_)),f.distance=void 0,f.startDistance=void 0,f}return $e()(c,[{key:"reset",value:function(){dc()(Sn()(c.prototype),"reset",this).call(this),delete this.distance,delete this.startDistance}},{key:"start",value:function(m){this.startDistance=this.distance=m[0].dist(m[1])}},{key:"move",value:function(m,_){var k=this.distance;if(this.distance=m[0].dist(m[1]),!(!this.active&&Math.abs(Bs(this.distance,this.startDistance))<Ss))return this.active=!0,{zoomDelta:Bs(this.distance,k),pinchAround:_}}}]),c}(Hn);function xu(b,p){var c;if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(c=qu(b))||p&&b&&typeof b.length=="number"){c&&(b=c);var f=0,m=function(){};return{s:m,n:function(){return f>=b.length?{done:!0}:{done:!1,value:b[f++]}},e:function(he){throw he},f:m}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _=!0,k=!1,te;return{s:function(){c=b[Symbol.iterator]()},n:function(){var he=c.next();return _=he.done,he},e:function(he){k=!0,te=he},f:function(){try{!_&&c.return!=null&&c.return()}finally{if(k)throw te}}}}function qu(b,p){if(!!b){if(typeof b=="string")return $l(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return $l(b,p)}}function $l(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,f=new Array(p);c<p;c++)f[c]=b[c];return f}var ml=function(p){return p.zoom||p.drag||p.pitch||p.rotate};function iu(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta}var pc=function(){function b(p,c){var f=this;Pe()(this,b),this.map=void 0,this.el=void 0,this.handlers=void 0,this.eventsInProgress=void 0,this.frameId=void 0,this.inertia=void 0,this.bearingSnap=void 0,this.handlersById=void 0,this.updatingCamera=void 0,this.changes=void 0,this.previousActiveHandlers=void 0,this.bearingChanged=void 0,this.listeners=void 0,this.handleWindowEvent=function(Lt){f.handleEvent(Lt,"".concat(Lt.type,"Window"))},this.handleEvent=function(Lt,Bt){if(Lt.type==="blur"){f.stop();return}f.updatingCamera=!0;var mr=Lt.type==="renderFrame"?void 0:Lt,yr={needsRenderFrame:!1},Ir={},Xr={},Jr=Lt.touches?f.getMapTouches(Lt.touches):void 0,jn=Jr?Ho.touchPos(f.el,Jr):Ho.mousePos(f.el,Lt),Zn=xu(f.handlers),Ci;try{for(Zn.s();!(Ci=Zn.n()).done;){var mi=Ci.value,la=mi.handlerName,Bi=mi.handler,Yi=mi.allowed;if(!!Bi.isEnabled()){var Ia=void 0;if(f.blockedByActive(Xr,Yi,la))Bi.reset();else{var ka=Bt||Lt.type;Bi&&Bi[ka]&&(Ia=Bi[ka](Lt,jn,Jr),f.mergeIHandlerResult(yr,Ir,Ia,la,mr),Ia&&Ia.needsRenderFrame&&f.triggerRenderFrame())}(Ia||Bi.isActive())&&(Xr[la]=Bi)}}}catch(ia){Zn.e(ia)}finally{Zn.f()}var jo={};for(var Dl in f.previousActiveHandlers)Xr[Dl]||(jo[Dl]=mr);f.previousActiveHandlers=Xr,(Object.keys(jo).length||iu(yr))&&(f.changes.push([yr,Ir,jo]),f.triggerRenderFrame()),(Object.keys(Xr).length||iu(yr))&&f.map.stop(!0),f.updatingCamera=!1;var Ha=yr.cameraAnimation;Ha&&(f.inertia.clear(),f.fireEvents({},{}),f.changes=[],Ha(f.map))},this.map=p,this.el=this.map.getCanvasContainer(),this.handlers=[],this.handlersById={},this.changes=[],this.inertia=new _f(p),this.bearingSnap=c.bearingSnap,this.previousActiveHandlers={},this.eventsInProgress={},this.addDefaultHandlers(c);var m=this.el;this.listeners=[[m,"touchstart",{passive:!1}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[window.document,"mousemove",{capture:!0}],[window.document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];var _=xu(this.listeners),k;try{for(_.s();!(k=_.n()).done;){var te=_i()(k.value,3),se=te[0],he=te[1],Ye=te[2];Ho.addEventListener(se,he,se===window.document?this.handleWindowEvent:this.handleEvent,Ye)}}catch(Lt){_.e(Lt)}finally{_.f()}}return $e()(b,[{key:"destroy",value:function(){var c=xu(this.listeners),f;try{for(c.s();!(f=c.n()).done;){var m=_i()(f.value,3),_=m[0],k=m[1],te=m[2];Ho.removeEventListener(_,k,_===window.document?this.handleWindowEvent:this.handleEvent,te)}}catch(se){c.e(se)}finally{c.f()}}},{key:"stop",value:function(){if(!this.updatingCamera){var c=xu(this.handlers),f;try{for(c.s();!(f=c.n()).done;){var m=f.value.handler;m.reset()}}catch(_){c.e(_)}finally{c.f()}this.inertia.clear(),this.fireEvents({},{}),this.changes=[]}}},{key:"isActive",value:function(){var c=xu(this.handlers),f;try{for(c.s();!(f=c.n()).done;){var m=f.value.handler;if(m.isActive())return!0}}catch(_){c.e(_)}finally{c.f()}return!1}},{key:"isZooming",value:function(){return!!this.eventsInProgress.zoom||this.map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this.eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(ml(this.eventsInProgress))||this.isZooming()}},{key:"mergeIHandlerResult",value:function(c,f,m,_,k){if(!!m){So()(c,m);var te={handlerName:_,originalEvent:m.originalEvent||k};m.zoomDelta!==void 0&&(f.zoom=te),m.panDelta!==void 0&&(f.drag=te),m.pitchDelta!==void 0&&(f.pitch=te),m.bearingDelta!==void 0&&(f.rotate=te)}}},{key:"triggerRenderFrame",value:function(){var c=this;this.frameId===void 0&&(this.frameId=this.map.requestRenderFrame(function(f){delete c.frameId,c.handleEvent(new dl("renderFrame",{timeStamp:f})),c.applyChanges()}))}},{key:"addDefaultHandlers",value:function(c){var f=this.map,m=f.getCanvasContainer();this.add("mapEvent",new Qu(f,c));var _=f.boxZoom=new cc(f,c);this.add("boxZoom",_);var k=new ui,te=new na;f.doubleClickZoom=new rr(te,k),this.add("tapZoom",k),this.add("clickZoom",te);var se=new wn;this.add("tapDragZoom",se);var he=f.touchPitch=new za;this.add("touchPitch",he);var Ye=new oe(c),Lt=new Ke(c);f.dragRotate=new zr(c,Ye,Lt),this.add("mouseRotate",Ye,["mousePitch"]),this.add("mousePitch",Lt,["mouseRotate"]);var Bt=new M(c),mr=new Si(c);f.dragPan=new nr(m,Bt,mr),this.add("mousePan",Bt),this.add("touchPan",mr,["touchZoom","touchRotate"]);var yr=new Ls,Ir=new Bu;f.touchZoomRotate=new pr(m,Ir,yr,se),this.add("touchRotate",yr,["touchPan","touchZoom"]),this.add("touchZoom",Ir,["touchPan","touchRotate"]);var Xr=f.scrollZoom=new jt(f,this);this.add("scrollZoom",Xr,["mousePan"]);var Jr=f.keyboard=new hc;this.add("keyboard",Jr),this.add("blockableMapEvent",new nu(f));for(var jn=0,Zn=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];jn<Zn.length;jn++){var Ci=Zn[jn];c.interactive&&c[Ci]&&f[Ci].enable(c[Ci])}}},{key:"add",value:function(c,f,m){this.handlers.push({handlerName:c,handler:f,allowed:m}),this.handlersById[c]=f}},{key:"blockedByActive",value:function(c,f,m){for(var _ in c)if(_!==m&&(!f||f.indexOf(_)<0))return!0;return!1}},{key:"getMapTouches",value:function(c){var f=[],m=xu(c),_;try{for(m.s();!(_=m.n()).done;){var k=_.value,te=k.target;this.el.contains(te)&&f.push(k)}}catch(se){m.e(se)}finally{m.f()}return f}},{key:"applyChanges",value:function(){var c={},f={},m={},_=xu(this.changes),k;try{for(_.s();!(k=_.n()).done;){var te=_i()(k.value,3),se=te[0],he=te[1],Ye=te[2];se.panDelta&&(c.panDelta=(c.panDelta||new Ki(0,0))._add(se.panDelta)),se.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+se.zoomDelta),se.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+se.bearingDelta),se.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+se.pitchDelta),se.around!==void 0&&(c.around=se.around),se.pinchAround!==void 0&&(c.pinchAround=se.pinchAround),se.noInertia&&(c.noInertia=se.noInertia),So()(f,he),So()(m,Ye)}}catch(Lt){_.e(Lt)}finally{_.f()}this.updateMapTransform(c,f,m),this.changes=[]}},{key:"updateMapTransform",value:function(c,f,m){var _=this.map,k=_.transform;if(!iu(c))return this.fireEvents(f,m);var te=c.panDelta,se=c.zoomDelta,he=c.bearingDelta,Ye=c.pitchDelta,Lt=c.pinchAround,Bt=c.around;Lt!==void 0&&(Bt=Lt),_.stop(!0),Bt=Bt||_.transform.centerPoint;var mr=k.pointLocation(te?Bt.sub(te):Bt);he&&(k.bearing+=he),Ye&&(k.pitch+=Ye),se&&(k.zoom+=se),k.setLocationAtPoint(mr,Bt),this.map.update(),c.noInertia||this.inertia.record(c),this.fireEvents(f,m)}},{key:"fireEvents",value:function(c,f){var m=this,_=ml(this.eventsInProgress),k=ml(c),te={};for(var se in c)if(c[se]){var he=c[se].originalEvent;this.eventsInProgress[se]||(te["".concat(se,"start")]=he),this.eventsInProgress[se]=c[se]}!_&&k&&this.fireEvent("movestart",k.originalEvent);for(var Ye in te)te[Ye]&&this.fireEvent(Ye,te[Ye]);c.rotate&&(this.bearingChanged=!0),k&&this.fireEvent("move",k.originalEvent);for(var Lt in c)if(c[Lt]){var Bt=c[Lt].originalEvent;this.fireEvent(Lt,Bt)}var mr={},yr;for(var Ir in this.eventsInProgress)if(this.eventsInProgress[Ir]){var Xr=this.eventsInProgress[Ir],Jr=Xr.handlerName,jn=Xr.originalEvent;this.handlersById[Jr].isActive()||(delete this.eventsInProgress[Ir],yr=f[Jr]||jn,mr["".concat(Ir,"end")]=yr)}for(var Zn in mr)mr[Zn]&&this.fireEvent(Zn,mr[Zn]);var Ci=ml(this.eventsInProgress);if((_||k)&&!Ci){this.updatingCamera=!0;var mi=this.inertia.onMoveEnd(this.map.dragPan.inertiaOptions),la=function(Yi){return Yi!==0&&-m.bearingSnap<Yi&&Yi<m.bearingSnap};mi?(la(mi.bearing||this.map.getBearing())&&(mi.bearing=0),this.map.easeTo(mi,{originalEvent:yr})):(this.map.emit("moveend",new Gi("moveend",{originalEvent:yr})),la(this.map.getBearing())&&this.map.resetNorth()),this.bearingChanged=!1,this.updatingCamera=!1}}},{key:"fireEvent",value:function(c,f){this.map.emit(c,new Gi(c,f?{originalEvent:f}:{}))}}]),b}(),bu=pc,Eo=a("DzJC"),gl=a.n(Eo),Jl=function(){function b(p){var c=this;Pe()(this,b),this.map=void 0,this.updateHash=void 0,this.hashName=void 0,this.onHashChange=function(){var f=c.getCurrentHash();if(f.length>=3&&!f.some(function(_){return isNaN(+_)})){var m=c.map.dragRotate.isEnabled()&&c.map.touchZoomRotate.isEnabled()?+(f[3]||0):c.map.getBearing();return c.map.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:m,pitch:+(f[4]||0)}),!0}return!1},this.getCurrentHash=function(){var f=window.location.hash.replace("#","");if(c.hashName){var m;return f.split("&").map(function(_){return _.split("=")}).forEach(function(_){_[0]===c.hashName&&(m=_)}),(m&&m[1]||"").split("/")}return f.split("/")},this.updateHashUnthrottled=function(){var f=c.getHashString();try{window.history.replaceState(window.history.state,"",f)}catch(m){}},this.hashName=p&&encodeURIComponent(p),this.updateHash=gl()(this.updateHashUnthrottled,30*1e3/100)}return $e()(b,[{key:"addTo",value:function(c){return this.map=c,window.addEventListener("hashchange",this.onHashChange,!1),this.map.on("moveend",this.updateHash),this}},{key:"remove",value:function(){return window.removeEventListener("hashchange",this.onHashChange,!1),this.map.off("moveend",this.updateHash),delete this.map,this}},{key:"getHashString",value:function(c){var f=this.map.getCenter(),m=Math.round(this.map.getZoom()*100)/100,_=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),k=Math.pow(10,_),te=Math.round(f.lng*k)/k,se=Math.round(f.lat*k)/k,he=this.map.getBearing(),Ye=this.map.getPitch(),Lt="";if(c?Lt+="/".concat(te,"/").concat(se,"/").concat(m):Lt+="".concat(m,"/").concat(se,"/").concat(te),(he||Ye)&&(Lt+="/".concat(Math.round(he*10)/10)),Ye&&(Lt+="/".concat(Math.round(Ye))),this.hashName){var Bt=this.hashName,mr=!1,yr=window.location.hash.slice(1).split("&").map(function(Ir){var Xr=Ir.split("=")[0];return Xr===Bt?(mr=!0,"".concat(Xr,"=").concat(Lt)):Ir}).filter(function(Ir){return Ir});return mr||yr.push("".concat(Bt,"=").concat(Lt)),"#".concat(yr.join("&"))}return"#".concat(Lt)}}]),b}(),Rs=Jl,To=null,vo=[],es=30,Ao=1e3/es,io=window.performance,ts={create:"create",load:"load",fullLoad:"fullLoad"},yl={mark:function(p){io.mark(p)},frame:function(p){var c=p;if(To!=null){var f=c-To;vo.push(f)}To=c},clearMetrics:function(){To=null,vo=[],io.clearMeasures("loadTime"),io.clearMeasures("fullLoadTime");for(var p in ts)io.clearMarks(ts[p])},getPerformanceMetrics:function(){var p=io.measure("loadTime",ts.create,ts.load).duration,c=io.measure("fullLoadTime",ts.create,ts.fullLoad).duration,f=vo.length,m=vo.reduce(function(se,he){return se+he},0)/f/1e3,_=1/m,k=vo.filter(function(se){return se>Ao}).reduce(function(se,he){return se+(he-Ao)/Ao},0),te=k/(f+k)*100;return{loadTime:p,fullLoadTime:c,fps:_,percentDroppedFrames:te}}};function Pc(b,p){var c;if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(c=Xc(b))||p&&b&&typeof b.length=="number"){c&&(b=c);var f=0,m=function(){};return{s:m,n:function(){return f>=b.length?{done:!0}:{done:!1,value:b[f++]}},e:function(he){throw he},f:m}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _=!0,k=!1,te;return{s:function(){c=b[Symbol.iterator]()},n:function(){var he=c.next();return _=he.done,he},e:function(he){k=!0,te=he},f:function(){try{!_&&c.return!=null&&c.return()}finally{if(k)throw te}}}}function Xc(b,p){if(!!b){if(typeof b=="string")return el(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return el(b,p)}}function el(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,f=new Array(p);c<p;c++)f[c]=b[c];return f}var vc=function(){function b(){Pe()(this,b),this.queue=void 0,this.id=void 0,this.cleared=void 0,this.currentlyRunning=void 0,this.queue=[],this.id=0,this.cleared=!1,this.currentlyRunning=!1}return $e()(b,[{key:"add",value:function(c){var f=++this.id,m=this.queue;return m.push({callback:c,id:f,cancelled:!1}),f}},{key:"remove",value:function(c){var f=this.currentlyRunning,m=f?this.queue.concat(f):this.queue,_=Pc(m),k;try{for(_.s();!(k=_.n()).done;){var te=k.value;if(te.id===c){te.cancelled=!0;return}}}catch(se){_.e(se)}finally{_.f()}}},{key:"run",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,f=this.currentlyRunning=this.queue;this.queue=[];var m=Pc(f),_;try{for(m.s();!(_=m.n()).done;){var k=_.value;if(!k.cancelled&&(k.callback(c),this.cleared))break}}catch(te){m.e(te)}finally{m.f()}this.cleared=!1,this.currentlyRunning=!1}},{key:"clear",value:function(){this.currentlyRunning&&(this.cleared=!0),this.queue=[]}}]),b}(),Ol=vc;function Hs(b){var p=Fo();return function(){var f=Sn()(b),m;if(p){var _=Sn()(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return cr()(this,m)}}function Fo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}a("BGjm")(`/* @antv/l7-map */
.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var Ql=-2,Es=22,ql=0,hf=60,Zf={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:Ql,maxZoom:Es,minPitch:ql,maxPitch:hf,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0},lh=function(b){dr()(c,b);var p=Hs(c);function c(f){var m;Pe()(this,c),m=p.call(this,So()({},Zf,f)),m.doubleClickZoom=void 0,m.dragRotate=void 0,m.dragPan=void 0,m.touchZoomRotate=void 0,m.scrollZoom=void 0,m.keyboard=void 0,m.touchPitch=void 0,m.boxZoom=void 0,m.handlers=void 0,m.container=void 0,m.canvas=void 0,m.canvasContainer=void 0,m.renderTaskQueue=new Ol,m.frame=void 0,m.trackResize=!0,m.hash=void 0,m.onWindowOnline=function(){m.update()},m.onWindowResize=function(k){m.trackResize&&m.resize({originalEvent:k}).update()},m.initContainer(),m.resize(),m.handlers=new bu(Cc()(m),m.options),typeof window!="undefined"&&(window.addEventListener("online",m.onWindowOnline,!1),window.addEventListener("resize",m.onWindowResize,!1),window.addEventListener("orientationchange",m.onWindowResize,!1));var _=typeof f.hash=="string"&&f.hash||void 0;return f.hash&&(m.hash=new Rs(_).addTo(Cc()(m))),(!m.hash||!m.hash.onHashChange())&&(m.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch}),f.bounds&&(m.resize(),m.fitBounds(f.bounds,So()({},f.fitBoundsOptions,{duration:0})))),m}return $e()(c,[{key:"resize",value:function(m){var _=this.containerDimensions(),k=_[0],te=_[1];this.transform.resize(k,te);var se=!this.moving;return se&&(this.stop(),this.emit("movestart",new Event("movestart",m)),this.emit("move",new Event("move",m))),this.emit("resize",new Event("resize",m)),se&&this.emit("moveend",new Event("moveend",m)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(m){return this.transform.locationPoint(ya.convert(m))}},{key:"unproject",value:function(m){return this.transform.pointLocation(Ki.convert(m))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(m){this.transform.setMaxBounds(zo.convert(m))}},{key:"setStyle",value:function(m){}},{key:"setMinZoom",value:function(m){if(m=m==null?Ql:m,m>=Ql&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between ".concat(Ql," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(m){if(m=m==null?Es:m,m>=this.transform.minZoom)return this.transform.maxZoom=m,this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(m){if(m=m==null?ql:m,m<ql)throw new Error("minPitch must be greater than or equal to ".concat(ql));if(m>=ql&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between ".concat(ql," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(m){if(m=m==null?hf:m,m>hf)throw new Error("maxPitch must be less than or equal to ".concat(hf));if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(m){this.transform.renderWorldCopies=!!m}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(m){return this.update(),this.renderTaskQueue.add(m)}},{key:"cancelRenderFrame",value:function(m){return this.renderTaskQueue.remove(m)}},{key:"triggerRepaint",value:function(){var m=this;this.frame||(this.frame=wf(function(_){yl.frame(_),m.frame=null,m.update(_)}))}},{key:"update",value:function(m){var _=this;this.frame||(this.frame=wf(function(k){yl.frame(k),_.frame=null,_.renderTaskQueue.run(m)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var m=this.container;m.classList.add("l7-map");var _=this.canvasContainer=pn.a.create("div","l7-canvas-container",m);this.options.interactive&&_.classList.add("l7-interactive")}},{key:"containerDimensions",value:function(){var m=0,_=0;return this.container&&(m=this.container.clientWidth||400,_=this.container.clientHeight||300),[m,_]}},{key:"resizeCanvas",value:function(m,_){var k=pn.a.DPR||1;this.canvas.width=k*m,this.canvas.height=k*_,this.canvas.style.width="".concat(m,"px"),this.canvas.style.height="".concat(_,"px")}}]),c}(Vs),xl=function(){function b(){Pe()(this,b),this.viewport=void 0}return $e()(b,[{key:"syncWithMapCamera",value:function(c){var f=c.center,m=c.zoom,_=c.pitch,k=c.bearing,te=c.viewportHeight,se=c.viewportWidth;this.viewport=new Bc({width:se,height:te,longitude:f&&f[0],latitude:f&&f[1],zoom:m,pitch:_,bearing:k})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,f){return this.viewport.projectFlat(c,f)}}]),b}(),Mf={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},df,Bf,ku,mc,Wf,_c,Mc,Ic,Xf,Yf,Kf,If,ch,ec;function Yc(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(b);p&&(f=f.filter(function(m){return Object.getOwnPropertyDescriptor(b,m).enumerable})),c.push.apply(c,f)}return c}function mo(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?Yc(Object(c),!0).forEach(function(f){fi()(b,f,c[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):Yc(Object(c)).forEach(function(f){Object.defineProperty(b,f,Object.getOwnPropertyDescriptor(c,f))})}return b}var tc={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Of=12,Kc=(df=Object(hi.injectable)(),Bf=Object(hi.inject)(ae.TYPES.MapConfig),ku=Object(hi.inject)(ae.TYPES.IGlobalConfigService),mc=Object(hi.inject)(ae.TYPES.ILogService),Wf=Object(hi.inject)(ae.TYPES.ICoordinateSystemService),_c=Object(hi.inject)(ae.TYPES.IEventEmitter),df(Mc=(Ic=(ec=function(){function b(){var p=this;Pe()(this,b),this.map=void 0,Gn()(this,"config",Xf,this),Gn()(this,"configService",Yf,this),Gn()(this,"logger",Kf,this),Gn()(this,"coordinateSystemService",If,this),Gn()(this,"eventEmitter",ch,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=p.map.getCenter(),f=c.lat,m=c.lng,_=p.config.offsetCoordinate,k=_===void 0?!0:_;p.viewport.syncWithMapCamera({bearing:p.map.getBearing(),center:[m,f],viewportHeight:p.map.transform.height,pitch:p.map.getPitch(),viewportWidth:p.map.transform.width,zoom:p.map.getZoom(),cameraHeight:0}),p.viewport.getZoom()>Of&&k?p.coordinateSystemService.setCoordinateSystem(ae.CoordinateSystem.LNGLAT_OFFSET):p.coordinateSystemService.setCoordinateSystem(ae.CoordinateSystem.LNGLAT),p.cameraChangedCallback(p.viewport)}}return $e()(b,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=pn.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,f){ae.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,f):this.map.on(tc[c]||c,f)}},{key:"off",value:function(c,f){this.map.off(tc[c]||c,f)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,f){this.map.zoomIn(c,f)}},{key:"zoomOut",value:function(c,f){this.map.zoomOut(c,f)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,f){this.map.fitBounds(c,f)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.dragEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,f){this.map.flyTo({zoom:c,center:f})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,f){throw new Error("not implement")}},{key:"getModelMatrix",value:function(c,f,m){var _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],k=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0};throw new Error("not implement")}},{key:"init",value:function(){var p=fn()(An.a.mark(function f(){var m,_,k,te,se,he,Ye,Lt,Bt,mr,yr;return An.a.wrap(function(Xr){for(;;)switch(Xr.prev=Xr.next){case 0:m=this.config,_=m.id,k=_===void 0?"map":_,te=m.attributionControl,se=te===void 0?!1:te,he=m.style,Ye=he===void 0?"light":he,Lt=m.rotation,Bt=Lt===void 0?0:Lt,mr=m.mapInstance,yr=Cr()(m,["id","attributionControl","style","rotation","mapInstance"]),this.viewport=new xl,mr?(this.map=mr,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(k),this.map=new lh(mo({container:this.$mapContainer,style:this.getMapStyle(Ye),bearing:Bt},yr))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 6:case"end":return Xr.stop()}},f,this)}));function c(){return p.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var f,m=arguments.length,_=new Array(m>1?m-1:0),k=1;k<m;k++)_[k-1]=arguments[k];(f=this.eventEmitter).emit.apply(f,[c].concat(_))}},{key:"once",value:function(c){for(var f,m=arguments.length,_=new Array(m>1?m-1:0),k=1;k<m;k++)_[k-1]=arguments[k];(f=this.eventEmitter).once.apply(f,[c].concat(_))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var f=this.map.getCanvas(),m=c==="jpg"?f==null?void 0:f.toDataURL("image/jpeg"):f==null?void 0:f.toDataURL("image/png");return m}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var f=c;return typeof c=="string"&&(f=document.getElementById(c)),f}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:Mf[c]?Mf[c]:c}}]),b}(),ec),Xf=pe()(Ic.prototype,"config",[Bf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yf=pe()(Ic.prototype,"configService",[ku],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kf=pe()(Ic.prototype,"logger",[mc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),If=pe()(Ic.prototype,"coordinateSystemService",[Wf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ch=pe()(Ic.prototype,"eventEmitter",[_c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ic))||Mc);function au(b){var p=Ll();return function(){var f=Sn()(b),m;if(p){var _=Sn()(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return cr()(this,m)}}function Ll(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}var Lf=function(b){dr()(c,b);var p=au(c);function c(){return Pe()(this,c),p.apply(this,arguments)}return $e()(c,[{key:"getServiceConstructor",value:function(){return Kc}}]),c}(or);function Rf(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(b);p&&(f=f.filter(function(m){return Object.getOwnPropertyDescriptor(b,m).enumerable})),c.push.apply(c,f)}return c}function Oc(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?Rf(Object(c),!0).forEach(function(f){pf(b,f,c[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):Rf(Object(c)).forEach(function(f){Object.defineProperty(b,f,Object.getOwnPropertyDescriptor(c,f))})}return b}function pf(b,p,c){return p in b?Object.defineProperty(b,p,{value:c,enumerable:!0,configurable:!0,writable:!0}):b[p]=c,b}function $c(b,p){return U(b)||D(b,p)||ee(b,p)||Rl()}function Rl(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ee(b,p){if(!!b){if(typeof b=="string")return ie(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return ie(b,p)}}function ie(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,f=new Array(p);c<p;c++)f[c]=b[c];return f}function D(b,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))){var c=[],f=!0,m=!1,_=void 0;try{for(var k=b[Symbol.iterator](),te;!(f=(te=k.next()).done)&&(c.push(te.value),!(p&&c.length===p));f=!0);}catch(se){m=!0,_=se}finally{try{!f&&k.return!=null&&k.return()}finally{if(m)throw _}}return c}}function U(b){if(Array.isArray(b))return b}var Se=st.a.memo(function(b){var p=b.style,c=b.className,f=b.map,m=b.option,_=b.onSceneLoaded,k=b.children,te=Object(ce.useRef)(null),se=Object(ce.useState)(),he=$c(se,2),Ye=he[0],Lt=he[1];return Object(ce.useEffect)(function(){var Bt=new Pt.Scene(Oc(Oc({id:te.current},m),{},{map:new Lf(f)}));return Bt.on("loaded",function(){Lt(Bt),_&&_(Bt)}),function(){Bt.destroy()}},[]),Object(ce.useEffect)(function(){Ye&&f.style&&Ye.setMapStyle(f.style)},[JSON.stringify(f.style)]),Object(ce.useEffect)(function(){Ye&&f.zoom&&Ye.setZoom(f.zoom)},[f.zoom]),Object(ce.useEffect)(function(){Ye&&f.center&&Ye.setCenter(f.center)},[JSON.stringify(f.center)]),Object(ce.useEffect)(function(){Ye&&f.pitch&&Ye.setPitch(f.pitch)},[f.pitch]),Object(ce.useEffect)(function(){Ye&&f.rotation&&Ye.setRotation(f.rotation)},[f.rotation]),st.a.createElement(ct.Provider,{value:Ye},st.a.createElement("div",{ref:te,className:c,style:p},Ye&&k))}),tt=Se;function Ut(b,p){return Rn(b)||en(b,p)||er(b,p)||qt()}function qt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function er(b,p){if(!!b){if(typeof b=="string")return _r(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return _r(b,p)}}function _r(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,f=new Array(p);c<p;c++)f[c]=b[c];return f}function en(b,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))){var c=[],f=!0,m=!1,_=void 0;try{for(var k=b[Symbol.iterator](),te;!(f=(te=k.next()).done)&&(c.push(te.value),!(p&&c.length===p));f=!0);}catch(se){m=!0,_=se}finally{try{!f&&k.return!=null&&k.return()}finally{if(m)throw _}}return c}}function Rn(b){if(Array.isArray(b))return b}var $n=st.a.memo(function(b){var p=b.style,c=b.className,f=b.map,m=b.children,_=Object(ce.useRef)(null),k=Object(ce.useState)(),te=Ut(k,2),se=te[0],he=te[1];return Object(ce.useEffect)(function(){var Ye=new Pt.Scene({id:_.current,map:f});return Ye.on("loaded",function(){he(Ye)}),function(){Ye.destroy()}},[]),st.a.createElement(ct.Provider,{value:se},st.a.createElement("div",{ref:_,className:c,style:p},se&&m))}),ri=st.a.memo(function(p){var c=ht(),f=Object(ce.useRef)(),m=p.type,_=p.position;return Object(ce.useEffect)(function(){var k;switch(m){case"scale":k=new Pt.Scale({position:_||"bottomright"});break;case"zoom":k=new Pt.Zoom({position:_||"topright"});break;case"logo":k=new Pt.Logo({position:_||"bottomleft"})}return f.current=k,c.addControl(k),function(){f.current=void 0,c.removeControl(k)}},[m]),Object(ce.useEffect)(function(){f.current&&f.current.setPosition(_)},[_]),null}),Mi=a("i8i4");function Ri(b,p){return ao(b)||go(b,p)||ua(b,p)||fa()}function fa(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ua(b,p){if(!!b){if(typeof b=="string")return Na(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Na(b,p)}}function Na(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,f=new Array(p);c<p;c++)f[c]=b[c];return f}function go(b,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))){var c=[],f=!0,m=!1,_=void 0;try{for(var k=b[Symbol.iterator](),te;!(f=(te=k.next()).done)&&(c.push(te.value),!(p&&c.length===p));f=!0);}catch(se){m=!0,_=se}finally{try{!f&&k.return!=null&&k.return()}finally{if(m)throw _}}return c}}function ao(b){if(Array.isArray(b))return b}var Va=ce.useEffect,Co=ce.useState;function Xi(b){var p=b.className,c=b.style,f=b.children,m=b.position,_=ht(),k=Co(function(){return document.createElement("div")}),te=Ri(k,1),se=te[0];return Va(function(){var he=new Pt.Control({position:m});return he.onAdd=function(){if(p&&(se.className=p),c){var Ye=Object.keys(c).map(function(Lt){return"".concat(Lt,":").concat(c[Lt])}).join(";");se.style.cssText=Ye}return se},_.addControl(he),function(){_.removeControl(he)}},[]),Object(Mi.createPortal)(f,se)}var Qa=Object(ce.createContext)({});function ls(){return Object(ce.useContext)(Qa)}var Sa=ce.useEffect,Ma=ce.memo(function(p){var c=p.layer,f=p.active;return Sa(function(){c.active(f.option)},[JSON.stringify(f)]),null}),gi=ce.useEffect,Bo=ce.memo(function(p){var c=p.layer,f=p.animate;return gi(function(){c.animate(f)},[JSON.stringify(f)]),null}),gc=ce.useEffect,$f=ce.memo(function(p){var c=p.layer,f=p.color;return gc(function(){f.field?c.color(f.field,f.values):c.color(f.values)},[f.field,f.scale,JSON.stringify(f.values),JSON.stringify(f.options)]),null}),vh=ce.useEffect,Jf=ce.memo(function(p){var c=p.layer,f=p.filter;return vh(function(){f.field&&c.filter(f.field,f.values)},[f.field,f.values,JSON.stringify(f.values),JSON.stringify(f.options)]),null}),ju=ce.useEffect,Qf=ce.memo(function(p){var c=p.layer,f=p.scale;return ju(function(){c.scale(f.values)},[f.values]),null}),vf=ce.useEffect,qf=ce.memo(function(p){var c=p.layer,f=p.select;return vf(function(){c.select(f.option)},[JSON.stringify(f)]),null}),Ph=ce.useEffect,mh=ce.memo(function(p){var c=p.layer,f=p.shape;return Ph(function(){f.field?c.shape(f.field,f.values):c.shape(f.values)},[f.field,JSON.stringify(f.values),JSON.stringify(f.options)]),null}),Df=ce.useEffect,fh=ce.memo(function(p){var c=p.layer,f=p.size;return Df(function(){f.field?c.size(f.field,f.values):c.size(f.values)},[f.field,f.scale,JSON.stringify(f.values),JSON.stringify(f.options)]),null});function eh(b,p){if(b==null)return{};var c=gh(b,p),f,m;if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(b);for(m=0;m<_.length;m++)f=_[m],!(p.indexOf(f)>=0)&&(!Object.prototype.propertyIsEnumerable.call(b,f)||(c[f]=b[f]))}return c}function gh(b,p){if(b==null)return{};var c={},f=Object.keys(b),m,_;for(_=0;_<f.length;_++)m=f[_],!(p.indexOf(m)>=0)&&(c[m]=b[m]);return c}var jh=ce.useEffect,kf=ce.memo(function(p){var c=p.layer,f=p.source,m=f.data,_=eh(f,["data"]);return jh(function(){c.inited?c.setData(m,_):c.source(m,_),_.autoFit&&c.fitBounds(_&&_.fitBoundsOptions)},[m,JSON.stringify(_)]),null}),jf=ce.useEffect,_h=ce.memo(function(p){var c=p.layer,f=p.style;return jf(function(){c.style(f)},Object.keys(f).map(function(m){return f[m]})),null});function xe(b,p){return Pr(b)||Rr(b,p)||At(b,p)||Fe()}function Fe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function At(b,p){if(!!b){if(typeof b=="string")return xr(b,p);var c=Object.prototype.toString.call(b).slice(8,-1);if(c==="Object"&&b.constructor&&(c=b.constructor.name),c==="Map"||c==="Set")return Array.from(b);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return xr(b,p)}}function xr(b,p){(p==null||p>b.length)&&(p=b.length);for(var c=0,f=new Array(p);c<p;c++)f[c]=b[c];return f}function Rr(b,p){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(b)))){var c=[],f=!0,m=!1,_=void 0;try{for(var k=b[Symbol.iterator](),te;!(f=(te=k.next()).done)&&(c.push(te.value),!(p&&c.length===p));f=!0);}catch(se){m=!0,_=se}finally{try{!f&&k.return!=null&&k.return()}finally{if(m)throw _}}return c}}function Pr(b){if(Array.isArray(b))return b}var br=ce.useEffect,Yr=ce.useState;function tn(b,p){var c=p.source,f=p.color,m=p.shape,_=p.style,k=p.size,te=p.scale,se=p.active,he=p.select,Ye=p.filter,Lt=p.animate,Bt=p.options,mr=p.onLayerLoaded,yr=ht(),Ir=Yr(),Xr=xe(Ir,2),Jr=Xr[0],jn=Xr[1];if(!Jr){var Zn;switch(b){case"polygonLayer":Zn=new Pt.PolygonLayer(Bt);break;case"lineLayer":Zn=new Pt.LineLayer(Bt);break;case"pointLayer":Zn=new Pt.PointLayer(Bt);break;case"heatmapLayer":Zn=new Pt.HeatmapLayer(Bt);break;case"rasterLayer":Zn=new Pt.RasterLayer(Bt);break;case"imageLayer":Zn=new Pt.ImageLayer(Bt);break;case"citybuildingLayer":Zn=new Pt.CityBuildingLayer(Bt);break;default:Zn=new Pt.PolygonLayer(Bt)}Zn.on("inited",function(){mr&&mr(Zn,yr)}),jn(Zn)}return br(function(){if(Jr!==void 0)return yr.addLayer(Jr),function(){yr.removeLayer(Jr)}},[]),br(function(){Jr&&Jr.inited&&Bt&&(Jr.updateLayerConfig(Bt),yr.render())},[Bt==null?void 0:Bt.minZoom,Bt==null?void 0:Bt.maxZoom,Bt==null?void 0:Bt.visible]),br(function(){Jr&&Jr.inited&&Bt&&Bt.zIndex&&Jr.setIndex(Bt.zIndex)},[Bt==null?void 0:Bt.zIndex]),br(function(){Jr&&Jr.inited&&Bt&&Bt.blend&&Jr.setBlend(Bt.blend)},[Bt==null?void 0:Bt.blend]),br(function(){Jr&&yr.render()},[]),Jr!=null?ce.createElement(Qa.Provider,{value:Jr},ce.createElement(kf,{layer:Jr,source:c}),te&&ce.createElement(Qf,{layer:Jr,scale:te}),f&&ce.createElement($f,{layer:Jr,color:f}),k&&ce.createElement(fh,{layer:Jr,size:k}),m&&ce.createElement(mh,{layer:Jr,shape:m}),_&&ce.createElement(_h,{layer:Jr,style:_}),se&&ce.createElement(Ma,{layer:Jr,active:se}),he&&ce.createElement(qf,{layer:Jr,select:he}),Ye&&ce.createElement(Jf,{layer:Jr,filter:Ye}),Lt&&ce.createElement(Bo,{layer:Jr,animate:Lt}),p.children):null}var on=ce.memo(function(p){return tn("polygonLayer",p)}),rn=ce.memo(function(p){return tn("lineLayer",p)}),cn=ce.memo(function(p){return tn("pointLayer",p)}),Pn=ce.memo(function(p){return tn("heatmapLayer",p)}),mn=ce.memo(function(p){return tn("rasterLayer",p)}),un=ce.memo(function(p){return tn("imageLayer",p)}),Sr=ce.memo(function(p){return tn("citybuildingLayer",p)}),gr=ce.useEffect,Kr=ce.memo(function(b){var p=b.type,c=b.handler,f=ls();return gr(function(){return f.off(p,c),f.on(p,c),function(){f.off(p,c)}},[p,c]),null}),On=ce.memo(function(b){var p=[{title:"1",color:"rgb(239,243,255)"},{title:"10",color:"rgb(198,219,239)"},{title:"30",color:"rgb(158,202,225)"},{title:"50",color:"rgb(107,174,214)"},{title:"60",color:"rgb(49,130,189)"},{title:"100",color:"rgb(8,81,156)"}],c=b.items,f=c===void 0?p:c;return ce.createElement("div",null,ce.createElement("div",null,f.map(function(m,_){return ce.createElement("div",{key:_,style:{background:m.color,height:"100%",display:"inline-block",cursor:"pointer",width:""+(100-f.length)/f.length+"%",marginRight:"1%",padding:5}})})),ce.createElement("div",null,f.map(function(m,_){return ce.createElement("div",{key:_,style:{background:"#fff",height:"100%",display:"inline-block",textAlign:"left",cursor:"pointer",width:""+(100-f.length)/f.length+"%",marginRight:"1%"}},m.title)})))});function Dr(b){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Dr=function(c){return typeof c}:Dr=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Dr(b)}function Qn(b,p){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(b);p&&(f=f.filter(function(m){return Object.getOwnPropertyDescriptor(b,m).enumerable})),c.push.apply(c,f)}return c}function qr(b){for(var p=1;p<arguments.length;p++){var c=arguments[p]!=null?arguments[p]:{};p%2?Qn(Object(c),!0).forEach(function(f){Gr(b,f,c[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):Qn(Object(c)).forEach(function(f){Object.defineProperty(b,f,Object.getOwnPropertyDescriptor(c,f))})}return b}function Gr(b,p,c){return p in b?Object.defineProperty(b,p,{value:c,enumerable:!0,configurable:!0,writable:!0}):b[p]=c,b}function Hr(b,p){if(!(b instanceof p))throw new TypeError("Cannot call a class as a function")}function Qr(b,p){for(var c=0;c<p.length;c++){var f=p[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}}function Yn(b,p,c){return p&&Qr(b.prototype,p),c&&Qr(b,c),b}function ai(b,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(p&&p.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),p&&ln(b,p)}function ln(b,p){return ln=Object.setPrototypeOf||function(f,m){return f.__proto__=m,f},ln(b,p)}function Wr(b){var p=di();return function(){var f=Nn(b),m;if(p){var _=Nn(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return jr(this,m)}}function jr(b,p){return p&&(Dr(p)==="object"||typeof p=="function")?p:vi(b)}function vi(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}function di(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}function Nn(b){return Nn=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},Nn(b)}var ea=function(b){ai(c,b);var p=Wr(c);function c(f){var m;return Hr(this,c),m=p.call(this,f),m.el=document.createElement("div"),m}return Yn(c,[{key:"componentDidMount",value:function(){var m,_=this.props,k=_.lnglat,te=_.children,se=_.option,he=_.lngLat,Ye=new Pt.Popup(qr(qr({},se),{},{stopPropagation:(m=this.props.option)===null||m===void 0?void 0:m.stopPropagation}));k&&Ye.setLnglat(k),he&&Ye.setLnglat(he),te&&Ye.setDOMContent(this.el),this.popup=Ye,this.scene.addPopup(Ye)}},{key:"componentDidUpdate",value:function(m){var _,k,te,se,he,Ye,Lt=Array.isArray(m.lnglat)?m.lnglat:[m==null||(_=m.lnglat)===null||_===void 0?void 0:_.lng,m==null||(k=m.lnglat)===null||k===void 0?void 0:k.lat],Bt=Array.isArray(this.props.lnglat)?this.props.lnglat:[(te=this.props)===null||te===void 0||(se=te.lnglat)===null||se===void 0?void 0:se.lng,(he=this.props)===null||he===void 0||(Ye=he.lnglat)===null||Ye===void 0?void 0:Ye.lat],mr=Lt.toString()!==Bt.toString();if(mr){var yr;this.popup.remove(),this.popup=new Pt.Popup(qr(qr({},this.props.option),{},{stopPropagation:(yr=this.props.option)===null||yr===void 0?void 0:yr.stopPropagation})),this.popup.setLnglat(this.props.lnglat),this.popup.setDOMContent(this.el),this.scene.addPopup(this.popup)}}},{key:"componentWillUnmount",value:function(){this.popup.remove()}},{key:"render",value:function(){var m=this;return ce.createElement(ct.Consumer,{},function(_){return _&&(m.scene=_),Object(Mi.createPortal)(m.props.children,m.el)})}}]),c}(ce.PureComponent);function Ai(b){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ai=function(c){return typeof c}:Ai=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Ai(b)}function Ji(b,p){if(!(b instanceof p))throw new TypeError("Cannot call a class as a function")}function ma(b,p){for(var c=0;c<p.length;c++){var f=p[c];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}}function Xo(b,p,c){return p&&ma(b.prototype,p),c&&ma(b,c),b}function Ts(b,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(p&&p.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),p&&ta(b,p)}function ta(b,p){return ta=Object.setPrototypeOf||function(f,m){return f.__proto__=m,f},ta(b,p)}function wo(b){var p=rs();return function(){var f=ko(b),m;if(p){var _=ko(this).constructor;m=Reflect.construct(f,arguments,_)}else m=f.apply(this,arguments);return Fa(this,m)}}function Fa(b,p){return p&&(Ai(p)==="object"||typeof p=="function")?p:As(b)}function As(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}function rs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(b){return!1}}function ko(b){return ko=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},ko(b)}var cs=function(b){Ts(c,b);var p=wo(c);function c(f){var m;return Ji(this,c),m=p.call(this,f),m.el=document.createElement("div"),m}return Xo(c,[{key:"componentDidMount",value:function(){var m=this.props,_=m.lnglat,k=m.children,te=m.option,se=m.onMarkerLoaded,he=new Pt.Marker(te);_&&he.setLnglat(_),k&&he.setElement(this.el),this.marker=he,se&&se(he),this.scene.addMarker(he)}},{key:"componentDidUpdate",value:function(m){var _,k=(m==null?void 0:m.lnglat.toString())!==((_=this.props)===null||_===void 0?void 0:_.lnglat.toString());k&&this.marker.setLnglat(this.props.lnglat)}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.remove()}},{key:"render",value:function(){var m=this;return ce.createElement(ct.Consumer,{},function(_){return _&&(m.scene=_),Object(Mi.createPortal)(m.props.children,m.el)})}}]),c}(ce.PureComponent),Zs=ce.useEffect,Yo=ce.memo(function(b){var p=b.type,c=b.handler,f=ht();return Zs(function(){return f.on(p,c),function(){f.off(p,c)}},[p]),null}),oi=Yo,ou=ce.useEffect,Ba=ce.memo(function(p){var c=p.name,f=p.url,m=ht();return ou(function(){m.addImage(c,f)},[c,f]),null}),_n=a("95SA"),Fi=["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],Qi=function(b){Object(q.a)(c,b);var p=Object(Ce.a)(c);function c(){var f;Object(F.a)(this,c);for(var m=arguments.length,_=new Array(m),k=0;k<m;k++)_[k]=arguments[k];return f=p.call.apply(p,[this].concat(_)),f.state={data:null,grid:null,loading:!1},f}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var f=Object(ur.a)(Gt.a.mark(function _(){var k,te,se,he;return Gt.a.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Lt.next=2,Promise.all([fetch("https://gw.alipayobjects.com/os/bmw-prod/c5dba875-b6ea-4e88-b778-66a862906c93.json").then(function(Bt){return Bt.json()}),fetch("https://gw.alipayobjects.com/os/bmw-prod/8990e8b4-c58e-419b-afb9-8ea3daff2dd1.json").then(function(Bt){return Bt.json()})]);case 2:k=Lt.sent,te=Object(J.a)(k,2),se=te[0],he=te[1],this.setState({data:se,grid:he,loading:!0});case 7:case"end":return Lt.stop()}},_,this)}));function m(){return f.apply(this,arguments)}return m}()},{key:"render",value:function(){var m=this.state,_=m.data,k=m.grid,te=m.loading;return te===!1?Object(De.jsx)(_n.a,{}):Object(De.jsxs)(Ul,{map:{center:[110.19382669582967,50.258134],pitch:0,style:"blank",zoom:1},style:{position:"relative",width:"100%",height:"452px"},children:[k&&Object(De.jsx)(Pn,{source:{data:k,transforms:[{type:"hexagon",size:8e5,field:"capacity",method:"sum"}]},color:{values:"#ddd"},shape:{values:"hexagon"},style:{coverage:.7,opacity:.8}},"1"),_&&[Object(De.jsx)(cn,{options:{autoFit:!0},source:{data:_},scale:{values:{color:{field:"cum_conf",type:"quantile"},size:{field:"cum_conf",type:"log"}}},color:{field:"cum_conf",values:Fi},shape:{values:"circle"},active:{option:{color:"#0c2c84"}},size:{field:"cum_conf",values:[0,30]},style:{opacity:.8}},"2"),Object(De.jsx)(cn,{source:{data:_},color:{values:"#fff"},shape:{field:"Short_Name_ZH",values:"text"},filter:{field:"cum_conf",values:function(he){return he>2e3}},size:{values:12},style:{opacity:1,strokeOpacity:1,strokeWidth:0}},"5")]]})}}]),c}(ce.Component),fs={Pie:R,WaterWave:re,Gauge:St,MiniArea:V,TagCloud:nt,Map:Qi},Ws=a("oBTY"),Lc=a("H+7v"),wt=a.n(Lc);function Tr(b){return b*1<10?"0".concat(b):b}function vr(){for(var b=[],p=0;p<24;p+=1)b.push({x:"".concat(Tr(p),":00"),y:Math.floor(Math.random()*200)+p*50});return b}var Dn=function(b){Object(q.a)(c,b);var p=Object(Ce.a)(c);function c(){var f;Object(F.a)(this,c);for(var m=arguments.length,_=new Array(m),k=0;k<m;k++)_[k]=arguments[k];return f=p.call.apply(p,[this].concat(_)),f.state={activeData:vr()},f.timer=void 0,f.requestRef=void 0,f.loopData=function(){f.requestRef=requestAnimationFrame(function(){f.timer=window.setTimeout(function(){f.setState({activeData:vr()},function(){f.loopData()})},1e3)})},f}return Object(K.a)(c,[{key:"componentDidMount",value:function(){this.loopData()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.requestRef&&cancelAnimationFrame(this.requestRef)}},{key:"render",value:function(){var m=this.state.activeData,_=m===void 0?[]:m;return Object(De.jsxs)("div",{className:wt.a.activeChart,children:[Object(De.jsx)(He.a,{title:"\u76EE\u6807\u8BC4\u4F30",value:"\u6709\u671B\u8FBE\u5230\u9884\u671F"}),Object(De.jsx)("div",{style:{marginTop:32},children:Object(De.jsx)(V,{animate:!1,line:!0,borderWidth:2,height:84,scale:{y:{tickCount:3}},yAxis:{tickLine:void 0,label:void 0,title:void 0,line:void 0},data:_})}),_&&Object(De.jsxs)("div",{children:[Object(De.jsxs)("div",{className:wt.a.activeChartGrid,children:[Object(De.jsxs)("p",{children:[Object(Ws.a)(_).sort()[_.length-1].y+200," \u4EBF\u5143"]}),Object(De.jsxs)("p",{children:[Object(Ws.a)(_).sort()[Math.floor(_.length/2)].y," \u4EBF\u5143"]})]}),Object(De.jsx)("div",{className:wt.a.dashedLine,children:Object(De.jsx)("div",{className:wt.a.line})}),Object(De.jsx)("div",{className:wt.a.dashedLine,children:Object(De.jsx)("div",{className:wt.a.line})})]}),_&&Object(De.jsxs)("div",{className:wt.a.activeChartLegend,children:[Object(De.jsx)("span",{children:"00:00"}),Object(De.jsx)("span",{children:_[Math.floor(_.length/2)].x}),Object(De.jsx)("span",{children:_[_.length-1].x})]})]})}}]),c}(ce.Component),Ui=a("Wnft"),yt=a.n(Ui),Qe=He.a.Countdown,Kt=Date.now()+1e3*60*60*24*2+1e3*30,sr=function(b){Object(q.a)(c,b);var p=Object(Ce.a)(c);function c(){return Object(F.a)(this,c),p.apply(this,arguments)}return Object(K.a)(c,[{key:"componentDidMount",value:function(){var m=this.props.dispatch;m({type:"dashboardAndmonitor/fetchTags"})}},{key:"render",value:function(){var m=this.props,_=m.dashboardAndmonitor,k=m.loading,te=_.tags;return Object(De.jsx)(ut.a,{children:Object(De.jsxs)(st.a.Fragment,{children:[Object(De.jsxs)(N.a,{gutter:24,children:[Object(De.jsx)(X.a,{xl:18,lg:24,md:24,sm:24,xs:24,style:{marginBottom:24},children:Object(De.jsxs)(v.a,{title:Object(De.jsx)(Be.a,{id:"dashboardandmonitor.monitor.trading-activity",defaultMessage:"Real-Time Trading Activity"}),bordered:!1,children:[Object(De.jsxs)(N.a,{children:[Object(De.jsx)(X.a,{md:6,sm:12,xs:24,children:Object(De.jsx)(He.a,{title:Object(De.jsx)(Be.a,{id:"dashboardandmonitor.monitor.total-transactions",defaultMessage:"Total transactions today"}),suffix:"\u5143",value:bt()(124543233).format("0,0")})}),Object(De.jsx)(X.a,{md:6,sm:12,xs:24,children:Object(De.jsx)(He.a,{title:Object(De.jsx)(Be.a,{id:"dashboardandmonitor.monitor.sales-target",defaultMessage:"Sales target completion rate"}),value:"92%"})}),Object(De.jsx)(X.a,{md:6,sm:12,xs:24,children:Object(De.jsx)(Qe,{title:Object(De.jsx)(Be.a,{id:"dashboardandmonitor.monitor.remaining-time",defaultMessage:"Remaining time of activity"}),value:Kt,format:"HH:mm:ss:SSS"})}),Object(De.jsx)(X.a,{md:6,sm:12,xs:24,children:Object(De.jsx)(He.a,{title:Object(De.jsx)(Be.a,{id:"dashboardandmonitor.monitor.total-transactions-per-second",defaultMessage:"Total transactions per second"}),suffix:"\u5143",value:bt()(234).format("0,0")})})]}),Object(De.jsx)("div",{className:yt.a.mapChart,children:Object(De.jsx)(Qi,{})})]})}),Object(De.jsxs)(X.a,{xl:6,lg:24,md:24,sm:24,xs:24,children:[Object(De.jsx)(v.a,{title:Object(De.jsx)(Be.a,{id:"dashboardandmonitor.monitor.activity-forecast",defaultMessage:"Activity forecast"}),style:{marginBottom:24},bordered:!1,children:Object(De.jsx)(Dn,{})}),Object(De.jsx)(v.a,{title:Object(De.jsx)(Be.a,{id:"dashboardandmonitor.monitor.efficiency",defaultMessage:"Efficiency"}),style:{marginBottom:24},bodyStyle:{textAlign:"center"},bordered:!1,children:Object(De.jsx)(St,{title:Object(Be.d)({id:"dashboardandmonitor.monitor.ratio",defaultMessage:"Ratio"}),height:180,percent:87})})]})]}),Object(De.jsxs)(N.a,{gutter:24,children:[Object(De.jsx)(X.a,{xl:12,lg:24,sm:24,xs:24,style:{marginBottom:24},children:Object(De.jsx)(v.a,{title:Object(De.jsx)(Be.a,{id:"dashboardandmonitor.monitor.proportion-per-category",defaultMessage:"Proportion Per Category"}),bordered:!1,className:yt.a.pieCard,children:Object(De.jsxs)(N.a,{style:{padding:"16px 0"},children:[Object(De.jsx)(X.a,{span:8,children:Object(De.jsx)(R,{animate:!1,percent:28,title:Object(De.jsx)(Be.a,{id:"dashboardandmonitor.monitor.fast-food",defaultMessage:"Fast food"}),total:"28%",height:128,lineWidth:2})}),Object(De.jsx)(X.a,{span:8,children:Object(De.jsx)(R,{animate:!1,color:"#5DDECF",percent:22,title:Object(De.jsx)(Be.a,{id:"dashboardandmonitor.monitor.western-food",defaultMessage:"Western food"}),total:"22%",height:128,lineWidth:2})}),Object(De.jsx)(X.a,{span:8,children:Object(De.jsx)(R,{animate:!1,color:"#2FC25B",percent:32,title:Object(De.jsx)(Be.a,{id:"dashboardandmonitor.monitor.hot-pot",defaultMessage:"Hot pot"}),total:"32%",height:128,lineWidth:2})})]})})}),Object(De.jsx)(X.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24},children:Object(De.jsx)(v.a,{title:Object(De.jsx)(Be.a,{id:"dashboardandmonitor.monitor.popular-searches",defaultMessage:"Popular Searches"}),loading:k,bordered:!1,bodyStyle:{overflow:"hidden"},children:Object(De.jsx)(nt,{data:te||[],height:161})})}),Object(De.jsx)(X.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24},children:Object(De.jsx)(v.a,{title:Object(De.jsx)(Be.a,{id:"dashboardandmonitor.monitor.resource-surplus",defaultMessage:"Resource Surplus"}),bodyStyle:{textAlign:"center",fontSize:0},bordered:!1,children:Object(De.jsx)(re,{height:161,title:Object(De.jsx)(Be.a,{id:"dashboardandmonitor.monitor.fund-surplus",defaultMessage:"Fund Surplus"}),percent:34})})})]})]})})}}]),c}(ce.Component),lr=x.default=Object(Be.c)(function(b){var p=b.dashboardAndmonitor,c=b.loading;return{dashboardAndmonitor:p,loading:c.models.dashboardAndmonitor}})(sr)},aF1E:function(we,x,a){"use strict";a.d(x,"a",function(){return o});var S=a("lSNA"),v=a.n(S);function Z(X,F){var K=Object.keys(X);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols(X);F&&(q=q.filter(function(Ce){return Object.getOwnPropertyDescriptor(X,Ce).enumerable})),K.push.apply(K,q)}return K}function N(X){for(var F=1;F<arguments.length;F++){var K=arguments[F]!=null?arguments[F]:{};F%2?Z(Object(K),!0).forEach(function(q){v()(X,q,K[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(X,Object.getOwnPropertyDescriptors(K)):Z(Object(K)).forEach(function(q){Object.defineProperty(X,q,Object.getOwnPropertyDescriptor(K,q))})}return X}function o(X,F){var K=F.sourceField,q=F.targetField,Ce=F.data,$={};return Ce.forEach(function(He){$[He[K]]=He}),X.dataArray=X.dataArray.map(function(He){var Be=He[q];return N(N({},He),$[Be])}),X}},aHsQ:function(we,x,a){"use strict";var S=a("cIOH"),v=a.n(S),Z=a("6D9b"),N=a.n(Z),o=a("cWXX")},aPG5:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.resolve=void 0;var S=a("MON2"),v=a("FV85"),Z=a("qK8v"),N=a("ujMp"),o=a("cSJO"),X=function(Ce,$,He){try{return He()}catch(Be){throw Z.isStackOverflowExeption(Be)?new Error(S.CIRCULAR_DEPENDENCY_IN_FACTORY(Ce,$.toString())):Be}},F=function q(Ce){return function($){$.parentContext.setCurrentRequest($);var He=$.bindings,Be=$.childRequests,ce=$.target&&$.target.isArray(),st=!$.parentRequest||!$.parentRequest.target||!$.target||!$.parentRequest.target.matchesArray($.target.serviceIdentifier);if(ce&&st)return Be.map(function(De){var ar=q(Ce);return ar(De)});var ut=null;if($.target.isOptional()&&He.length===0)return;var Me=He[0],bt=Me.scope===v.BindingScopeEnum.Singleton,xt=Me.scope===v.BindingScopeEnum.Request;if(bt&&Me.activated)return Me.cache;if(xt&&Ce!==null&&Ce.has(Me.id))return Ce.get(Me.id);if(Me.type===v.BindingTypeEnum.ConstantValue)ut=Me.cache;else if(Me.type===v.BindingTypeEnum.Function)ut=Me.cache;else if(Me.type===v.BindingTypeEnum.Constructor)ut=Me.implementationType;else if(Me.type===v.BindingTypeEnum.DynamicValue&&Me.dynamicValue!==null)ut=X("toDynamicValue",Me.serviceIdentifier,function(){return Me.dynamicValue($.parentContext)});else if(Me.type===v.BindingTypeEnum.Factory&&Me.factory!==null)ut=X("toFactory",Me.serviceIdentifier,function(){return Me.factory($.parentContext)});else if(Me.type===v.BindingTypeEnum.Provider&&Me.provider!==null)ut=X("toProvider",Me.serviceIdentifier,function(){return Me.provider($.parentContext)});else if(Me.type===v.BindingTypeEnum.Instance&&Me.implementationType!==null)ut=o.resolveInstance(Me.implementationType,Be,q(Ce));else{var Mt=N.getServiceIdentifierAsString($.serviceIdentifier);throw new Error(S.INVALID_BINDING_TYPE+" "+Mt)}return typeof Me.onActivation=="function"&&(ut=Me.onActivation($.parentContext,ut)),bt&&(Me.cache=ut,Me.activated=!0),xt&&Ce!==null&&!Ce.has(Me.id)&&Ce.set(Me.id,ut),ut}};function K(q){var Ce=F(q.plan.rootRequest.requestScope);return Ce(q.plan.rootRequest)}x.resolve=K},asDA:function(we,x){function a(S,v,Z,N){var o=-1,X=S==null?0:S.length;for(N&&X&&(Z=S[++o]);++o<X;)Z=v(Z,S[o],o,S);return Z}we.exports=a},b2z7:function(we,x){var a=/\w*$/;function S(v){var Z=new v.constructor(v.source,a.exec(v));return Z.lastIndex=v.lastIndex,Z}we.exports=S},b48C:function(we,x){function a(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(S){return!1}}we.exports=a},bB6j:function(we,x,a){"use strict";a.d(x,"a",function(){return S});var S={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),ILogService:Symbol.for("ILogService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},bPkA:function(we,x,a){"use strict";a.d(x,"a",function(){return S});var S;(function(v){v.Normal="normal",v.PostProcessing="post-processing"})(S||(S={}))},bTtR:function(we,x){},bYl4:function(we,x){},bahg:function(we,x){function a(S){return S.split("")}we.exports=a},bl9R:function(we,x,a){"use strict";a.r(x),a.d(x,"create",function(){return v}),a.d(x,"clone",function(){return Z}),a.d(x,"fromValues",function(){return N}),a.d(x,"copy",function(){return o}),a.d(x,"set",function(){return X}),a.d(x,"add",function(){return F}),a.d(x,"subtract",function(){return K}),a.d(x,"multiply",function(){return q}),a.d(x,"divide",function(){return Ce}),a.d(x,"ceil",function(){return $}),a.d(x,"floor",function(){return He}),a.d(x,"min",function(){return Be}),a.d(x,"max",function(){return ce}),a.d(x,"round",function(){return st}),a.d(x,"scale",function(){return ut}),a.d(x,"scaleAndAdd",function(){return Me}),a.d(x,"distance",function(){return bt}),a.d(x,"squaredDistance",function(){return xt}),a.d(x,"length",function(){return Mt}),a.d(x,"squaredLength",function(){return De}),a.d(x,"negate",function(){return ar}),a.d(x,"inverse",function(){return $t}),a.d(x,"normalize",function(){return Ht}),a.d(x,"dot",function(){return vt}),a.d(x,"cross",function(){return Ze}),a.d(x,"lerp",function(){return Et}),a.d(x,"random",function(){return Le}),a.d(x,"transformMat4",function(){return at}),a.d(x,"transformQuat",function(){return Wt}),a.d(x,"zero",function(){return St}),a.d(x,"str",function(){return dt}),a.d(x,"exactEquals",function(){return H}),a.d(x,"equals",function(){return z}),a.d(x,"sub",function(){return V}),a.d(x,"mul",function(){return be}),a.d(x,"div",function(){return me}),a.d(x,"dist",function(){return le}),a.d(x,"sqrDist",function(){return fe}),a.d(x,"len",function(){return Ne}),a.d(x,"sqrLen",function(){return lt}),a.d(x,"forEach",function(){return rt});var S=a("yU0y");function v(){var ue=new S.a(4);return S.a!=Float32Array&&(ue[0]=0,ue[1]=0,ue[2]=0,ue[3]=0),ue}function Z(ue){var ye=new S.a(4);return ye[0]=ue[0],ye[1]=ue[1],ye[2]=ue[2],ye[3]=ue[3],ye}function N(ue,ye,Ue,ft){var Oe=new S.a(4);return Oe[0]=ue,Oe[1]=ye,Oe[2]=Ue,Oe[3]=ft,Oe}function o(ue,ye){return ue[0]=ye[0],ue[1]=ye[1],ue[2]=ye[2],ue[3]=ye[3],ue}function X(ue,ye,Ue,ft,Oe){return ue[0]=ye,ue[1]=Ue,ue[2]=ft,ue[3]=Oe,ue}function F(ue,ye,Ue){return ue[0]=ye[0]+Ue[0],ue[1]=ye[1]+Ue[1],ue[2]=ye[2]+Ue[2],ue[3]=ye[3]+Ue[3],ue}function K(ue,ye,Ue){return ue[0]=ye[0]-Ue[0],ue[1]=ye[1]-Ue[1],ue[2]=ye[2]-Ue[2],ue[3]=ye[3]-Ue[3],ue}function q(ue,ye,Ue){return ue[0]=ye[0]*Ue[0],ue[1]=ye[1]*Ue[1],ue[2]=ye[2]*Ue[2],ue[3]=ye[3]*Ue[3],ue}function Ce(ue,ye,Ue){return ue[0]=ye[0]/Ue[0],ue[1]=ye[1]/Ue[1],ue[2]=ye[2]/Ue[2],ue[3]=ye[3]/Ue[3],ue}function $(ue,ye){return ue[0]=Math.ceil(ye[0]),ue[1]=Math.ceil(ye[1]),ue[2]=Math.ceil(ye[2]),ue[3]=Math.ceil(ye[3]),ue}function He(ue,ye){return ue[0]=Math.floor(ye[0]),ue[1]=Math.floor(ye[1]),ue[2]=Math.floor(ye[2]),ue[3]=Math.floor(ye[3]),ue}function Be(ue,ye,Ue){return ue[0]=Math.min(ye[0],Ue[0]),ue[1]=Math.min(ye[1],Ue[1]),ue[2]=Math.min(ye[2],Ue[2]),ue[3]=Math.min(ye[3],Ue[3]),ue}function ce(ue,ye,Ue){return ue[0]=Math.max(ye[0],Ue[0]),ue[1]=Math.max(ye[1],Ue[1]),ue[2]=Math.max(ye[2],Ue[2]),ue[3]=Math.max(ye[3],Ue[3]),ue}function st(ue,ye){return ue[0]=Math.round(ye[0]),ue[1]=Math.round(ye[1]),ue[2]=Math.round(ye[2]),ue[3]=Math.round(ye[3]),ue}function ut(ue,ye,Ue){return ue[0]=ye[0]*Ue,ue[1]=ye[1]*Ue,ue[2]=ye[2]*Ue,ue[3]=ye[3]*Ue,ue}function Me(ue,ye,Ue,ft){return ue[0]=ye[0]+Ue[0]*ft,ue[1]=ye[1]+Ue[1]*ft,ue[2]=ye[2]+Ue[2]*ft,ue[3]=ye[3]+Ue[3]*ft,ue}function bt(ue,ye){var Ue=ye[0]-ue[0],ft=ye[1]-ue[1],Oe=ye[2]-ue[2],Ve=ye[3]-ue[3];return Math.hypot(Ue,ft,Oe,Ve)}function xt(ue,ye){var Ue=ye[0]-ue[0],ft=ye[1]-ue[1],Oe=ye[2]-ue[2],Ve=ye[3]-ue[3];return Ue*Ue+ft*ft+Oe*Oe+Ve*Ve}function Mt(ue){var ye=ue[0],Ue=ue[1],ft=ue[2],Oe=ue[3];return Math.hypot(ye,Ue,ft,Oe)}function De(ue){var ye=ue[0],Ue=ue[1],ft=ue[2],Oe=ue[3];return ye*ye+Ue*Ue+ft*ft+Oe*Oe}function ar(ue,ye){return ue[0]=-ye[0],ue[1]=-ye[1],ue[2]=-ye[2],ue[3]=-ye[3],ue}function $t(ue,ye){return ue[0]=1/ye[0],ue[1]=1/ye[1],ue[2]=1/ye[2],ue[3]=1/ye[3],ue}function Ht(ue,ye){var Ue=ye[0],ft=ye[1],Oe=ye[2],Ve=ye[3],P=Ue*Ue+ft*ft+Oe*Oe+Ve*Ve;return P>0&&(P=1/Math.sqrt(P)),ue[0]=Ue*P,ue[1]=ft*P,ue[2]=Oe*P,ue[3]=Ve*P,ue}function vt(ue,ye){return ue[0]*ye[0]+ue[1]*ye[1]+ue[2]*ye[2]+ue[3]*ye[3]}function Ze(ue,ye,Ue,ft){var Oe=Ue[0]*ft[1]-Ue[1]*ft[0],Ve=Ue[0]*ft[2]-Ue[2]*ft[0],P=Ue[0]*ft[3]-Ue[3]*ft[0],R=Ue[1]*ft[2]-Ue[2]*ft[1],J=Ue[1]*ft[3]-Ue[3]*ft[1],de=Ue[2]*ft[3]-Ue[3]*ft[2],je=ye[0],We=ye[1],gt=ye[2],nt=ye[3];return ue[0]=We*de-gt*J+nt*R,ue[1]=-(je*de)+gt*P-nt*Ve,ue[2]=je*J-We*P+nt*Oe,ue[3]=-(je*R)+We*Ve-gt*Oe,ue}function Et(ue,ye,Ue,ft){var Oe=ye[0],Ve=ye[1],P=ye[2],R=ye[3];return ue[0]=Oe+ft*(Ue[0]-Oe),ue[1]=Ve+ft*(Ue[1]-Ve),ue[2]=P+ft*(Ue[2]-P),ue[3]=R+ft*(Ue[3]-R),ue}function Le(ue,ye){ye=ye||1;var Ue,ft,Oe,Ve,P,R;do Ue=S.c()*2-1,ft=S.c()*2-1,P=Ue*Ue+ft*ft;while(P>=1);do Oe=S.c()*2-1,Ve=S.c()*2-1,R=Oe*Oe+Ve*Ve;while(R>=1);var J=Math.sqrt((1-P)/R);return ue[0]=ye*Ue,ue[1]=ye*ft,ue[2]=ye*Oe*J,ue[3]=ye*Ve*J,ue}function at(ue,ye,Ue){var ft=ye[0],Oe=ye[1],Ve=ye[2],P=ye[3];return ue[0]=Ue[0]*ft+Ue[4]*Oe+Ue[8]*Ve+Ue[12]*P,ue[1]=Ue[1]*ft+Ue[5]*Oe+Ue[9]*Ve+Ue[13]*P,ue[2]=Ue[2]*ft+Ue[6]*Oe+Ue[10]*Ve+Ue[14]*P,ue[3]=Ue[3]*ft+Ue[7]*Oe+Ue[11]*Ve+Ue[15]*P,ue}function Wt(ue,ye,Ue){var ft=ye[0],Oe=ye[1],Ve=ye[2],P=Ue[0],R=Ue[1],J=Ue[2],de=Ue[3],je=de*ft+R*Ve-J*Oe,We=de*Oe+J*ft-P*Ve,gt=de*Ve+P*Oe-R*ft,nt=-P*ft-R*Oe-J*Ve;return ue[0]=je*de+nt*-P+We*-J-gt*-R,ue[1]=We*de+nt*-R+gt*-P-je*-J,ue[2]=gt*de+nt*-J+je*-R-We*-P,ue[3]=ye[3],ue}function St(ue){return ue[0]=0,ue[1]=0,ue[2]=0,ue[3]=0,ue}function dt(ue){return"vec4("+ue[0]+", "+ue[1]+", "+ue[2]+", "+ue[3]+")"}function H(ue,ye){return ue[0]===ye[0]&&ue[1]===ye[1]&&ue[2]===ye[2]&&ue[3]===ye[3]}function z(ue,ye){var Ue=ue[0],ft=ue[1],Oe=ue[2],Ve=ue[3],P=ye[0],R=ye[1],J=ye[2],de=ye[3];return Math.abs(Ue-P)<=S.b*Math.max(1,Math.abs(Ue),Math.abs(P))&&Math.abs(ft-R)<=S.b*Math.max(1,Math.abs(ft),Math.abs(R))&&Math.abs(Oe-J)<=S.b*Math.max(1,Math.abs(Oe),Math.abs(J))&&Math.abs(Ve-de)<=S.b*Math.max(1,Math.abs(Ve),Math.abs(de))}var V=K,be=q,me=Ce,le=bt,fe=xt,Ne=Mt,lt=De,rt=function(){var ue=v();return function(ye,Ue,ft,Oe,Ve,P){var R,J;for(Ue||(Ue=4),ft||(ft=0),Oe?J=Math.min(Oe*Ue+ft,ye.length):J=ye.length,R=ft;R<J;R+=Ue)ue[0]=ye[R],ue[1]=ye[R+1],ue[2]=ye[R+2],ue[3]=ye[R+3],Ve(ue,ue,P),ye[R]=ue[0],ye[R+1]=ue[1],ye[R+2]=ue[2],ye[R+3]=ue[3];return ye}}()},bzyH:function(we,x){},cSJO:function(we,x,a){"use strict";var S=this&&this.__spreadArrays||function(){for(var q=0,Ce=0,$=arguments.length;Ce<$;Ce++)q+=arguments[Ce].length;for(var He=Array(q),Be=0,Ce=0;Ce<$;Ce++)for(var ce=arguments[Ce],st=0,ut=ce.length;st<ut;st++,Be++)He[Be]=ce[st];return He};Object.defineProperty(x,"__esModule",{value:!0}),x.resolveInstance=void 0;var v=a("MON2"),Z=a("FV85"),N=a("xfSm");function o(q,Ce,$){var He=Ce.filter(function(ce){return ce.target!==null&&ce.target.type===Z.TargetTypeEnum.ClassProperty}),Be=He.map($);return He.forEach(function(ce,st){var ut="";ut=ce.target.name.value();var Me=Be[st];q[ut]=Me}),q}function X(q,Ce){return new(q.bind.apply(q,S([void 0],Ce)))}function F(q,Ce){if(Reflect.hasMetadata(N.POST_CONSTRUCT,q)){var $=Reflect.getMetadata(N.POST_CONSTRUCT,q);try{Ce[$.value]()}catch(He){throw new Error(v.POST_CONSTRUCT_ERROR(q.name,He.message))}}}function K(q,Ce,$){var He=null;if(Ce.length>0){var Be=Ce.filter(function(st){return st.target!==null&&st.target.type===Z.TargetTypeEnum.ConstructorArgument}),ce=Be.map($);He=X(q,ce),He=o(He,Ce,$)}else He=new q;return F(q,He),He}x.resolveInstance=K},cWXX:function(we,x,a){"use strict";var S=a("cIOH"),v=a.n(S),Z=a("oIFs"),N=a.n(Z)},cZ5Q:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.injectable=void 0;var S=a("MON2"),v=a("xfSm");function Z(){return function(N){if(Reflect.hasOwnMetadata(v.PARAM_TYPES,N))throw new Error(S.DUPLICATED_INJECTABLE_DECORATOR);var o=Reflect.getMetadata(v.DESIGN_PARAM_TYPES,N)||[];return Reflect.defineMetadata(v.PARAM_TYPES,o,N),N}}x.injectable=Z},cZlC:function(we,x,a){"use strict";a.d(x,"b",function(){return S}),a.d(x,"c",function(){return v}),a.d(x,"a",function(){return Z});var S;(function(N){N.LINEAR="linear",N.POWER="power",N.LOG="log",N.IDENTITY="identity",N.TIME="time",N.QUANTILE="quantile",N.QUANTIZE="quantize",N.THRESHOLD="threshold",N.CAT="cat"})(S||(S={}));var v;(function(N){N.CONSTANT="constant",N.VARIABLE="variable"})(v||(v={}));var Z;(function(N){N[N.Attribute=0]="Attribute",N[N.InstancedAttribute=1]="InstancedAttribute",N[N.Uniform=2]="Uniform"})(Z||(Z={}))},"cq/+":function(we,x,a){var S=a("mc0g"),v=S();we.exports=v},cvCv:function(we,x){function a(S){return function(){return S}}we.exports=a},d9O0:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.id=void 0;var S=0;function v(){return S++}x.id=v},d9mD:function(we,x,a){we.exports={pie:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-pie",chart:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-chart",hasLegend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-hasLegend",legend:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legend",dot:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-dot",line:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-line",legendTitle:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendTitle",percent:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-percent",value:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-value",title:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-title",total:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-total",legendBlock:"antd-pro-pages-dashboard-monitor-components-charts-pie-index-legendBlock"}},dQpi:function(we,x,a){var S=a("yGk4"),v=a("vN+2"),Z=a("rEGp"),N=1/0,o=S&&1/Z(new S([,-0]))[1]==N?function(X){return new S(X)}:v;we.exports=o},dTAl:function(we,x,a){var S=a("GoyQ"),v=Object.create,Z=function(){function N(){}return function(o){if(!S(o))return{};if(v)return v(o);N.prototype=o;var X=new N;return N.prototype=void 0,X}}();we.exports=Z},dVn5:function(we,x){var a=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function S(v){return v.match(a)||[]}we.exports=S},dX1H:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.Target=void 0;var S=a("xfSm"),v=a("d9O0"),Z=a("GXnB"),N=a("zxMA"),o=function(){function X(F,K,q,Ce){this.id=v.id(),this.type=F,this.serviceIdentifier=q,this.name=new N.QueryableString(K||""),this.metadata=new Array;var $=null;typeof Ce=="string"?$=new Z.Metadata(S.NAMED_TAG,Ce):Ce instanceof Z.Metadata&&($=Ce),$!==null&&this.metadata.push($)}return X.prototype.hasTag=function(F){for(var K=0,q=this.metadata;K<q.length;K++){var Ce=q[K];if(Ce.key===F)return!0}return!1},X.prototype.isArray=function(){return this.hasTag(S.MULTI_INJECT_TAG)},X.prototype.matchesArray=function(F){return this.matchesTag(S.MULTI_INJECT_TAG)(F)},X.prototype.isNamed=function(){return this.hasTag(S.NAMED_TAG)},X.prototype.isTagged=function(){return this.metadata.some(function(F){return F.key!==S.INJECT_TAG&&F.key!==S.MULTI_INJECT_TAG&&F.key!==S.NAME_TAG&&F.key!==S.UNMANAGED_TAG&&F.key!==S.NAMED_TAG})},X.prototype.isOptional=function(){return this.matchesTag(S.OPTIONAL_TAG)(!0)},X.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(F){return F.key===S.NAMED_TAG})[0]:null},X.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(F){return F.key!==S.INJECT_TAG&&F.key!==S.MULTI_INJECT_TAG&&F.key!==S.NAME_TAG&&F.key!==S.UNMANAGED_TAG&&F.key!==S.NAMED_TAG}):null},X.prototype.matchesNamedTag=function(F){return this.matchesTag(S.NAMED_TAG)(F)},X.prototype.matchesTag=function(F){var K=this;return function(q){for(var Ce=0,$=K.metadata;Ce<$.length;Ce++){var He=$[Ce];if(He.key===F&&He.value===q)return!0}return!1}},X}();x.Target=o},doU7:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.BindingCount=void 0;var S={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};x.BindingCount=S},dt0z:function(we,x,a){var S=a("zoYe");function v(Z){return Z==null?"":S(Z)}we.exports=v},dxzI:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.AsyncContainerModule=x.ContainerModule=void 0;var S=a("d9O0"),v=function(){function N(o){this.id=S.id(),this.registry=o}return N}();x.ContainerModule=v;var Z=function(){function N(o){this.id=S.id(),this.registry=o}return N}();x.AsyncContainerModule=Z},eUgh:function(we,x){function a(S,v){for(var Z=-1,N=S==null?0:S.length,o=Array(N);++Z<N;)o[Z]=v(S[Z],Z,S);return o}we.exports=a},"eg+a":function(we,x,a){"use strict";a.d(x,"a",function(){return S});var S=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},fX6N:function(we,x,a){"use strict";a.d(x,"d",function(){return Lf}),a.d(x,"b",function(){return $c}),a.d(x,"a",function(){return Rl});var S=a("mNvP"),v=a("uhBA"),Z=a.n(v),N=a("4cb6"),o=a("APxj"),X=a.n(o),F=a("bB6j"),K=a("lSNA"),q=a.n(K),Ce=a("lwsE"),$=a.n(Ce),He=a("W8MJ"),Be=a.n(He),ce=a("Hel2"),st=a("rxlC"),ut=a.n(st);function Me(ee,ie){var D=Object.keys(ee);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ee);ie&&(U=U.filter(function(Se){return Object.getOwnPropertyDescriptor(ee,Se).enumerable})),D.push.apply(D,U)}return D}function bt(ee){for(var ie=1;ie<arguments.length;ie++){var D=arguments[ie]!=null?arguments[ie]:{};ie%2?Me(Object(D),!0).forEach(function(U){q()(ee,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(D)):Me(Object(D)).forEach(function(U){Object.defineProperty(ee,U,Object.getOwnPropertyDescriptor(D,U))})}return ee}function xt(ee,ie){var D;if(typeof Symbol=="undefined"||ee[Symbol.iterator]==null){if(Array.isArray(ee)||(D=Mt(ee))||ie&&ee&&typeof ee.length=="number"){D&&(ee=D);var U=0,Se=function(){};return{s:Se,n:function(){return U>=ee.length?{done:!0}:{done:!1,value:ee[U++]}},e:function(_r){throw _r},f:Se}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var tt=!0,Ut=!1,qt;return{s:function(){D=ee[Symbol.iterator]()},n:function(){var _r=D.next();return tt=_r.done,_r},e:function(_r){Ut=!0,qt=_r},f:function(){try{!tt&&D.return!=null&&D.return()}finally{if(Ut)throw qt}}}}function Mt(ee,ie){if(!!ee){if(typeof ee=="string")return De(ee,ie);var D=Object.prototype.toString.call(ee).slice(8,-1);if(D==="Object"&&ee.constructor&&(D=ee.constructor.name),D==="Map"||D==="Set")return Array.from(ee);if(D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D))return De(ee,ie)}}function De(ee,ie){(ie==null||ie>ee.length)&&(ie=ee.length);for(var D=0,U=new Array(ie);D<ie;D++)U[D]=ee[D];return U}var ar=30;function $t(ee){var ie=ee.characterSet,D=ee.getFontWidth,U=ee.fontHeight,Se=ee.buffer,tt=ee.maxCanvasWidth,Ut=ee.mapping,qt=Ut===void 0?{}:Ut,er=ee.xOffset,_r=er===void 0?0:er,en=ee.yOffset,Rn=en===void 0?0:en,$n=0,ri=_r;Array.from(ie).forEach(function(Ri,fa){if(!qt[Ri]){var ua=D(Ri,fa);ri+ar>tt&&(ri=0,$n++),qt[Ri]={x:ri,y:Rn+$n*ar,width:ar,height:ar,advance:ua},ri+=ar}});var Mi=U+Se*2;return{mapping:qt,xOffset:ri,yOffset:Rn+$n*Mi,canvasHeight:Ze(Rn+($n+1)*Mi)}}function Ht(ee,ie,D){var U=0,Se=0,tt=0,Ut=[],qt={},er=xt(ee),_r;try{for(er.s();!(_r=er.n()).done;){var en=_r.value;if(!qt[en.id]){var Rn=en.size;U+Rn+ie>D&&(vt(qt,Ut,Se),U=0,Se=tt+Se+ie,tt=0,Ut=[]),Ut.push({icon:en,xOffset:U}),U=U+Rn+ie,tt=Math.max(tt,Rn)}}}catch(ri){er.e(ri)}finally{er.f()}Ut.length>0&&vt(qt,Ut,Se);var $n=Ze(tt+Se+ie);return{mapping:qt,canvasHeight:$n}}function vt(ee,ie,D){var U=xt(ie),Se;try{for(U.s();!(Se=U.n()).done;){var tt=Se.value,Ut=tt.icon,qt=tt.xOffset;ee[Ut.id]=bt(bt({},Ut),{},{x:qt,y:D,image:Ut.image,width:Ut.width,height:Ut.height})}}catch(er){U.e(er)}finally{U.f()}}function Ze(ee){return Math.pow(2,Math.ceil(Math.log2(ee)))}var Et,Le,at;function Wt(ee,ie){var D;if(typeof Symbol=="undefined"||ee[Symbol.iterator]==null){if(Array.isArray(ee)||(D=St(ee))||ie&&ee&&typeof ee.length=="number"){D&&(ee=D);var U=0,Se=function(){};return{s:Se,n:function(){return U>=ee.length?{done:!0}:{done:!1,value:ee[U++]}},e:function(_r){throw _r},f:Se}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var tt=!0,Ut=!1,qt;return{s:function(){D=ee[Symbol.iterator]()},n:function(){var _r=D.next();return tt=_r.done,_r},e:function(_r){Ut=!0,qt=_r},f:function(){try{!tt&&D.return!=null&&D.return()}finally{if(Ut)throw qt}}}}function St(ee,ie){if(!!ee){if(typeof ee=="string")return dt(ee,ie);var D=Object.prototype.toString.call(ee).slice(8,-1);if(D==="Object"&&ee.constructor&&(D=ee.constructor.name),D==="Map"||D==="Set")return Array.from(ee);if(D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D))return dt(ee,ie)}}function dt(ee,ie){(ie==null||ie>ee.length)&&(ie=ee.length);for(var D=0,U=new Array(ie);D<ie;D++)U[D]=ee[D];return U}function H(ee,ie){var D=Object.keys(ee);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ee);ie&&(U=U.filter(function(Se){return Object.getOwnPropertyDescriptor(ee,Se).enumerable})),D.push.apply(D,U)}return D}function z(ee){for(var ie=1;ie<arguments.length;ie++){var D=arguments[ie]!=null?arguments[ie]:{};ie%2?H(Object(D),!0).forEach(function(U){q()(ee,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(D)):H(Object(D)).forEach(function(U){Object.defineProperty(ee,U,Object.getOwnPropertyDescriptor(D,U))})}return ee}var V=Oe(),be="sans-serif",me="normal",le=24,fe=3,Ne=.25,lt=8,rt=1024,ue=1,ye=1,Ue=3,ft=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function Oe(){for(var ee=[],ie=32;ie<128;ie++)ee.push(String.fromCharCode(ie));return ee}function Ve(ee,ie,D,U){ee.font="".concat(U," ").concat(D,"px ").concat(ie),ee.fillStyle="black",ee.textBaseline="middle"}function P(ee,ie){for(var D=0;D<ee.length;D++)ie.data[4*D+3]=ee[D]}var R=(Et=Object(N.injectable)(),Et(Le=(at=function(){function ee(){$()(this,ee),this.fontAtlas=void 0,this.iconFontGlyphs={},this.fontOptions=void 0,this.key=void 0,this.cache=new ce.b(Ue)}return Be()(ee,[{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:be,fontWeight:me,characterSet:V,fontSize:le,buffer:fe,sdf:!0,cutoff:Ne,radius:lt},this.key=""}},{key:"addIconGlyphs",value:function(D){var U=this;D.forEach(function(Se){U.iconFontGlyphs[Se.name]=Se.unicode})}},{key:"getGlyph",value:function(D){return this.iconFontGlyphs[D]?String.fromCharCode(parseInt(this.iconFontGlyphs[D],16)):""}},{key:"setFontOptions",value:function(D){this.fontOptions=z(z({},this.fontOptions),D),this.key=this.getKey();var U=this.getNewChars(this.key,this.fontOptions.characterSet),Se=this.cache.get(this.key);if(!(Se&&U.length===0)){var tt=this.generateFontAtlas(this.key,U,Se);this.fontAtlas=tt,this.cache.set(this.key,tt)}}},{key:"destroy",value:function(){this.cache.clear()}},{key:"generateFontAtlas",value:function(D,U,Se){var tt=this.fontOptions,Ut=tt.fontFamily,qt=tt.fontWeight,er=tt.fontSize,_r=tt.buffer,en=tt.sdf,Rn=tt.radius,$n=tt.cutoff,ri=Se&&Se.data;ri||(ri=document.createElement("canvas"),ri.width=rt);var Mi=ri.getContext("2d");Ve(Mi,Ut,er,qt);var Ri=$t(z({getFontWidth:function(gc){return Mi.measureText(gc).width},fontHeight:er*ye,buffer:_r,characterSet:U,maxCanvasWidth:rt},Se&&{mapping:Se.mapping,xOffset:Se.xOffset,yOffset:Se.yOffset})),fa=Ri.mapping,ua=Ri.canvasHeight,Na=Ri.xOffset,go=Ri.yOffset,ao=Mi.getImageData(0,0,ri.width,ri.height);if(ri.height=ua,Mi.putImageData(ao,0,0),Ve(Mi,Ut,er,qt),en){var Va=new ut.a(er,_r,Rn,$n,Ut,qt),Co=Mi.getImageData(0,0,Va.size,Va.size),Xi=Wt(U),Qa;try{for(Xi.s();!(Qa=Xi.n()).done;){var ls=Qa.value;P(Va.draw(ls),Co),Mi.putImageData(Co,fa[ls].x,fa[ls].y)}}catch(Bo){Xi.e(Bo)}finally{Xi.f()}}else{var Sa=Wt(U),Ma;try{for(Sa.s();!(Ma=Sa.n()).done;){var gi=Ma.value;Mi.fillText(gi,fa[gi].x,fa[gi].y+er*ue)}}catch(Bo){Sa.e(Bo)}finally{Sa.f()}}return{xOffset:Na,yOffset:go,mapping:fa,data:ri,width:ri.width,height:ri.height}}},{key:"getKey",value:function(){var D=this.fontOptions,U=D.fontFamily,Se=D.fontWeight,tt=D.fontSize,Ut=D.buffer,qt=D.sdf,er=D.radius,_r=D.cutoff;return qt?"".concat(U," ").concat(Se," ").concat(tt," ").concat(Ut," ").concat(er," ").concat(_r):"".concat(U," ").concat(Se," ").concat(tt," ").concat(Ut)}},{key:"getNewChars",value:function(D,U){var Se=this.cache.get(D);if(!Se)return U;var tt=[],Ut=Se.mapping,qt=new Set(Object.keys(Ut)),er=new Set(U);return er.forEach(function(_r){qt.has(_r)||tt.push(_r)}),tt}},{key:"scale",get:function(){return ye}},{key:"canvas",get:function(){var D=this.cache.get(this.key);return D&&D.data}},{key:"mapping",get:function(){var D=this.cache.get(this.key);return D&&D.mapping}}]),ee}(),at))||Le),J=a("7W2i"),de=a.n(J),je=a("a1gu"),We=a.n(je),gt=a("Nsbk"),nt=a.n(gt),Nt,Y,Xe;function re(ee){var ie=Je();return function(){var U=nt()(ee),Se;if(ie){var tt=nt()(this).constructor;Se=Reflect.construct(U,arguments,tt)}else Se=U.apply(this,arguments);return We()(this,Se)}}function Je(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var Gt=3,ur=1024,ct=64,ht=(Nt=Object(N.injectable)(),Nt(Y=(Xe=function(ee){de()(D,ee);var ie=re(D);function D(){var U;$()(this,D);for(var Se=arguments.length,tt=new Array(Se),Ut=0;Ut<Se;Ut++)tt[Ut]=arguments[Ut];return U=ie.call.apply(ie,[this].concat(tt)),U.canvasHeight=128,U.texture=void 0,U.canvas=void 0,U.iconData=void 0,U.iconMap=void 0,U.ctx=void 0,U.loadingImageCount=0,U}return Be()(D,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(Se,tt){var Ut=this,qt=new Image;if(this.loadingImageCount++,this.hasImage(Se))throw new Error("Image Id already exists");this.iconData.push({id:Se,size:ct}),this.updateIconMap(),this.loadImage(tt).then(function(er){qt=er;var _r=Ut.iconData.find(function(en){return en.id===Se});_r&&(_r.image=qt,_r.width=qt.width,_r.height=qt.height),Ut.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(Se){return this.iconMap.hasOwnProperty(Se)}},{key:"removeImage",value:function(Se){this.hasImage(Se)&&(this.iconData=this.iconData.filter(function(tt){return tt.id!==Se}),delete this.iconMap[Se],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var Se=this;this.canvas.width=ur,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(tt){var Ut=Se.iconMap[tt],qt=Ut.x,er=Ut.y,_r=Ut.image,en=Ut.width,Rn=en===void 0?64:en,$n=Ut.height,ri=$n===void 0?64:$n,Mi=Math.max(Rn,ri),Ri=Mi/ct,fa=ri/Ri,ua=Rn/Ri;_r&&Se.ctx.drawImage(_r,qt+(ct-ua)/2,er+(ct-fa)/2,ua,fa)})}},{key:"updateIconMap",value:function(){var Se=Ht(this.iconData,Gt,ur),tt=Se.mapping,Ut=Se.canvasHeight;this.iconMap=tt,this.canvasHeight=Ut}},{key:"loadImage",value:function(Se){return new Promise(function(tt,Ut){if(Se instanceof HTMLImageElement){tt(Se);return}var qt=new Image;qt.crossOrigin="anonymous",qt.onload=function(){tt(qt)},qt.onerror=function(){Ut(new Error("Could not load image at "+Se))},qt.src=Se instanceof File?URL.createObjectURL(Se):Se})}}]),D}(v.EventEmitter),Xe))||Y),Pt=a("J4zp"),pt=a.n(Pt),Pe=a("IOcx"),ot,$e,Vt,dr=(ot=Object(N.injectable)(),ot($e=(Vt=function(){function ee(){$()(this,ee),this.viewport=void 0,this.overridedViewProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0,this.jitteredProjectionMatrix=void 0,this.viewMatrixInverse=void 0,this.cameraPosition=void 0}return Be()(ee,[{key:"init",value:function(){}},{key:"update",value:function(D){this.viewport=D,this.viewMatrixInverse=Pe.b.invert(Pe.b.create(),this.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var D=this.viewport.getCenter(),U=pt()(D,2),Se=U[0],tt=U[1];return[Se,tt]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(D,U){return this.viewport.projectFlat(D,U)}},{key:"setViewProjectionMatrix",value:function(D){this.overridedViewProjectionMatrix=D}},{key:"jitterProjectionMatrix",value:function(D,U){var Se=Pe.b.fromTranslation(Pe.b.create(),[D,U,0]);this.jitteredProjectionMatrix=Pe.b.multiply(Pe.b.create(),Se,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=Pe.b.multiply(Pe.b.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),ee}(),Vt))||$e),Zr,cr,Un;function Sn(ee,ie){var D;if(typeof Symbol=="undefined"||ee[Symbol.iterator]==null){if(Array.isArray(ee)||(D=ni(ee))||ie&&ee&&typeof ee.length=="number"){D&&(ee=D);var U=0,Se=function(){};return{s:Se,n:function(){return U>=ee.length?{done:!0}:{done:!1,value:ee[U++]}},e:function(_r){throw _r},f:Se}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var tt=!0,Ut=!1,qt;return{s:function(){D=ee[Symbol.iterator]()},n:function(){var _r=D.next();return tt=_r.done,_r},e:function(_r){Ut=!0,qt=_r},f:function(){try{!tt&&D.return!=null&&D.return()}finally{if(Ut)throw qt}}}}function ni(ee,ie){if(!!ee){if(typeof ee=="string")return fi(ee,ie);var D=Object.prototype.toString.call(ee).slice(8,-1);if(D==="Object"&&ee.constructor&&(D=ee.constructor.name),D==="Map"||D==="Set")return Array.from(ee);if(D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D))return fi(ee,ie)}}function fi(ee,ie){(ie==null||ie>ee.length)&&(ie=ee.length);for(var D=0,U=new Array(ie);D<ie;D++)U[D]=ee[D];return U}var Wn=(Zr=Object(N.injectable)(),Zr(cr=(Un=function(){function ee(){$()(this,ee),this.container=void 0,this.controlCorners=void 0,this.controlContainer=void 0,this.scene=void 0,this.mapsService=void 0,this.controls=[],this.unAddControls=[]}return Be()(ee,[{key:"init",value:function(D,U){this.container=D.container,this.scene=U,this.mapsService=U.get(F.a.IMapService),this.initControlPos()}},{key:"addControl",value:function(D,U){var Se=U.get(F.a.IMapService);Se.map?(D.addTo(this.scene),this.controls.push(D)):this.unAddControls.push(D)}},{key:"getControlByName",value:function(D){return this.controls.find(function(U){return U.controlOption.name===D})}},{key:"removeControl",value:function(D){var U=this.controls.indexOf(D);return U>-1&&this.controls.splice(U,1),D.remove(),this}},{key:"addControls",value:function(){var D=this;this.unAddControls.forEach(function(U){U.addTo(D.scene),D.controls.push(U)}),this.unAddControls=[]}},{key:"destroy",value:function(){var D=Sn(this.controls),U;try{for(D.s();!(U=D.n()).done;){var Se=U.value;Se.remove()}}catch(tt){D.e(tt)}finally{D.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var D=this.controlCorners={},U="l7-",Se=this.controlContainer=ce.a.create("div",U+"control-container",this.container);function tt(Ut,qt){var er=U+Ut+" "+U+qt;D[Ut+qt]=ce.a.create("div",er,Se)}tt("top","left"),tt("top","right"),tt("bottom","left"),tt("bottom","right")}},{key:"clearControlPos",value:function(){for(var D in this.controlCorners)this.controlCorners[D]&&ce.a.remove(this.controlCorners[D]);this.controlContainer&&ce.a.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),ee}(),Un))||cr),Gn,Ee,pe,W=(Gn=Object(N.injectable)(),Gn(Ee=(pe=function(){function ee(){$()(this,ee),this.container=void 0,this.scene=void 0,this.mapsService=void 0,this.markers=[],this.markerLayers=[],this.unAddMarkers=[],this.unAddMarkerLayers=[]}return Be()(ee,[{key:"addMarkerLayer",value:function(D){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(D),D.addTo(this.scene)):this.unAddMarkerLayers.push(D)}},{key:"removeMarkerLayer",value:function(D){D.destroy(),this.markerLayers.indexOf(D);var U=this.markerLayers.indexOf(D);U>-1&&this.markerLayers.splice(U,1)}},{key:"addMarker",value:function(D){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(D),D.addTo(this.scene)):this.unAddMarkers.push(D)}},{key:"addMarkers",value:function(){var D=this;this.unAddMarkers.forEach(function(U){U.addTo(D.scene),D.markers.push(U)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var D=this;this.unAddMarkerLayers.forEach(function(U){D.markerLayers.push(U),U.addTo(D.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(D){D.remove(),this.markers.indexOf(D);var U=this.markers.indexOf(D);U>-1&&this.markers.splice(U,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(D){this.scene=D,this.mapsService=D.get(F.a.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(D){D.remove()}),this.markers=[],this.markerLayers.forEach(function(D){D.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(D){D.destroy()}}]),ee}(),pe))||Ee),ae,Ie,qe,Ct=(ae=Object(N.injectable)(),ae(Ie=(qe=function(){function ee(){$()(this,ee),this.scene=void 0,this.popup=void 0,this.mapsService=void 0,this.unAddPopup=void 0}return Be()(ee,[{key:"removePopup",value:function(D){D.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(D){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(D.addTo(this.scene),this.popup=D):this.unAddPopup=D}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(D){this.scene=D,this.mapsService=D.get(F.a.IMapService)}}]),ee}(),qe))||Ie),Re=a("QkVN"),mt=a.n(Re),Qt={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},Br=Qt,Ur,or,Vr;function An(ee,ie){var D=Object.keys(ee);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ee);ie&&(U=U.filter(function(Se){return Object.getOwnPropertyDescriptor(ee,Se).enumerable})),D.push.apply(D,U)}return D}function dn(ee){for(var ie=1;ie<arguments.length;ie++){var D=arguments[ie]!=null?arguments[ie]:{};ie%2?An(Object(D),!0).forEach(function(U){q()(ee,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(D)):An(Object(D)).forEach(function(U){Object.defineProperty(ee,U,Object.getOwnPropertyDescriptor(D,U))})}return ee}var Cr={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},Tn={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15}},fn=(Ur=Object(N.injectable)(),Ur(or=(Vr=function(){function ee(){$()(this,ee),this.sceneConfigCache={},this.layerConfigCache={}}return Be()(ee,[{key:"getSceneConfig",value:function(D){return this.sceneConfigCache[D]}},{key:"getSceneWarninfo",value:function(D){return Br[D]}},{key:"setSceneConfig",value:function(D,U){this.sceneConfigCache[D]=dn(dn({},Cr),U)}},{key:"getLayerConfig",value:function(D){return this.layerConfigCache[D]}},{key:"setLayerConfig",value:function(D,U,Se){this.layerConfigCache[U]=dn({},mt()({},this.sceneConfigCache[D],Tn,Se))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),ee}(),Vr))||or),En=a("yG8O"),Cn=a.n(En),pn=a("U+yc"),Lr=a.n(pn),hi=a("1ABj"),xi=Math.PI/180,ki=512,_i=4003e4;function eo(ee){var ie=ee.latitude,D=ie===void 0?0:ie,U=ee.zoom,Se=U===void 0?0:U,tt=ee.scale,Ut=ee.highPrecision,qt=Ut===void 0?!1:Ut,er=ee.flipY,_r=er===void 0?!1:er;tt=tt!==void 0?tt:Math.pow(2,Se);var en={},Rn=ki*tt,$n=Math.cos(D*xi),ri=Rn/360,Mi=ri/$n,Ri=Rn/_i/$n;if(en.pixelsPerMeter=[Ri,-Ri,Ri],en.metersPerPixel=[1/Ri,-1/Ri,1/Ri],en.pixelsPerDegree=[ri,-Mi,Ri],en.degreesPerPixel=[1/ri,-1/Mi,1/Ri],qt){var fa=xi*Math.tan(D*xi)/$n,ua=ri*fa/2,Na=Rn/_i*fa,go=Na/Mi*Ri;en.pixelsPerDegree2=[0,-ua,Na],en.pixelsPerMeter2=[go,0,go],_r&&(en.pixelsPerDegree2[1]=-en.pixelsPerDegree2[1],en.pixelsPerMeter2[1]=-en.pixelsPerMeter2[1])}return _r&&(en.pixelsPerMeter[1]=-en.pixelsPerMeter[1],en.metersPerPixel[1]=-en.metersPerPixel[1],en.pixelsPerDegree[1]=-en.pixelsPerDegree[1],en.degreesPerPixel[1]=-en.degreesPerPixel[1]),en}var pi=a("HthE"),Ta,Di,bi,ci,ja,ps,to=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],lo=(Ta=Object(N.injectable)(),Di=Object(N.inject)(F.a.ICameraService),Ta(bi=(ci=(ps=function(){function ee(){$()(this,ee),this.needRefresh=!0,Cn()(this,"cameraService",ja,this),this.coordinateSystem=void 0,this.viewportCenter=void 0,this.viewportCenterProjection=void 0,this.pixelsPerDegree=void 0,this.pixelsPerDegree2=void 0,this.pixelsPerMeter=void 0}return Be()(ee,[{key:"refresh",value:function(){var D=this.cameraService.getZoom(),U=this.cameraService.getZoomScale(),Se=this.cameraService.getCenter(),tt=eo({latitude:Se[1],zoom:D}),Ut=tt.pixelsPerMeter,qt=tt.pixelsPerDegree;this.viewportCenter=Se,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=Ut,this.pixelsPerDegree=qt,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===pi.a.LNGLAT||this.coordinateSystem===pi.a.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===pi.a.LNGLAT_OFFSET?this.calculateLnglatOffset(Se,D):this.coordinateSystem===pi.a.P20_OFFSET&&this.calculateLnglatOffset(Se,D,U,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(D){this.coordinateSystem=D}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(D,U,Se,tt){var Ut=eo({latitude:D[1],zoom:U,scale:Se,flipY:tt,highPrecision:!0}),qt=Ut.pixelsPerMeter,er=Ut.pixelsPerDegree,_r=Ut.pixelsPerDegree2,en=this.cameraService.getViewMatrix(),Rn=this.cameraService.getProjectionMatrix(),$n=Pe.b.multiply([],Rn,en),ri=this.cameraService.projectFlat([Math.fround(D[0]),Math.fround(D[1])],Math.pow(2,U));this.viewportCenterProjection=Pe.e.transformMat4([],[ri[0],ri[1],0,1],$n),en=this.cameraService.getViewMatrixUncentered()||en,$n=Pe.b.multiply([],Rn,en),$n=Pe.b.multiply([],$n,to),this.cameraService.setViewProjectionMatrix($n),this.pixelsPerMeter=qt,this.pixelsPerDegree=er,this.pixelsPerDegree2=_r}}]),ee}(),ps),ja=Lr()(ci.prototype,"cameraService",[Di],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ci))||bi),Gu=a("PJYZ"),qi=a.n(Gu),Oa=a("yLV6"),is=a.n(Oa),ca=a("V1cb"),Ya,qo,sa,yo,co,Tu,as,bl;function _s(ee){var ie=Lo();return function(){var U=nt()(ee),Se;if(ie){var tt=nt()(this).constructor;Se=Reflect.construct(U,arguments,tt)}else Se=U.apply(this,arguments);return We()(this,Se)}}function Lo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var kt={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancle"},ze=(Ya=Object(N.injectable)(),qo=Object(N.inject)(F.a.IMapService),sa=Object(N.inject)(F.a.ILogService),Ya(yo=(co=(bl=function(ee){de()(D,ee);var ie=_s(D);function D(){var U;$()(this,D);for(var Se=arguments.length,tt=new Array(Se),Ut=0;Ut<Se;Ut++)tt[Ut]=arguments[Ut];return U=ie.call.apply(ie,[this].concat(tt)),Cn()(U,"mapService",Tu,qi()(U)),Cn()(U,"logger",as,qi()(U)),U.hammertime=void 0,U.lastClickTime=0,U.lastClickXY=[-1,-1],U.clickTimer=void 0,U.$containter=void 0,U.onDrag=function(qt){var er=U.interactionEvent(qt);er.type=kt[er.type],U.emit(ca.a.Drag,er)},U.onHammer=function(qt){qt.srcEvent.stopPropagation();var er=U.interactionEvent(qt);U.emit(ca.a.Hover,er)},U.onTouch=function(qt){var er=qt.touches[0];U.onHover({x:er.pageX,y:er.pageY,type:"touch"})},U.onHover=function(qt){var er=qt.clientX,_r=qt.clientY,en=er,Rn=_r,$n=qt.type,ri=U.mapService.getMapContainer();if(ri){var Mi=ri.getBoundingClientRect(),Ri=Mi.top,fa=Mi.left;en=en-fa-ri.clientLeft,Rn=Rn-Ri-ri.clientTop}var ua=U.mapService.containerToLngLat([en,Rn]);if($n==="click"){if("ontouchstart"in document.documentElement)return;U.isDoubleTap(en,Rn,ua);return}if($n==="touch"){U.isDoubleTap(en,Rn,ua);return}$n!=="click"&&$n!=="dblclick"&&U.emit(ca.a.Hover,{x:en,y:Rn,lngLat:ua,type:$n,target:qt})},U}return Be()(D,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(ca.a.Hover)}},{key:"triggerHover",value:function(Se){var tt=Se.x,Ut=Se.y;this.emit(ca.a.Hover,{x:tt,y:Ut})}},{key:"triggerSelect",value:function(Se){this.emit(ca.a.Select,{featureId:Se})}},{key:"triggerActive",value:function(Se){this.emit(ca.a.Active,{featureId:Se})}},{key:"addEventListenerOnMap",value:function(){var Se=this.mapService.getMapContainer();if(Se){var tt=new is.a.Manager(Se);tt.add(new is.a.Tap({event:"dblclick",taps:2})),tt.add(new is.a.Tap({event:"click"})),tt.add(new is.a.Pan({threshold:0,pointers:0})),tt.add(new is.a.Press({})),tt.on("dblclick click",this.onHammer),tt.on("panstart panmove panend pancancel",this.onDrag),Se.addEventListener("mousemove",this.onHover),Se.addEventListener("mousedown",this.onHover,!0),Se.addEventListener("mouseup",this.onHover),Se.addEventListener("contextmenu",this.onHover),this.hammertime=tt,this.logger.debug("add event listeners on canvas")}}},{key:"removeEventListenerOnMap",value:function(){var Se=this.mapService.getMapContainer();Se&&(Se.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),Se.removeEventListener("mousedown",this.onHover),Se.removeEventListener("mouseup",this.onHover),Se.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(Se){var tt=Se.type,Ut=Se.pointerType,qt,er;Ut==="touch"?(er=Math.floor(Se.pointers[0].clientY),qt=Math.floor(Se.pointers[0].clientX)):(er=Math.floor(Se.srcEvent.y),qt=Math.floor(Se.srcEvent.x));var _r=this.mapService.getMapContainer();if(_r){var en=_r.getBoundingClientRect(),Rn=en.top,$n=en.left;qt-=$n,er-=Rn}var ri=this.mapService.containerToLngLat([qt,er]);return{x:qt,y:er,lngLat:ri,type:tt,target:Se.srcEvent}}},{key:"isDoubleTap",value:function(Se,tt,Ut){var qt=this,er=new Date().getTime(),_r="click";er-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-Se)<10&&Math.abs(this.lastClickXY[1]-tt)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),_r="dblclick",this.emit(ca.a.Hover,{x:Se,y:tt,lngLat:Ut,type:_r})):(this.lastClickTime=er,this.lastClickXY=[Se,tt],this.clickTimer=setTimeout(function(){_r="click",qt.emit(ca.a.Hover,{x:Se,y:tt,lngLat:Ut,type:_r})},400))}}]),D}(Z.a),bl),Tu=Lr()(co.prototype,"mapService",[qo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),as=Lr()(co.prototype,"logger",[sa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),co))||yo),It=a("o0o1"),fr=a.n(It),nn=a("yXPU"),yn=a.n(nn),Vn=a("o+pz"),Ua,xo,_o,Ro,Hu,zl,Ks,nf,Nl,vs,fu,bo;function $s(ee,ie){var D=Object.keys(ee);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ee);ie&&(U=U.filter(function(Se){return Object.getOwnPropertyDescriptor(ee,Se).enumerable})),D.push.apply(D,U)}return D}function Zu(ee){for(var ie=1;ie<arguments.length;ie++){var D=arguments[ie]!=null?arguments[ie]:{};ie%2?$s(Object(D),!0).forEach(function(U){q()(ee,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(D)):$s(Object(D)).forEach(function(U){Object.defineProperty(ee,U,Object.getOwnPropertyDescriptor(D,U))})}return ee}var Js=(Ua=Object(N.injectable)(),xo=Object(N.inject)(F.a.IRendererService),_o=Object(N.inject)(F.a.IGlobalConfigService),Ro=Object(N.inject)(F.a.IInteractionService),Hu=Object(N.inject)(F.a.ILayerService),Ua(zl=(Ks=(bo=function(){function ee(){var ie=this;$()(this,ee),Cn()(this,"rendererService",nf,this),Cn()(this,"configService",Nl,this),Cn()(this,"interactionService",vs,this),Cn()(this,"layerService",fu,this),this.pickingFBO=void 0,this.width=0,this.height=0,this.alreadyInPicking=!1,this.pickBufferScale=1,this.pickFromPickingFBO=function(D,U){var Se,tt=U.x,Ut=U.y,qt=U.lngLat,er=U.type,_r=U.target,en=!1,Rn=ie.rendererService,$n=Rn.getViewportSize,ri=Rn.readPixels,Mi=Rn.getContainer,Ri=Mi().getBoundingClientRect(),fa=Ri.width,ua=Ri.height;fa*=ce.a.DPR,ua*=ce.a.DPR;var Na=D.getLayerConfig(),go=Na.enableHighlight,ao=Na.enableSelect,Va=tt*ce.a.DPR,Co=Ut*ce.a.DPR;if(Va>fa-1*ce.a.DPR||Va<0||Co>ua-1*ce.a.DPR||Co<0)return!1;var Xi;if(Xi=ri({x:Math.floor(Va/ie.pickBufferScale),y:Math.floor((ua-(Ut+1)*ce.a.DPR)/ie.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:ie.pickingFBO}),Xi[0]!==0||Xi[1]!==0||Xi[2]!==0){var Qa=Object(ce.k)(Xi),ls=D.getSource().getFeatureById(Qa);Qa!==D.getCurrentPickId()&&er==="mousemove"&&(er="mouseenter");var Sa={x:tt,y:Ut,type:er,lngLat:qt,featureId:Qa,feature:ls,target:_r};ls&&(en=!0,D.setCurrentPickId(Qa),ie.triggerHoverOnLayer(D,Sa))}else{var Ma={x:tt,y:Ut,lngLat:qt,type:D.getCurrentPickId()!==null&&er==="mousemove"?"mouseout":"un"+er,featureId:null,target:_r,feature:null};ie.triggerHoverOnLayer(D,Zu(Zu({},Ma),{},{type:"unpick"})),ie.triggerHoverOnLayer(D,Ma),D.setCurrentPickId(null)}if(go&&ie.highlightPickedFeature(D,Xi),ao&&er==="click"&&((Se=Xi)===null||Se===void 0?void 0:Se.toString())!==[0,0,0,0].toString()){var gi=Object(ce.k)(Xi);D.getCurrentSelectedId()===null||gi!==D.getCurrentSelectedId()?(ie.selectFeature(D,Xi),D.setCurrentSelectedId(gi)):(ie.selectFeature(D,new Uint8Array([0,0,0,0])),D.setCurrentSelectedId(null))}return en}}return Be()(ee,[{key:"init",value:function(D){var U=this.rendererService,Se=U.createTexture2D,tt=U.createFramebuffer,Ut=U.getViewportSize,qt=U.getContainer,er=qt().getBoundingClientRect(),_r=er.width,en=er.height;_r*=ce.a.DPR,en*=ce.a.DPR,this.pickBufferScale=this.configService.getSceneConfig(D).pickBufferScale||1,this.pickingFBO=tt({color:Se({width:Math.round(_r/this.pickBufferScale),height:Math.round(en/this.pickBufferScale),wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})}),this.interactionService.on(ca.a.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var ie=yn()(fr.a.mark(function U(Se,tt,Ut){var qt=this,er,_r,en,Rn;return fr.a.wrap(function(ri){for(;;)switch(ri.prev=ri.next){case 0:er=this.rendererService,_r=er.useFramebuffer,en=er.clear,Rn=er.getContainer,this.resizePickingFBO(),_r(this.pickingFBO,function(){en({framebuffer:qt.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Se.hooks.beforePickingEncode.call(),Se.renderModels(),Se.hooks.afterPickingEncode.call();var Mi=qt.pickBox(Se,tt);Ut(Mi)});case 3:case"end":return ri.stop()}},U,this)}));function D(U,Se,tt){return ie.apply(this,arguments)}return D}()},{key:"pickBox",value:function(D,U){var Se=this,tt=U.map(function(Ma){var gi=Ma<0?0:Ma;return Math.floor(gi*ce.a.DPR/Se.pickBufferScale)}),Ut=pt()(tt,4),qt=Ut[0],er=Ut[1],_r=Ut[2],en=Ut[3],Rn=this.rendererService,$n=Rn.getViewportSize,ri=Rn.readPixels,Mi=Rn.getContainer,Ri=Mi().getBoundingClientRect(),fa=Ri.width,ua=Ri.height;if(fa*=ce.a.DPR,ua*=ce.a.DPR,qt>(fa-1)*ce.a.DPR/this.pickBufferScale||_r<0||er>(ua-1)*ce.a.DPR/this.pickBufferScale||en<0)return[];var Na,go=Math.min(fa/this.pickBufferScale,_r)-qt,ao=Math.min(ua/this.pickBufferScale,en)-er;Na=ri({x:qt,y:Math.floor(ua/this.pickBufferScale-(en+1)),width:go,height:ao,data:new Uint8Array(go*ao*4),framebuffer:this.pickingFBO});for(var Va=[],Co={},Xi=0;Xi<Na.length/4;Xi=Xi+1){var Qa=Na.slice(Xi*4,Xi*4+4),ls=Object(ce.k)(Qa);if(ls!==-1&&!Co[ls]){var Sa=D.getSource().getFeatureById(ls);Va.push(Sa),Co[ls]=!0}}return Va}},{key:"pickingAllLayer",value:function(){var ie=yn()(fr.a.mark(function U(Se){return fr.a.wrap(function(Ut){for(;;)switch(Ut.prev=Ut.next){case 0:if(!(this.alreadyInPicking||this.layerService.alreadyInRendering)){Ut.next=2;break}return Ut.abrupt("return");case 2:return this.alreadyInPicking=!0,Ut.next=5,this.pickingLayers(Se);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return Ut.stop()}},U,this)}));function D(U){return ie.apply(this,arguments)}return D}()},{key:"resizePickingFBO",value:function(){var D=this.rendererService.getContainer,U=D().getBoundingClientRect(),Se=U.width,tt=U.height;Se*=ce.a.DPR,tt*=ce.a.DPR,(this.width!==Se||this.height!==tt)&&(this.pickingFBO.resize({width:Math.round(Se/this.pickBufferScale),height:Math.round(tt/this.pickBufferScale)}),this.width=Se,this.height=tt)}},{key:"pickingLayers",value:function(){var ie=yn()(fr.a.mark(function U(Se){var tt=this,Ut,qt,er,_r,en;return fr.a.wrap(function($n){for(;;)switch($n.prev=$n.next){case 0:Ut=this.rendererService,qt=Ut.getViewportSize,er=Ut.useFramebuffer,_r=Ut.clear,en=Ut.getContainer,this.resizePickingFBO(),er(this.pickingFBO,function(){var ri=tt.layerService.getLayers();ri.filter(function(Mi){return Mi.needPick(Se.type)}).reverse().some(function(Mi){_r({framebuffer:tt.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Mi.hooks.beforePickingEncode.call(),Mi.renderModels(),Mi.hooks.afterPickingEncode.call();var Ri=tt.pickFromPickingFBO(Mi,Se);return Ri&&!Mi.getLayerConfig().enablePropagation})});case 3:case"end":return $n.stop()}},U,this)}));function D(U){return ie.apply(this,arguments)}return D}()},{key:"triggerHoverOnLayer",value:function(D,U){D.emit(U.type,U)}},{key:"highlightPickedFeature",value:function(D,U){var Se=pt()(U,3),tt=Se[0],Ut=Se[1],qt=Se[2];D.hooks.beforeHighlight.call([tt,Ut,qt])}},{key:"selectFeature",value:function(D,U){var Se=pt()(U,3),tt=Se[0],Ut=Se[1],qt=Se[2];D.hooks.beforeSelect.call([tt,Ut,qt])}}]),ee}(),bo),nf=Lr()(Ks.prototype,"rendererService",[xo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nl=Lr()(Ks.prototype,"configService",[_o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vs=Lr()(Ks.prototype,"interactionService",[Ro],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fu=Lr()(Ks.prototype,"layerService",[Hu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ks))||zl),Wu=function(){function ee(){var ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;$()(this,ee),this.autoStart=void 0,this.startTime=0,this.oldTime=0,this.running=!1,this.elapsedTime=0,this.autoStart=ie}return Be()(ee,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var D=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var U=(typeof performance=="undefined"?Date:performance).now();D=(U-this.oldTime)/1e3,this.oldTime=U,this.elapsedTime+=D}return D}}]),ee}(),wa,Ka,hu,Xu,nc,Ot,tr,Mr,Xn=(wa=Object(N.injectable)(),Ka=Object(N.inject)(F.a.IRendererService),hu=Object(N.inject)(F.a.IGlobalConfigService),wa(Xu=(nc=(Mr=function(){function ee(){$()(this,ee),this.clock=new Wu,this.alreadyInRendering=!1,this.layers=[],this.layerRenderID=void 0,this.sceneInited=!1,this.animateInstanceCount=0,Cn()(this,"renderService",Ot,this),Cn()(this,"configService",tr,this)}return Be()(ee,[{key:"add",value:function(D){this.sceneInited&&D.init(),this.layers.push(D)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(D){D.inited||D.init()})}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(D){return this.layers.find(function(U){return U.id===D})}},{key:"getLayerByName",value:function(D){return this.layers.find(function(U){return U.name===D})}},{key:"remove",value:function(D){var U=this.layers.indexOf(D);U>-1&&this.layers.splice(U,1),D.emit("remove",null),D.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(){this.alreadyInRendering||(this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter(function(D){return D.inited}).filter(function(D){return D.isVisible()}).forEach(function(D){D.hooks.beforeRenderData.call(),D.hooks.beforeRender.call(),D.render(),D.hooks.afterRender.call()}),this.alreadyInRendering=!1)}},{key:"updateRenderOrder",value:function(){this.layers.sort(function(D,U){return D.zIndex-U.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(D){return D.destroy()}),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){this.animateInstanceCount++==0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount==0&&(this.stopRender(),this.clock.stop())}},{key:"clear",value:function(){this.renderService.clear({color:[0,0,0,0],depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),ee}(),Mr),Ot=Lr()(nc.prototype,"renderService",[Ka],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tr=Lr()(nc.prototype,"configService",[hu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nc))||Xu),Wi=a("QILm"),oa=a.n(Wi),Xa=a("RIqP"),zi=a.n(Xa),La=a("J2iB"),Do=a.n(La),ms=function(){function ee(ie){var D=this;$()(this,ee),this.name=void 0,this.type=void 0,this.scale=void 0,this.descriptor=void 0,this.featureBufferLayout=[],this.needRescale=!1,this.needRemapping=!1,this.needRegenerateVertices=!1,this.featureRange={startIndex:0,endIndex:Infinity},this.vertexAttribute=void 0,this.defaultCallback=function(U){if(U.length===0){var Se;return((Se=D.scale)===null||Se===void 0?void 0:Se.defaultValues)||[]}return U.map(function(tt,Ut){var qt,er=(qt=D.scale)===null||qt===void 0?void 0:qt.scalers[Ut].func,_r=er(tt);return _r})},this.setProps(ie)}return Be()(ee,[{key:"setProps",value:function(D){Object.assign(this,D)}},{key:"mapping",value:function(D){var U;if((U=this.scale)===null||U===void 0?void 0:U.callback){var Se,tt=(Se=this.scale)===null||Se===void 0?void 0:Se.callback.apply(Se,zi()(D));if(!Do()(tt))return[tt]}return this.defaultCallback(D)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),ee}(),Aa,Sl,du,os,Yu,Au,Ku;function Cu(ee,ie){var D=Object.keys(ee);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ee);ie&&(U=U.filter(function(Se){return Object.getOwnPropertyDescriptor(ee,Se).enumerable})),D.push.apply(D,U)}return D}function ol(ee){for(var ie=1;ie<arguments.length;ie++){var D=arguments[ie]!=null?arguments[ie]:{};ie%2?Cu(Object(D),!0).forEach(function(U){q()(ee,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(D)):Cu(Object(D)).forEach(function(U){Object.defineProperty(ee,U,Object.getOwnPropertyDescriptor(D,U))})}return ee}function pu(ee){return new Promise(function(ie){return setTimeout(ie,ee)})}var af=(Aa={},q()(Aa,Vn.a.FLOAT,4),q()(Aa,Vn.a.UNSIGNED_BYTE,1),q()(Aa,Vn.a.UNSIGNED_SHORT,2),Aa),Nf=(Sl=Object(N.injectable)(),du=Object(N.inject)(F.a.IRendererService),Sl(os=(Yu=(Ku=function(){function ee(){$()(this,ee),this.attributesAndIndices=void 0,Cn()(this,"rendererService",Au,this),this.attributes=[],this.triangulation=void 0,this.featureLayout={sizePerElement:0,elements:[]}}return Be()(ee,[{key:"registerStyleAttribute",value:function(D){var U=this.getLayerStyleAttribute(D.name||"");return U?U.setProps(D):(U=new ms(D),this.attributes.push(U)),U}},{key:"updateStyleAttribute",value:function(D,U,Se){var tt=this.getLayerStyleAttribute(D);tt||(tt=this.registerStyleAttribute(ol(ol({},U),{},{name:D})));var Ut=U.scale;Ut&&tt&&(tt.scale=Ut,tt.needRescale=!0,tt.needRemapping=!0,tt.needRegenerateVertices=!0,Se&&Se.featureRange&&(tt.featureRange=Se.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(D){return this.attributes.find(function(U){return U.name===D})}},{key:"getLayerAttributeScale",value:function(D){var U,Se=this.getLayerStyleAttribute(D),tt=Se==null||(U=Se.scale)===null||U===void 0?void 0:U.scalers;return tt&&tt[0]?tt[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(D,U){var Se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,tt=arguments.length>3?arguments[3]:void 0,Ut=this.attributes.find(function(ao){return ao.name===D});if(Ut&&Ut.descriptor){var qt=Ut.descriptor,er=qt.update,_r=qt.buffer,en=qt.size,Rn=en===void 0?0:en,$n=af[_r.type||Vn.a.FLOAT];if(er){var ri=this.featureLayout,Mi=ri.elements,Ri=ri.sizePerElement,fa=Mi.slice(Se,tt);if(!fa.length)return;var ua=fa[0].offset,Na=ua*Rn*$n,go=fa.map(function(ao,Va){for(var Co=ao.featureIdx,Xi=ao.vertices,Qa=ao.normals,ls=Xi.length/Ri,Sa=[],Ma=0;Ma<ls;Ma++){var gi=Qa?Qa.slice(Ma*3,Ma*3+3):[];Sa.push.apply(Sa,zi()(er(U[Co],Co,Xi.slice(Ma*Ri,Ma*Ri+Ri),Va,gi)))}return Sa}).reduce(function(ao,Va){return ao.push.apply(ao,zi()(Va)),ao},[]);Ut.vertexAttribute.updateBuffer({data:go,offset:Na})}}}},{key:"createAttributesAndIndices",value:function(D,U){var Se=this;this.featureLayout={sizePerElement:0,elements:[]},U&&(this.triangulation=U);var tt=this.attributes.map(function(ua){return ua.resetDescriptor(),ua.descriptor}),Ut=0,qt=[],er=[],_r=[],en=3;D.forEach(function(ua,Na){var go=Se.triangulation(ua),ao=go.indices,Va=go.vertices,Co=go.normals,Xi=go.size;ao.forEach(function(Ma){er.push(Ma+Ut)}),en=Xi;var Qa=Va.length/Xi;Se.featureLayout.sizePerElement=en,Se.featureLayout.elements.push({featureIdx:Na,vertices:Va,normals:Co,offset:Ut}),Ut+=Qa;for(var ls=function(gi){var Bo=(Co==null?void 0:Co.slice(gi*3,gi*3+3))||[],gc=Va.slice(gi*Xi,gi*Xi+Xi);tt.forEach(function($f,vh){if($f&&$f.update){var Jf;(Jf=$f.buffer.data).push.apply(Jf,zi()($f.update(ua,Na,gc,gi,Bo)))}})},Sa=0;Sa<Qa;Sa++)ls(Sa)});var Rn=this.rendererService,$n=Rn.createAttribute,ri=Rn.createBuffer,Mi=Rn.createElements,Ri={};tt.forEach(function(ua,Na){if(ua){var go=ua.buffer,ao=ua.update,Va=ua.name,Co=oa()(ua,["buffer","update","name"]),Xi=$n(ol({buffer:ri(go)},Co));Ri[ua.name||""]=Xi,Se.attributes[Na].vertexAttribute=Xi}});var fa=Mi({data:er,type:Vn.a.UNSIGNED_INT,count:er.length});return this.attributesAndIndices={attributes:Ri,elements:fa},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var D;this.attributes.forEach(function(U){U.vertexAttribute&&U.vertexAttribute.destroy()}),(D=this.attributesAndIndices)===null||D===void 0||D.elements.destroy(),this.attributes=[]}}]),ee}(),Ku),Au=Lr()(Yu.prototype,"rendererService",[du],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yu))||os),ba=a("U8pU"),Nc=a("KQm4"),Fc=a("rePB"),bf=a("1OyB"),Bc=a("vuIU"),Sf=a("5ku3"),ro=typeof __VERSION__!="undefined"?__VERSION__:"untranspiled source",wu=Object(Sf.a)();function El(ee){try{var ie=window[ee],D="__storage_test__";return ie.setItem(D,D),ie.removeItem(D),ie}catch(U){return null}}var gs=function(){function ee(ie,D){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";Object(bf.a)(this,ee),this.storage=El(U),this.id=ie,this.config={},Object.assign(this.config,D),this._loadConfiguration()}return Object(Bc.a)(ee,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(D){return this.config={},this.updateConfiguration(D)}},{key:"updateConfiguration",value:function(D){if(Object.assign(this.config,D),this.storage){var U=JSON.stringify(this.config);this.storage.setItem(this.id,U)}return this}},{key:"_loadConfiguration",value:function(){var D={};if(this.storage){var U=this.storage.getItem(this.id);D=U?JSON.parse(U):{}}return Object.assign(this.config,D),this}}]),ee}();function kc(ee){var ie;return ee<10?ie="".concat(ee.toFixed(2),"ms"):ee<100?ie="".concat(ee.toFixed(1),"ms"):ee<1e3?ie="".concat(ee.toFixed(0),"ms"):ie="".concat((ee/1e3).toFixed(2),"s"),ie}function bc(ee){var ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,D=Math.max(ie-ee.length,0);return"".concat(" ".repeat(D)).concat(ee)}function Tl(ee){var ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,D=Math.max(ie-ee.length,0);return"".concat(ee).concat(" ".repeat(D))}function sl(ee){var ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},D=1e-16,U=ie.isInteger,Se=U===void 0?!1:U;if(Array.isArray(ee)||ArrayBuffer.isView(ee))return $u(ee,ie);if(!Number.isFinite(ee))return String(ee);if(Math.abs(ee)<D)return Se?"0":"0.";if(Se||Math.abs(ee)>100&&Math.abs(ee)<1e4)return ee.toFixed(0);var tt=ee.toPrecision(2),Ut=tt.indexOf(".0");return Ut===tt.length-2?tt.slice(0,-1):tt}function $u(ee,ie){for(var D=ie.maxElts,U=D===void 0?16:D,Se=ie.size,tt=Se===void 0?1:Se,Ut="[",qt=0;qt<ee.length&&qt<U;++qt)qt>0&&(Ut+=",".concat(qt%tt==0?" ":"")),Ut+=sl(ee[qt],ie);var er=ee.length>U?"...":"]";return"".concat(Ut).concat(er)}function Qs(ee,ie,D){var U=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,Se=ee.src.replace(/\(/g,"%28").replace(/\)/g,"%29");ee.width>U&&(D=Math.min(D,U/ee.width));var tt=ee.width*D,Ut=ee.height*D,qt=["font-size:1px;","padding:".concat(Math.floor(Ut/2),"px ").concat(Math.floor(tt/2),"px;"),"line-height:".concat(Ut,"px;"),"background:url(".concat(Se,");"),"background-size:".concat(tt,"px ").concat(Ut,"px;"),"color:transparent;"].join("");return["".concat(ie," %c+"),qt]}var Pu={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function jc(ee){return typeof ee=="string"?Pu[ee.toUpperCase()]||Pu.WHITE:ee}function Fl(ee,ie,D){return!wu&&typeof ee=="string"&&(ie&&(ie=jc(ie),ee="[".concat(ie,"m").concat(ee,"[39m")),D&&(ie=jc(D),ee="[".concat(D+10,"m").concat(ee,"[49m"))),ee}function Pa(ee){if(typeof Symbol=="undefined"||ee[Symbol.iterator]==null){if(Array.isArray(ee)||(ee=Uc(ee))){var ie=0,D=function(){};return{s:D,n:function(){return ie>=ee.length?{done:!0}:{done:!1,value:ee[ie++]}},e:function(er){throw er},f:D}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var U,Se=!0,tt=!1,Ut;return{s:function(){U=ee[Symbol.iterator]()},n:function(){var er=U.next();return Se=er.done,er},e:function(er){tt=!0,Ut=er},f:function(){try{!Se&&U.return!=null&&U.return()}finally{if(tt)throw Ut}}}}function Uc(ee,ie){if(!!ee){if(typeof ee=="string")return Ef(ee,ie);var D=Object.prototype.toString.call(ee).slice(8,-1);if(D==="Object"&&ee.constructor&&(D=ee.constructor.name),D==="Map"||D==="Set")return Array.from(D);if(D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D))return Ef(ee,ie)}}function Ef(ee,ie){(ie==null||ie>ee.length)&&(ie=ee.length);for(var D=0,U=new Array(ie);D<ie;D++)U[D]=ee[D];return U}function Sc(ee){var ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"],D=Object.getPrototypeOf(ee),U=Object.getOwnPropertyNames(D),Se=Pa(U),tt;try{var Ut=function(){var er=tt.value;typeof ee[er]=="function"&&(ie.find(function(_r){return er===_r})||(ee[er]=ee[er].bind(ee)))};for(Se.s();!(tt=Se.n()).done;)Ut()}catch(qt){Se.e(qt)}finally{Se.f()}}function Ec(ee,ie){if(!ee)throw new Error(ie||"Assertion failed")}var ic=a("K9nA");function ul(){var ee;if(wu&&ic.b.performance)ee=ic.b.performance.now();else if(ic.a.hrtime){var ie=ic.a.hrtime();ee=ie[0]*1e3+ie[1]/1e6}else ee=Date.now();return ee}var _u={debug:wu&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Bl={enabled:!0,level:0};function Vo(){}var ac={},kl={once:!0};function Al(ee){for(var ie in ee)for(var D in ee[ie])return D||"untitled";return"empty"}var Tc=function(){function ee(){var ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},D=ie.id;Object(bf.a)(this,ee),this.id=D,this.VERSION=ro,this._startTs=ul(),this._deltaTs=ul(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new gs("__probe-".concat(this.id,"__"),Bl),this.userData={},this.timeStamp("".concat(this.id," started")),Sc(this),Object.seal(this)}return Object(Bc.a)(ee,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((ul()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((ul()-this._deltaTs).toPrecision(10))}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:D}),this}},{key:"setLevel",value:function(D){return this._storage.updateConfiguration({level:D}),this}},{key:"assert",value:function(D,U){Ec(D,U)}},{key:"warn",value:function(D){return this._getLogFunction(0,D,_u.warn,arguments,kl)}},{key:"error",value:function(D){return this._getLogFunction(0,D,_u.error,arguments)}},{key:"deprecated",value:function(D,U){return this.warn("`".concat(D,"` is deprecated and will be removed in a later version. Use `").concat(U,"` instead"))}},{key:"removed",value:function(D,U){return this.error("`".concat(D,"` has been removed. Use `").concat(U,"` instead"))}},{key:"probe",value:function(D,U){return this._getLogFunction(D,U,_u.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(D,U){return this._getLogFunction(D,U,_u.debug,arguments)}},{key:"info",value:function(D,U){return this._getLogFunction(D,U,console.info,arguments)}},{key:"once",value:function(D,U){return this._getLogFunction(D,U,_u.debug||_u.info,arguments,kl)}},{key:"table",value:function(D,U,Se){return U?this._getLogFunction(D,U,console.table||Vo,Se&&[Se],{tag:Al(U)}):Vo}},{key:"image",value:function(D){var U=D.logLevel,Se=D.priority,tt=D.image,Ut=D.message,qt=Ut===void 0?"":Ut,er=D.scale,_r=er===void 0?1:er;return this._shouldLog(U||Se)?wu?of({image:tt,message:qt,scale:_r}):Af({image:tt,message:qt,scale:_r}):Vo}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(D){return this._storage.config[D]}},{key:"set",value:function(D,U){this._storage.updateConfiguration(Object(Fc.a)({},D,U))}},{key:"time",value:function(D,U){return this._getLogFunction(D,U,console.time?console.time:console.info)}},{key:"timeEnd",value:function(D,U){return this._getLogFunction(D,U,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(D,U){return this._getLogFunction(D,U,console.timeStamp||Vo)}},{key:"group",value:function(D,U){var Se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};Se=qs({logLevel:D,message:U,opts:Se});var tt=Se,Ut=tt.collapsed;return Se.method=(Ut?console.groupCollapsed:console.group)||console.info,this._getLogFunction(Se)}},{key:"groupCollapsed",value:function(D,U){var Se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(D,U,Object.assign({},Se,{collapsed:!0}))}},{key:"groupEnd",value:function(D){return this._getLogFunction(D,"",console.groupEnd||Vo)}},{key:"withGroup",value:function(D,U,Se){this.group(D,U)();try{Se()}finally{this.groupEnd(D)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(D){return this.isEnabled()&&this.getLevel()>=jl(D)}},{key:"_getLogFunction",value:function(D,U,Se){var tt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],Ut=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(D)){var qt;Ut=qs({logLevel:D,message:U,args:tt,opts:Ut}),Se=Se||Ut.method,Ec(Se),Ut.total=this.getTotal(),Ut.delta=this.getDelta(),this._deltaTs=ul();var er=Ut.tag||Ut.message;if(Ut.once)if(!ac[er])ac[er]=ul();else return Vo;return U=Tf(this.id,Ut.message,Ut),(qt=Se).bind.apply(qt,[console,U].concat(Object(Nc.a)(Ut.args)))}return Vo}},{key:"level",set:function(D){this.setLevel(D)},get:function(){return this.getLevel()}},{key:"priority",set:function(D){this.level=D},get:function(){return this.level}}]),ee}();Tc.VERSION=ro;function jl(ee){if(!ee)return 0;var ie;switch(Object(ba.a)(ee)){case"number":ie=ee;break;case"object":ie=ee.logLevel||ee.priority||0;break;default:return 0}return Ec(Number.isFinite(ie)&&ie>=0),ie}function qs(ee){var ie=ee.logLevel,D=ee.message;ee.logLevel=jl(ie);for(var U=ee.args?Array.from(ee.args):[];U.length&&U.shift()!==D;);switch(ee.args=U,Object(ba.a)(ie)){case"string":case"function":D!==void 0&&U.unshift(D),ee.message=ie;break;case"object":Object.assign(ee,ie);break;default:}typeof ee.message=="function"&&(ee.message=ee.message());var Se=Object(ba.a)(ee.message);return Ec(Se==="string"||Se==="object"),Object.assign(ee,ee.opts)}function Tf(ee,ie,D){if(typeof ie=="string"){var U=D.time?bc(kc(D.total)):"";ie=D.time?"".concat(ee,": ").concat(U,"  ").concat(ie):"".concat(ee,": ").concat(ie),ie=Fl(ie,D.color,D.background)}return ie}function Af(ee){var ie=ee.image,D=ee.message,U=D===void 0?"":D,Se=ee.scale,tt=Se===void 0?1:Se,Ut=null;try{Ut=a(2)}catch(qt){}return Ut?function(){return Ut(ie,{fit:"box",width:"".concat(Math.round(80*tt),"%")}).then(function(qt){return console.log(qt)})}:Vo}function of(ee){var ie=ee.image,D=ee.message,U=D===void 0?"":D,Se=ee.scale,tt=Se===void 0?1:Se;if(typeof ie=="string"){var Ut=new Image;return Ut.onload=function(){var en,Rn=Qs(Ut,U,tt);(en=console).log.apply(en,Object(Nc.a)(Rn))},Ut.src=ie,Vo}var qt=ie.nodeName||"";if(qt.toLowerCase()==="img"){var er;return(er=console).log.apply(er,Object(Nc.a)(Qs(ie,U,tt))),Vo}if(qt.toLowerCase()==="canvas"){var _r=new Image;return _r.onload=function(){var en;return(en=console).log.apply(en,Object(Nc.a)(Qs(_r,U,tt)))},_r.src=ie.toDataURL(),Vo}return Vo}var Cl,oc,ll=new Tc({id:"L7"}).enable(!1);ll.priority=5;var Ul=(Cl=Object(N.injectable)(),Cl(oc=function(){function ee(){$()(this,ee)}return Be()(ee,[{key:"error",value:function(D){ll.error(D)()}},{key:"warn",value:function(D){ll.probe(1,D)()}},{key:"info",value:function(D){ll.info(3,D)()}},{key:"debug",value:function(D){ll.probe(4,D)()}}]),ee}())||oc),Ac=a("xp6e"),Cc=a("iegG"),Vl=a.n(Cc),So=window.document.documentElement.style,Ff=0;function Cf(ee){var ie=ee;if(typeof ee=="string"&&(ie=document.getElementById(ee)),ie){var D=document.createElement("div");return D.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,D.id="l7-scene-".concat(Ff++),D.classList.add("l7-scene"),ie.appendChild(D),D}return null}var sc,Vc,sf,uf,Gl,lf,Mu,Ra,eu,Go,Iu,ji,Da,js,tu,Hl,uc,wf,zo,Zl,ya,Ki,fo,ys,wl,$a,Mn,zs,wc,cl,vu,Us,Ou,an,Gc,lc;function Wl(ee){var ie=mu();return function(){var U=nt()(ee),Se;if(ie){var tt=nt()(this).constructor;Se=Reflect.construct(U,arguments,tt)}else Se=U.apply(this,arguments);return We()(this,Se)}}function mu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var Gi=(sc=Object(N.injectable)(),Vc=Object(N.inject)(F.a.SceneID),sf=Object(N.inject)(F.a.IIconService),uf=Object(N.inject)(F.a.IFontService),Gl=Object(N.inject)(F.a.IControlService),lf=Object(N.inject)(F.a.ILogService),Mu=Object(N.inject)(F.a.IGlobalConfigService),Ra=Object(N.inject)(F.a.IMapService),eu=Object(N.inject)(F.a.ICoordinateSystemService),Go=Object(N.inject)(F.a.IRendererService),Iu=Object(N.inject)(F.a.ILayerService),ji=Object(N.inject)(F.a.ICameraService),Da=Object(N.inject)(F.a.IInteractionService),js=Object(N.inject)(F.a.IPickingService),tu=Object(N.inject)(F.a.IShaderModuleService),Hl=Object(N.inject)(F.a.IMarkerService),uc=Object(N.inject)(F.a.IPopupService),sc(wf=(zo=(lc=function(ee){de()(D,ee);var ie=Wl(D);function D(){var U;return $()(this,D),U=ie.call(this),U.destroyed=!1,U.loaded=!1,Cn()(U,"id",Zl,qi()(U)),Cn()(U,"iconService",ya,qi()(U)),Cn()(U,"fontService",Ki,qi()(U)),Cn()(U,"controlService",fo,qi()(U)),Cn()(U,"logger",ys,qi()(U)),Cn()(U,"configService",wl,qi()(U)),Cn()(U,"map",$a,qi()(U)),Cn()(U,"coordinateSystemService",Mn,qi()(U)),Cn()(U,"rendererService",zs,qi()(U)),Cn()(U,"layerService",wc,qi()(U)),Cn()(U,"cameraService",cl,qi()(U)),Cn()(U,"interactionService",vu,qi()(U)),Cn()(U,"pickingService",Us,qi()(U)),Cn()(U,"shaderModuleService",Ou,qi()(U)),Cn()(U,"markerService",an,qi()(U)),Cn()(U,"popupService",Gc,qi()(U)),U.inited=!1,U.initPromise=void 0,U.rendering=!1,U.$container=void 0,U.canvas=void 0,U.markerContainer=void 0,U.hooks=void 0,U.handleWindowResized=function(){U.emit("resize"),U.$container&&(U.initContainer(),ce.a.triggerResize(),U.coordinateSystemService.needRefresh=!0,U.render())},U.handleMapCameraChanged=function(Se){U.cameraService.update(Se),U.render()},U.hooks={init:new Ac.a},U}return Be()(D,[{key:"init",value:function(Se){var tt=this;this.configService.setSceneConfig(this.id,Se),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",yn()(fr.a.mark(function Ut(){return fr.a.wrap(function(er){for(;;)switch(er.prev=er.next){case 0:return er.next=2,new Promise(function(_r){tt.map.onCameraChanged(function(en){tt.cameraService.init(),tt.cameraService.update(en),_r()}),tt.map.init()});case 2:tt.map.onCameraChanged(tt.handleMapCameraChanged),tt.map.addMarkerContainer(),tt.markerService.addMarkers(),tt.markerService.addMarkerLayers(),tt.popupService.initPopup(),tt.interactionService.init(),tt.interactionService.on(ca.a.Drag,tt.addSceneEvent.bind(tt)),tt.logger.debug("map ".concat(tt.id," loaded"));case 10:case"end":return er.stop()}},Ut)}))),this.hooks.init.tapPromise("initRenderer",yn()(fr.a.mark(function Ut(){var qt;return fr.a.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:if(qt=Cf(tt.configService.getSceneConfig(tt.id).id||""),tt.$container=qt,!qt){_r.next=11;break}return tt.canvas=ce.a.create("canvas","",qt),tt.setCanvas(),_r.next=7,tt.rendererService.init(tt.canvas,tt.configService.getSceneConfig(tt.id));case 7:Vl()(tt.$container,tt.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(tt.handleWindowResized),_r.next=12;break;case 11:tt.logger.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 12:tt.pickingService.init(tt.id),tt.logger.debug("scene ".concat(tt.id," renderer loaded"));case 14:case"end":return _r.stop()}},Ut)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(Se){this.logger.debug("add layer ".concat(Se.name," to scene ").concat(this.id)),this.layerService.add(Se),this.render()}},{key:"render",value:function(){var U=yn()(fr.a.mark(function tt(){return fr.a.wrap(function(qt){for(;;)switch(qt.prev=qt.next){case 0:if(!(this.rendering||this.destroyed)){qt.next=2;break}return qt.abrupt("return");case 2:if(this.rendering=!0,this.inited){qt.next=13;break}return qt.next=6,this.initPromise;case 6:this.destroyed&&this.destroy(),this.logger.info(" render inited"),this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 13:this.layerService.renderLayers(),this.logger.debug("scene ".concat(this.id," render")),this.rendering=!1;case 16:case"end":return qt.stop()}},tt,this)}));function Se(){return U.apply(this,arguments)}return Se}()},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(Se){var tt,Ut=(tt=this.$container)===null||tt===void 0?void 0:tt.getElementsByTagName("canvas")[0];this.render();var qt=Se==="jpg"?Ut==null?void 0:Ut.toDataURL("image/jpeg"):Ut==null?void 0:Ut.toDataURL("image/png");return qt}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var Se=this.$container.parentElement;Se!==null&&(this.markerContainer=ce.a.create("div","l7-marker-container",Se))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){if(!this.inited){this.destroyed=!0;return}this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.removeAllListeners(),this.inited=!1,Object(Cc.unbind)(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)}},{key:"initContainer",value:function(){var Se,tt,Ut=ce.a.DPR,qt=((Se=this.$container)===null||Se===void 0?void 0:Se.clientWidth)||400,er=((tt=this.$container)===null||tt===void 0?void 0:tt.clientHeight)||300,_r=this.canvas;_r&&(_r.width=qt*Ut,_r.height=er*Ut,_r.style.width="".concat(qt,"px"),_r.style.height="".concat(er,"px")),this.rendererService.viewport({x:0,y:0,width:Ut*qt,height:Ut*er})}},{key:"setCanvas",value:function(){var Se,tt,Ut=ce.a.DPR,qt=((Se=this.$container)===null||Se===void 0?void 0:Se.clientWidth)||400,er=((tt=this.$container)===null||tt===void 0?void 0:tt.clientHeight)||300,_r=this.canvas;_r.width=qt*Ut,_r.height=er*Ut,_r.style.width="".concat(qt,"px"),_r.style.height="".concat(er,"px")}},{key:"addSceneEvent",value:function(Se){this.emit(Se.type,Se)}}]),D}(v.EventEmitter),lc),Zl=Lr()(zo.prototype,"id",[Vc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ya=Lr()(zo.prototype,"iconService",[sf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ki=Lr()(zo.prototype,"fontService",[uf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fo=Lr()(zo.prototype,"controlService",[Gl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ys=Lr()(zo.prototype,"logger",[lf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wl=Lr()(zo.prototype,"configService",[Mu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$a=Lr()(zo.prototype,"map",[Ra],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mn=Lr()(zo.prototype,"coordinateSystemService",[eu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zs=Lr()(zo.prototype,"rendererService",[Go],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wc=Lr()(zo.prototype,"layerService",[Iu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cl=Lr()(zo.prototype,"cameraService",[ji],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vu=Lr()(zo.prototype,"interactionService",[Da],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Us=Lr()(zo.prototype,"pickingService",[js],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ou=Lr()(zo.prototype,"shaderModuleService",[tu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),an=Lr()(zo.prototype,"markerService",[Hl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gc=Lr()(zo.prototype,"popupService",[uc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zo))||wf),cf=a("7tbW"),ff=a.n(cf);function Vs(ee){var ie=0;switch(ee){case"vec2":case"ivec2":ie=2;break;case"vec3":case"ivec3":ie=3;break;case"vec4":case"ivec4":case"mat2":ie=4;break;case"mat3":ie=9;break;case"mat4":ie=16;break;default:}return ie}var fl=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function Hc(ee){var ie={};return ee=ee.replace(fl,function(D,U,Se){var tt=Se.split(":"),Ut=tt[0].trim(),qt="";switch(tt.length>1&&(qt=tt[1].trim()),U){case"bool":qt=qt==="true";break;case"float":case"int":qt=Number(qt);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":qt?qt=qt.replace("[","").replace("]","").split(",").reduce(function(er,_r){return er.push(Number(_r.trim())),er},[]):qt=new Array(Vs(U)).fill(0);break;default:}return ie[Ut]=qt,"uniform ".concat(U," ").concat(Ut,`;
`)}),{content:ee,uniforms:ie}}var Xl,Ns,Ho;function ss(ee,ie){var D=Object.keys(ee);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ee);ie&&(U=U.filter(function(Se){return Object.getOwnPropertyDescriptor(ee,Se).enumerable})),D.push.apply(D,U)}return D}function us(ee){for(var ie=1;ie<arguments.length;ie++){var D=arguments[ie]!=null?arguments[ie]:{};ie%2?ss(Object(D),!0).forEach(function(U){q()(ee,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(D)):ss(Object(D)).forEach(function(U){Object.defineProperty(ee,U,Object.getOwnPropertyDescriptor(D,U))})}return ee}var Ti="#define PI 3.14159265359",Lu=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,Zo=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,ho=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,Ru=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,Ju=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}
`,gu=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}
`,Ms=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0
#define COORDINATE_SYSTEM_P20_OFFSET 6.0
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }
  return vector;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }
  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}

`,ru=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,Jn=/precision\s+(high|low|medium)p\s+float/,Bn=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,Pl=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,xs=(Xl=Object(N.injectable)(),Xl(Ns=(Ho=function(){function ee(){$()(this,ee),this.moduleCache={},this.rawContentCache={}}return Be()(ee,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:Ti,fs:Ti}),this.registerModule("decode",{vs:Lu,fs:""}),this.registerModule("projection",{vs:Ms,fs:""}),this.registerModule("project",{vs:gu,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:ru}),this.registerModule("lighting",{vs:ho,fs:""}),this.registerModule("light",{vs:Zo,fs:""}),this.registerModule("picking",{vs:Ju,fs:Ru})}},{key:"registerModule",value:function(D,U){if(!this.rawContentCache[D]){var Se=U.vs,tt=U.fs,Ut=U.uniforms,qt=Hc(Se),er=qt.content,_r=qt.uniforms,en=Hc(tt),Rn=en.content,$n=en.uniforms;this.rawContentCache[D]={fs:Rn,uniforms:us(us(us({},_r),$n),Ut),vs:er}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(D){var U=this;if(this.moduleCache[D])return this.moduleCache[D];var Se=this.rawContentCache[D].vs,tt=this.rawContentCache[D].fs,Ut=this.processModule(Se,[],"vs"),qt=Ut.content,er=Ut.includeList,_r=this.processModule(tt,[],"fs"),en=_r.content,Rn=_r.includeList,$n=en,ri=ff()(er.concat(Rn).concat(D)).reduce(function(Mi,Ri){return us(us({},Mi),U.rawContentCache[Ri].uniforms)},{});return Jn.test(en)||($n=Bn+en),this.moduleCache[D]={fs:$n.trim(),uniforms:ri,vs:qt.trim()},this.moduleCache[D]}},{key:"processModule",value:function(D,U,Se){var tt=this,Ut=D.replace(Pl,function(qt,er){var _r=er.split(" "),en=_r[0].replace(/"/g,"");if(U.indexOf(en)>-1)return"";var Rn=tt.rawContentCache[en][Se];U.push(en);var $n=tt.processModule(Rn,U,Se),ri=$n.content;return ri});return{content:Ut,includeList:U}}}]),ee}(),Ho))||Ns),Wo=a("iWIM"),No=a.n(Wo),nu=a("bPkA"),Du,cc,na,po,hl,dl,fc=(Du=Object(N.injectable)(),cc=Object(N.inject)(F.a.IShaderModuleService),Du(na=(po=(dl=function(){function ee(){$()(this,ee),Cn()(this,"shaderModuleService",hl,this),this.rendererService=void 0,this.cameraService=void 0,this.mapService=void 0,this.interactionService=void 0,this.layerService=void 0,this.config=void 0}return Be()(ee,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return nu.a.Normal}},{key:"init",value:function(D,U){this.config=U,this.rendererService=D.getContainer().get(F.a.IRendererService),this.cameraService=D.getContainer().get(F.a.ICameraService),this.mapService=D.getContainer().get(F.a.IMapService),this.interactionService=D.getContainer().get(F.a.IInteractionService),this.layerService=D.getContainer().get(F.a.ILayerService)}},{key:"render",value:function(D){}}]),ee}(),dl),hl=Lr()(po.prototype,"shaderModuleService",[cc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),po))||na),zu,Is;function Yl(ee){var ie=Gs();return function(){var U=nt()(ee),Se;if(ie){var tt=nt()(this).constructor;Se=Reflect.construct(U,arguments,tt)}else Se=U.apply(this,arguments);return We()(this,Se)}}function Gs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var Pf=(zu=Object(N.injectable)(),zu(Is=function(ee){de()(D,ee);var ie=Yl(D);function D(){return $()(this,D),ie.apply(this,arguments)}return Be()(D,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(Se,tt){No()(nt()(D.prototype),"init",this).call(this,Se,tt)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),D}(fc))||Is),Kl,Zc,_f,bs,Nu,Wc;function _l(ee,ie){var D;if(typeof Symbol=="undefined"||ee[Symbol.iterator]==null){if(Array.isArray(ee)||(D=Ml(ee))||ie&&ee&&typeof ee.length=="number"){D&&(ee=D);var U=0,Se=function(){};return{s:Se,n:function(){return U>=ee.length?{done:!0}:{done:!1,value:ee[U++]}},e:function(_r){throw _r},f:Se}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var tt=!0,Ut=!1,qt;return{s:function(){D=ee[Symbol.iterator]()},n:function(){var _r=D.next();return tt=_r.done,_r},e:function(_r){Ut=!0,qt=_r},f:function(){try{!tt&&D.return!=null&&D.return()}finally{if(Ut)throw qt}}}}function Ml(ee,ie){if(!!ee){if(typeof ee=="string")return hc(ee,ie);var D=Object.prototype.toString.call(ee).slice(8,-1);if(D==="Object"&&ee.constructor&&(D=ee.constructor.name),D==="Map"||D==="Set")return Array.from(ee);if(D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D))return hc(ee,ie)}}function hc(ee,ie){(ie==null||ie>ee.length)&&(ie=ee.length);for(var D=0,U=new Array(ie);D<ie;D++)U[D]=ee[D];return U}var Qu=(Kl=Object(N.injectable)(),Zc=Object(N.inject)(F.a.IPostProcessor),Kl(_f=(bs=(Wc=function(){function ee(){$()(this,ee),this.passes=[],Cn()(this,"postProcessor",Nu,this),this.layer=void 0,this.renderFlag=void 0,this.width=0,this.height=0}return Be()(ee,[{key:"setLayer",value:function(D){this.layer=D}},{key:"setRenderFlag",value:function(D){this.renderFlag=D}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var ie=yn()(fr.a.mark(function U(){var Se,tt,Ut;return fr.a.wrap(function(er){for(;;)switch(er.prev=er.next){case 0:Se=_l(this.passes),er.prev=1,Se.s();case 3:if((tt=Se.n()).done){er.next=9;break}return Ut=tt.value,er.next=7,Ut.render(this.layer);case 7:er.next=3;break;case 9:er.next=14;break;case 11:er.prev=11,er.t0=er.catch(1),Se.e(er.t0);case 14:return er.prev=14,Se.f(),er.finish(14);case 17:this.layer.renderModels();case 18:case"end":return er.stop()}},U,this,[[1,11,14,17]])}));function D(){return ie.apply(this,arguments)}return D}()},{key:"resize",value:function(D,U){(this.width!==D||this.height!==U)&&(this.width=D,this.height=U)}},{key:"add",value:function(D,U){D.getType()===nu.a.PostProcessing?this.postProcessor.add(D,this.layer,U):(D.init(this.layer,U),this.passes.push(D))}},{key:"insert",value:function(D,U,Se){D.init(this.layer,U),this.passes.splice(Se,0,D)}},{key:"destroy",value:function(){this.passes.length=0}}]),ee}(),Wc),Nu=Lr()(bs.prototype,"postProcessor",[Zc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bs))||_f),Fs,dc,pl,vl,Il,s;function i(ee,ie){var D=Object.keys(ee);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ee);ie&&(U=U.filter(function(Se){return Object.getOwnPropertyDescriptor(ee,Se).enumerable})),D.push.apply(D,U)}return D}function n(ee){for(var ie=1;ie<arguments.length;ie++){var D=arguments[ie]!=null?arguments[ie]:{};ie%2?i(Object(D),!0).forEach(function(U){q()(ee,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(D)):i(Object(D)).forEach(function(U){Object.defineProperty(ee,U,Object.getOwnPropertyDescriptor(D,U))})}return ee}function l(ee){var ie=y();return function(){var U=nt()(ee),Se;if(ie){var tt=nt()(this).constructor;Se=Reflect.construct(U,arguments,tt)}else Se=U.apply(this,arguments);return We()(this,Se)}}function y(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var M=(Fs=Object(N.injectable)(),dc=Object(N.inject)(F.a.ILogService),Fs(pl=(vl=(s=function(ee){de()(D,ee);var ie=l(D);function D(){var U;$()(this,D);for(var Se=arguments.length,tt=new Array(Se),Ut=0;Ut<Se;Ut++)tt[Ut]=arguments[Ut];return U=ie.call.apply(ie,[this].concat(tt)),Cn()(U,"logger",Il,qi()(U)),U.pickingFBO=void 0,U.layer=void 0,U.width=0,U.height=0,U.alreadyInRendering=!1,U.pickFromPickingFBO=function(qt){var er=qt.x,_r=qt.y,en=qt.lngLat,Rn=qt.type;if(!(!U.layer.isVisible()||!U.layer.needPick(Rn))){var $n=U.rendererService,ri=$n.getViewportSize,Mi=$n.readPixels,Ri=$n.useFramebuffer,fa=ri(),ua=fa.width,Na=fa.height,go=U.layer.getLayerConfig(),ao=go.enableHighlight,Va=go.enableSelect,Co=er*ce.a.DPR,Xi=_r*ce.a.DPR;if(!(Co>ua||Co<0||Xi>Na||Xi<0)){var Qa;Ri(U.pickingFBO,function(){var ls;if(Qa=Mi({x:Math.round(Co),y:Math.round(Na-(_r+1)*ce.a.DPR),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:U.pickingFBO}),Qa[0]!==0||Qa[1]!==0||Qa[2]!==0){U.logger.debug("picked");var Sa=Object(ce.k)(Qa),Ma=U.layer.getSource().getFeatureById(Sa),gi={x:er,y:_r,type:Rn,lngLat:en,featureId:Sa,feature:Ma};Ma&&(U.layer.setCurrentPickId(Sa),U.triggerHoverOnLayer(gi))}else{var Bo={x:er,y:_r,lngLat:en,type:U.layer.getCurrentPickId()===null?"un"+Rn:"mouseout",featureId:null,feature:null};U.triggerHoverOnLayer(n(n({},Bo),{},{type:"unpick"})),U.triggerHoverOnLayer(Bo),U.layer.setCurrentPickId(null)}ao&&U.highlightPickedFeature(Qa),Va&&Rn==="click"&&((ls=Qa)===null||ls===void 0?void 0:ls.toString())!==[0,0,0,0].toString()&&U.selectFeature(Qa)})}}},U}return Be()(D,[{key:"getType",value:function(){return nu.a.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(Se,tt){No()(nt()(D.prototype),"init",this).call(this,Se,tt),this.layer=Se;var Ut=this.rendererService,qt=Ut.createTexture2D,er=Ut.createFramebuffer,_r=Ut.getViewportSize,en=_r(),Rn=en.width,$n=en.height;this.pickingFBO=er({color:qt({width:Rn,height:$n,wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})}),this.interactionService.on(ca.a.Hover,this.pickFromPickingFBO),this.interactionService.on(ca.a.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(ca.a.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(Se){var tt=this;if(!this.alreadyInRendering){var Ut=this.rendererService,qt=Ut.getViewportSize,er=Ut.useFramebuffer,_r=Ut.clear,en=qt(),Rn=en.width,$n=en.height;this.alreadyInRendering=!0,(this.width!==Rn||this.height!==$n)&&(this.pickingFBO.resize({width:Rn,height:$n}),this.width=Rn,this.height=$n),er(this.pickingFBO,function(){_r({framebuffer:tt.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var ri=tt.layer.multiPassRenderer.getRenderFlag();tt.layer.multiPassRenderer.setRenderFlag(!1),Se.hooks.beforePickingEncode.call(),Se.render(),Se.hooks.afterPickingEncode.call(),tt.layer.multiPassRenderer.setRenderFlag(ri),tt.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(Se){this.layer.emit(Se.type,Se)}},{key:"highlightPickedFeature",value:function(Se){var tt=pt()(Se,3),Ut=tt[0],qt=tt[1],er=tt[2];this.layer.hooks.beforeHighlight.call([Ut,qt,er]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(Se){var tt=pt()(Se,3),Ut=tt[0],qt=tt[1],er=tt[2];this.layer.hooks.beforeSelect.call([Ut,qt,er]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(Se){var tt=Se.featureId,Ut=Object(ce.l)(tt);this.selectFeature(new Uint8Array(Ut))}},{key:"highlightFeatureHandle",value:function(Se){var tt=Se.featureId,Ut=Object(ce.l)(tt);this.highlightPickedFeature(new Uint8Array(Ut))}}]),D}(fc),s),Il=Lr()(vl.prototype,"logger",[dc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vl))||pl),L=a("+em5"),B,oe;function Te(ee,ie){var D=Object.keys(ee);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ee);ie&&(U=U.filter(function(Se){return Object.getOwnPropertyDescriptor(ee,Se).enumerable})),D.push.apply(D,U)}return D}function Ge(ee){for(var ie=1;ie<arguments.length;ie++){var D=arguments[ie]!=null?arguments[ie]:{};ie%2?Te(Object(D),!0).forEach(function(U){q()(ee,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(D)):Te(Object(D)).forEach(function(U){Object.defineProperty(ee,U,Object.getOwnPropertyDescriptor(D,U))})}return ee}function Ke(ee){var ie=et();return function(){var U=nt()(ee),Se;if(ie){var tt=nt()(this).constructor;Se=Reflect.construct(U,arguments,tt)}else Se=U.apply(this,arguments);return We()(this,Se)}}function et(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var Ft=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Rt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Yt=(B=Object(N.injectable)(),B(oe=function(ee){de()(D,ee);var ie=Ke(D);function D(){return $()(this,D),ie.apply(this,arguments)}return Be()(D,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Rt,fs:Ft});var Se=this.shaderModuleService.getModule("blur-pass"),tt=Se.vs,Ut=Se.fs,qt=Se.uniforms,er=this.rendererService.getViewportSize(),_r=er.width,en=er.height;return{vs:tt,fs:Ut,uniforms:Ge(Ge({},qt),{},{u_ViewportSize:[_r,en]})}}},{key:"convertOptionsToUniforms",value:function(Se){var tt={};return Do()(Se.blurRadius)||(tt.u_BlurDir=[Se.blurRadius,0]),tt}}]),D}(L.a))||oe),zt,jt;function rr(ee,ie){var D=Object.keys(ee);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ee);ie&&(U=U.filter(function(Se){return Object.getOwnPropertyDescriptor(ee,Se).enumerable})),D.push.apply(D,U)}return D}function nr(ee){for(var ie=1;ie<arguments.length;ie++){var D=arguments[ie]!=null?arguments[ie]:{};ie%2?rr(Object(D),!0).forEach(function(U){q()(ee,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(D)):rr(Object(D)).forEach(function(U){Object.defineProperty(ee,U,Object.getOwnPropertyDescriptor(D,U))})}return ee}function zr(ee){var ie=pr();return function(){var U=nt()(ee),Se;if(ie){var tt=nt()(this).constructor;Se=Reflect.construct(U,arguments,tt)}else Se=U.apply(this,arguments);return We()(this,Se)}}function pr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var Ar=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,wr=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,sn=(zt=Object(N.injectable)(),zt(jt=function(ee){de()(D,ee);var ie=zr(D);function D(){return $()(this,D),ie.apply(this,arguments)}return Be()(D,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:wr,fs:Ar});var Se=this.shaderModuleService.getModule("blur-pass"),tt=Se.vs,Ut=Se.fs,qt=Se.uniforms,er=this.rendererService.getViewportSize(),_r=er.width,en=er.height;return{vs:tt,fs:Ut,uniforms:nr(nr({},qt),{},{u_ViewportSize:[_r,en]})}}},{key:"convertOptionsToUniforms",value:function(Se){var tt={};return Do()(Se.blurRadius)||(tt.u_BlurDir=[0,Se.blurRadius]),tt}}]),D}(L.a))||jt),$r,xn;function In(ee,ie){var D=Object.keys(ee);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ee);ie&&(U=U.filter(function(Se){return Object.getOwnPropertyDescriptor(ee,Se).enumerable})),D.push.apply(D,U)}return D}function ei(ee){for(var ie=1;ie<arguments.length;ie++){var D=arguments[ie]!=null?arguments[ie]:{};ie%2?In(Object(D),!0).forEach(function(U){q()(ee,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(D)):In(Object(D)).forEach(function(U){Object.defineProperty(ee,U,Object.getOwnPropertyDescriptor(D,U))})}return ee}function si(ee){var ie=Ii();return function(){var U=nt()(ee),Se;if(ie){var tt=nt()(this).constructor;Se=Reflect.construct(U,arguments,tt)}else Se=U.apply(this,arguments);return We()(this,Se)}}function Ii(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var $i=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,wn=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ui=($r=Object(N.injectable)(),$r(xn=function(ee){de()(D,ee);var ie=si(D);function D(){return $()(this,D),ie.apply(this,arguments)}return Be()(D,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:wn,fs:$i});var Se=this.shaderModuleService.getModule("colorhalftone-pass"),tt=Se.vs,Ut=Se.fs,qt=Se.uniforms,er=this.rendererService.getViewportSize(),_r=er.width,en=er.height;return{vs:tt,fs:Ut,uniforms:ei(ei({},qt),{},{u_ViewportSize:[_r,en]})}}}]),D}(L.a))||xn),Si,Hn;function Ei(ee){var ie=ii();return function(){var U=nt()(ee),Se;if(ie){var tt=nt()(this).constructor;Se=Reflect.construct(U,arguments,tt)}else Se=U.apply(this,arguments);return We()(this,Se)}}function ii(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var Ni=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,Hi=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,no=(Si=Object(N.injectable)(),Si(Hn=function(ee){de()(D,ee);var ie=Ei(D);function D(){return $()(this,D),ie.apply(this,arguments)}return Be()(D,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:Hi,fs:Ni}),this.shaderModuleService.getModule("copy-pass")}}]),D}(L.a))||Hn),za,Mo;function _a(ee,ie){var D=Object.keys(ee);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ee);ie&&(U=U.filter(function(Se){return Object.getOwnPropertyDescriptor(ee,Se).enumerable})),D.push.apply(D,U)}return D}function Ja(ee){for(var ie=1;ie<arguments.length;ie++){var D=arguments[ie]!=null?arguments[ie]:{};ie%2?_a(Object(D),!0).forEach(function(U){q()(ee,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(D)):_a(Object(D)).forEach(function(U){Object.defineProperty(ee,U,Object.getOwnPropertyDescriptor(D,U))})}return ee}function Os(ee){var ie=Ls();return function(){var U=nt()(ee),Se;if(ie){var tt=nt()(this).constructor;Se=Reflect.construct(U,arguments,tt)}else Se=U.apply(this,arguments);return We()(this,Se)}}function Ls(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var yu=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,Fu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Ss=(za=Object(N.injectable)(),za(Mo=function(ee){de()(D,ee);var ie=Os(D);function D(){return $()(this,D),ie.apply(this,arguments)}return Be()(D,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:Fu,fs:yu});var Se=this.shaderModuleService.getModule("hexagonalpixelate-pass"),tt=Se.vs,Ut=Se.fs,qt=Se.uniforms,er=this.rendererService.getViewportSize(),_r=er.width,en=er.height;return{vs:tt,fs:Ut,uniforms:Ja(Ja({},qt),{},{u_ViewportSize:[_r,en]})}}}]),D}(L.a))||Mo),Bs,Bu;function xu(ee,ie){var D=Object.keys(ee);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ee);ie&&(U=U.filter(function(Se){return Object.getOwnPropertyDescriptor(ee,Se).enumerable})),D.push.apply(D,U)}return D}function qu(ee){for(var ie=1;ie<arguments.length;ie++){var D=arguments[ie]!=null?arguments[ie]:{};ie%2?xu(Object(D),!0).forEach(function(U){q()(ee,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(D)):xu(Object(D)).forEach(function(U){Object.defineProperty(ee,U,Object.getOwnPropertyDescriptor(D,U))})}return ee}function $l(ee){var ie=ml();return function(){var U=nt()(ee),Se;if(ie){var tt=nt()(this).constructor;Se=Reflect.construct(U,arguments,tt)}else Se=U.apply(this,arguments);return We()(this,Se)}}function ml(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var iu=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,pc=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,bu=(Bs=Object(N.injectable)(),Bs(Bu=function(ee){de()(D,ee);var ie=$l(D);function D(){return $()(this,D),ie.apply(this,arguments)}return Be()(D,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:pc,fs:iu});var Se=this.shaderModuleService.getModule("ink-pass"),tt=Se.vs,Ut=Se.fs,qt=Se.uniforms,er=this.rendererService.getViewportSize(),_r=er.width,en=er.height;return{vs:tt,fs:Ut,uniforms:qu(qu({},qt),{},{u_ViewportSize:[_r,en]})}}}]),D}(L.a))||Bu),Eo,gl;function Jl(ee){var ie=Rs();return function(){var U=nt()(ee),Se;if(ie){var tt=nt()(this).constructor;Se=Reflect.construct(U,arguments,tt)}else Se=U.apply(this,arguments);return We()(this,Se)}}function Rs(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var To=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,vo=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,es=(Eo=Object(N.injectable)(),Eo(gl=function(ee){de()(D,ee);var ie=Jl(D);function D(){return $()(this,D),ie.apply(this,arguments)}return Be()(D,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:vo,fs:To}),this.shaderModuleService.getModule("noise-pass")}}]),D}(L.a))||gl),Ao,io;function ts(ee){var ie=yl();return function(){var U=nt()(ee),Se;if(ie){var tt=nt()(this).constructor;Se=Reflect.construct(U,arguments,tt)}else Se=U.apply(this,arguments);return We()(this,Se)}}function yl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var Pc=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Xc=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,el=(Ao=Object(N.injectable)(),Ao(io=function(ee){de()(D,ee);var ie=ts(D);function D(){return $()(this,D),ie.apply(this,arguments)}return Be()(D,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:Pc,fs:Xc}),this.shaderModuleService.getModule("sepia-pass")}}]),D}(L.a))||io),vc,Ol,Hs,Fo,Ql,Es,ql,hf=(vc=Object(N.injectable)(),Ol=Object(N.inject)(F.a.IRendererService),Hs=Object(N.postConstruct)(),vc(Fo=(Ql=(ql=function(){function ee(){$()(this,ee),Cn()(this,"rendererService",Es,this),this.passes=[],this.readFBO=void 0,this.writeFBO=void 0}return Be()(ee,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:function(){var ie=yn()(fr.a.mark(function U(Se){var tt,Ut;return fr.a.wrap(function(er){for(;;)switch(er.prev=er.next){case 0:tt=0;case 1:if(!(tt<this.passes.length)){er.next=10;break}return Ut=this.passes[tt],Ut.setRenderToScreen(this.isLastEnabledPass(tt)),er.next=6,Ut.render(Se);case 6:tt!==this.passes.length-1&&this.swap();case 7:tt++,er.next=1;break;case 10:case"end":return er.stop()}},U,this)}));function D(U){return ie.apply(this,arguments)}return D}()},{key:"resize",value:function(D,U){this.readFBO.resize({width:D,height:U}),this.writeFBO.resize({width:D,height:U})}},{key:"add",value:function(D,U,Se){D.init(U,Se),this.passes.push(D)}},{key:"insert",value:function(D,U,Se,tt){D.init(Se,tt),this.passes.splice(U,0,D)}},{key:"getPostProcessingPassByName",value:function(D){return this.passes.find(function(U){return U.getName()===D})}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(D){for(var U=D+1;U<this.passes.length;U++)if(this.passes[U].isEnabled())return!1;return!0}},{key:"swap",value:function(){var D=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=D}}]),ee}(),ql),Es=Lr()(Ql.prototype,"rendererService",[Ol],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lr()(Ql.prototype,"init",[Hs],Object.getOwnPropertyDescriptor(Ql.prototype,"init"),Ql.prototype),Ql))||Fo),Zf,lh;function xl(ee){var ie=Mf();return function(){var U=nt()(ee),Se;if(ie){var tt=nt()(this).constructor;Se=Reflect.construct(U,arguments,tt)}else Se=U.apply(this,arguments);return We()(this,Se)}}function Mf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var df=(Zf=Object(N.injectable)(),Zf(lh=function(ee){de()(D,ee);var ie=xl(D);function D(){return $()(this,D),ie.apply(this,arguments)}return Be()(D,[{key:"getType",value:function(){return nu.a.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(Se,tt){No()(nt()(D.prototype),"init",this).call(this,Se,tt)}},{key:"render",value:function(Se){var tt=this.rendererService,Ut=tt.useFramebuffer,qt=tt.clear;Ut(null,function(){qt({color:[0,0,0,0],depth:1,stencil:0}),Se.multiPassRenderer.setRenderFlag(!1),Se.render(),Se.multiPassRenderer.setRenderFlag(!0)})}}]),D}(fc))||lh),Bf,ku,mc,Wf,_c,Mc,Ic,Xf;function Yf(ee,ie){var D=Object.keys(ee);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(ee);ie&&(U=U.filter(function(Se){return Object.getOwnPropertyDescriptor(ee,Se).enumerable})),D.push.apply(D,U)}return D}function Kf(ee){for(var ie=1;ie<arguments.length;ie++){var D=arguments[ie]!=null?arguments[ie]:{};ie%2?Yf(Object(D),!0).forEach(function(U){q()(ee,U,D[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(D)):Yf(Object(D)).forEach(function(U){Object.defineProperty(ee,U,Object.getOwnPropertyDescriptor(D,U))})}return ee}function If(ee){var ie=ch();return function(){var U=nt()(ee),Se;if(ie){var tt=nt()(this).constructor;Se=Reflect.construct(U,arguments,tt)}else Se=U.apply(this,arguments);return We()(this,Se)}}function ch(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ee){return!1}}var ec=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,Yc=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,mo=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function tc(ee,ie){for(var D=0,U=1/ie,Se=ee;Se>0;)D=D+U*(Se%ie),Se=Math.floor(Se/ie),U=U/ie;return D}var Of=1,Kc=(Bf=Object(N.injectable)(),ku=Object(N.inject)(F.a.IShaderModuleService),mc=Object(N.inject)(F.a.ILogService),Bf(Wf=(_c=(Xf=function(ee){de()(D,ee);var ie=If(D);function D(){var U;$()(this,D);for(var Se=arguments.length,tt=new Array(Se),Ut=0;Ut<Se;Ut++)tt[Ut]=arguments[Ut];return U=ie.call.apply(ie,[this].concat(tt)),Cn()(U,"shaderModuleService",Mc,qi()(U)),Cn()(U,"logger",Ic,qi()(U)),U.haltonSequence=[],U.accumulatingId=0,U.frame=0,U.timer=void 0,U.sampleRenderTarget=void 0,U.prevRenderTarget=void 0,U.outputRenderTarget=void 0,U.copyRenderTarget=void 0,U.blendModel=void 0,U.outputModel=void 0,U.copyModel=void 0,U}return Be()(D,[{key:"getType",value:function(){return nu.a.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(Se,tt){No()(nt()(D.prototype),"init",this).call(this,Se,tt);var Ut=this.rendererService,qt=Ut.createFramebuffer,er=Ut.createTexture2D;this.sampleRenderTarget=qt({color:er({width:1,height:1,wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})}),this.prevRenderTarget=qt({color:er({width:1,height:1,wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})}),this.outputRenderTarget=qt({color:er({width:1,height:1,wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})}),this.copyRenderTarget=qt({color:er({width:1,height:1,wrapS:Vn.a.CLAMP_TO_EDGE,wrapT:Vn.a.CLAMP_TO_EDGE})});for(var _r=0;_r<30;_r++)this.haltonSequence.push([tc(_r,2),tc(_r,3)]);this.blendModel=this.createTriangleModel("blend-pass",ec),this.outputModel=this.createTriangleModel("copy-pass",Yc,{blend:{enable:!0,func:{srcRGB:Vn.a.ONE,dstRGB:Vn.a.ONE_MINUS_SRC_ALPHA,srcAlpha:Vn.a.ONE,dstAlpha:Vn.a.ONE_MINUS_SRC_ALPHA},equation:{rgb:Vn.a.FUNC_ADD,alpha:Vn.a.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",Yc)}},{key:"render",value:function(Se){var tt=this,Ut=this.rendererService,qt=Ut.clear,er=Ut.getViewportSize,_r=Ut.useFramebuffer,en=er(),Rn=en.width,$n=en.height;this.sampleRenderTarget.resize({width:Rn,height:$n}),this.prevRenderTarget.resize({width:Rn,height:$n}),this.outputRenderTarget.resize({width:Rn,height:$n}),this.copyRenderTarget.resize({width:Rn,height:$n}),this.resetFrame(),this.stopAccumulating();var ri=Se.multiPassRenderer.getPostProcessor().getReadFBO();_r(ri,function(){qt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:ri}),Se.multiPassRenderer.setRenderFlag(!1),Se.render(),Se.multiPassRenderer.setRenderFlag(!0)});var Mi=function Ri(fa){!tt.accumulatingId||fa!==tt.accumulatingId||tt.isFinished()||(tt.doRender(Se),requestAnimationFrame(function(){Ri(fa)}))};this.accumulatingId=Of++,this.timer=window.setTimeout(function(){Mi(tt.accumulatingId)},50)}},{key:"doRender",value:function(Se){var tt=this;this.logger.debug("accumulatingId: ".concat(this.accumulatingId));var Ut=this.rendererService,qt=Ut.clear,er=Ut.getViewportSize,_r=Ut.useFramebuffer,en=er(),Rn=en.width,$n=en.height,ri=Se.getLayerConfig(),Mi=ri.jitterScale,Ri=Mi===void 0?1:Mi,fa=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((fa[0]*2-1)/Rn*Ri,(fa[1]*2-1)/$n*Ri),Se.multiPassRenderer.setRenderFlag(!1),Se.hooks.beforeRender.call(),_r(this.sampleRenderTarget,function(){qt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:tt.sampleRenderTarget}),Se.render()}),Se.hooks.afterRender.call(),Se.multiPassRenderer.setRenderFlag(!0);var ua=Se.getLayerConfig();_r(this.outputRenderTarget,function(){tt.blendModel.draw({uniforms:{u_opacity:ua.opacity||1,u_MixRatio:tt.frame===0?1:.9,u_Diffuse1:tt.sampleRenderTarget,u_Diffuse2:tt.frame===0?Se.multiPassRenderer.getPostProcessor().getReadFBO():tt.prevRenderTarget}})}),this.frame===0&&qt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(_r(this.copyRenderTarget,function(){tt.outputModel.draw({uniforms:{u_Texture:tt.outputRenderTarget}})}),_r(Se.multiPassRenderer.getPostProcessor().getReadFBO(),function(){tt.copyModel.draw({uniforms:{u_Texture:tt.copyRenderTarget}})}),Se.multiPassRenderer.getPostProcessor().render(Se));var Na=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=Na,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(Se,tt,Ut){this.shaderModuleService.registerModule(Se,{vs:mo,fs:tt});var qt=this.shaderModuleService.getModule(Se),er=qt.vs,_r=qt.fs,en=qt.uniforms,Rn=this.rendererService,$n=Rn.createAttribute,ri=Rn.createBuffer,Mi=Rn.createModel;return Mi(Kf({vs:er,fs:_r,attributes:{a_Position:$n({buffer:ri({data:[-4,-4,4,-4,0,4],type:Vn.a.FLOAT}),size:2})},uniforms:Kf({},en),depth:{enable:!1},count:3},Ut))}}]),D}(fc),Xf),Mc=Lr()(_c.prototype,"shaderModuleService",[ku],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ic=Lr()(_c.prototype,"logger",[mc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_c))||Wf),au=new N.Container;au.bind(F.a.IGlobalConfigService).to(fn).inSingletonScope(),au.bind(F.a.IShaderModuleService).to(xs).inSingletonScope(),au.bind(F.a.ILogService).to(Ul).inSingletonScope(),Object(N.decorate)(Object(N.injectable)(),v.EventEmitter),au.bind(F.a.IEventEmitter).to(v.EventEmitter);var Ll=X()(au,!1),Lf=function(ie){var D=Ll.lazyInject(ie);return function(U,Se,tt){D.call(this,U,Se),tt&&(tt.initializer=function(){return U[Se]})}},Rf=function(ie){var D=Ll.lazyMultiInject(ie);return function(U,Se,tt){D.call(this,U,Se),tt&&(tt.initializer=function(){return U[Se]})}},Oc=x.c=au,pf=0;function $c(){var ee=new N.Container;return ee.parent=au,ee.bind(F.a.SceneID).toConstantValue("".concat(pf++)),ee.bind(F.a.ILayerService).to(Xn).inSingletonScope(),ee.bind(F.a.ISceneService).to(Gi).inSingletonScope(),ee.bind(F.a.ICameraService).to(dr).inSingletonScope(),ee.bind(F.a.ICoordinateSystemService).to(lo).inSingletonScope(),ee.bind(F.a.IInteractionService).to(ze).inSingletonScope(),ee.bind(F.a.IPickingService).to(Js).inSingletonScope(),ee.bind(F.a.IControlService).to(Wn).inSingletonScope(),ee.bind(F.a.IMarkerService).to(W).inSingletonScope(),ee.bind(F.a.IIconService).to(ht).inSingletonScope(),ee.bind(F.a.IFontService).to(R).inSingletonScope(),ee.bind(F.a.IPopupService).to(Ct).inSingletonScope(),ee.bind(F.a.INormalPass).to(Pf).whenTargetNamed("clear"),ee.bind(F.a.INormalPass).to(M).whenTargetNamed("pixelPicking"),ee.bind(F.a.INormalPass).to(df).whenTargetNamed("render"),ee.bind(F.a.INormalPass).to(Kc).whenTargetNamed("taa"),ee.bind(F.a.IFactoryNormalPass).toFactory(function(ie){return function(D){return ie.container.getNamed(F.a.INormalPass,D)}}),ee.bind(F.a.IPostProcessingPass).to(no).whenTargetNamed("copy"),ee.bind(F.a.IPostProcessingPass).to(Yt).whenTargetNamed("blurH"),ee.bind(F.a.IPostProcessingPass).to(sn).whenTargetNamed("blurV"),ee.bind(F.a.IPostProcessingPass).to(es).whenTargetNamed("noise"),ee.bind(F.a.IPostProcessingPass).to(el).whenTargetNamed("sepia"),ee.bind(F.a.IPostProcessingPass).to(ui).whenTargetNamed("colorHalftone"),ee.bind(F.a.IPostProcessingPass).to(Ss).whenTargetNamed("hexagonalPixelate"),ee.bind(F.a.IPostProcessingPass).to(bu).whenTargetNamed("ink"),ee.bind(F.a.IFactoryPostProcessingPass).toFactory(function(ie){return function(D){var U=ie.container.getNamed(F.a.IPostProcessingPass,D);return U.setName(D),U}}),ee}function Rl(ee){var ie=new N.Container;return ie.parent=ee,ie.bind(F.a.IStyleAttributeService).to(Nf).inSingletonScope(),ie.bind(F.a.IMultiPassRenderer).to(Qu).inSingletonScope(),ie.bind(F.a.IPostProcessor).to(hf).inSingletonScope(),ie}},fbrv:function(we,x,a){"use strict";var S=this&&this.__spreadArrays||function(){for(var st=0,ut=0,Me=arguments.length;ut<Me;ut++)st+=arguments[ut].length;for(var bt=Array(st),xt=0,ut=0;ut<Me;ut++)for(var Mt=arguments[ut],De=0,ar=Mt.length;De<ar;De++,xt++)bt[xt]=Mt[De];return bt};Object.defineProperty(x,"__esModule",{value:!0}),x.getFunctionName=x.getBaseClassDependencyCount=x.getDependencies=void 0;var v=a("Yk9n"),Z=a("MON2"),N=a("FV85"),o=a("xfSm"),X=a("ujMp");Object.defineProperty(x,"getFunctionName",{enumerable:!0,get:function(){return X.getFunctionName}});var F=a("dX1H");function K(st,ut){var Me=X.getFunctionName(ut),bt=q(st,Me,ut,!1);return bt}x.getDependencies=K;function q(st,ut,Me,bt){var xt=st.getConstructorMetadata(Me),Mt=xt.compilerGeneratedMetadata;if(Mt===void 0){var De=Z.MISSING_INJECTABLE_ANNOTATION+" "+ut+".";throw new Error(De)}var ar=xt.userGeneratedMetadata,$t=Object.keys(ar),Ht=Me.length===0&&$t.length>0,vt=Ht?$t.length:Me.length,Ze=$(bt,ut,Mt,ar,vt),Et=He(st,Me),Le=S(Ze,Et);return Le}function Ce(st,ut,Me,bt,xt){var Mt=xt[st.toString()]||[],De=ce(Mt),ar=De.unmanaged!==!0,$t=bt[st],Ht=De.inject||De.multiInject;if($t=Ht||$t,$t instanceof v.LazyServiceIdentifer&&($t=$t.unwrap()),ar){var vt=$t===Object,Ze=$t===Function,Et=$t===void 0,Le=vt||Ze||Et;if(!ut&&Le){var at=Z.MISSING_INJECT_ANNOTATION+" argument "+st+" in class "+Me+".";throw new Error(at)}var Wt=new F.Target(N.TargetTypeEnum.ConstructorArgument,De.targetName,$t);return Wt.metadata=Mt,Wt}return null}function $(st,ut,Me,bt,xt){for(var Mt=[],De=0;De<xt;De++){var ar=De,$t=Ce(ar,st,ut,Me,bt);$t!==null&&Mt.push($t)}return Mt}function He(st,ut){for(var Me=st.getPropertiesMetadata(ut),bt=[],xt=Object.keys(Me),Mt=0,De=xt;Mt<De.length;Mt++){var ar=De[Mt],$t=Me[ar],Ht=ce(Me[ar]),vt=Ht.targetName||ar,Ze=Ht.inject||Ht.multiInject,Et=new F.Target(N.TargetTypeEnum.ClassProperty,vt,Ze);Et.metadata=$t,bt.push(Et)}var Le=Object.getPrototypeOf(ut.prototype).constructor;if(Le!==Object){var at=He(st,Le);bt=S(bt,at)}return bt}function Be(st,ut){var Me=Object.getPrototypeOf(ut.prototype).constructor;if(Me!==Object){var bt=X.getFunctionName(Me),xt=q(st,bt,Me,!0),Mt=xt.map(function($t){return $t.metadata.filter(function(Ht){return Ht.key===o.UNMANAGED_TAG})}),De=[].concat.apply([],Mt).length,ar=xt.length-De;return ar>0?ar:Be(st,Me)}else return 0}x.getBaseClassDependencyCount=Be;function ce(st){var ut={};return st.forEach(function(Me){ut[Me.key.toString()]=Me.value}),{inject:ut[o.INJECT_TAG],multiInject:ut[o.MULTI_INJECT_TAG],targetName:ut[o.NAME_TAG],unmanaged:ut[o.UNMANAGED_TAG]}}},fbvF:function(we,x,a){(function(S,v){we.exports=v()})(this,function(){"use strict";var S=function(Fe){return Fe instanceof Uint8Array||Fe instanceof Uint16Array||Fe instanceof Uint32Array||Fe instanceof Int8Array||Fe instanceof Int16Array||Fe instanceof Int32Array||Fe instanceof Float32Array||Fe instanceof Float64Array||Fe instanceof Uint8ClampedArray},v=function(Fe,At){for(var xr=Object.keys(At),Rr=0;Rr<xr.length;++Rr)Fe[xr[Rr]]=At[xr[Rr]];return Fe},Z=`
`;function N(xe){return typeof atob!="undefined"?atob(xe):"base64:"+xe}function o(xe){var Fe=new Error("(regl) "+xe);throw console.error(Fe),Fe}function X(xe,Fe){xe||o(Fe)}function F(xe){return xe?": "+xe:""}function K(xe,Fe,At){xe in Fe||o("unknown parameter ("+xe+")"+F(At)+". possible values: "+Object.keys(Fe).join())}function q(xe,Fe){S(xe)||o("invalid parameter type"+F(Fe)+". must be a typed array")}function Ce(xe,Fe){switch(Fe){case"number":return typeof xe=="number";case"object":return typeof xe=="object";case"string":return typeof xe=="string";case"boolean":return typeof xe=="boolean";case"function":return typeof xe=="function";case"undefined":return typeof xe=="undefined";case"symbol":return typeof xe=="symbol"}}function $(xe,Fe,At){Ce(xe,Fe)||o("invalid parameter type"+F(At)+". expected "+Fe+", got "+typeof xe)}function He(xe,Fe){xe>=0&&(xe|0)===xe||o("invalid parameter type, ("+xe+")"+F(Fe)+". must be a nonnegative integer")}function Be(xe,Fe,At){Fe.indexOf(xe)<0&&o("invalid value"+F(At)+". must be one of: "+Fe)}var ce=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function st(xe){Object.keys(xe).forEach(function(Fe){ce.indexOf(Fe)<0&&o('invalid regl constructor argument "'+Fe+'". must be one of '+ce)})}function ut(xe,Fe){for(xe=xe+"";xe.length<Fe;)xe=" "+xe;return xe}function Me(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function bt(xe,Fe){this.number=xe,this.line=Fe,this.errors=[]}function xt(xe,Fe,At){this.file=xe,this.line=Fe,this.message=At}function Mt(){var xe=new Error,Fe=(xe.stack||xe).toString(),At=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Fe);if(At)return At[1];var xr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Fe);return xr?xr[1]:"unknown"}function De(){var xe=new Error,Fe=(xe.stack||xe).toString(),At=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Fe);if(At)return At[1];var xr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Fe);return xr?xr[1]:"unknown"}function ar(xe,Fe){var At=xe.split(`
`),xr=1,Rr=0,Pr={unknown:new Me,0:new Me};Pr.unknown.name=Pr[0].name=Fe||Mt(),Pr.unknown.lines.push(new bt(0,""));for(var br=0;br<At.length;++br){var Yr=At[br],tn=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Yr);if(tn)switch(tn[1]){case"line":var on=/(\d+)(\s+\d+)?/.exec(tn[2]);on&&(xr=on[1]|0,on[2]&&(Rr=on[2]|0,Rr in Pr||(Pr[Rr]=new Me)));break;case"define":var rn=/SHADER_NAME(_B64)?\s+(.*)$/.exec(tn[2]);rn&&(Pr[Rr].name=rn[1]?N(rn[2]):rn[2]);break}Pr[Rr].lines.push(new bt(xr++,Yr))}return Object.keys(Pr).forEach(function(cn){var Pn=Pr[cn];Pn.lines.forEach(function(mn){Pn.index[mn.number]=mn})}),Pr}function $t(xe){var Fe=[];return xe.split(`
`).forEach(function(At){if(!(At.length<5)){var xr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(At);xr?Fe.push(new xt(xr[1]|0,xr[2]|0,xr[3].trim())):At.length>0&&Fe.push(new xt("unknown",0,At))}}),Fe}function Ht(xe,Fe){Fe.forEach(function(At){var xr=xe[At.file];if(xr){var Rr=xr.index[At.line];if(Rr){Rr.errors.push(At),xr.hasErrors=!0;return}}xe.unknown.hasErrors=!0,xe.unknown.lines[0].errors.push(At)})}function vt(xe,Fe,At,xr,Rr){if(!xe.getShaderParameter(Fe,xe.COMPILE_STATUS)){var Pr=xe.getShaderInfoLog(Fe),br=xr===xe.FRAGMENT_SHADER?"fragment":"vertex";dt(At,"string",br+" shader source must be a string",Rr);var Yr=ar(At,Rr),tn=$t(Pr);Ht(Yr,tn),Object.keys(Yr).forEach(function(on){var rn=Yr[on];if(!rn.hasErrors)return;var cn=[""],Pn=[""];function mn(un,Sr){cn.push(un),Pn.push(Sr||"")}mn("file number "+on+": "+rn.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),rn.lines.forEach(function(un){if(un.errors.length>0){mn(ut(un.number,4)+"|  ","background-color:yellow; font-weight:bold"),mn(un.line+Z,"color:red; background-color:yellow; font-weight:bold");var Sr=0;un.errors.forEach(function(gr){var Kr=gr.message,On=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Kr);if(On){var Dr=On[1];switch(Kr=On[2],Dr){case"assign":Dr="=";break}Sr=Math.max(un.line.indexOf(Dr,Sr),0)}else Sr=0;mn(ut("| ",6)),mn(ut("^^^",Sr+3)+Z,"font-weight:bold"),mn(ut("| ",6)),mn(Kr+Z,"font-weight:bold")}),mn(ut("| ",6)+Z)}else mn(ut(un.number,4)+"|  "),mn(un.line+Z,"color:red")}),typeof document!="undefined"&&!window.chrome?(Pn[0]=cn.join("%c"),console.log.apply(console,Pn)):console.log(cn.join(""))}),X.raise("Error compiling "+br+" shader, "+Yr[0].name)}}function Ze(xe,Fe,At,xr,Rr){if(!xe.getProgramParameter(Fe,xe.LINK_STATUS)){var Pr=xe.getProgramInfoLog(Fe),br=ar(At,Rr),Yr=ar(xr,Rr),tn='Error linking program with vertex shader, "'+Yr[0].name+'", and fragment shader "'+br[0].name+'"';typeof document!="undefined"?console.log("%c"+tn+Z+"%c"+Pr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(tn+Z+Pr),X.raise(tn)}}function Et(xe){xe._commandRef=Mt()}function Le(xe,Fe,At,xr){Et(xe);function Rr(tn){return tn?xr.id(tn):0}xe._fragId=Rr(xe.static.frag),xe._vertId=Rr(xe.static.vert);function Pr(tn,on){Object.keys(on).forEach(function(rn){tn[xr.id(rn)]=!0})}var br=xe._uniformSet={};Pr(br,Fe.static),Pr(br,Fe.dynamic);var Yr=xe._attributeSet={};Pr(Yr,At.static),Pr(Yr,At.dynamic),xe._hasCount="count"in xe.static||"count"in xe.dynamic||"elements"in xe.static||"elements"in xe.dynamic}function at(xe,Fe){var At=De();o(xe+" in command "+(Fe||Mt())+(At==="unknown"?"":" called from "+At))}function Wt(xe,Fe,At){xe||at(Fe,At||Mt())}function St(xe,Fe,At,xr){xe in Fe||at("unknown parameter ("+xe+")"+F(At)+". possible values: "+Object.keys(Fe).join(),xr||Mt())}function dt(xe,Fe,At,xr){Ce(xe,Fe)||at("invalid parameter type"+F(At)+". expected "+Fe+", got "+typeof xe,xr||Mt())}function H(xe){xe()}function z(xe,Fe,At){xe.texture?Be(xe.texture._texture.internalformat,Fe,"unsupported texture format for attachment"):Be(xe.renderbuffer._renderbuffer.format,At,"unsupported renderbuffer format for attachment")}var V=33071,be=9728,me=9984,le=9985,fe=9986,Ne=9987,lt=5120,rt=5121,ue=5122,ye=5123,Ue=5124,ft=5125,Oe=5126,Ve=32819,P=32820,R=33635,J=34042,de=36193,je={};je[lt]=je[rt]=1,je[ue]=je[ye]=je[de]=je[R]=je[Ve]=je[P]=2,je[Ue]=je[ft]=je[Oe]=je[J]=4;function We(xe,Fe){return xe===P||xe===Ve||xe===R?2:xe===J?4:je[xe]*Fe}function gt(xe){return!(xe&xe-1)&&!!xe}function nt(xe,Fe,At){var xr,Rr=Fe.width,Pr=Fe.height,br=Fe.channels;X(Rr>0&&Rr<=At.maxTextureSize&&Pr>0&&Pr<=At.maxTextureSize,"invalid texture shape"),(xe.wrapS!==V||xe.wrapT!==V)&&X(gt(Rr)&&gt(Pr),"incompatible wrap mode for texture, both width and height must be power of 2"),Fe.mipmask===1?Rr!==1&&Pr!==1&&X(xe.minFilter!==me&&xe.minFilter!==fe&&xe.minFilter!==le&&xe.minFilter!==Ne,"min filter requires mipmap"):(X(gt(Rr)&&gt(Pr),"texture must be a square power of 2 to support mipmapping"),X(Fe.mipmask===(Rr<<1)-1,"missing or incomplete mipmap data")),Fe.type===Oe&&(At.extensions.indexOf("oes_texture_float_linear")<0&&X(xe.minFilter===be&&xe.magFilter===be,"filter not supported, must enable oes_texture_float_linear"),X(!xe.genMipmaps,"mipmap generation not supported with float textures"));var Yr=Fe.images;for(xr=0;xr<16;++xr)if(Yr[xr]){var tn=Rr>>xr,on=Pr>>xr;X(Fe.mipmask&1<<xr,"missing mipmap data");var rn=Yr[xr];if(X(rn.width===tn&&rn.height===on,"invalid shape for mip images"),X(rn.format===Fe.format&&rn.internalformat===Fe.internalformat&&rn.type===Fe.type,"incompatible type for mip image"),!rn.compressed)if(rn.data){var cn=Math.ceil(We(rn.type,br)*tn/rn.unpackAlignment)*rn.unpackAlignment;X(rn.data.byteLength===cn*on,"invalid data for image, buffer size is inconsistent with image format")}else rn.element||rn.copy}else xe.genMipmaps||X((Fe.mipmask&1<<xr)==0,"extra mipmap data");Fe.compressed&&X(!xe.genMipmaps,"mipmap generation for compressed images not supported")}function Nt(xe,Fe,At,xr){var Rr=xe.width,Pr=xe.height,br=xe.channels;X(Rr>0&&Rr<=xr.maxTextureSize&&Pr>0&&Pr<=xr.maxTextureSize,"invalid texture shape"),X(Rr===Pr,"cube map must be square"),X(Fe.wrapS===V&&Fe.wrapT===V,"wrap mode not supported by cube map");for(var Yr=0;Yr<At.length;++Yr){var tn=At[Yr];X(tn.width===Rr&&tn.height===Pr,"inconsistent cube map face shape"),Fe.genMipmaps&&(X(!tn.compressed,"can not generate mipmap for compressed textures"),X(tn.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var on=tn.images,rn=0;rn<16;++rn){var cn=on[rn];if(cn){var Pn=Rr>>rn,mn=Pr>>rn;X(tn.mipmask&1<<rn,"missing mipmap data"),X(cn.width===Pn&&cn.height===mn,"invalid shape for mip images"),X(cn.format===xe.format&&cn.internalformat===xe.internalformat&&cn.type===xe.type,"incompatible type for mip image"),cn.compressed||(cn.data?X(cn.data.byteLength===Pn*mn*Math.max(We(cn.type,br),cn.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):cn.element||cn.copy)}}}}var Y=v(X,{optional:H,raise:o,commandRaise:at,command:Wt,parameter:K,commandParameter:St,constructor:st,type:$,commandType:dt,isTypedArray:q,nni:He,oneOf:Be,shaderError:vt,linkError:Ze,callSite:De,saveCommandRef:Et,saveDrawInfo:Le,framebufferFormat:z,guessCommand:Mt,texture2D:nt,textureCube:Nt}),Xe=0,re=0,Je=5,Gt=6;function ur(xe,Fe){this.id=Xe++,this.type=xe,this.data=Fe}function ct(xe){return xe.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function ht(xe){if(xe.length===0)return[];var Fe=xe.charAt(0),At=xe.charAt(xe.length-1);if(xe.length>1&&Fe===At&&(Fe==='"'||Fe==="'"))return['"'+ct(xe.substr(1,xe.length-2))+'"'];var xr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(xe);if(xr)return ht(xe.substr(0,xr.index)).concat(ht(xr[1])).concat(ht(xe.substr(xr.index+xr[0].length)));var Rr=xe.split(".");if(Rr.length===1)return['"'+ct(xe)+'"'];for(var Pr=[],br=0;br<Rr.length;++br)Pr=Pr.concat(ht(Rr[br]));return Pr}function Pt(xe){return"["+ht(xe).join("][")+"]"}function pt(xe,Fe){return new ur(xe,Pt(Fe+""))}function Pe(xe){return typeof xe=="function"&&!xe._reglType||xe instanceof ur}function ot(xe,Fe){if(typeof xe=="function")return new ur(re,xe);if(typeof xe=="number"||typeof xe=="boolean")return new ur(Je,xe);if(Array.isArray(xe))return new ur(Gt,xe.map(function(At,xr){return ot(At,Fe+"["+xr+"]")}));if(xe instanceof ur)return xe;Y(!1,"invalid option type in uniform "+Fe)}var $e={DynamicVariable:ur,define:pt,isDynamic:Pe,unbox:ot,accessor:Pt},Vt={next:typeof requestAnimationFrame=="function"?function(xe){return requestAnimationFrame(xe)}:function(xe){return setTimeout(xe,16)},cancel:typeof cancelAnimationFrame=="function"?function(xe){return cancelAnimationFrame(xe)}:clearTimeout},dr=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Zr(){var xe={"":0},Fe=[""];return{id:function(xr){var Rr=xe[xr];return Rr||(Rr=xe[xr]=Fe.length,Fe.push(xr),Rr)},str:function(xr){return Fe[xr]}}}function cr(xe,Fe,At){var xr=document.createElement("canvas");v(xr.style,{border:0,margin:0,padding:0,top:0,left:0}),xe.appendChild(xr),xe===document.body&&(xr.style.position="absolute",v(xe.style,{margin:0,padding:0}));function Rr(){var Yr=window.innerWidth,tn=window.innerHeight;if(xe!==document.body){var on=xe.getBoundingClientRect();Yr=on.right-on.left,tn=on.bottom-on.top}xr.width=At*Yr,xr.height=At*tn,v(xr.style,{width:Yr+"px",height:tn+"px"})}var Pr;xe!==document.body&&typeof ResizeObserver=="function"?(Pr=new ResizeObserver(function(){setTimeout(Rr)}),Pr.observe(xe)):window.addEventListener("resize",Rr,!1);function br(){Pr?Pr.disconnect():window.removeEventListener("resize",Rr),xe.removeChild(xr)}return Rr(),{canvas:xr,onDestroy:br}}function Un(xe,Fe){function At(xr){try{return xe.getContext(xr,Fe)}catch(Rr){return null}}return At("webgl")||At("experimental-webgl")||At("webgl-experimental")}function Sn(xe){return typeof xe.nodeName=="string"&&typeof xe.appendChild=="function"&&typeof xe.getBoundingClientRect=="function"}function ni(xe){return typeof xe.drawArrays=="function"||typeof xe.drawElements=="function"}function fi(xe){return typeof xe=="string"?xe.split():(Y(Array.isArray(xe),"invalid extension array"),xe)}function Wn(xe){return typeof xe=="string"?(Y(typeof document!="undefined","not supported outside of DOM"),document.querySelector(xe)):xe}function Gn(xe){var Fe=xe||{},At,xr,Rr,Pr,br={},Yr=[],tn=[],on=typeof window=="undefined"?1:window.devicePixelRatio,rn=!1,cn=function(Sr){Sr&&Y.raise(Sr)},Pn=function(){};if(typeof Fe=="string"?(Y(typeof document!="undefined","selector queries only supported in DOM enviroments"),At=document.querySelector(Fe),Y(At,"invalid query string for element")):typeof Fe=="object"?Sn(Fe)?At=Fe:ni(Fe)?(Pr=Fe,Rr=Pr.canvas):(Y.constructor(Fe),"gl"in Fe?Pr=Fe.gl:"canvas"in Fe?Rr=Wn(Fe.canvas):"container"in Fe&&(xr=Wn(Fe.container)),"attributes"in Fe&&(br=Fe.attributes,Y.type(br,"object","invalid context attributes")),"extensions"in Fe&&(Yr=fi(Fe.extensions)),"optionalExtensions"in Fe&&(tn=fi(Fe.optionalExtensions)),"onDone"in Fe&&(Y.type(Fe.onDone,"function","invalid or missing onDone callback"),cn=Fe.onDone),"profile"in Fe&&(rn=!!Fe.profile),"pixelRatio"in Fe&&(on=+Fe.pixelRatio,Y(on>0,"invalid pixel ratio"))):Y.raise("invalid arguments to regl"),At&&(At.nodeName.toLowerCase()==="canvas"?Rr=At:xr=At),!Pr){if(!Rr){Y(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var mn=cr(xr||document.body,cn,on);if(!mn)return null;Rr=mn.canvas,Pn=mn.onDestroy}br.premultipliedAlpha===void 0&&(br.premultipliedAlpha=!0),Pr=Un(Rr,br)}return Pr?{gl:Pr,canvas:Rr,container:xr,extensions:Yr,optionalExtensions:tn,pixelRatio:on,profile:rn,onDone:cn,onDestroy:Pn}:(Pn(),cn("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Ee(xe,Fe){var At={};function xr(br){Y.type(br,"string","extension name must be string");var Yr=br.toLowerCase(),tn;try{tn=At[Yr]=xe.getExtension(Yr)}catch(on){}return!!tn}for(var Rr=0;Rr<Fe.extensions.length;++Rr){var Pr=Fe.extensions[Rr];if(!xr(Pr))return Fe.onDestroy(),Fe.onDone('"'+Pr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Fe.optionalExtensions.forEach(xr),{extensions:At,restore:function(){Object.keys(At).forEach(function(Yr){if(At[Yr]&&!xr(Yr))throw new Error("(regl): error restoring extension "+Yr)})}}}function pe(xe,Fe){for(var At=Array(xe),xr=0;xr<xe;++xr)At[xr]=Fe(xr);return At}var W=5120,ae=5121,Ie=5122,qe=5123,Ct=5124,Re=5125,mt=5126;function Qt(xe){for(var Fe=16;Fe<=1<<28;Fe*=16)if(xe<=Fe)return Fe;return 0}function Br(xe){var Fe,At;return Fe=(xe>65535)<<4,xe>>>=Fe,At=(xe>255)<<3,xe>>>=At,Fe|=At,At=(xe>15)<<2,xe>>>=At,Fe|=At,At=(xe>3)<<1,xe>>>=At,Fe|=At,Fe|xe>>1}function Ur(){var xe=pe(8,function(){return[]});function Fe(Pr){var br=Qt(Pr),Yr=xe[Br(br)>>2];return Yr.length>0?Yr.pop():new ArrayBuffer(br)}function At(Pr){xe[Br(Pr.byteLength)>>2].push(Pr)}function xr(Pr,br){var Yr=null;switch(Pr){case W:Yr=new Int8Array(Fe(br),0,br);break;case ae:Yr=new Uint8Array(Fe(br),0,br);break;case Ie:Yr=new Int16Array(Fe(2*br),0,br);break;case qe:Yr=new Uint16Array(Fe(2*br),0,br);break;case Ct:Yr=new Int32Array(Fe(4*br),0,br);break;case Re:Yr=new Uint32Array(Fe(4*br),0,br);break;case mt:Yr=new Float32Array(Fe(4*br),0,br);break;default:return null}return Yr.length!==br?Yr.subarray(0,br):Yr}function Rr(Pr){At(Pr.buffer)}return{alloc:Fe,free:At,allocType:xr,freeType:Rr}}var or=Ur();or.zero=Ur();var Vr=3408,An=3410,dn=3411,Cr=3412,Tn=3413,fn=3414,En=3415,Cn=33901,pn=33902,Lr=3379,hi=3386,xi=34921,ki=36347,_i=36348,eo=35661,pi=35660,Ta=34930,Di=36349,bi=34076,ci=34024,ja=7936,ps=7937,to=7938,lo=35724,Gu=34047,qi=36063,Oa=34852,is=3553,ca=34067,Ya=34069,qo=33984,sa=6408,yo=5126,co=5121,Tu=36160,as=36053,bl=36064,_s=16384,Lo=function(Fe,At){var xr=1;At.ext_texture_filter_anisotropic&&(xr=Fe.getParameter(Gu));var Rr=1,Pr=1;At.webgl_draw_buffers&&(Rr=Fe.getParameter(Oa),Pr=Fe.getParameter(qi));var br=!!At.oes_texture_float;if(br){var Yr=Fe.createTexture();Fe.bindTexture(is,Yr),Fe.texImage2D(is,0,sa,1,1,0,sa,yo,null);var tn=Fe.createFramebuffer();if(Fe.bindFramebuffer(Tu,tn),Fe.framebufferTexture2D(Tu,bl,is,Yr,0),Fe.bindTexture(is,null),Fe.checkFramebufferStatus(Tu)!==as)br=!1;else{Fe.viewport(0,0,1,1),Fe.clearColor(1,0,0,1),Fe.clear(_s);var on=or.allocType(yo,4);Fe.readPixels(0,0,1,1,sa,yo,on),Fe.getError()?br=!1:(Fe.deleteFramebuffer(tn),Fe.deleteTexture(Yr),br=on[0]===1),or.freeType(on)}}var rn=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),cn=!0;if(!rn){var Pn=Fe.createTexture(),mn=or.allocType(co,36);Fe.activeTexture(qo),Fe.bindTexture(ca,Pn),Fe.texImage2D(Ya,0,sa,3,3,0,sa,co,mn),or.freeType(mn),Fe.bindTexture(ca,null),Fe.deleteTexture(Pn),cn=!Fe.getError()}return{colorBits:[Fe.getParameter(An),Fe.getParameter(dn),Fe.getParameter(Cr),Fe.getParameter(Tn)],depthBits:Fe.getParameter(fn),stencilBits:Fe.getParameter(En),subpixelBits:Fe.getParameter(Vr),extensions:Object.keys(At).filter(function(un){return!!At[un]}),maxAnisotropic:xr,maxDrawbuffers:Rr,maxColorAttachments:Pr,pointSizeDims:Fe.getParameter(Cn),lineWidthDims:Fe.getParameter(pn),maxViewportDims:Fe.getParameter(hi),maxCombinedTextureUnits:Fe.getParameter(eo),maxCubeMapSize:Fe.getParameter(bi),maxRenderbufferSize:Fe.getParameter(ci),maxTextureUnits:Fe.getParameter(Ta),maxTextureSize:Fe.getParameter(Lr),maxAttributes:Fe.getParameter(xi),maxVertexUniforms:Fe.getParameter(ki),maxVertexTextureUnits:Fe.getParameter(pi),maxVaryingVectors:Fe.getParameter(_i),maxFragmentUniforms:Fe.getParameter(Di),glsl:Fe.getParameter(lo),renderer:Fe.getParameter(ps),vendor:Fe.getParameter(ja),version:Fe.getParameter(to),readFloat:br,npotTextureCube:cn}};function kt(xe){return!!xe&&typeof xe=="object"&&Array.isArray(xe.shape)&&Array.isArray(xe.stride)&&typeof xe.offset=="number"&&xe.shape.length===xe.stride.length&&(Array.isArray(xe.data)||S(xe.data))}var ze=function(Fe){return Object.keys(Fe).map(function(At){return Fe[At]})},It={shape:xo,flatten:Ua};function fr(xe,Fe,At){for(var xr=0;xr<Fe;++xr)At[xr]=xe[xr]}function nn(xe,Fe,At,xr){for(var Rr=0,Pr=0;Pr<Fe;++Pr)for(var br=xe[Pr],Yr=0;Yr<At;++Yr)xr[Rr++]=br[Yr]}function yn(xe,Fe,At,xr,Rr,Pr){for(var br=Pr,Yr=0;Yr<Fe;++Yr)for(var tn=xe[Yr],on=0;on<At;++on)for(var rn=tn[on],cn=0;cn<xr;++cn)Rr[br++]=rn[cn]}function Vn(xe,Fe,At,xr,Rr){for(var Pr=1,br=At+1;br<Fe.length;++br)Pr*=Fe[br];var Yr=Fe[At];if(Fe.length-At==4){var tn=Fe[At+1],on=Fe[At+2],rn=Fe[At+3];for(br=0;br<Yr;++br)yn(xe[br],tn,on,rn,xr,Rr),Rr+=Pr}else for(br=0;br<Yr;++br)Vn(xe[br],Fe,At+1,xr,Rr),Rr+=Pr}function Ua(xe,Fe,At,xr){var Rr=1;if(Fe.length)for(var Pr=0;Pr<Fe.length;++Pr)Rr*=Fe[Pr];else Rr=0;var br=xr||or.allocType(At,Rr);switch(Fe.length){case 0:break;case 1:fr(xe,Fe[0],br);break;case 2:nn(xe,Fe[0],Fe[1],br);break;case 3:yn(xe,Fe[0],Fe[1],Fe[2],br,0);break;default:Vn(xe,Fe,0,br,0)}return br}function xo(xe){for(var Fe=[],At=xe;At.length;At=At[0])Fe.push(At.length);return Fe}var _o={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Ro=5120,Hu=5122,zl=5124,Ks=5121,nf=5123,Nl=5125,vs=5126,fu=5126,bo={int8:Ro,int16:Hu,int32:zl,uint8:Ks,uint16:nf,uint32:Nl,float:vs,float32:fu},$s=35048,Zu=35040,Js={dynamic:$s,stream:Zu,static:35044},Wu=It.flatten,wa=It.shape,Ka=35044,hu=35040,Xu=5121,nc=5126,Ot=[];Ot[5120]=1,Ot[5122]=2,Ot[5124]=4,Ot[5121]=1,Ot[5123]=2,Ot[5125]=4,Ot[5126]=4;function tr(xe){return _o[Object.prototype.toString.call(xe)]|0}function Mr(xe,Fe){for(var At=0;At<Fe.length;++At)xe[At]=Fe[At]}function Xn(xe,Fe,At,xr,Rr,Pr,br){for(var Yr=0,tn=0;tn<At;++tn)for(var on=0;on<xr;++on)xe[Yr++]=Fe[Rr*tn+Pr*on+br]}function Wi(xe,Fe,At,xr){var Rr=0,Pr={};function br(Sr){this.id=Rr++,this.buffer=xe.createBuffer(),this.type=Sr,this.usage=Ka,this.byteLength=0,this.dimension=1,this.dtype=Xu,this.persistentData=null,At.profile&&(this.stats={size:0})}br.prototype.bind=function(){xe.bindBuffer(this.type,this.buffer)},br.prototype.destroy=function(){Pn(this)};var Yr=[];function tn(Sr,gr){var Kr=Yr.pop();return Kr||(Kr=new br(Sr)),Kr.bind(),cn(Kr,gr,hu,0,1,!1),Kr}function on(Sr){Yr.push(Sr)}function rn(Sr,gr,Kr){Sr.byteLength=gr.byteLength,xe.bufferData(Sr.type,gr,Kr)}function cn(Sr,gr,Kr,On,Dr,Qn){var qr;if(Sr.usage=Kr,Array.isArray(gr)){if(Sr.dtype=On||nc,gr.length>0){var Gr;if(Array.isArray(gr[0])){qr=wa(gr);for(var Hr=1,Qr=1;Qr<qr.length;++Qr)Hr*=qr[Qr];Sr.dimension=Hr,Gr=Wu(gr,qr,Sr.dtype),rn(Sr,Gr,Kr),Qn?Sr.persistentData=Gr:or.freeType(Gr)}else if(typeof gr[0]=="number"){Sr.dimension=Dr;var Yn=or.allocType(Sr.dtype,gr.length);Mr(Yn,gr),rn(Sr,Yn,Kr),Qn?Sr.persistentData=Yn:or.freeType(Yn)}else S(gr[0])?(Sr.dimension=gr[0].length,Sr.dtype=On||tr(gr[0])||nc,Gr=Wu(gr,[gr.length,gr[0].length],Sr.dtype),rn(Sr,Gr,Kr),Qn?Sr.persistentData=Gr:or.freeType(Gr)):Y.raise("invalid buffer data")}}else if(S(gr))Sr.dtype=On||tr(gr),Sr.dimension=Dr,rn(Sr,gr,Kr),Qn&&(Sr.persistentData=new Uint8Array(new Uint8Array(gr.buffer)));else if(kt(gr)){qr=gr.shape;var ai=gr.stride,ln=gr.offset,Wr=0,jr=0,vi=0,di=0;qr.length===1?(Wr=qr[0],jr=1,vi=ai[0],di=0):qr.length===2?(Wr=qr[0],jr=qr[1],vi=ai[0],di=ai[1]):Y.raise("invalid shape"),Sr.dtype=On||tr(gr.data)||nc,Sr.dimension=jr;var Nn=or.allocType(Sr.dtype,Wr*jr);Xn(Nn,gr.data,Wr,jr,vi,di,ln),rn(Sr,Nn,Kr),Qn?Sr.persistentData=Nn:or.freeType(Nn)}else gr instanceof ArrayBuffer?(Sr.dtype=Xu,Sr.dimension=Dr,rn(Sr,gr,Kr),Qn&&(Sr.persistentData=new Uint8Array(new Uint8Array(gr)))):Y.raise("invalid buffer data")}function Pn(Sr){Fe.bufferCount--,xr(Sr);var gr=Sr.buffer;Y(gr,"buffer must not be deleted already"),xe.deleteBuffer(gr),Sr.buffer=null,delete Pr[Sr.id]}function mn(Sr,gr,Kr,On){Fe.bufferCount++;var Dr=new br(gr);Pr[Dr.id]=Dr;function Qn(Hr){var Qr=Ka,Yn=null,ai=0,ln=0,Wr=1;return Array.isArray(Hr)||S(Hr)||kt(Hr)||Hr instanceof ArrayBuffer?Yn=Hr:typeof Hr=="number"?ai=Hr|0:Hr&&(Y.type(Hr,"object","buffer arguments must be an object, a number or an array"),"data"in Hr&&(Y(Yn===null||Array.isArray(Yn)||S(Yn)||kt(Yn),"invalid data for buffer"),Yn=Hr.data),"usage"in Hr&&(Y.parameter(Hr.usage,Js,"invalid buffer usage"),Qr=Js[Hr.usage]),"type"in Hr&&(Y.parameter(Hr.type,bo,"invalid buffer type"),ln=bo[Hr.type]),"dimension"in Hr&&(Y.type(Hr.dimension,"number","invalid dimension"),Wr=Hr.dimension|0),"length"in Hr&&(Y.nni(ai,"buffer length must be a nonnegative integer"),ai=Hr.length|0)),Dr.bind(),Yn?cn(Dr,Yn,Qr,ln,Wr,On):(ai&&xe.bufferData(Dr.type,ai,Qr),Dr.dtype=ln||Xu,Dr.usage=Qr,Dr.dimension=Wr,Dr.byteLength=ai),At.profile&&(Dr.stats.size=Dr.byteLength*Ot[Dr.dtype]),Qn}function qr(Hr,Qr){Y(Qr+Hr.byteLength<=Dr.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Hr.byteLength+" starting from offset "+Qr+" to a buffer of size "+Dr.byteLength),xe.bufferSubData(Dr.type,Qr,Hr)}function Gr(Hr,Qr){var Yn=(Qr||0)|0,ai;if(Dr.bind(),S(Hr)||Hr instanceof ArrayBuffer)qr(Hr,Yn);else if(Array.isArray(Hr)){if(Hr.length>0)if(typeof Hr[0]=="number"){var ln=or.allocType(Dr.dtype,Hr.length);Mr(ln,Hr),qr(ln,Yn),or.freeType(ln)}else if(Array.isArray(Hr[0])||S(Hr[0])){ai=wa(Hr);var Wr=Wu(Hr,ai,Dr.dtype);qr(Wr,Yn),or.freeType(Wr)}else Y.raise("invalid buffer data")}else if(kt(Hr)){ai=Hr.shape;var jr=Hr.stride,vi=0,di=0,Nn=0,ea=0;ai.length===1?(vi=ai[0],di=1,Nn=jr[0],ea=0):ai.length===2?(vi=ai[0],di=ai[1],Nn=jr[0],ea=jr[1]):Y.raise("invalid shape");var Ai=Array.isArray(Hr.data)?Dr.dtype:tr(Hr.data),Ji=or.allocType(Ai,vi*di);Xn(Ji,Hr.data,vi,di,Nn,ea,Hr.offset),qr(Ji,Yn),or.freeType(Ji)}else Y.raise("invalid data for buffer subdata");return Qn}return Kr||Qn(Sr),Qn._reglType="buffer",Qn._buffer=Dr,Qn.subdata=Gr,At.profile&&(Qn.stats=Dr.stats),Qn.destroy=function(){Pn(Dr)},Qn}function un(){ze(Pr).forEach(function(Sr){Sr.buffer=xe.createBuffer(),xe.bindBuffer(Sr.type,Sr.buffer),xe.bufferData(Sr.type,Sr.persistentData||Sr.byteLength,Sr.usage)})}return At.profile&&(Fe.getTotalBufferSize=function(){var Sr=0;return Object.keys(Pr).forEach(function(gr){Sr+=Pr[gr].stats.size}),Sr}),{create:mn,createStream:tn,destroyStream:on,clear:function(){ze(Pr).forEach(Pn),Yr.forEach(Pn)},getBuffer:function(gr){return gr&&gr._buffer instanceof br?gr._buffer:null},restore:un,_initBuffer:cn}}var oa=0,Xa=0,zi=1,La=1,Do=4,ms=4,Aa={points:oa,point:Xa,lines:zi,line:La,triangles:Do,triangle:ms,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Sl=0,du=1,os=4,Yu=5120,Au=5121,Ku=5122,Cu=5123,ol=5124,pu=5125,af=34963,Nf=35040,ba=35044;function Nc(xe,Fe,At,xr){var Rr={},Pr=0,br={uint8:Au,uint16:Cu};Fe.oes_element_index_uint&&(br.uint32=pu);function Yr(un){this.id=Pr++,Rr[this.id]=this,this.buffer=un,this.primType=os,this.vertCount=0,this.type=0}Yr.prototype.bind=function(){this.buffer.bind()};var tn=[];function on(un){var Sr=tn.pop();return Sr||(Sr=new Yr(At.create(null,af,!0,!1)._buffer)),cn(Sr,un,Nf,-1,-1,0,0),Sr}function rn(un){tn.push(un)}function cn(un,Sr,gr,Kr,On,Dr,Qn){un.buffer.bind();var qr;if(Sr){var Gr=Qn;!Qn&&(!S(Sr)||kt(Sr)&&!S(Sr.data))&&(Gr=Fe.oes_element_index_uint?pu:Cu),At._initBuffer(un.buffer,Sr,gr,Gr,3)}else xe.bufferData(af,Dr,gr),un.buffer.dtype=qr||Au,un.buffer.usage=gr,un.buffer.dimension=3,un.buffer.byteLength=Dr;if(qr=Qn,!Qn){switch(un.buffer.dtype){case Au:case Yu:qr=Au;break;case Cu:case Ku:qr=Cu;break;case pu:case ol:qr=pu;break;default:Y.raise("unsupported type for element array")}un.buffer.dtype=qr}un.type=qr,Y(qr!==pu||!!Fe.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Hr=On;Hr<0&&(Hr=un.buffer.byteLength,qr===Cu?Hr>>=1:qr===pu&&(Hr>>=2)),un.vertCount=Hr;var Qr=Kr;if(Kr<0){Qr=os;var Yn=un.buffer.dimension;Yn===1&&(Qr=Sl),Yn===2&&(Qr=du),Yn===3&&(Qr=os)}un.primType=Qr}function Pn(un){xr.elementsCount--,Y(un.buffer!==null,"must not double destroy elements"),delete Rr[un.id],un.buffer.destroy(),un.buffer=null}function mn(un,Sr){var gr=At.create(null,af,!0),Kr=new Yr(gr._buffer);xr.elementsCount++;function On(Dr){if(!Dr)gr(),Kr.primType=os,Kr.vertCount=0,Kr.type=Au;else if(typeof Dr=="number")gr(Dr),Kr.primType=os,Kr.vertCount=Dr|0,Kr.type=Au;else{var Qn=null,qr=ba,Gr=-1,Hr=-1,Qr=0,Yn=0;Array.isArray(Dr)||S(Dr)||kt(Dr)?Qn=Dr:(Y.type(Dr,"object","invalid arguments for elements"),"data"in Dr&&(Qn=Dr.data,Y(Array.isArray(Qn)||S(Qn)||kt(Qn),"invalid data for element buffer")),"usage"in Dr&&(Y.parameter(Dr.usage,Js,"invalid element buffer usage"),qr=Js[Dr.usage]),"primitive"in Dr&&(Y.parameter(Dr.primitive,Aa,"invalid element buffer primitive"),Gr=Aa[Dr.primitive]),"count"in Dr&&(Y(typeof Dr.count=="number"&&Dr.count>=0,"invalid vertex count for elements"),Hr=Dr.count|0),"type"in Dr&&(Y.parameter(Dr.type,br,"invalid buffer type"),Yn=br[Dr.type]),"length"in Dr?Qr=Dr.length|0:(Qr=Hr,Yn===Cu||Yn===Ku?Qr*=2:(Yn===pu||Yn===ol)&&(Qr*=4))),cn(Kr,Qn,qr,Gr,Hr,Qr,Yn)}return On}return On(un),On._reglType="elements",On._elements=Kr,On.subdata=function(Dr,Qn){return gr.subdata(Dr,Qn),On},On.destroy=function(){Pn(Kr)},On}return{create:mn,createStream:on,destroyStream:rn,getElements:function(Sr){return typeof Sr=="function"&&Sr._elements instanceof Yr?Sr._elements:null},clear:function(){ze(Rr).forEach(Pn)}}}var Fc=new Float32Array(1),bf=new Uint32Array(Fc.buffer),Bc=5123;function Sf(xe){for(var Fe=or.allocType(Bc,xe.length),At=0;At<xe.length;++At)if(isNaN(xe[At]))Fe[At]=65535;else if(xe[At]===Infinity)Fe[At]=31744;else if(xe[At]===-Infinity)Fe[At]=64512;else{Fc[0]=xe[At];var xr=bf[0],Rr=xr>>>31<<15,Pr=(xr<<1>>>24)-127,br=xr>>13&(1<<10)-1;if(Pr<-24)Fe[At]=Rr;else if(Pr<-14){var Yr=-14-Pr;Fe[At]=Rr+(br+(1<<10)>>Yr)}else Pr>15?Fe[At]=Rr+31744:Fe[At]=Rr+(Pr+15<<10)+br}return Fe}function ro(xe){return Array.isArray(xe)||S(xe)}var wu=function(Fe){return!(Fe&Fe-1)&&!!Fe},El=34467,gs=3553,kc=34067,bc=34069,Tl=6408,sl=6406,$u=6407,Qs=6409,Pu=6410,jc=32854,Fl=32855,Pa=36194,Uc=32819,Ef=32820,Sc=33635,Ec=34042,ic=6402,ul=34041,_u=35904,Bl=35906,Vo=36193,ac=33776,kl=33777,Al=33778,Tc=33779,jl=35986,qs=35987,Tf=34798,Af=35840,of=35841,Cl=35842,oc=35843,ll=36196,Ul=5121,Ac=5123,Cc=5125,Vl=5126,So=10242,Ff=10243,Cf=10497,sc=33071,Vc=33648,sf=10240,uf=10241,Gl=9728,lf=9729,Mu=9984,Ra=9985,eu=9986,Go=9987,Iu=33170,ji=4352,Da=4353,js=4354,tu=34046,Hl=3317,uc=37440,wf=37441,zo=37443,Zl=37444,ya=33984,Ki=[Mu,eu,Ra,Go],fo=[0,Qs,Pu,$u,Tl],ys={};ys[Qs]=ys[sl]=ys[ic]=1,ys[ul]=ys[Pu]=2,ys[$u]=ys[_u]=3,ys[Tl]=ys[Bl]=4;function wl(xe){return"[object "+xe+"]"}var $a=wl("HTMLCanvasElement"),Mn=wl("OffscreenCanvas"),zs=wl("CanvasRenderingContext2D"),wc=wl("ImageBitmap"),cl=wl("HTMLImageElement"),vu=wl("HTMLVideoElement"),Us=Object.keys(_o).concat([$a,Mn,zs,wc,cl,vu]),Ou=[];Ou[Ul]=1,Ou[Vl]=4,Ou[Vo]=2,Ou[Ac]=2,Ou[Cc]=4;var an=[];an[jc]=2,an[Fl]=2,an[Pa]=2,an[ul]=4,an[ac]=.5,an[kl]=.5,an[Al]=1,an[Tc]=1,an[jl]=.5,an[qs]=1,an[Tf]=1,an[Af]=.5,an[of]=.25,an[Cl]=.5,an[oc]=.25,an[ll]=.5;function Gc(xe){return Array.isArray(xe)&&(xe.length===0||typeof xe[0]=="number")}function lc(xe){if(!Array.isArray(xe))return!1;var Fe=xe.length;return!(Fe===0||!ro(xe[0]))}function Wl(xe){return Object.prototype.toString.call(xe)}function mu(xe){return Wl(xe)===$a}function Gi(xe){return Wl(xe)===Mn}function cf(xe){return Wl(xe)===zs}function ff(xe){return Wl(xe)===wc}function Vs(xe){return Wl(xe)===cl}function fl(xe){return Wl(xe)===vu}function Hc(xe){if(!xe)return!1;var Fe=Wl(xe);return Us.indexOf(Fe)>=0?!0:Gc(xe)||lc(xe)||kt(xe)}function Xl(xe){return _o[Object.prototype.toString.call(xe)]|0}function Ns(xe,Fe){var At=Fe.length;switch(xe.type){case Ul:case Ac:case Cc:case Vl:var xr=or.allocType(xe.type,At);xr.set(Fe),xe.data=xr;break;case Vo:xe.data=Sf(Fe);break;default:Y.raise("unsupported texture type, must specify a typed array")}}function Ho(xe,Fe){return or.allocType(xe.type===Vo?Vl:xe.type,Fe)}function ss(xe,Fe){xe.type===Vo?(xe.data=Sf(Fe),or.freeType(Fe)):xe.data=Fe}function us(xe,Fe,At,xr,Rr,Pr){for(var br=xe.width,Yr=xe.height,tn=xe.channels,on=br*Yr*tn,rn=Ho(xe,on),cn=0,Pn=0;Pn<Yr;++Pn)for(var mn=0;mn<br;++mn)for(var un=0;un<tn;++un)rn[cn++]=Fe[At*mn+xr*Pn+Rr*un+Pr];ss(xe,rn)}function Ti(xe,Fe,At,xr,Rr,Pr){var br;if(typeof an[xe]!="undefined"?br=an[xe]:br=ys[xe]*Ou[Fe],Pr&&(br*=6),Rr){for(var Yr=0,tn=At;tn>=1;)Yr+=br*tn*tn,tn/=2;return Yr}else return br*At*xr}function Lu(xe,Fe,At,xr,Rr,Pr,br){var Yr={"don't care":ji,"dont care":ji,nice:js,fast:Da},tn={repeat:Cf,clamp:sc,mirror:Vc},on={nearest:Gl,linear:lf},rn=v({mipmap:Go,"nearest mipmap nearest":Mu,"linear mipmap nearest":Ra,"nearest mipmap linear":eu,"linear mipmap linear":Go},on),cn={none:0,browser:Zl},Pn={uint8:Ul,rgba4:Uc,rgb565:Sc,"rgb5 a1":Ef},mn={alpha:sl,luminance:Qs,"luminance alpha":Pu,rgb:$u,rgba:Tl,rgba4:jc,"rgb5 a1":Fl,rgb565:Pa},un={};Fe.ext_srgb&&(mn.srgb=_u,mn.srgba=Bl),Fe.oes_texture_float&&(Pn.float32=Pn.float=Vl),Fe.oes_texture_half_float&&(Pn.float16=Pn["half float"]=Vo),Fe.webgl_depth_texture&&(v(mn,{depth:ic,"depth stencil":ul}),v(Pn,{uint16:Ac,uint32:Cc,"depth stencil":Ec})),Fe.webgl_compressed_texture_s3tc&&v(un,{"rgb s3tc dxt1":ac,"rgba s3tc dxt1":kl,"rgba s3tc dxt3":Al,"rgba s3tc dxt5":Tc}),Fe.webgl_compressed_texture_atc&&v(un,{"rgb atc":jl,"rgba atc explicit alpha":qs,"rgba atc interpolated alpha":Tf}),Fe.webgl_compressed_texture_pvrtc&&v(un,{"rgb pvrtc 4bppv1":Af,"rgb pvrtc 2bppv1":of,"rgba pvrtc 4bppv1":Cl,"rgba pvrtc 2bppv1":oc}),Fe.webgl_compressed_texture_etc1&&(un["rgb etc1"]=ll);var Sr=Array.prototype.slice.call(xe.getParameter(El));Object.keys(un).forEach(function(wt){var Tr=un[wt];Sr.indexOf(Tr)>=0&&(mn[wt]=Tr)});var gr=Object.keys(mn);At.textureFormats=gr;var Kr=[];Object.keys(mn).forEach(function(wt){var Tr=mn[wt];Kr[Tr]=wt});var On=[];Object.keys(Pn).forEach(function(wt){var Tr=Pn[wt];On[Tr]=wt});var Dr=[];Object.keys(on).forEach(function(wt){var Tr=on[wt];Dr[Tr]=wt});var Qn=[];Object.keys(rn).forEach(function(wt){var Tr=rn[wt];Qn[Tr]=wt});var qr=[];Object.keys(tn).forEach(function(wt){var Tr=tn[wt];qr[Tr]=wt});var Gr=gr.reduce(function(wt,Tr){var vr=mn[Tr];return vr===Qs||vr===sl||vr===Qs||vr===Pu||vr===ic||vr===ul||Fe.ext_srgb&&(vr===_u||vr===Bl)?wt[vr]=vr:vr===Fl||Tr.indexOf("rgba")>=0?wt[vr]=Tl:wt[vr]=$u,wt},{});function Hr(){this.internalformat=Tl,this.format=Tl,this.type=Ul,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Zl,this.width=0,this.height=0,this.channels=0}function Qr(wt,Tr){wt.internalformat=Tr.internalformat,wt.format=Tr.format,wt.type=Tr.type,wt.compressed=Tr.compressed,wt.premultiplyAlpha=Tr.premultiplyAlpha,wt.flipY=Tr.flipY,wt.unpackAlignment=Tr.unpackAlignment,wt.colorSpace=Tr.colorSpace,wt.width=Tr.width,wt.height=Tr.height,wt.channels=Tr.channels}function Yn(wt,Tr){if(!(typeof Tr!="object"||!Tr)){if("premultiplyAlpha"in Tr&&(Y.type(Tr.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),wt.premultiplyAlpha=Tr.premultiplyAlpha),"flipY"in Tr&&(Y.type(Tr.flipY,"boolean","invalid texture flip"),wt.flipY=Tr.flipY),"alignment"in Tr&&(Y.oneOf(Tr.alignment,[1,2,4,8],"invalid texture unpack alignment"),wt.unpackAlignment=Tr.alignment),"colorSpace"in Tr&&(Y.parameter(Tr.colorSpace,cn,"invalid colorSpace"),wt.colorSpace=cn[Tr.colorSpace]),"type"in Tr){var vr=Tr.type;Y(Fe.oes_texture_float||!(vr==="float"||vr==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),Y(Fe.oes_texture_half_float||!(vr==="half float"||vr==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),Y(Fe.webgl_depth_texture||!(vr==="uint16"||vr==="uint32"||vr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Y.parameter(vr,Pn,"invalid texture type"),wt.type=Pn[vr]}var Dn=wt.width,Ui=wt.height,yt=wt.channels,Qe=!1;"shape"in Tr?(Y(Array.isArray(Tr.shape)&&Tr.shape.length>=2,"shape must be an array"),Dn=Tr.shape[0],Ui=Tr.shape[1],Tr.shape.length===3&&(yt=Tr.shape[2],Y(yt>0&&yt<=4,"invalid number of channels"),Qe=!0),Y(Dn>=0&&Dn<=At.maxTextureSize,"invalid width"),Y(Ui>=0&&Ui<=At.maxTextureSize,"invalid height")):("radius"in Tr&&(Dn=Ui=Tr.radius,Y(Dn>=0&&Dn<=At.maxTextureSize,"invalid radius")),"width"in Tr&&(Dn=Tr.width,Y(Dn>=0&&Dn<=At.maxTextureSize,"invalid width")),"height"in Tr&&(Ui=Tr.height,Y(Ui>=0&&Ui<=At.maxTextureSize,"invalid height")),"channels"in Tr&&(yt=Tr.channels,Y(yt>0&&yt<=4,"invalid number of channels"),Qe=!0)),wt.width=Dn|0,wt.height=Ui|0,wt.channels=yt|0;var Kt=!1;if("format"in Tr){var sr=Tr.format;Y(Fe.webgl_depth_texture||!(sr==="depth"||sr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Y.parameter(sr,mn,"invalid texture format");var lr=wt.internalformat=mn[sr];wt.format=Gr[lr],sr in Pn&&("type"in Tr||(wt.type=Pn[sr])),sr in un&&(wt.compressed=!0),Kt=!0}!Qe&&Kt?wt.channels=ys[wt.format]:Qe&&!Kt?wt.channels!==fo[wt.format]&&(wt.format=wt.internalformat=fo[wt.channels]):Kt&&Qe&&Y(wt.channels===ys[wt.format],"number of channels inconsistent with specified format")}}function ai(wt){xe.pixelStorei(uc,wt.flipY),xe.pixelStorei(wf,wt.premultiplyAlpha),xe.pixelStorei(zo,wt.colorSpace),xe.pixelStorei(Hl,wt.unpackAlignment)}function ln(){Hr.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Wr(wt,Tr){var vr=null;if(Hc(Tr)?vr=Tr:Tr&&(Y.type(Tr,"object","invalid pixel data type"),Yn(wt,Tr),"x"in Tr&&(wt.xOffset=Tr.x|0),"y"in Tr&&(wt.yOffset=Tr.y|0),Hc(Tr.data)&&(vr=Tr.data)),Y(!wt.compressed||vr instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Tr.copy){Y(!vr,"can not specify copy and data field for the same texture");var Dn=Rr.viewportWidth,Ui=Rr.viewportHeight;wt.width=wt.width||Dn-wt.xOffset,wt.height=wt.height||Ui-wt.yOffset,wt.needsCopy=!0,Y(wt.xOffset>=0&&wt.xOffset<Dn&&wt.yOffset>=0&&wt.yOffset<Ui&&wt.width>0&&wt.width<=Dn&&wt.height>0&&wt.height<=Ui,"copy texture read out of bounds")}else if(!vr)wt.width=wt.width||1,wt.height=wt.height||1,wt.channels=wt.channels||4;else if(S(vr))wt.channels=wt.channels||4,wt.data=vr,!("type"in Tr)&&wt.type===Ul&&(wt.type=Xl(vr));else if(Gc(vr))wt.channels=wt.channels||4,Ns(wt,vr),wt.alignment=1,wt.needsFree=!0;else if(kt(vr)){var yt=vr.data;!Array.isArray(yt)&&wt.type===Ul&&(wt.type=Xl(yt));var Qe=vr.shape,Kt=vr.stride,sr,lr,b,p,c,f;Qe.length===3?(b=Qe[2],f=Kt[2]):(Y(Qe.length===2,"invalid ndarray pixel data, must be 2 or 3D"),b=1,f=1),sr=Qe[0],lr=Qe[1],p=Kt[0],c=Kt[1],wt.alignment=1,wt.width=sr,wt.height=lr,wt.channels=b,wt.format=wt.internalformat=fo[b],wt.needsFree=!0,us(wt,yt,p,c,f,vr.offset)}else if(mu(vr)||Gi(vr)||cf(vr))mu(vr)||Gi(vr)?wt.element=vr:wt.element=vr.canvas,wt.width=wt.element.width,wt.height=wt.element.height,wt.channels=4;else if(ff(vr))wt.element=vr,wt.width=vr.width,wt.height=vr.height,wt.channels=4;else if(Vs(vr))wt.element=vr,wt.width=vr.naturalWidth,wt.height=vr.naturalHeight,wt.channels=4;else if(fl(vr))wt.element=vr,wt.width=vr.videoWidth,wt.height=vr.videoHeight,wt.channels=4;else if(lc(vr)){var m=wt.width||vr[0].length,_=wt.height||vr.length,k=wt.channels;ro(vr[0][0])?k=k||vr[0][0].length:k=k||1;for(var te=It.shape(vr),se=1,he=0;he<te.length;++he)se*=te[he];var Ye=Ho(wt,se);It.flatten(vr,te,"",Ye),ss(wt,Ye),wt.alignment=1,wt.width=m,wt.height=_,wt.channels=k,wt.format=wt.internalformat=fo[k],wt.needsFree=!0}wt.type===Vl?Y(At.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):wt.type===Vo&&Y(At.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function jr(wt,Tr,vr){var Dn=wt.element,Ui=wt.data,yt=wt.internalformat,Qe=wt.format,Kt=wt.type,sr=wt.width,lr=wt.height;ai(wt),Dn?xe.texImage2D(Tr,vr,Qe,Qe,Kt,Dn):wt.compressed?xe.compressedTexImage2D(Tr,vr,yt,sr,lr,0,Ui):wt.needsCopy?(xr(),xe.copyTexImage2D(Tr,vr,Qe,wt.xOffset,wt.yOffset,sr,lr,0)):xe.texImage2D(Tr,vr,Qe,sr,lr,0,Qe,Kt,Ui||null)}function vi(wt,Tr,vr,Dn,Ui){var yt=wt.element,Qe=wt.data,Kt=wt.internalformat,sr=wt.format,lr=wt.type,b=wt.width,p=wt.height;ai(wt),yt?xe.texSubImage2D(Tr,Ui,vr,Dn,sr,lr,yt):wt.compressed?xe.compressedTexSubImage2D(Tr,Ui,vr,Dn,Kt,b,p,Qe):wt.needsCopy?(xr(),xe.copyTexSubImage2D(Tr,Ui,vr,Dn,wt.xOffset,wt.yOffset,b,p)):xe.texSubImage2D(Tr,Ui,vr,Dn,b,p,sr,lr,Qe)}var di=[];function Nn(){return di.pop()||new ln}function ea(wt){wt.needsFree&&or.freeType(wt.data),ln.call(wt),di.push(wt)}function Ai(){Hr.call(this),this.genMipmaps=!1,this.mipmapHint=ji,this.mipmask=0,this.images=Array(16)}function Ji(wt,Tr,vr){var Dn=wt.images[0]=Nn();wt.mipmask=1,Dn.width=wt.width=Tr,Dn.height=wt.height=vr,Dn.channels=wt.channels=4}function ma(wt,Tr){var vr=null;if(Hc(Tr))vr=wt.images[0]=Nn(),Qr(vr,wt),Wr(vr,Tr),wt.mipmask=1;else if(Yn(wt,Tr),Array.isArray(Tr.mipmap))for(var Dn=Tr.mipmap,Ui=0;Ui<Dn.length;++Ui)vr=wt.images[Ui]=Nn(),Qr(vr,wt),vr.width>>=Ui,vr.height>>=Ui,Wr(vr,Dn[Ui]),wt.mipmask|=1<<Ui;else vr=wt.images[0]=Nn(),Qr(vr,wt),Wr(vr,Tr),wt.mipmask=1;Qr(wt,wt.images[0]),wt.compressed&&(wt.internalformat===ac||wt.internalformat===kl||wt.internalformat===Al||wt.internalformat===Tc)&&Y(wt.width%4==0&&wt.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Xo(wt,Tr){for(var vr=wt.images,Dn=0;Dn<vr.length;++Dn){if(!vr[Dn])return;jr(vr[Dn],Tr,Dn)}}var Ts=[];function ta(){var wt=Ts.pop()||new Ai;Hr.call(wt),wt.mipmask=0;for(var Tr=0;Tr<16;++Tr)wt.images[Tr]=null;return wt}function wo(wt){for(var Tr=wt.images,vr=0;vr<Tr.length;++vr)Tr[vr]&&ea(Tr[vr]),Tr[vr]=null;Ts.push(wt)}function Fa(){this.minFilter=Gl,this.magFilter=Gl,this.wrapS=sc,this.wrapT=sc,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=ji}function As(wt,Tr){if("min"in Tr){var vr=Tr.min;Y.parameter(vr,rn),wt.minFilter=rn[vr],Ki.indexOf(wt.minFilter)>=0&&!("faces"in Tr)&&(wt.genMipmaps=!0)}if("mag"in Tr){var Dn=Tr.mag;Y.parameter(Dn,on),wt.magFilter=on[Dn]}var Ui=wt.wrapS,yt=wt.wrapT;if("wrap"in Tr){var Qe=Tr.wrap;typeof Qe=="string"?(Y.parameter(Qe,tn),Ui=yt=tn[Qe]):Array.isArray(Qe)&&(Y.parameter(Qe[0],tn),Y.parameter(Qe[1],tn),Ui=tn[Qe[0]],yt=tn[Qe[1]])}else{if("wrapS"in Tr){var Kt=Tr.wrapS;Y.parameter(Kt,tn),Ui=tn[Kt]}if("wrapT"in Tr){var sr=Tr.wrapT;Y.parameter(sr,tn),yt=tn[sr]}}if(wt.wrapS=Ui,wt.wrapT=yt,"anisotropic"in Tr){var lr=Tr.anisotropic;Y(typeof lr=="number"&&lr>=1&&lr<=At.maxAnisotropic,"aniso samples must be between 1 and "),wt.anisotropic=Tr.anisotropic}if("mipmap"in Tr){var b=!1;switch(typeof Tr.mipmap){case"string":Y.parameter(Tr.mipmap,Yr,"invalid mipmap hint"),wt.mipmapHint=Yr[Tr.mipmap],wt.genMipmaps=!0,b=!0;break;case"boolean":b=wt.genMipmaps=Tr.mipmap;break;case"object":Y(Array.isArray(Tr.mipmap),"invalid mipmap type"),wt.genMipmaps=!1,b=!0;break;default:Y.raise("invalid mipmap type")}b&&!("min"in Tr)&&(wt.minFilter=Mu)}}function rs(wt,Tr){xe.texParameteri(Tr,uf,wt.minFilter),xe.texParameteri(Tr,sf,wt.magFilter),xe.texParameteri(Tr,So,wt.wrapS),xe.texParameteri(Tr,Ff,wt.wrapT),Fe.ext_texture_filter_anisotropic&&xe.texParameteri(Tr,tu,wt.anisotropic),wt.genMipmaps&&(xe.hint(Iu,wt.mipmapHint),xe.generateMipmap(Tr))}var ko=0,cs={},Zs=At.maxTextureUnits,Yo=Array(Zs).map(function(){return null});function oi(wt){Hr.call(this),this.mipmask=0,this.internalformat=Tl,this.id=ko++,this.refCount=1,this.target=wt,this.texture=xe.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Fa,br.profile&&(this.stats={size:0})}function ou(wt){xe.activeTexture(ya),xe.bindTexture(wt.target,wt.texture)}function Ba(){var wt=Yo[0];wt?xe.bindTexture(wt.target,wt.texture):xe.bindTexture(gs,null)}function _n(wt){var Tr=wt.texture;Y(Tr,"must not double destroy texture");var vr=wt.unit,Dn=wt.target;vr>=0&&(xe.activeTexture(ya+vr),xe.bindTexture(Dn,null),Yo[vr]=null),xe.deleteTexture(Tr),wt.texture=null,wt.params=null,wt.pixels=null,wt.refCount=0,delete cs[wt.id],Pr.textureCount--}v(oi.prototype,{bind:function(){var Tr=this;Tr.bindCount+=1;var vr=Tr.unit;if(vr<0){for(var Dn=0;Dn<Zs;++Dn){var Ui=Yo[Dn];if(Ui){if(Ui.bindCount>0)continue;Ui.unit=-1}Yo[Dn]=Tr,vr=Dn;break}vr>=Zs&&Y.raise("insufficient number of texture units"),br.profile&&Pr.maxTextureUnits<vr+1&&(Pr.maxTextureUnits=vr+1),Tr.unit=vr,xe.activeTexture(ya+vr),xe.bindTexture(Tr.target,Tr.texture)}return vr},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&_n(this)}});function Fi(wt,Tr){var vr=new oi(gs);cs[vr.id]=vr,Pr.textureCount++;function Dn(Qe,Kt){var sr=vr.texInfo;Fa.call(sr);var lr=ta();return typeof Qe=="number"?typeof Kt=="number"?Ji(lr,Qe|0,Kt|0):Ji(lr,Qe|0,Qe|0):Qe?(Y.type(Qe,"object","invalid arguments to regl.texture"),As(sr,Qe),ma(lr,Qe)):Ji(lr,1,1),sr.genMipmaps&&(lr.mipmask=(lr.width<<1)-1),vr.mipmask=lr.mipmask,Qr(vr,lr),Y.texture2D(sr,lr,At),vr.internalformat=lr.internalformat,Dn.width=lr.width,Dn.height=lr.height,ou(vr),Xo(lr,gs),rs(sr,gs),Ba(),wo(lr),br.profile&&(vr.stats.size=Ti(vr.internalformat,vr.type,lr.width,lr.height,sr.genMipmaps,!1)),Dn.format=Kr[vr.internalformat],Dn.type=On[vr.type],Dn.mag=Dr[sr.magFilter],Dn.min=Qn[sr.minFilter],Dn.wrapS=qr[sr.wrapS],Dn.wrapT=qr[sr.wrapT],Dn}function Ui(Qe,Kt,sr,lr){Y(!!Qe,"must specify image data");var b=Kt|0,p=sr|0,c=lr|0,f=Nn();return Qr(f,vr),f.width=0,f.height=0,Wr(f,Qe),f.width=f.width||(vr.width>>c)-b,f.height=f.height||(vr.height>>c)-p,Y(vr.type===f.type&&vr.format===f.format&&vr.internalformat===f.internalformat,"incompatible format for texture.subimage"),Y(b>=0&&p>=0&&b+f.width<=vr.width&&p+f.height<=vr.height,"texture.subimage write out of bounds"),Y(vr.mipmask&1<<c,"missing mipmap data"),Y(f.data||f.element||f.needsCopy,"missing image data"),ou(vr),vi(f,gs,b,p,c),Ba(),ea(f),Dn}function yt(Qe,Kt){var sr=Qe|0,lr=Kt|0||sr;if(sr===vr.width&&lr===vr.height)return Dn;Dn.width=vr.width=sr,Dn.height=vr.height=lr,ou(vr);for(var b=0;vr.mipmask>>b;++b){var p=sr>>b,c=lr>>b;if(!p||!c)break;xe.texImage2D(gs,b,vr.format,p,c,0,vr.format,vr.type,null)}return Ba(),br.profile&&(vr.stats.size=Ti(vr.internalformat,vr.type,sr,lr,!1,!1)),Dn}return Dn(wt,Tr),Dn.subimage=Ui,Dn.resize=yt,Dn._reglType="texture2d",Dn._texture=vr,br.profile&&(Dn.stats=vr.stats),Dn.destroy=function(){vr.decRef()},Dn}function Qi(wt,Tr,vr,Dn,Ui,yt){var Qe=new oi(kc);cs[Qe.id]=Qe,Pr.cubeCount++;var Kt=new Array(6);function sr(p,c,f,m,_,k){var te,se=Qe.texInfo;for(Fa.call(se),te=0;te<6;++te)Kt[te]=ta();if(typeof p=="number"||!p){var he=p|0||1;for(te=0;te<6;++te)Ji(Kt[te],he,he)}else if(typeof p=="object")if(c)ma(Kt[0],p),ma(Kt[1],c),ma(Kt[2],f),ma(Kt[3],m),ma(Kt[4],_),ma(Kt[5],k);else if(As(se,p),Yn(Qe,p),"faces"in p){var Ye=p.faces;for(Y(Array.isArray(Ye)&&Ye.length===6,"cube faces must be a length 6 array"),te=0;te<6;++te)Y(typeof Ye[te]=="object"&&!!Ye[te],"invalid input for cube map face"),Qr(Kt[te],Qe),ma(Kt[te],Ye[te])}else for(te=0;te<6;++te)ma(Kt[te],p);else Y.raise("invalid arguments to cube map");for(Qr(Qe,Kt[0]),At.npotTextureCube||Y(wu(Qe.width)&&wu(Qe.height),"your browser does not support non power or two texture dimensions"),se.genMipmaps?Qe.mipmask=(Kt[0].width<<1)-1:Qe.mipmask=Kt[0].mipmask,Y.textureCube(Qe,se,Kt,At),Qe.internalformat=Kt[0].internalformat,sr.width=Kt[0].width,sr.height=Kt[0].height,ou(Qe),te=0;te<6;++te)Xo(Kt[te],bc+te);for(rs(se,kc),Ba(),br.profile&&(Qe.stats.size=Ti(Qe.internalformat,Qe.type,sr.width,sr.height,se.genMipmaps,!0)),sr.format=Kr[Qe.internalformat],sr.type=On[Qe.type],sr.mag=Dr[se.magFilter],sr.min=Qn[se.minFilter],sr.wrapS=qr[se.wrapS],sr.wrapT=qr[se.wrapT],te=0;te<6;++te)wo(Kt[te]);return sr}function lr(p,c,f,m,_){Y(!!c,"must specify image data"),Y(typeof p=="number"&&p===(p|0)&&p>=0&&p<6,"invalid face");var k=f|0,te=m|0,se=_|0,he=Nn();return Qr(he,Qe),he.width=0,he.height=0,Wr(he,c),he.width=he.width||(Qe.width>>se)-k,he.height=he.height||(Qe.height>>se)-te,Y(Qe.type===he.type&&Qe.format===he.format&&Qe.internalformat===he.internalformat,"incompatible format for texture.subimage"),Y(k>=0&&te>=0&&k+he.width<=Qe.width&&te+he.height<=Qe.height,"texture.subimage write out of bounds"),Y(Qe.mipmask&1<<se,"missing mipmap data"),Y(he.data||he.element||he.needsCopy,"missing image data"),ou(Qe),vi(he,bc+p,k,te,se),Ba(),ea(he),sr}function b(p){var c=p|0;if(c!==Qe.width){sr.width=Qe.width=c,sr.height=Qe.height=c,ou(Qe);for(var f=0;f<6;++f)for(var m=0;Qe.mipmask>>m;++m)xe.texImage2D(bc+f,m,Qe.format,c>>m,c>>m,0,Qe.format,Qe.type,null);return Ba(),br.profile&&(Qe.stats.size=Ti(Qe.internalformat,Qe.type,sr.width,sr.height,!1,!0)),sr}}return sr(wt,Tr,vr,Dn,Ui,yt),sr.subimage=lr,sr.resize=b,sr._reglType="textureCube",sr._texture=Qe,br.profile&&(sr.stats=Qe.stats),sr.destroy=function(){Qe.decRef()},sr}function fs(){for(var wt=0;wt<Zs;++wt)xe.activeTexture(ya+wt),xe.bindTexture(gs,null),Yo[wt]=null;ze(cs).forEach(_n),Pr.cubeCount=0,Pr.textureCount=0}br.profile&&(Pr.getTotalTextureSize=function(){var wt=0;return Object.keys(cs).forEach(function(Tr){wt+=cs[Tr].stats.size}),wt});function Ws(){for(var wt=0;wt<Zs;++wt){var Tr=Yo[wt];Tr&&(Tr.bindCount=0,Tr.unit=-1,Yo[wt]=null)}ze(cs).forEach(function(vr){vr.texture=xe.createTexture(),xe.bindTexture(vr.target,vr.texture);for(var Dn=0;Dn<32;++Dn)if((vr.mipmask&1<<Dn)!=0)if(vr.target===gs)xe.texImage2D(gs,Dn,vr.internalformat,vr.width>>Dn,vr.height>>Dn,0,vr.internalformat,vr.type,null);else for(var Ui=0;Ui<6;++Ui)xe.texImage2D(bc+Ui,Dn,vr.internalformat,vr.width>>Dn,vr.height>>Dn,0,vr.internalformat,vr.type,null);rs(vr.texInfo,vr.target)})}function Lc(){for(var wt=0;wt<Zs;++wt){var Tr=Yo[wt];Tr&&(Tr.bindCount=0,Tr.unit=-1,Yo[wt]=null),xe.activeTexture(ya+wt),xe.bindTexture(gs,null),xe.bindTexture(kc,null)}}return{create2D:Fi,createCube:Qi,clear:fs,getTexture:function(Tr){return null},restore:Ws,refresh:Lc}}var Zo=36161,ho=32854,Ru=32855,Ju=36194,gu=33189,Ms=36168,ru=34041,Jn=35907,Bn=34836,Pl=34842,xs=34843,Wo=[];Wo[ho]=2,Wo[Ru]=2,Wo[Ju]=2,Wo[gu]=2,Wo[Ms]=1,Wo[ru]=4,Wo[Jn]=4,Wo[Bn]=16,Wo[Pl]=8,Wo[xs]=6;function No(xe,Fe,At){return Wo[xe]*Fe*At}var nu=function(Fe,At,xr,Rr,Pr){var br={rgba4:ho,rgb565:Ju,"rgb5 a1":Ru,depth:gu,stencil:Ms,"depth stencil":ru};At.ext_srgb&&(br.srgba=Jn),At.ext_color_buffer_half_float&&(br.rgba16f=Pl,br.rgb16f=xs),At.webgl_color_buffer_float&&(br.rgba32f=Bn);var Yr=[];Object.keys(br).forEach(function(un){var Sr=br[un];Yr[Sr]=un});var tn=0,on={};function rn(un){this.id=tn++,this.refCount=1,this.renderbuffer=un,this.format=ho,this.width=0,this.height=0,Pr.profile&&(this.stats={size:0})}rn.prototype.decRef=function(){--this.refCount<=0&&cn(this)};function cn(un){var Sr=un.renderbuffer;Y(Sr,"must not double destroy renderbuffer"),Fe.bindRenderbuffer(Zo,null),Fe.deleteRenderbuffer(Sr),un.renderbuffer=null,un.refCount=0,delete on[un.id],Rr.renderbufferCount--}function Pn(un,Sr){var gr=new rn(Fe.createRenderbuffer());on[gr.id]=gr,Rr.renderbufferCount++;function Kr(Dr,Qn){var qr=0,Gr=0,Hr=ho;if(typeof Dr=="object"&&Dr){var Qr=Dr;if("shape"in Qr){var Yn=Qr.shape;Y(Array.isArray(Yn)&&Yn.length>=2,"invalid renderbuffer shape"),qr=Yn[0]|0,Gr=Yn[1]|0}else"radius"in Qr&&(qr=Gr=Qr.radius|0),"width"in Qr&&(qr=Qr.width|0),"height"in Qr&&(Gr=Qr.height|0);"format"in Qr&&(Y.parameter(Qr.format,br,"invalid renderbuffer format"),Hr=br[Qr.format])}else typeof Dr=="number"?(qr=Dr|0,typeof Qn=="number"?Gr=Qn|0:Gr=qr):Dr?Y.raise("invalid arguments to renderbuffer constructor"):qr=Gr=1;if(Y(qr>0&&Gr>0&&qr<=xr.maxRenderbufferSize&&Gr<=xr.maxRenderbufferSize,"invalid renderbuffer size"),!(qr===gr.width&&Gr===gr.height&&Hr===gr.format))return Kr.width=gr.width=qr,Kr.height=gr.height=Gr,gr.format=Hr,Fe.bindRenderbuffer(Zo,gr.renderbuffer),Fe.renderbufferStorage(Zo,Hr,qr,Gr),Y(Fe.getError()===0,"invalid render buffer format"),Pr.profile&&(gr.stats.size=No(gr.format,gr.width,gr.height)),Kr.format=Yr[gr.format],Kr}function On(Dr,Qn){var qr=Dr|0,Gr=Qn|0||qr;return qr===gr.width&&Gr===gr.height||(Y(qr>0&&Gr>0&&qr<=xr.maxRenderbufferSize&&Gr<=xr.maxRenderbufferSize,"invalid renderbuffer size"),Kr.width=gr.width=qr,Kr.height=gr.height=Gr,Fe.bindRenderbuffer(Zo,gr.renderbuffer),Fe.renderbufferStorage(Zo,gr.format,qr,Gr),Y(Fe.getError()===0,"invalid render buffer format"),Pr.profile&&(gr.stats.size=No(gr.format,gr.width,gr.height))),Kr}return Kr(un,Sr),Kr.resize=On,Kr._reglType="renderbuffer",Kr._renderbuffer=gr,Pr.profile&&(Kr.stats=gr.stats),Kr.destroy=function(){gr.decRef()},Kr}Pr.profile&&(Rr.getTotalRenderbufferSize=function(){var un=0;return Object.keys(on).forEach(function(Sr){un+=on[Sr].stats.size}),un});function mn(){ze(on).forEach(function(un){un.renderbuffer=Fe.createRenderbuffer(),Fe.bindRenderbuffer(Zo,un.renderbuffer),Fe.renderbufferStorage(Zo,un.format,un.width,un.height)}),Fe.bindRenderbuffer(Zo,null)}return{create:Pn,clear:function(){ze(on).forEach(cn)},restore:mn}},Du=36160,cc=36161,na=3553,po=34069,hl=36064,dl=36096,fc=36128,zu=33306,Is=36053,Yl=36054,Gs=36055,Pf=36057,Kl=36061,Zc=36193,_f=5121,bs=5126,Nu=6407,Wc=6408,_l=6402,Ml=[Nu,Wc],hc=[];hc[Wc]=4,hc[Nu]=3;var Qu=[];Qu[_f]=1,Qu[bs]=4,Qu[Zc]=2;var Fs=32854,dc=32855,pl=36194,vl=33189,Il=36168,s=34041,i=35907,n=34836,l=34842,y=34843,M=[Fs,dc,pl,i,l,y,n],L={};L[Is]="complete",L[Yl]="incomplete attachment",L[Pf]="incomplete dimensions",L[Gs]="incomplete, missing attachment",L[Kl]="unsupported";function B(xe,Fe,At,xr,Rr,Pr){var br={cur:null,next:null,dirty:!1,setFBO:null},Yr=["rgba"],tn=["rgba4","rgb565","rgb5 a1"];Fe.ext_srgb&&tn.push("srgba"),Fe.ext_color_buffer_half_float&&tn.push("rgba16f","rgb16f"),Fe.webgl_color_buffer_float&&tn.push("rgba32f");var on=["uint8"];Fe.oes_texture_half_float&&on.push("half float","float16"),Fe.oes_texture_float&&on.push("float","float32");function rn(ln,Wr,jr){this.target=ln,this.texture=Wr,this.renderbuffer=jr;var vi=0,di=0;Wr?(vi=Wr.width,di=Wr.height):jr&&(vi=jr.width,di=jr.height),this.width=vi,this.height=di}function cn(ln){ln&&(ln.texture&&ln.texture._texture.decRef(),ln.renderbuffer&&ln.renderbuffer._renderbuffer.decRef())}function Pn(ln,Wr,jr){if(!!ln)if(ln.texture){var vi=ln.texture._texture,di=Math.max(1,vi.width),Nn=Math.max(1,vi.height);Y(di===Wr&&Nn===jr,"inconsistent width/height for supplied texture"),vi.refCount+=1}else{var ea=ln.renderbuffer._renderbuffer;Y(ea.width===Wr&&ea.height===jr,"inconsistent width/height for renderbuffer"),ea.refCount+=1}}function mn(ln,Wr){Wr&&(Wr.texture?xe.framebufferTexture2D(Du,ln,Wr.target,Wr.texture._texture.texture,0):xe.framebufferRenderbuffer(Du,ln,cc,Wr.renderbuffer._renderbuffer.renderbuffer))}function un(ln){var Wr=na,jr=null,vi=null,di=ln;typeof ln=="object"&&(di=ln.data,"target"in ln&&(Wr=ln.target|0)),Y.type(di,"function","invalid attachment data");var Nn=di._reglType;return Nn==="texture2d"?(jr=di,Y(Wr===na)):Nn==="textureCube"?(jr=di,Y(Wr>=po&&Wr<po+6,"invalid cube map target")):Nn==="renderbuffer"?(vi=di,Wr=cc):Y.raise("invalid regl object for attachment"),new rn(Wr,jr,vi)}function Sr(ln,Wr,jr,vi,di){if(jr){var Nn=xr.create2D({width:ln,height:Wr,format:vi,type:di});return Nn._texture.refCount=0,new rn(na,Nn,null)}else{var ea=Rr.create({width:ln,height:Wr,format:vi});return ea._renderbuffer.refCount=0,new rn(cc,null,ea)}}function gr(ln){return ln&&(ln.texture||ln.renderbuffer)}function Kr(ln,Wr,jr){ln&&(ln.texture?ln.texture.resize(Wr,jr):ln.renderbuffer&&ln.renderbuffer.resize(Wr,jr),ln.width=Wr,ln.height=jr)}var On=0,Dr={};function Qn(){this.id=On++,Dr[this.id]=this,this.framebuffer=xe.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function qr(ln){ln.colorAttachments.forEach(cn),cn(ln.depthAttachment),cn(ln.stencilAttachment),cn(ln.depthStencilAttachment)}function Gr(ln){var Wr=ln.framebuffer;Y(Wr,"must not double destroy framebuffer"),xe.deleteFramebuffer(Wr),ln.framebuffer=null,Pr.framebufferCount--,delete Dr[ln.id]}function Hr(ln){var Wr;xe.bindFramebuffer(Du,ln.framebuffer);var jr=ln.colorAttachments;for(Wr=0;Wr<jr.length;++Wr)mn(hl+Wr,jr[Wr]);for(Wr=jr.length;Wr<At.maxColorAttachments;++Wr)xe.framebufferTexture2D(Du,hl+Wr,na,null,0);xe.framebufferTexture2D(Du,zu,na,null,0),xe.framebufferTexture2D(Du,dl,na,null,0),xe.framebufferTexture2D(Du,fc,na,null,0),mn(dl,ln.depthAttachment),mn(fc,ln.stencilAttachment),mn(zu,ln.depthStencilAttachment);var vi=xe.checkFramebufferStatus(Du);!xe.isContextLost()&&vi!==Is&&Y.raise("framebuffer configuration not supported, status = "+L[vi]),xe.bindFramebuffer(Du,br.next?br.next.framebuffer:null),br.cur=br.next,xe.getError()}function Qr(ln,Wr){var jr=new Qn;Pr.framebufferCount++;function vi(Nn,ea){var Ai;Y(br.next!==jr,"can not update framebuffer which is currently in use");var Ji=0,ma=0,Xo=!0,Ts=!0,ta=null,wo=!0,Fa="rgba",As="uint8",rs=1,ko=null,cs=null,Zs=null,Yo=!1;if(typeof Nn=="number")Ji=Nn|0,ma=ea|0||Ji;else if(!Nn)Ji=ma=1;else{Y.type(Nn,"object","invalid arguments for framebuffer");var oi=Nn;if("shape"in oi){var ou=oi.shape;Y(Array.isArray(ou)&&ou.length>=2,"invalid shape for framebuffer"),Ji=ou[0],ma=ou[1]}else"radius"in oi&&(Ji=ma=oi.radius),"width"in oi&&(Ji=oi.width),"height"in oi&&(ma=oi.height);("color"in oi||"colors"in oi)&&(ta=oi.color||oi.colors,Array.isArray(ta)&&Y(ta.length===1||Fe.webgl_draw_buffers,"multiple render targets not supported")),ta||("colorCount"in oi&&(rs=oi.colorCount|0,Y(rs>0,"invalid color buffer count")),"colorTexture"in oi&&(wo=!!oi.colorTexture,Fa="rgba4"),"colorType"in oi&&(As=oi.colorType,wo?(Y(Fe.oes_texture_float||!(As==="float"||As==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),Y(Fe.oes_texture_half_float||!(As==="half float"||As==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):As==="half float"||As==="float16"?(Y(Fe.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Fa="rgba16f"):(As==="float"||As==="float32")&&(Y(Fe.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Fa="rgba32f"),Y.oneOf(As,on,"invalid color type")),"colorFormat"in oi&&(Fa=oi.colorFormat,Yr.indexOf(Fa)>=0?wo=!0:tn.indexOf(Fa)>=0?wo=!1:wo?Y.oneOf(oi.colorFormat,Yr,"invalid color format for texture"):Y.oneOf(oi.colorFormat,tn,"invalid color format for renderbuffer"))),("depthTexture"in oi||"depthStencilTexture"in oi)&&(Yo=!!(oi.depthTexture||oi.depthStencilTexture),Y(!Yo||Fe.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in oi&&(typeof oi.depth=="boolean"?Xo=oi.depth:(ko=oi.depth,Ts=!1)),"stencil"in oi&&(typeof oi.stencil=="boolean"?Ts=oi.stencil:(cs=oi.stencil,Xo=!1)),"depthStencil"in oi&&(typeof oi.depthStencil=="boolean"?Xo=Ts=oi.depthStencil:(Zs=oi.depthStencil,Xo=!1,Ts=!1))}var Ba=null,_n=null,Fi=null,Qi=null;if(Array.isArray(ta))Ba=ta.map(un);else if(ta)Ba=[un(ta)];else for(Ba=new Array(rs),Ai=0;Ai<rs;++Ai)Ba[Ai]=Sr(Ji,ma,wo,Fa,As);Y(Fe.webgl_draw_buffers||Ba.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),Y(Ba.length<=At.maxColorAttachments,"too many color attachments, not supported"),Ji=Ji||Ba[0].width,ma=ma||Ba[0].height,ko?_n=un(ko):Xo&&!Ts&&(_n=Sr(Ji,ma,Yo,"depth","uint32")),cs?Fi=un(cs):Ts&&!Xo&&(Fi=Sr(Ji,ma,!1,"stencil","uint8")),Zs?Qi=un(Zs):!ko&&!cs&&Ts&&Xo&&(Qi=Sr(Ji,ma,Yo,"depth stencil","depth stencil")),Y(!!ko+!!cs+!!Zs<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var fs=null;for(Ai=0;Ai<Ba.length;++Ai)if(Pn(Ba[Ai],Ji,ma),Y(!Ba[Ai]||Ba[Ai].texture&&Ml.indexOf(Ba[Ai].texture._texture.format)>=0||Ba[Ai].renderbuffer&&M.indexOf(Ba[Ai].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Ai+" is invalid"),Ba[Ai]&&Ba[Ai].texture){var Ws=hc[Ba[Ai].texture._texture.format]*Qu[Ba[Ai].texture._texture.type];fs===null?fs=Ws:Y(fs===Ws,"all color attachments much have the same number of bits per pixel.")}return Pn(_n,Ji,ma),Y(!_n||_n.texture&&_n.texture._texture.format===_l||_n.renderbuffer&&_n.renderbuffer._renderbuffer.format===vl,"invalid depth attachment for framebuffer object"),Pn(Fi,Ji,ma),Y(!Fi||Fi.renderbuffer&&Fi.renderbuffer._renderbuffer.format===Il,"invalid stencil attachment for framebuffer object"),Pn(Qi,Ji,ma),Y(!Qi||Qi.texture&&Qi.texture._texture.format===s||Qi.renderbuffer&&Qi.renderbuffer._renderbuffer.format===s,"invalid depth-stencil attachment for framebuffer object"),qr(jr),jr.width=Ji,jr.height=ma,jr.colorAttachments=Ba,jr.depthAttachment=_n,jr.stencilAttachment=Fi,jr.depthStencilAttachment=Qi,vi.color=Ba.map(gr),vi.depth=gr(_n),vi.stencil=gr(Fi),vi.depthStencil=gr(Qi),vi.width=jr.width,vi.height=jr.height,Hr(jr),vi}function di(Nn,ea){Y(br.next!==jr,"can not resize a framebuffer which is currently in use");var Ai=Math.max(Nn|0,1),Ji=Math.max(ea|0||Ai,1);if(Ai===jr.width&&Ji===jr.height)return vi;for(var ma=jr.colorAttachments,Xo=0;Xo<ma.length;++Xo)Kr(ma[Xo],Ai,Ji);return Kr(jr.depthAttachment,Ai,Ji),Kr(jr.stencilAttachment,Ai,Ji),Kr(jr.depthStencilAttachment,Ai,Ji),jr.width=vi.width=Ai,jr.height=vi.height=Ji,Hr(jr),vi}return vi(ln,Wr),v(vi,{resize:di,_reglType:"framebuffer",_framebuffer:jr,destroy:function(){Gr(jr),qr(jr)},use:function(ea){br.setFBO({framebuffer:vi},ea)}})}function Yn(ln){var Wr=Array(6);function jr(di){var Nn;Y(Wr.indexOf(br.next)<0,"can not update framebuffer which is currently in use");var ea={color:null},Ai=0,Ji=null,ma="rgba",Xo="uint8",Ts=1;if(typeof di=="number")Ai=di|0;else if(!di)Ai=1;else{Y.type(di,"object","invalid arguments for framebuffer");var ta=di;if("shape"in ta){var wo=ta.shape;Y(Array.isArray(wo)&&wo.length>=2,"invalid shape for framebuffer"),Y(wo[0]===wo[1],"cube framebuffer must be square"),Ai=wo[0]}else"radius"in ta&&(Ai=ta.radius|0),"width"in ta?(Ai=ta.width|0,"height"in ta&&Y(ta.height===Ai,"must be square")):"height"in ta&&(Ai=ta.height|0);("color"in ta||"colors"in ta)&&(Ji=ta.color||ta.colors,Array.isArray(Ji)&&Y(Ji.length===1||Fe.webgl_draw_buffers,"multiple render targets not supported")),Ji||("colorCount"in ta&&(Ts=ta.colorCount|0,Y(Ts>0,"invalid color buffer count")),"colorType"in ta&&(Y.oneOf(ta.colorType,on,"invalid color type"),Xo=ta.colorType),"colorFormat"in ta&&(ma=ta.colorFormat,Y.oneOf(ta.colorFormat,Yr,"invalid color format for texture"))),"depth"in ta&&(ea.depth=ta.depth),"stencil"in ta&&(ea.stencil=ta.stencil),"depthStencil"in ta&&(ea.depthStencil=ta.depthStencil)}var Fa;if(Ji)if(Array.isArray(Ji))for(Fa=[],Nn=0;Nn<Ji.length;++Nn)Fa[Nn]=Ji[Nn];else Fa=[Ji];else{Fa=Array(Ts);var As={radius:Ai,format:ma,type:Xo};for(Nn=0;Nn<Ts;++Nn)Fa[Nn]=xr.createCube(As)}for(ea.color=Array(Fa.length),Nn=0;Nn<Fa.length;++Nn){var rs=Fa[Nn];Y(typeof rs=="function"&&rs._reglType==="textureCube","invalid cube map"),Ai=Ai||rs.width,Y(rs.width===Ai&&rs.height===Ai,"invalid cube map shape"),ea.color[Nn]={target:po,data:Fa[Nn]}}for(Nn=0;Nn<6;++Nn){for(var ko=0;ko<Fa.length;++ko)ea.color[ko].target=po+Nn;Nn>0&&(ea.depth=Wr[0].depth,ea.stencil=Wr[0].stencil,ea.depthStencil=Wr[0].depthStencil),Wr[Nn]?Wr[Nn](ea):Wr[Nn]=Qr(ea)}return v(jr,{width:Ai,height:Ai,color:Fa})}function vi(di){var Nn,ea=di|0;if(Y(ea>0&&ea<=At.maxCubeMapSize,"invalid radius for cube fbo"),ea===jr.width)return jr;var Ai=jr.color;for(Nn=0;Nn<Ai.length;++Nn)Ai[Nn].resize(ea);for(Nn=0;Nn<6;++Nn)Wr[Nn].resize(ea);return jr.width=jr.height=ea,jr}return jr(ln),v(jr,{faces:Wr,resize:vi,_reglType:"framebufferCube",destroy:function(){Wr.forEach(function(Nn){Nn.destroy()})}})}function ai(){br.cur=null,br.next=null,br.dirty=!0,ze(Dr).forEach(function(ln){ln.framebuffer=xe.createFramebuffer(),Hr(ln)})}return v(br,{getFramebuffer:function(Wr){if(typeof Wr=="function"&&Wr._reglType==="framebuffer"){var jr=Wr._framebuffer;if(jr instanceof Qn)return jr}return null},create:Qr,createCube:Yn,clear:function(){ze(Dr).forEach(Gr)},restore:ai})}var oe=5126,Te=34962;function Ge(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=oe,this.offset=0,this.stride=0,this.divisor=0}function Ke(xe,Fe,At,xr,Rr){for(var Pr=At.maxAttributes,br=new Array(Pr),Yr=0;Yr<Pr;++Yr)br[Yr]=new Ge;var tn=0,on={},rn={Record:Ge,scope:{},state:br,currentVAO:null,targetVAO:null,restore:Pn()?Dr:function(){},createVAO:Qn,getVAO:un,destroyBuffer:cn,setVAO:Pn()?Sr:gr,clear:Pn()?Kr:function(){}};function cn(qr){for(var Gr=0;Gr<br.length;++Gr){var Hr=br[Gr];Hr.buffer===qr&&(xe.disableVertexAttribArray(Gr),Hr.buffer=null)}}function Pn(){return Fe.oes_vertex_array_object}function mn(){return Fe.angle_instanced_arrays}function un(qr){return typeof qr=="function"&&qr._vao?qr._vao:null}function Sr(qr){if(qr!==rn.currentVAO){var Gr=Pn();qr?Gr.bindVertexArrayOES(qr.vao):Gr.bindVertexArrayOES(null),rn.currentVAO=qr}}function gr(qr){if(qr!==rn.currentVAO){if(qr)qr.bindAttrs();else for(var Gr=mn(),Hr=0;Hr<br.length;++Hr){var Qr=br[Hr];Qr.buffer?(xe.enableVertexAttribArray(Hr),xe.vertexAttribPointer(Hr,Qr.size,Qr.type,Qr.normalized,Qr.stride,Qr.offfset),Gr&&Qr.divisor&&Gr.vertexAttribDivisorANGLE(Hr,Qr.divisor)):(xe.disableVertexAttribArray(Hr),xe.vertexAttrib4f(Hr,Qr.x,Qr.y,Qr.z,Qr.w))}rn.currentVAO=qr}}function Kr(){ze(on).forEach(function(qr){qr.destroy()})}function On(){this.id=++tn,this.attributes=[];var qr=Pn();qr?this.vao=qr.createVertexArrayOES():this.vao=null,on[this.id]=this,this.buffers=[]}On.prototype.bindAttrs=function(){for(var qr=mn(),Gr=this.attributes,Hr=0;Hr<Gr.length;++Hr){var Qr=Gr[Hr];Qr.buffer?(xe.enableVertexAttribArray(Hr),xe.bindBuffer(Te,Qr.buffer.buffer),xe.vertexAttribPointer(Hr,Qr.size,Qr.type,Qr.normalized,Qr.stride,Qr.offset),qr&&Qr.divisor&&qr.vertexAttribDivisorANGLE(Hr,Qr.divisor)):(xe.disableVertexAttribArray(Hr),xe.vertexAttrib4f(Hr,Qr.x,Qr.y,Qr.z,Qr.w))}for(var Yn=Gr.length;Yn<Pr;++Yn)xe.disableVertexAttribArray(Yn)},On.prototype.refresh=function(){var qr=Pn();qr&&(qr.bindVertexArrayOES(this.vao),this.bindAttrs(),rn.currentVAO=this)},On.prototype.destroy=function(){if(this.vao){var qr=Pn();this===rn.currentVAO&&(rn.currentVAO=null,qr.bindVertexArrayOES(null)),qr.deleteVertexArrayOES(this.vao),this.vao=null}on[this.id]&&(delete on[this.id],xr.vaoCount-=1)};function Dr(){var qr=Pn();qr&&ze(on).forEach(function(Gr){Gr.refresh()})}function Qn(qr){var Gr=new On;xr.vaoCount+=1;function Hr(Qr){Y(Array.isArray(Qr),"arguments to vertex array constructor must be an array"),Y(Qr.length<Pr,"too many attributes"),Y(Qr.length>0,"must specify at least one attribute");var Yn={},ai=Gr.attributes;ai.length=Qr.length;for(var ln=0;ln<Qr.length;++ln){var Wr=Qr[ln],jr=ai[ln]=new Ge,vi=Wr.data||Wr;if(Array.isArray(vi)||S(vi)||kt(vi)){var di;Gr.buffers[ln]&&(di=Gr.buffers[ln],S(vi)&&di._buffer.byteLength>=vi.byteLength?di.subdata(vi):(di.destroy(),Gr.buffers[ln]=null)),Gr.buffers[ln]||(di=Gr.buffers[ln]=Rr.create(Wr,Te,!1,!0)),jr.buffer=Rr.getBuffer(di),jr.size=jr.buffer.dimension|0,jr.normalized=!1,jr.type=jr.buffer.dtype,jr.offset=0,jr.stride=0,jr.divisor=0,jr.state=1,Yn[ln]=1}else Rr.getBuffer(Wr)?(jr.buffer=Rr.getBuffer(Wr),jr.size=jr.buffer.dimension|0,jr.normalized=!1,jr.type=jr.buffer.dtype,jr.offset=0,jr.stride=0,jr.divisor=0,jr.state=1):Rr.getBuffer(Wr.buffer)?(jr.buffer=Rr.getBuffer(Wr.buffer),jr.size=(+Wr.size||jr.buffer.dimension)|0,jr.normalized=!!Wr.normalized||!1,"type"in Wr?(Y.parameter(Wr.type,bo,"invalid buffer type"),jr.type=bo[Wr.type]):jr.type=jr.buffer.dtype,jr.offset=(Wr.offset||0)|0,jr.stride=(Wr.stride||0)|0,jr.divisor=(Wr.divisor||0)|0,jr.state=1,Y(jr.size>=1&&jr.size<=4,"size must be between 1 and 4"),Y(jr.offset>=0,"invalid offset"),Y(jr.stride>=0&&jr.stride<=255,"stride must be between 0 and 255"),Y(jr.divisor>=0,"divisor must be positive"),Y(!jr.divisor||!!Fe.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Wr?(Y(ln>0,"first attribute must not be a constant"),jr.x=+Wr.x||0,jr.y=+Wr.y||0,jr.z=+Wr.z||0,jr.w=+Wr.w||0,jr.state=2):Y(!1,"invalid attribute spec for location "+ln)}for(var Nn=0;Nn<Gr.buffers.length;++Nn)!Yn[Nn]&&Gr.buffers[Nn]&&(Gr.buffers[Nn].destroy(),Gr.buffers[Nn]=null);return Gr.refresh(),Hr}return Hr.destroy=function(){for(var Qr=0;Qr<Gr.buffers.length;++Qr)Gr.buffers[Qr]&&Gr.buffers[Qr].destroy();Gr.buffers.length=0,Gr.destroy()},Hr._vao=Gr,Hr._reglType="vao",Hr(qr)}return rn}var et=35632,Ft=35633,Rt=35718,Yt=35721;function zt(xe,Fe,At,xr){var Rr={},Pr={};function br(Sr,gr,Kr,On){this.name=Sr,this.id=gr,this.location=Kr,this.info=On}function Yr(Sr,gr){for(var Kr=0;Kr<Sr.length;++Kr)if(Sr[Kr].id===gr.id){Sr[Kr].location=gr.location;return}Sr.push(gr)}function tn(Sr,gr,Kr){var On=Sr===et?Rr:Pr,Dr=On[gr];if(!Dr){var Qn=Fe.str(gr);Dr=xe.createShader(Sr),xe.shaderSource(Dr,Qn),xe.compileShader(Dr),Y.shaderError(xe,Dr,Qn,Sr,Kr),On[gr]=Dr}return Dr}var on={},rn=[],cn=0;function Pn(Sr,gr){this.id=cn++,this.fragId=Sr,this.vertId=gr,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,xr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function mn(Sr,gr,Kr){var On,Dr,Qn=tn(et,Sr.fragId),qr=tn(Ft,Sr.vertId),Gr=Sr.program=xe.createProgram();if(xe.attachShader(Gr,Qn),xe.attachShader(Gr,qr),Kr)for(On=0;On<Kr.length;++On){var Hr=Kr[On];xe.bindAttribLocation(Gr,Hr[0],Hr[1])}xe.linkProgram(Gr),Y.linkError(xe,Gr,Fe.str(Sr.fragId),Fe.str(Sr.vertId),gr);var Qr=xe.getProgramParameter(Gr,Rt);xr.profile&&(Sr.stats.uniformsCount=Qr);var Yn=Sr.uniforms;for(On=0;On<Qr;++On)if(Dr=xe.getActiveUniform(Gr,On),Dr)if(Dr.size>1)for(var ai=0;ai<Dr.size;++ai){var ln=Dr.name.replace("[0]","["+ai+"]");Yr(Yn,new br(ln,Fe.id(ln),xe.getUniformLocation(Gr,ln),Dr))}else Yr(Yn,new br(Dr.name,Fe.id(Dr.name),xe.getUniformLocation(Gr,Dr.name),Dr));var Wr=xe.getProgramParameter(Gr,Yt);xr.profile&&(Sr.stats.attributesCount=Wr);var jr=Sr.attributes;for(On=0;On<Wr;++On)Dr=xe.getActiveAttrib(Gr,On),Dr&&Yr(jr,new br(Dr.name,Fe.id(Dr.name),xe.getAttribLocation(Gr,Dr.name),Dr))}xr.profile&&(At.getMaxUniformsCount=function(){var Sr=0;return rn.forEach(function(gr){gr.stats.uniformsCount>Sr&&(Sr=gr.stats.uniformsCount)}),Sr},At.getMaxAttributesCount=function(){var Sr=0;return rn.forEach(function(gr){gr.stats.attributesCount>Sr&&(Sr=gr.stats.attributesCount)}),Sr});function un(){Rr={},Pr={};for(var Sr=0;Sr<rn.length;++Sr)mn(rn[Sr],null,rn[Sr].attributes.map(function(gr){return[gr.location,gr.name]}))}return{clear:function(){var gr=xe.deleteShader.bind(xe);ze(Rr).forEach(gr),Rr={},ze(Pr).forEach(gr),Pr={},rn.forEach(function(Kr){xe.deleteProgram(Kr.program)}),rn.length=0,on={},At.shaderCount=0},program:function(gr,Kr,On,Dr){Y.command(gr>=0,"missing vertex shader",On),Y.command(Kr>=0,"missing fragment shader",On);var Qn=on[Kr];Qn||(Qn=on[Kr]={});var qr=Qn[gr];if(qr&&(qr.refCount++,!Dr))return qr;var Gr=new Pn(Kr,gr);return At.shaderCount++,mn(Gr,On,Dr),qr||(Qn[gr]=Gr),rn.push(Gr),v(Gr,{destroy:function(){if(Gr.refCount--,Gr.refCount<=0){xe.deleteProgram(Gr.program);var Qr=rn.indexOf(Gr);rn.splice(Qr,1),At.shaderCount--}Qn[Gr.vertId].refCount<=0&&(xe.deleteShader(Pr[Gr.vertId]),delete Pr[Gr.vertId],delete on[Gr.fragId][Gr.vertId]),Object.keys(on[Gr.fragId]).length||(xe.deleteShader(Rr[Gr.fragId]),delete Rr[Gr.fragId],delete on[Gr.fragId])}})},restore:un,shader:tn,frag:-1,vert:-1}}var jt=6408,rr=5121,nr=3333,zr=5126;function pr(xe,Fe,At,xr,Rr,Pr,br){function Yr(rn){var cn;Fe.next===null?(Y(Rr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),cn=rr):(Y(Fe.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),cn=Fe.next.colorAttachments[0].texture._texture.type,Pr.oes_texture_float?(Y(cn===rr||cn===zr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),cn===zr&&Y(br.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):Y(cn===rr,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Pn=0,mn=0,un=xr.framebufferWidth,Sr=xr.framebufferHeight,gr=null;S(rn)?gr=rn:rn&&(Y.type(rn,"object","invalid arguments to regl.read()"),Pn=rn.x|0,mn=rn.y|0,Y(Pn>=0&&Pn<xr.framebufferWidth,"invalid x offset for regl.read"),Y(mn>=0&&mn<xr.framebufferHeight,"invalid y offset for regl.read"),un=(rn.width||xr.framebufferWidth-Pn)|0,Sr=(rn.height||xr.framebufferHeight-mn)|0,gr=rn.data||null),gr&&(cn===rr?Y(gr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):cn===zr&&Y(gr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),Y(un>0&&un+Pn<=xr.framebufferWidth,"invalid width for read pixels"),Y(Sr>0&&Sr+mn<=xr.framebufferHeight,"invalid height for read pixels"),At();var Kr=un*Sr*4;return gr||(cn===rr?gr=new Uint8Array(Kr):cn===zr&&(gr=gr||new Float32Array(Kr))),Y.isTypedArray(gr,"data buffer for regl.read() must be a typedarray"),Y(gr.byteLength>=Kr,"data buffer for regl.read() too small"),xe.pixelStorei(nr,4),xe.readPixels(Pn,mn,un,Sr,jt,cn,gr),gr}function tn(rn){var cn;return Fe.setFBO({framebuffer:rn.framebuffer},function(){cn=Yr(rn)}),cn}function on(rn){return!rn||!("framebuffer"in rn)?Yr(rn):tn(rn)}return on}function Ar(xe){return Array.prototype.slice.call(xe)}function wr(xe){return Ar(xe).join("")}function sn(){var xe=0,Fe=[],At=[];function xr(cn){for(var Pn=0;Pn<At.length;++Pn)if(At[Pn]===cn)return Fe[Pn];var mn="g"+xe++;return Fe.push(mn),At.push(cn),mn}function Rr(){var cn=[];function Pn(){cn.push.apply(cn,Ar(arguments))}var mn=[];function un(){var Sr="v"+xe++;return mn.push(Sr),arguments.length>0&&(cn.push(Sr,"="),cn.push.apply(cn,Ar(arguments)),cn.push(";")),Sr}return v(Pn,{def:un,toString:function(){return wr([mn.length>0?"var "+mn.join(",")+";":"",wr(cn)])}})}function Pr(){var cn=Rr(),Pn=Rr(),mn=cn.toString,un=Pn.toString;function Sr(gr,Kr){Pn(gr,Kr,"=",cn.def(gr,Kr),";")}return v(function(){cn.apply(cn,Ar(arguments))},{def:cn.def,entry:cn,exit:Pn,save:Sr,set:function(Kr,On,Dr){Sr(Kr,On),cn(Kr,On,"=",Dr,";")},toString:function(){return mn()+un()}})}function br(){var cn=wr(arguments),Pn=Pr(),mn=Pr(),un=Pn.toString,Sr=mn.toString;return v(Pn,{then:function(){return Pn.apply(Pn,Ar(arguments)),this},else:function(){return mn.apply(mn,Ar(arguments)),this},toString:function(){var Kr=Sr();return Kr&&(Kr="else{"+Kr+"}"),wr(["if(",cn,"){",un(),"}",Kr])}})}var Yr=Rr(),tn={};function on(cn,Pn){var mn=[];function un(){var Dr="a"+mn.length;return mn.push(Dr),Dr}Pn=Pn||0;for(var Sr=0;Sr<Pn;++Sr)un();var gr=Pr(),Kr=gr.toString,On=tn[cn]=v(gr,{arg:un,toString:function(){return wr(["function(",mn.join(),"){",Kr(),"}"])}});return On}function rn(){var cn=['"use strict";',Yr,"return {"];Object.keys(tn).forEach(function(un){cn.push('"',un,'":',tn[un].toString(),",")}),cn.push("}");var Pn=wr(cn).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),mn=Function.apply(null,Fe.concat(Pn));return mn.apply(null,At)}return{global:Yr,link:xr,block:Rr,proc:on,scope:Pr,cond:br,compile:rn}}var $r="xyzw".split(""),xn=5121,In=1,ei=2,si=0,Ii=1,$i=2,wn=3,ui=4,Si=5,Hn=6,Ei="dither",ii="blend.enable",Ni="blend.color",Hi="blend.equation",no="blend.func",za="depth.enable",Mo="depth.func",_a="depth.range",Ja="depth.mask",Os="colorMask",Ls="cull.enable",yu="cull.face",Fu="frontFace",Ss="lineWidth",Bs="polygonOffset.enable",Bu="polygonOffset.offset",xu="sample.alpha",qu="sample.enable",$l="sample.coverage",ml="stencil.enable",iu="stencil.mask",pc="stencil.func",bu="stencil.opFront",Eo="stencil.opBack",gl="scissor.enable",Jl="scissor.box",Rs="viewport",To="profile",vo="framebuffer",es="vert",Ao="frag",io="elements",ts="primitive",yl="count",Pc="offset",Xc="instances",el="vao",vc="Width",Ol="Height",Hs=vo+vc,Fo=vo+Ol,Ql=Rs+vc,Es=Rs+Ol,ql="drawingBuffer",hf=ql+vc,Zf=ql+Ol,lh=[no,Hi,pc,bu,Eo,$l,Rs,Jl,Bu],xl=34962,Mf=34963,df=35632,Bf=35633,ku=3553,mc=34067,Wf=2884,_c=3042,Mc=3024,Ic=2960,Xf=2929,Yf=3089,Kf=32823,If=32926,ch=32928,ec=5126,Yc=35664,mo=35665,tc=35666,Of=5124,Kc=35667,au=35668,Ll=35669,Lf=35670,Rf=35671,Oc=35672,pf=35673,$c=35674,Rl=35675,ee=35676,ie=35678,D=35680,U=4,Se=1028,tt=1029,Ut=2304,qt=2305,er=32775,_r=32776,en=519,Rn=7680,$n=0,ri=1,Mi=32774,Ri=513,fa=36160,ua=36064,Na={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},go=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],ao={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Va={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Co={frag:df,vert:Bf},Xi={cw:Ut,ccw:qt};function Qa(xe){return Array.isArray(xe)||S(xe)||kt(xe)}function ls(xe){return xe.sort(function(Fe,At){return Fe===Rs?-1:At===Rs?1:Fe<At?-1:1})}function Sa(xe,Fe,At,xr){this.thisDep=xe,this.contextDep=Fe,this.propDep=At,this.append=xr}function Ma(xe){return xe&&!(xe.thisDep||xe.contextDep||xe.propDep)}function gi(xe){return new Sa(!1,!1,!1,xe)}function Bo(xe,Fe){var At=xe.type;if(At===si){var xr=xe.data.length;return new Sa(!0,xr>=1,xr>=2,Fe)}else if(At===ui){var Rr=xe.data;return new Sa(Rr.thisDep,Rr.contextDep,Rr.propDep,Fe)}else{if(At===Si)return new Sa(!1,!1,!1,Fe);if(At===Hn){for(var Pr=!1,br=!1,Yr=!1,tn=0;tn<xe.data.length;++tn){var on=xe.data[tn];if(on.type===Ii)Yr=!0;else if(on.type===$i)br=!0;else if(on.type===wn)Pr=!0;else if(on.type===si){Pr=!0;var rn=on.data;rn>=1&&(br=!0),rn>=2&&(Yr=!0)}else on.type===ui&&(Pr=Pr||on.data.thisDep,br=br||on.data.contextDep,Yr=Yr||on.data.propDep)}return new Sa(Pr,br,Yr,Fe)}else return new Sa(At===wn,At===$i,At===Ii,Fe)}}var gc=new Sa(!1,!1,!1,function(){});function $f(xe,Fe,At,xr,Rr,Pr,br,Yr,tn,on,rn,cn,Pn,mn,un){var Sr=on.Record,gr={add:32774,subtract:32778,"reverse subtract":32779};At.ext_blend_minmax&&(gr.min=er,gr.max=_r);var Kr=At.angle_instanced_arrays,On=At.webgl_draw_buffers,Dr={dirty:!0,profile:un.profile},Qn={},qr=[],Gr={},Hr={};function Qr(yt){return yt.replace(".","_")}function Yn(yt,Qe,Kt){var sr=Qr(yt);qr.push(yt),Qn[sr]=Dr[sr]=!!Kt,Gr[sr]=Qe}function ai(yt,Qe,Kt){var sr=Qr(yt);qr.push(yt),Array.isArray(Kt)?(Dr[sr]=Kt.slice(),Qn[sr]=Kt.slice()):Dr[sr]=Qn[sr]=Kt,Hr[sr]=Qe}Yn(Ei,Mc),Yn(ii,_c),ai(Ni,"blendColor",[0,0,0,0]),ai(Hi,"blendEquationSeparate",[Mi,Mi]),ai(no,"blendFuncSeparate",[ri,$n,ri,$n]),Yn(za,Xf,!0),ai(Mo,"depthFunc",Ri),ai(_a,"depthRange",[0,1]),ai(Ja,"depthMask",!0),ai(Os,Os,[!0,!0,!0,!0]),Yn(Ls,Wf),ai(yu,"cullFace",tt),ai(Fu,Fu,qt),ai(Ss,Ss,1),Yn(Bs,Kf),ai(Bu,"polygonOffset",[0,0]),Yn(xu,If),Yn(qu,ch),ai($l,"sampleCoverage",[1,!1]),Yn(ml,Ic),ai(iu,"stencilMask",-1),ai(pc,"stencilFunc",[en,0,-1]),ai(bu,"stencilOpSeparate",[Se,Rn,Rn,Rn]),ai(Eo,"stencilOpSeparate",[tt,Rn,Rn,Rn]),Yn(gl,Yf),ai(Jl,"scissor",[0,0,xe.drawingBufferWidth,xe.drawingBufferHeight]),ai(Rs,Rs,[0,0,xe.drawingBufferWidth,xe.drawingBufferHeight]);var ln={gl:xe,context:Pn,strings:Fe,next:Qn,current:Dr,draw:cn,elements:Pr,buffer:Rr,shader:rn,attributes:on.state,vao:on,uniforms:tn,framebuffer:Yr,extensions:At,timer:mn,isBufferArgs:Qa},Wr={primTypes:Aa,compareFuncs:ao,blendFuncs:Na,blendEquations:gr,stencilOps:Va,glTypes:bo,orientationType:Xi};Y.optional(function(){ln.isArrayLike=ro}),On&&(Wr.backBuffer=[tt],Wr.drawBuffer=pe(xr.maxDrawbuffers,function(yt){return yt===0?[0]:pe(yt,function(Qe){return ua+Qe})}));var jr=0;function vi(){var yt=sn(),Qe=yt.link,Kt=yt.global;yt.id=jr++,yt.batchId="0";var sr=Qe(ln),lr=yt.shared={props:"a0"};Object.keys(ln).forEach(function(m){lr[m]=Kt.def(sr,".",m)}),Y.optional(function(){yt.CHECK=Qe(Y),yt.commandStr=Y.guessCommand(),yt.command=Qe(yt.commandStr),yt.assert=function(m,_,k){m("if(!(",_,"))",this.CHECK,".commandRaise(",Qe(k),",",this.command,");")},Wr.invalidBlendCombinations=go});var b=yt.next={},p=yt.current={};Object.keys(Hr).forEach(function(m){Array.isArray(Dr[m])&&(b[m]=Kt.def(lr.next,".",m),p[m]=Kt.def(lr.current,".",m))});var c=yt.constants={};Object.keys(Wr).forEach(function(m){c[m]=Kt.def(JSON.stringify(Wr[m]))}),yt.invoke=function(m,_){switch(_.type){case si:var k=["this",lr.context,lr.props,yt.batchId];return m.def(Qe(_.data),".call(",k.slice(0,Math.max(_.data.length+1,4)),")");case Ii:return m.def(lr.props,_.data);case $i:return m.def(lr.context,_.data);case wn:return m.def("this",_.data);case ui:return _.data.append(yt,m),_.data.ref;case Si:return _.data.toString();case Hn:return _.data.map(function(te){return yt.invoke(m,te)})}},yt.attribCache={};var f={};return yt.scopeAttrib=function(m){var _=Fe.id(m);if(_ in f)return f[_];var k=on.scope[_];k||(k=on.scope[_]=new Sr);var te=f[_]=Qe(k);return te},yt}function di(yt){var Qe=yt.static,Kt=yt.dynamic,sr;if(To in Qe){var lr=!!Qe[To];sr=gi(function(p,c){return lr}),sr.enable=lr}else if(To in Kt){var b=Kt[To];sr=Bo(b,function(p,c){return p.invoke(c,b)})}return sr}function Nn(yt,Qe){var Kt=yt.static,sr=yt.dynamic;if(vo in Kt){var lr=Kt[vo];return lr?(lr=Yr.getFramebuffer(lr),Y.command(lr,"invalid framebuffer object"),gi(function(p,c){var f=p.link(lr),m=p.shared;c.set(m.framebuffer,".next",f);var _=m.context;return c.set(_,"."+Hs,f+".width"),c.set(_,"."+Fo,f+".height"),f})):gi(function(p,c){var f=p.shared;c.set(f.framebuffer,".next","null");var m=f.context;return c.set(m,"."+Hs,m+"."+hf),c.set(m,"."+Fo,m+"."+Zf),"null"})}else if(vo in sr){var b=sr[vo];return Bo(b,function(p,c){var f=p.invoke(c,b),m=p.shared,_=m.framebuffer,k=c.def(_,".getFramebuffer(",f,")");Y.optional(function(){p.assert(c,"!"+f+"||"+k,"invalid framebuffer object")}),c.set(_,".next",k);var te=m.context;return c.set(te,"."+Hs,k+"?"+k+".width:"+te+"."+hf),c.set(te,"."+Fo,k+"?"+k+".height:"+te+"."+Zf),k})}else return null}function ea(yt,Qe,Kt){var sr=yt.static,lr=yt.dynamic;function b(f){if(f in sr){var m=sr[f];Y.commandType(m,"object","invalid "+f,Kt.commandStr);var _=!0,k=m.x|0,te=m.y|0,se,he;return"width"in m?(se=m.width|0,Y.command(se>=0,"invalid "+f,Kt.commandStr)):_=!1,"height"in m?(he=m.height|0,Y.command(he>=0,"invalid "+f,Kt.commandStr)):_=!1,new Sa(!_&&Qe&&Qe.thisDep,!_&&Qe&&Qe.contextDep,!_&&Qe&&Qe.propDep,function(Bt,mr){var yr=Bt.shared.context,Ir=se;"width"in m||(Ir=mr.def(yr,".",Hs,"-",k));var Xr=he;return"height"in m||(Xr=mr.def(yr,".",Fo,"-",te)),[k,te,Ir,Xr]})}else if(f in lr){var Ye=lr[f],Lt=Bo(Ye,function(Bt,mr){var yr=Bt.invoke(mr,Ye);Y.optional(function(){Bt.assert(mr,yr+"&&typeof "+yr+'==="object"',"invalid "+f)});var Ir=Bt.shared.context,Xr=mr.def(yr,".x|0"),Jr=mr.def(yr,".y|0"),jn=mr.def('"width" in ',yr,"?",yr,".width|0:","(",Ir,".",Hs,"-",Xr,")"),Zn=mr.def('"height" in ',yr,"?",yr,".height|0:","(",Ir,".",Fo,"-",Jr,")");return Y.optional(function(){Bt.assert(mr,jn+">=0&&"+Zn+">=0","invalid "+f)}),[Xr,Jr,jn,Zn]});return Qe&&(Lt.thisDep=Lt.thisDep||Qe.thisDep,Lt.contextDep=Lt.contextDep||Qe.contextDep,Lt.propDep=Lt.propDep||Qe.propDep),Lt}else return Qe?new Sa(Qe.thisDep,Qe.contextDep,Qe.propDep,function(Bt,mr){var yr=Bt.shared.context;return[0,0,mr.def(yr,".",Hs),mr.def(yr,".",Fo)]}):null}var p=b(Rs);if(p){var c=p;p=new Sa(p.thisDep,p.contextDep,p.propDep,function(f,m){var _=c.append(f,m),k=f.shared.context;return m.set(k,"."+Ql,_[2]),m.set(k,"."+Es,_[3]),_})}return{viewport:p,scissor_box:b(Jl)}}function Ai(yt,Qe){var Kt=yt.static,sr=typeof Kt[Ao]=="string"&&typeof Kt[es]=="string";if(sr){if(Object.keys(Qe.dynamic).length>0)return null;var lr=Qe.static,b=Object.keys(lr);if(b.length>0&&typeof lr[b[0]]=="number"){for(var p=[],c=0;c<b.length;++c)Y(typeof lr[b[c]]=="number","must specify all vertex attribute locations when using vaos"),p.push([lr[b[c]]|0,b[c]]);return p}}return null}function Ji(yt,Qe,Kt){var sr=yt.static,lr=yt.dynamic;function b(_){if(_ in sr){var k=Fe.id(sr[_]);Y.optional(function(){rn.shader(Co[_],k,Y.guessCommand())});var te=gi(function(){return k});return te.id=k,te}else if(_ in lr){var se=lr[_];return Bo(se,function(he,Ye){var Lt=he.invoke(Ye,se),Bt=Ye.def(he.shared.strings,".id(",Lt,")");return Y.optional(function(){Ye(he.shared.shader,".shader(",Co[_],",",Bt,",",he.command,");")}),Bt})}return null}var p=b(Ao),c=b(es),f=null,m;return Ma(p)&&Ma(c)?(f=rn.program(c.id,p.id,null,Kt),m=gi(function(_,k){return _.link(f)})):m=new Sa(p&&p.thisDep||c&&c.thisDep,p&&p.contextDep||c&&c.contextDep,p&&p.propDep||c&&c.propDep,function(_,k){var te=_.shared.shader,se;p?se=p.append(_,k):se=k.def(te,".",Ao);var he;c?he=c.append(_,k):he=k.def(te,".",es);var Ye=te+".program("+he+","+se;return Y.optional(function(){Ye+=","+_.command}),k.def(Ye+")")}),{frag:p,vert:c,progVar:m,program:f}}function ma(yt,Qe){var Kt=yt.static,sr=yt.dynamic;function lr(){if(io in Kt){var _=Kt[io];Qa(_)?_=Pr.getElements(Pr.create(_,!0)):_&&(_=Pr.getElements(_),Y.command(_,"invalid elements",Qe.commandStr));var k=gi(function(se,he){if(_){var Ye=se.link(_);return se.ELEMENTS=Ye,Ye}return se.ELEMENTS=null,null});return k.value=_,k}else if(io in sr){var te=sr[io];return Bo(te,function(se,he){var Ye=se.shared,Lt=Ye.isBufferArgs,Bt=Ye.elements,mr=se.invoke(he,te),yr=he.def("null"),Ir=he.def(Lt,"(",mr,")"),Xr=se.cond(Ir).then(yr,"=",Bt,".createStream(",mr,");").else(yr,"=",Bt,".getElements(",mr,");");return Y.optional(function(){se.assert(Xr.else,"!"+mr+"||"+yr,"invalid elements")}),he.entry(Xr),he.exit(se.cond(Ir).then(Bt,".destroyStream(",yr,");")),se.ELEMENTS=yr,yr})}return null}var b=lr();function p(){if(ts in Kt){var _=Kt[ts];return Y.commandParameter(_,Aa,"invalid primitve",Qe.commandStr),gi(function(te,se){return Aa[_]})}else if(ts in sr){var k=sr[ts];return Bo(k,function(te,se){var he=te.constants.primTypes,Ye=te.invoke(se,k);return Y.optional(function(){te.assert(se,Ye+" in "+he,"invalid primitive, must be one of "+Object.keys(Aa))}),se.def(he,"[",Ye,"]")})}else if(b)return Ma(b)?b.value?gi(function(te,se){return se.def(te.ELEMENTS,".primType")}):gi(function(){return U}):new Sa(b.thisDep,b.contextDep,b.propDep,function(te,se){var he=te.ELEMENTS;return se.def(he,"?",he,".primType:",U)});return null}function c(_,k){if(_ in Kt){var te=Kt[_]|0;return Y.command(!k||te>=0,"invalid "+_,Qe.commandStr),gi(function(he,Ye){return k&&(he.OFFSET=te),te})}else if(_ in sr){var se=sr[_];return Bo(se,function(he,Ye){var Lt=he.invoke(Ye,se);return k&&(he.OFFSET=Lt,Y.optional(function(){he.assert(Ye,Lt+">=0","invalid "+_)})),Lt})}else if(k&&b)return gi(function(he,Ye){return he.OFFSET="0",0});return null}var f=c(Pc,!0);function m(){if(yl in Kt){var _=Kt[yl]|0;return Y.command(typeof _=="number"&&_>=0,"invalid vertex count",Qe.commandStr),gi(function(){return _})}else if(yl in sr){var k=sr[yl];return Bo(k,function(he,Ye){var Lt=he.invoke(Ye,k);return Y.optional(function(){he.assert(Ye,"typeof "+Lt+'==="number"&&'+Lt+">=0&&"+Lt+"===("+Lt+"|0)","invalid vertex count")}),Lt})}else if(b)if(Ma(b)){if(b)return f?new Sa(f.thisDep,f.contextDep,f.propDep,function(he,Ye){var Lt=Ye.def(he.ELEMENTS,".vertCount-",he.OFFSET);return Y.optional(function(){he.assert(Ye,Lt+">=0","invalid vertex offset/element buffer too small")}),Lt}):gi(function(he,Ye){return Ye.def(he.ELEMENTS,".vertCount")});var te=gi(function(){return-1});return Y.optional(function(){te.MISSING=!0}),te}else{var se=new Sa(b.thisDep||f.thisDep,b.contextDep||f.contextDep,b.propDep||f.propDep,function(he,Ye){var Lt=he.ELEMENTS;return he.OFFSET?Ye.def(Lt,"?",Lt,".vertCount-",he.OFFSET,":-1"):Ye.def(Lt,"?",Lt,".vertCount:-1")});return Y.optional(function(){se.DYNAMIC=!0}),se}return null}return{elements:b,primitive:p(),count:m(),instances:c(Xc,!1),offset:f}}function Xo(yt,Qe){var Kt=yt.static,sr=yt.dynamic,lr={};return qr.forEach(function(b){var p=Qr(b);function c(f,m){if(b in Kt){var _=f(Kt[b]);lr[p]=gi(function(){return _})}else if(b in sr){var k=sr[b];lr[p]=Bo(k,function(te,se){return m(te,se,te.invoke(se,k))})}}switch(b){case Ls:case ii:case Ei:case ml:case za:case gl:case Bs:case xu:case qu:case Ja:return c(function(f){return Y.commandType(f,"boolean",b,Qe.commandStr),f},function(f,m,_){return Y.optional(function(){f.assert(m,"typeof "+_+'==="boolean"',"invalid flag "+b,f.commandStr)}),_});case Mo:return c(function(f){return Y.commandParameter(f,ao,"invalid "+b,Qe.commandStr),ao[f]},function(f,m,_){var k=f.constants.compareFuncs;return Y.optional(function(){f.assert(m,_+" in "+k,"invalid "+b+", must be one of "+Object.keys(ao))}),m.def(k,"[",_,"]")});case _a:return c(function(f){return Y.command(ro(f)&&f.length===2&&typeof f[0]=="number"&&typeof f[1]=="number"&&f[0]<=f[1],"depth range is 2d array",Qe.commandStr),f},function(f,m,_){Y.optional(function(){f.assert(m,f.shared.isArrayLike+"("+_+")&&"+_+".length===2&&typeof "+_+'[0]==="number"&&typeof '+_+'[1]==="number"&&'+_+"[0]<="+_+"[1]","depth range must be a 2d array")});var k=m.def("+",_,"[0]"),te=m.def("+",_,"[1]");return[k,te]});case no:return c(function(f){Y.commandType(f,"object","blend.func",Qe.commandStr);var m="srcRGB"in f?f.srcRGB:f.src,_="srcAlpha"in f?f.srcAlpha:f.src,k="dstRGB"in f?f.dstRGB:f.dst,te="dstAlpha"in f?f.dstAlpha:f.dst;return Y.commandParameter(m,Na,p+".srcRGB",Qe.commandStr),Y.commandParameter(_,Na,p+".srcAlpha",Qe.commandStr),Y.commandParameter(k,Na,p+".dstRGB",Qe.commandStr),Y.commandParameter(te,Na,p+".dstAlpha",Qe.commandStr),Y.command(go.indexOf(m+", "+k)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+m+", "+k+")",Qe.commandStr),[Na[m],Na[k],Na[_],Na[te]]},function(f,m,_){var k=f.constants.blendFuncs;Y.optional(function(){f.assert(m,_+"&&typeof "+_+'==="object"',"invalid blend func, must be an object")});function te(yr,Ir){var Xr=m.def('"',yr,Ir,'" in ',_,"?",_,".",yr,Ir,":",_,".",yr);return Y.optional(function(){f.assert(m,Xr+" in "+k,"invalid "+b+"."+yr+Ir+", must be one of "+Object.keys(Na))}),Xr}var se=te("src","RGB"),he=te("dst","RGB");Y.optional(function(){var yr=f.constants.invalidBlendCombinations;f.assert(m,yr+".indexOf("+se+'+", "+'+he+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Ye=m.def(k,"[",se,"]"),Lt=m.def(k,"[",te("src","Alpha"),"]"),Bt=m.def(k,"[",he,"]"),mr=m.def(k,"[",te("dst","Alpha"),"]");return[Ye,Bt,Lt,mr]});case Hi:return c(function(f){if(typeof f=="string")return Y.commandParameter(f,gr,"invalid "+b,Qe.commandStr),[gr[f],gr[f]];if(typeof f=="object")return Y.commandParameter(f.rgb,gr,b+".rgb",Qe.commandStr),Y.commandParameter(f.alpha,gr,b+".alpha",Qe.commandStr),[gr[f.rgb],gr[f.alpha]];Y.commandRaise("invalid blend.equation",Qe.commandStr)},function(f,m,_){var k=f.constants.blendEquations,te=m.def(),se=m.def(),he=f.cond("typeof ",_,'==="string"');return Y.optional(function(){function Ye(Lt,Bt,mr){f.assert(Lt,mr+" in "+k,"invalid "+Bt+", must be one of "+Object.keys(gr))}Ye(he.then,b,_),f.assert(he.else,_+"&&typeof "+_+'==="object"',"invalid "+b),Ye(he.else,b+".rgb",_+".rgb"),Ye(he.else,b+".alpha",_+".alpha")}),he.then(te,"=",se,"=",k,"[",_,"];"),he.else(te,"=",k,"[",_,".rgb];",se,"=",k,"[",_,".alpha];"),m(he),[te,se]});case Ni:return c(function(f){return Y.command(ro(f)&&f.length===4,"blend.color must be a 4d array",Qe.commandStr),pe(4,function(m){return+f[m]})},function(f,m,_){return Y.optional(function(){f.assert(m,f.shared.isArrayLike+"("+_+")&&"+_+".length===4","blend.color must be a 4d array")}),pe(4,function(k){return m.def("+",_,"[",k,"]")})});case iu:return c(function(f){return Y.commandType(f,"number",p,Qe.commandStr),f|0},function(f,m,_){return Y.optional(function(){f.assert(m,"typeof "+_+'==="number"',"invalid stencil.mask")}),m.def(_,"|0")});case pc:return c(function(f){Y.commandType(f,"object",p,Qe.commandStr);var m=f.cmp||"keep",_=f.ref||0,k="mask"in f?f.mask:-1;return Y.commandParameter(m,ao,b+".cmp",Qe.commandStr),Y.commandType(_,"number",b+".ref",Qe.commandStr),Y.commandType(k,"number",b+".mask",Qe.commandStr),[ao[m],_,k]},function(f,m,_){var k=f.constants.compareFuncs;Y.optional(function(){function Ye(){f.assert(m,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Ye(_+"&&typeof ",_,'==="object"'),Ye('!("cmp" in ',_,")||(",_,".cmp in ",k,")")});var te=m.def('"cmp" in ',_,"?",k,"[",_,".cmp]",":",Rn),se=m.def(_,".ref|0"),he=m.def('"mask" in ',_,"?",_,".mask|0:-1");return[te,se,he]});case bu:case Eo:return c(function(f){Y.commandType(f,"object",p,Qe.commandStr);var m=f.fail||"keep",_=f.zfail||"keep",k=f.zpass||"keep";return Y.commandParameter(m,Va,b+".fail",Qe.commandStr),Y.commandParameter(_,Va,b+".zfail",Qe.commandStr),Y.commandParameter(k,Va,b+".zpass",Qe.commandStr),[b===Eo?tt:Se,Va[m],Va[_],Va[k]]},function(f,m,_){var k=f.constants.stencilOps;Y.optional(function(){f.assert(m,_+"&&typeof "+_+'==="object"',"invalid "+b)});function te(se){return Y.optional(function(){f.assert(m,'!("'+se+'" in '+_+")||("+_+"."+se+" in "+k+")","invalid "+b+"."+se+", must be one of "+Object.keys(Va))}),m.def('"',se,'" in ',_,"?",k,"[",_,".",se,"]:",Rn)}return[b===Eo?tt:Se,te("fail"),te("zfail"),te("zpass")]});case Bu:return c(function(f){Y.commandType(f,"object",p,Qe.commandStr);var m=f.factor|0,_=f.units|0;return Y.commandType(m,"number",p+".factor",Qe.commandStr),Y.commandType(_,"number",p+".units",Qe.commandStr),[m,_]},function(f,m,_){Y.optional(function(){f.assert(m,_+"&&typeof "+_+'==="object"',"invalid "+b)});var k=m.def(_,".factor|0"),te=m.def(_,".units|0");return[k,te]});case yu:return c(function(f){var m=0;return f==="front"?m=Se:f==="back"&&(m=tt),Y.command(!!m,p,Qe.commandStr),m},function(f,m,_){return Y.optional(function(){f.assert(m,_+'==="front"||'+_+'==="back"',"invalid cull.face")}),m.def(_,'==="front"?',Se,":",tt)});case Ss:return c(function(f){return Y.command(typeof f=="number"&&f>=xr.lineWidthDims[0]&&f<=xr.lineWidthDims[1],"invalid line width, must be a positive number between "+xr.lineWidthDims[0]+" and "+xr.lineWidthDims[1],Qe.commandStr),f},function(f,m,_){return Y.optional(function(){f.assert(m,"typeof "+_+'==="number"&&'+_+">="+xr.lineWidthDims[0]+"&&"+_+"<="+xr.lineWidthDims[1],"invalid line width")}),_});case Fu:return c(function(f){return Y.commandParameter(f,Xi,p,Qe.commandStr),Xi[f]},function(f,m,_){return Y.optional(function(){f.assert(m,_+'==="cw"||'+_+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),m.def(_+'==="cw"?'+Ut+":"+qt)});case Os:return c(function(f){return Y.command(ro(f)&&f.length===4,"color.mask must be length 4 array",Qe.commandStr),f.map(function(m){return!!m})},function(f,m,_){return Y.optional(function(){f.assert(m,f.shared.isArrayLike+"("+_+")&&"+_+".length===4","invalid color.mask")}),pe(4,function(k){return"!!"+_+"["+k+"]"})});case $l:return c(function(f){Y.command(typeof f=="object"&&f,p,Qe.commandStr);var m="value"in f?f.value:1,_=!!f.invert;return Y.command(typeof m=="number"&&m>=0&&m<=1,"sample.coverage.value must be a number between 0 and 1",Qe.commandStr),[m,_]},function(f,m,_){Y.optional(function(){f.assert(m,_+"&&typeof "+_+'==="object"',"invalid sample.coverage")});var k=m.def('"value" in ',_,"?+",_,".value:1"),te=m.def("!!",_,".invert");return[k,te]})}}),lr}function Ts(yt,Qe){var Kt=yt.static,sr=yt.dynamic,lr={};return Object.keys(Kt).forEach(function(b){var p=Kt[b],c;if(typeof p=="number"||typeof p=="boolean")c=gi(function(){return p});else if(typeof p=="function"){var f=p._reglType;f==="texture2d"||f==="textureCube"?c=gi(function(m){return m.link(p)}):f==="framebuffer"||f==="framebufferCube"?(Y.command(p.color.length>0,'missing color attachment for framebuffer sent to uniform "'+b+'"',Qe.commandStr),c=gi(function(m){return m.link(p.color[0])})):Y.commandRaise('invalid data for uniform "'+b+'"',Qe.commandStr)}else ro(p)?c=gi(function(m){var _=m.global.def("[",pe(p.length,function(k){return Y.command(typeof p[k]=="number"||typeof p[k]=="boolean","invalid uniform "+b,m.commandStr),p[k]}),"]");return _}):Y.commandRaise('invalid or missing data for uniform "'+b+'"',Qe.commandStr);c.value=p,lr[b]=c}),Object.keys(sr).forEach(function(b){var p=sr[b];lr[b]=Bo(p,function(c,f){return c.invoke(f,p)})}),lr}function ta(yt,Qe){var Kt=yt.static,sr=yt.dynamic,lr={};return Object.keys(Kt).forEach(function(b){var p=Kt[b],c=Fe.id(b),f=new Sr;if(Qa(p))f.state=In,f.buffer=Rr.getBuffer(Rr.create(p,xl,!1,!0)),f.type=0;else{var m=Rr.getBuffer(p);if(m)f.state=In,f.buffer=m,f.type=0;else if(Y.command(typeof p=="object"&&p,"invalid data for attribute "+b,Qe.commandStr),"constant"in p){var _=p.constant;f.buffer="null",f.state=ei,typeof _=="number"?f.x=_:(Y.command(ro(_)&&_.length>0&&_.length<=4,"invalid constant for attribute "+b,Qe.commandStr),$r.forEach(function(Bt,mr){mr<_.length&&(f[Bt]=_[mr])}))}else{Qa(p.buffer)?m=Rr.getBuffer(Rr.create(p.buffer,xl,!1,!0)):m=Rr.getBuffer(p.buffer),Y.command(!!m,'missing buffer for attribute "'+b+'"',Qe.commandStr);var k=p.offset|0;Y.command(k>=0,'invalid offset for attribute "'+b+'"',Qe.commandStr);var te=p.stride|0;Y.command(te>=0&&te<256,'invalid stride for attribute "'+b+'", must be integer betweeen [0, 255]',Qe.commandStr);var se=p.size|0;Y.command(!("size"in p)||se>0&&se<=4,'invalid size for attribute "'+b+'", must be 1,2,3,4',Qe.commandStr);var he=!!p.normalized,Ye=0;"type"in p&&(Y.commandParameter(p.type,bo,"invalid type for attribute "+b,Qe.commandStr),Ye=bo[p.type]);var Lt=p.divisor|0;"divisor"in p&&(Y.command(Lt===0||Kr,'cannot specify divisor for attribute "'+b+'", instancing not supported',Qe.commandStr),Y.command(Lt>=0,'invalid divisor for attribute "'+b+'"',Qe.commandStr)),Y.optional(function(){var Bt=Qe.commandStr,mr=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(p).forEach(function(yr){Y.command(mr.indexOf(yr)>=0,'unknown parameter "'+yr+'" for attribute pointer "'+b+'" (valid parameters are '+mr+")",Bt)})}),f.buffer=m,f.state=In,f.size=se,f.normalized=he,f.type=Ye||m.dtype,f.offset=k,f.stride=te,f.divisor=Lt}}lr[b]=gi(function(Bt,mr){var yr=Bt.attribCache;if(c in yr)return yr[c];var Ir={isStream:!1};return Object.keys(f).forEach(function(Xr){Ir[Xr]=f[Xr]}),f.buffer&&(Ir.buffer=Bt.link(f.buffer),Ir.type=Ir.type||Ir.buffer+".dtype"),yr[c]=Ir,Ir})}),Object.keys(sr).forEach(function(b){var p=sr[b];function c(f,m){var _=f.invoke(m,p),k=f.shared,te=f.constants,se=k.isBufferArgs,he=k.buffer;Y.optional(function(){f.assert(m,_+"&&(typeof "+_+'==="object"||typeof '+_+'==="function")&&('+se+"("+_+")||"+he+".getBuffer("+_+")||"+he+".getBuffer("+_+".buffer)||"+se+"("+_+'.buffer)||("constant" in '+_+"&&(typeof "+_+'.constant==="number"||'+k.isArrayLike+"("+_+".constant))))",'invalid dynamic attribute "'+b+'"')});var Ye={isStream:m.def(!1)},Lt=new Sr;Lt.state=In,Object.keys(Lt).forEach(function(Ir){Ye[Ir]=m.def(""+Lt[Ir])});var Bt=Ye.buffer,mr=Ye.type;m("if(",se,"(",_,")){",Ye.isStream,"=true;",Bt,"=",he,".createStream(",xl,",",_,");",mr,"=",Bt,".dtype;","}else{",Bt,"=",he,".getBuffer(",_,");","if(",Bt,"){",mr,"=",Bt,".dtype;",'}else if("constant" in ',_,"){",Ye.state,"=",ei,";","if(typeof "+_+'.constant === "number"){',Ye[$r[0]],"=",_,".constant;",$r.slice(1).map(function(Ir){return Ye[Ir]}).join("="),"=0;","}else{",$r.map(function(Ir,Xr){return Ye[Ir]+"="+_+".constant.length>"+Xr+"?"+_+".constant["+Xr+"]:0;"}).join(""),"}}else{","if(",se,"(",_,".buffer)){",Bt,"=",he,".createStream(",xl,",",_,".buffer);","}else{",Bt,"=",he,".getBuffer(",_,".buffer);","}",mr,'="type" in ',_,"?",te.glTypes,"[",_,".type]:",Bt,".dtype;",Ye.normalized,"=!!",_,".normalized;");function yr(Ir){m(Ye[Ir],"=",_,".",Ir,"|0;")}return yr("size"),yr("offset"),yr("stride"),yr("divisor"),m("}}"),m.exit("if(",Ye.isStream,"){",he,".destroyStream(",Bt,");","}"),Ye}lr[b]=Bo(p,c)}),lr}function wo(yt,Qe){var Kt=yt.static,sr=yt.dynamic;if(el in Kt){var lr=Kt[el];return lr!==null&&on.getVAO(lr)===null&&(lr=on.createVAO(lr)),gi(function(p){return p.link(on.getVAO(lr))})}else if(el in sr){var b=sr[el];return Bo(b,function(p,c){var f=p.invoke(c,b);return c.def(p.shared.vao+".getVAO("+f+")")})}return null}function Fa(yt){var Qe=yt.static,Kt=yt.dynamic,sr={};return Object.keys(Qe).forEach(function(lr){var b=Qe[lr];sr[lr]=gi(function(p,c){return typeof b=="number"||typeof b=="boolean"?""+b:p.link(b)})}),Object.keys(Kt).forEach(function(lr){var b=Kt[lr];sr[lr]=Bo(b,function(p,c){return p.invoke(c,b)})}),sr}function As(yt,Qe,Kt,sr,lr){var b=yt.static,p=yt.dynamic;Y.optional(function(){var yr=[vo,es,Ao,io,ts,Pc,yl,Xc,To,el].concat(qr);function Ir(Xr){Object.keys(Xr).forEach(function(Jr){Y.command(yr.indexOf(Jr)>=0,'unknown parameter "'+Jr+'"',lr.commandStr)})}Ir(b),Ir(p)});var c=Ai(yt,Qe),f=Nn(yt,lr),m=ea(yt,f,lr),_=ma(yt,lr),k=Xo(yt,lr),te=Ji(yt,lr,c);function se(yr){var Ir=m[yr];Ir&&(k[yr]=Ir)}se(Rs),se(Qr(Jl));var he=Object.keys(k).length>0,Ye={framebuffer:f,draw:_,shader:te,state:k,dirty:he,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Ye.profile=di(yt,lr),Ye.uniforms=Ts(Kt,lr),Ye.drawVAO=Ye.scopeVAO=wo(yt,lr),!Ye.drawVAO&&te.program&&!c&&At.angle_instanced_arrays){var Lt=!0,Bt=te.program.attributes.map(function(yr){var Ir=Qe.static[yr];return Lt=Lt&&!!Ir,Ir});if(Lt&&Bt.length>0){var mr=on.getVAO(on.createVAO(Bt));Ye.drawVAO=new Sa(null,null,null,function(yr,Ir){return yr.link(mr)}),Ye.useVAO=!0}}return c?Ye.useVAO=!0:Ye.attributes=ta(Qe,lr),Ye.context=Fa(sr,lr),Ye}function rs(yt,Qe,Kt){var sr=yt.shared,lr=sr.context,b=yt.scope();Object.keys(Kt).forEach(function(p){Qe.save(lr,"."+p);var c=Kt[p],f=c.append(yt,Qe);Array.isArray(f)?b(lr,".",p,"=[",f.join(),"];"):b(lr,".",p,"=",f,";")}),Qe(b)}function ko(yt,Qe,Kt,sr){var lr=yt.shared,b=lr.gl,p=lr.framebuffer,c;On&&(c=Qe.def(lr.extensions,".webgl_draw_buffers"));var f=yt.constants,m=f.drawBuffer,_=f.backBuffer,k;Kt?k=Kt.append(yt,Qe):k=Qe.def(p,".next"),sr||Qe("if(",k,"!==",p,".cur){"),Qe("if(",k,"){",b,".bindFramebuffer(",fa,",",k,".framebuffer);"),On&&Qe(c,".drawBuffersWEBGL(",m,"[",k,".colorAttachments.length]);"),Qe("}else{",b,".bindFramebuffer(",fa,",null);"),On&&Qe(c,".drawBuffersWEBGL(",_,");"),Qe("}",p,".cur=",k,";"),sr||Qe("}")}function cs(yt,Qe,Kt){var sr=yt.shared,lr=sr.gl,b=yt.current,p=yt.next,c=sr.current,f=sr.next,m=yt.cond(c,".dirty");qr.forEach(function(_){var k=Qr(_);if(!(k in Kt.state)){var te,se;if(k in p){te=p[k],se=b[k];var he=pe(Dr[k].length,function(Lt){return m.def(te,"[",Lt,"]")});m(yt.cond(he.map(function(Lt,Bt){return Lt+"!=="+se+"["+Bt+"]"}).join("||")).then(lr,".",Hr[k],"(",he,");",he.map(function(Lt,Bt){return se+"["+Bt+"]="+Lt}).join(";"),";"))}else{te=m.def(f,".",k);var Ye=yt.cond(te,"!==",c,".",k);m(Ye),k in Gr?Ye(yt.cond(te).then(lr,".enable(",Gr[k],");").else(lr,".disable(",Gr[k],");"),c,".",k,"=",te,";"):Ye(lr,".",Hr[k],"(",te,");",c,".",k,"=",te,";")}}}),Object.keys(Kt.state).length===0&&m(c,".dirty=false;"),Qe(m)}function Zs(yt,Qe,Kt,sr){var lr=yt.shared,b=yt.current,p=lr.current,c=lr.gl;ls(Object.keys(Kt)).forEach(function(f){var m=Kt[f];if(!(sr&&!sr(m))){var _=m.append(yt,Qe);if(Gr[f]){var k=Gr[f];Ma(m)?_?Qe(c,".enable(",k,");"):Qe(c,".disable(",k,");"):Qe(yt.cond(_).then(c,".enable(",k,");").else(c,".disable(",k,");")),Qe(p,".",f,"=",_,";")}else if(ro(_)){var te=b[f];Qe(c,".",Hr[f],"(",_,");",_.map(function(se,he){return te+"["+he+"]="+se}).join(";"),";")}else Qe(c,".",Hr[f],"(",_,");",p,".",f,"=",_,";")}})}function Yo(yt,Qe){Kr&&(yt.instancing=Qe.def(yt.shared.extensions,".angle_instanced_arrays"))}function oi(yt,Qe,Kt,sr,lr){var b=yt.shared,p=yt.stats,c=b.current,f=b.timer,m=Kt.profile;function _(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var k,te;function se(yr){k=Qe.def(),yr(k,"=",_(),";"),typeof lr=="string"?yr(p,".count+=",lr,";"):yr(p,".count++;"),mn&&(sr?(te=Qe.def(),yr(te,"=",f,".getNumPendingQueries();")):yr(f,".beginQuery(",p,");"))}function he(yr){yr(p,".cpuTime+=",_(),"-",k,";"),mn&&(sr?yr(f,".pushScopeStats(",te,",",f,".getNumPendingQueries(),",p,");"):yr(f,".endQuery();"))}function Ye(yr){var Ir=Qe.def(c,".profile");Qe(c,".profile=",yr,";"),Qe.exit(c,".profile=",Ir,";")}var Lt;if(m){if(Ma(m)){m.enable?(se(Qe),he(Qe.exit),Ye("true")):Ye("false");return}Lt=m.append(yt,Qe),Ye(Lt)}else Lt=Qe.def(c,".profile");var Bt=yt.block();se(Bt),Qe("if(",Lt,"){",Bt,"}");var mr=yt.block();he(mr),Qe.exit("if(",Lt,"){",mr,"}")}function ou(yt,Qe,Kt,sr,lr){var b=yt.shared;function p(f){switch(f){case Yc:case Kc:case Rf:return 2;case mo:case au:case Oc:return 3;case tc:case Ll:case pf:return 4;default:return 1}}function c(f,m,_){var k=b.gl,te=Qe.def(f,".location"),se=Qe.def(b.attributes,"[",te,"]"),he=_.state,Ye=_.buffer,Lt=[_.x,_.y,_.z,_.w],Bt=["buffer","normalized","offset","stride"];function mr(){Qe("if(!",se,".buffer){",k,".enableVertexAttribArray(",te,");}");var Ir=_.type,Xr;if(_.size?Xr=Qe.def(_.size,"||",m):Xr=m,Qe("if(",se,".type!==",Ir,"||",se,".size!==",Xr,"||",Bt.map(function(jn){return se+"."+jn+"!=="+_[jn]}).join("||"),"){",k,".bindBuffer(",xl,",",Ye,".buffer);",k,".vertexAttribPointer(",[te,Xr,Ir,_.normalized,_.stride,_.offset],");",se,".type=",Ir,";",se,".size=",Xr,";",Bt.map(function(jn){return se+"."+jn+"="+_[jn]+";"}).join(""),"}"),Kr){var Jr=_.divisor;Qe("if(",se,".divisor!==",Jr,"){",yt.instancing,".vertexAttribDivisorANGLE(",[te,Jr],");",se,".divisor=",Jr,";}")}}function yr(){Qe("if(",se,".buffer){",k,".disableVertexAttribArray(",te,");",se,".buffer=null;","}if(",$r.map(function(Ir,Xr){return se+"."+Ir+"!=="+Lt[Xr]}).join("||"),"){",k,".vertexAttrib4f(",te,",",Lt,");",$r.map(function(Ir,Xr){return se+"."+Ir+"="+Lt[Xr]+";"}).join(""),"}")}he===In?mr():he===ei?yr():(Qe("if(",he,"===",In,"){"),mr(),Qe("}else{"),yr(),Qe("}"))}sr.forEach(function(f){var m=f.name,_=Kt.attributes[m],k;if(_){if(!lr(_))return;k=_.append(yt,Qe)}else{if(!lr(gc))return;var te=yt.scopeAttrib(m);Y.optional(function(){yt.assert(Qe,te+".state","missing attribute "+m)}),k={},Object.keys(new Sr).forEach(function(se){k[se]=Qe.def(te,".",se)})}c(yt.link(f),p(f.info.type),k)})}function Ba(yt,Qe,Kt,sr,lr){for(var b=yt.shared,p=b.gl,c,f=0;f<sr.length;++f){var m=sr[f],_=m.name,k=m.info.type,te=Kt.uniforms[_],se=yt.link(m),he=se+".location",Ye;if(te){if(!lr(te))continue;if(Ma(te)){var Lt=te.value;if(Y.command(Lt!==null&&typeof Lt!="undefined",'missing uniform "'+_+'"',yt.commandStr),k===ie||k===D){Y.command(typeof Lt=="function"&&(k===ie&&(Lt._reglType==="texture2d"||Lt._reglType==="framebuffer")||k===D&&(Lt._reglType==="textureCube"||Lt._reglType==="framebufferCube")),"invalid texture for uniform "+_,yt.commandStr);var Bt=yt.link(Lt._texture||Lt.color[0]._texture);Qe(p,".uniform1i(",he,",",Bt+".bind());"),Qe.exit(Bt,".unbind();")}else if(k===$c||k===Rl||k===ee){Y.optional(function(){Y.command(ro(Lt),"invalid matrix for uniform "+_,yt.commandStr),Y.command(k===$c&&Lt.length===4||k===Rl&&Lt.length===9||k===ee&&Lt.length===16,"invalid length for matrix uniform "+_,yt.commandStr)});var mr=yt.global.def("new Float32Array(["+Array.prototype.slice.call(Lt)+"])"),yr=2;k===Rl?yr=3:k===ee&&(yr=4),Qe(p,".uniformMatrix",yr,"fv(",he,",false,",mr,");")}else{switch(k){case ec:Y.commandType(Lt,"number","uniform "+_,yt.commandStr),c="1f";break;case Yc:Y.command(ro(Lt)&&Lt.length===2,"uniform "+_,yt.commandStr),c="2f";break;case mo:Y.command(ro(Lt)&&Lt.length===3,"uniform "+_,yt.commandStr),c="3f";break;case tc:Y.command(ro(Lt)&&Lt.length===4,"uniform "+_,yt.commandStr),c="4f";break;case Lf:Y.commandType(Lt,"boolean","uniform "+_,yt.commandStr),c="1i";break;case Of:Y.commandType(Lt,"number","uniform "+_,yt.commandStr),c="1i";break;case Rf:Y.command(ro(Lt)&&Lt.length===2,"uniform "+_,yt.commandStr),c="2i";break;case Kc:Y.command(ro(Lt)&&Lt.length===2,"uniform "+_,yt.commandStr),c="2i";break;case Oc:Y.command(ro(Lt)&&Lt.length===3,"uniform "+_,yt.commandStr),c="3i";break;case au:Y.command(ro(Lt)&&Lt.length===3,"uniform "+_,yt.commandStr),c="3i";break;case pf:Y.command(ro(Lt)&&Lt.length===4,"uniform "+_,yt.commandStr),c="4i";break;case Ll:Y.command(ro(Lt)&&Lt.length===4,"uniform "+_,yt.commandStr),c="4i";break}Qe(p,".uniform",c,"(",he,",",ro(Lt)?Array.prototype.slice.call(Lt):Lt,");")}continue}else Ye=te.append(yt,Qe)}else{if(!lr(gc))continue;Ye=Qe.def(b.uniforms,"[",Fe.id(_),"]")}k===ie?(Y(!Array.isArray(Ye),"must specify a scalar prop for textures"),Qe("if(",Ye,"&&",Ye,'._reglType==="framebuffer"){',Ye,"=",Ye,".color[0];","}")):k===D&&(Y(!Array.isArray(Ye),"must specify a scalar prop for cube maps"),Qe("if(",Ye,"&&",Ye,'._reglType==="framebufferCube"){',Ye,"=",Ye,".color[0];","}")),Y.optional(function(){function Zn(Bi,Yi){yt.assert(Qe,Bi,'bad data or missing for uniform "'+_+'".  '+Yi)}function Ci(Bi){Y(!Array.isArray(Ye),"must not specify an array type for uniform"),Zn("typeof "+Ye+'==="'+Bi+'"',"invalid type, expected "+Bi)}function mi(Bi,Yi){Array.isArray(Ye)?Y(Ye.length===Bi,"must have length "+Bi):Zn(b.isArrayLike+"("+Ye+")&&"+Ye+".length==="+Bi,"invalid vector, should have length "+Bi,yt.commandStr)}function la(Bi){Y(!Array.isArray(Ye),"must not specify a value type"),Zn("typeof "+Ye+'==="function"&&'+Ye+'._reglType==="texture'+(Bi===ku?"2d":"Cube")+'"',"invalid texture type",yt.commandStr)}switch(k){case Of:Ci("number");break;case Kc:mi(2,"number");break;case au:mi(3,"number");break;case Ll:mi(4,"number");break;case ec:Ci("number");break;case Yc:mi(2,"number");break;case mo:mi(3,"number");break;case tc:mi(4,"number");break;case Lf:Ci("boolean");break;case Rf:mi(2,"boolean");break;case Oc:mi(3,"boolean");break;case pf:mi(4,"boolean");break;case $c:mi(4,"number");break;case Rl:mi(9,"number");break;case ee:mi(16,"number");break;case ie:la(ku);break;case D:la(mc);break}});var Ir=1;switch(k){case ie:case D:var Xr=Qe.def(Ye,"._texture");Qe(p,".uniform1i(",he,",",Xr,".bind());"),Qe.exit(Xr,".unbind();");continue;case Of:case Lf:c="1i";break;case Kc:case Rf:c="2i",Ir=2;break;case au:case Oc:c="3i",Ir=3;break;case Ll:case pf:c="4i",Ir=4;break;case ec:c="1f";break;case Yc:c="2f",Ir=2;break;case mo:c="3f",Ir=3;break;case tc:c="4f",Ir=4;break;case $c:c="Matrix2fv";break;case Rl:c="Matrix3fv";break;case ee:c="Matrix4fv";break}if(Qe(p,".uniform",c,"(",he,","),c.charAt(0)==="M"){var Jr=Math.pow(k-$c+2,2),jn=yt.global.def("new Float32Array(",Jr,")");Array.isArray(Ye)?Qe("false,(",pe(Jr,function(Zn){return jn+"["+Zn+"]="+Ye[Zn]}),",",jn,")"):Qe("false,(Array.isArray(",Ye,")||",Ye," instanceof Float32Array)?",Ye,":(",pe(Jr,function(Zn){return jn+"["+Zn+"]="+Ye+"["+Zn+"]"}),",",jn,")")}else Ir>1?Qe(pe(Ir,function(Zn){return Array.isArray(Ye)?Ye[Zn]:Ye+"["+Zn+"]"})):(Y(!Array.isArray(Ye),"uniform value must not be an array"),Qe(Ye));Qe(");")}}function _n(yt,Qe,Kt,sr){var lr=yt.shared,b=lr.gl,p=lr.draw,c=sr.draw;function f(){var Xr=c.elements,Jr,jn=Qe;return Xr?((Xr.contextDep&&sr.contextDynamic||Xr.propDep)&&(jn=Kt),Jr=Xr.append(yt,jn)):Jr=jn.def(p,".",io),Jr&&jn("if("+Jr+")"+b+".bindBuffer("+Mf+","+Jr+".buffer.buffer);"),Jr}function m(){var Xr=c.count,Jr,jn=Qe;return Xr?((Xr.contextDep&&sr.contextDynamic||Xr.propDep)&&(jn=Kt),Jr=Xr.append(yt,jn),Y.optional(function(){Xr.MISSING&&yt.assert(Qe,"false","missing vertex count"),Xr.DYNAMIC&&yt.assert(jn,Jr+">=0","missing vertex count")})):(Jr=jn.def(p,".",yl),Y.optional(function(){yt.assert(jn,Jr+">=0","missing vertex count")})),Jr}var _=f();function k(Xr){var Jr=c[Xr];return Jr?Jr.contextDep&&sr.contextDynamic||Jr.propDep?Jr.append(yt,Kt):Jr.append(yt,Qe):Qe.def(p,".",Xr)}var te=k(ts),se=k(Pc),he=m();if(typeof he=="number"){if(he===0)return}else Kt("if(",he,"){"),Kt.exit("}");var Ye,Lt;Kr&&(Ye=k(Xc),Lt=yt.instancing);var Bt=_+".type",mr=c.elements&&Ma(c.elements);function yr(){function Xr(){Kt(Lt,".drawElementsInstancedANGLE(",[te,he,Bt,se+"<<(("+Bt+"-"+xn+")>>1)",Ye],");")}function Jr(){Kt(Lt,".drawArraysInstancedANGLE(",[te,se,he,Ye],");")}_?mr?Xr():(Kt("if(",_,"){"),Xr(),Kt("}else{"),Jr(),Kt("}")):Jr()}function Ir(){function Xr(){Kt(b+".drawElements("+[te,he,Bt,se+"<<(("+Bt+"-"+xn+")>>1)"]+");")}function Jr(){Kt(b+".drawArrays("+[te,se,he]+");")}_?mr?Xr():(Kt("if(",_,"){"),Xr(),Kt("}else{"),Jr(),Kt("}")):Jr()}Kr&&(typeof Ye!="number"||Ye>=0)?typeof Ye=="string"?(Kt("if(",Ye,">0){"),yr(),Kt("}else if(",Ye,"<0){"),Ir(),Kt("}")):yr():Ir()}function Fi(yt,Qe,Kt,sr,lr){var b=vi(),p=b.proc("body",lr);return Y.optional(function(){b.commandStr=Qe.commandStr,b.command=b.link(Qe.commandStr)}),Kr&&(b.instancing=p.def(b.shared.extensions,".angle_instanced_arrays")),yt(b,p,Kt,sr),b.compile().body}function Qi(yt,Qe,Kt,sr){Yo(yt,Qe),Kt.useVAO?Kt.drawVAO?Qe(yt.shared.vao,".setVAO(",Kt.drawVAO.append(yt,Qe),");"):Qe(yt.shared.vao,".setVAO(",yt.shared.vao,".targetVAO);"):(Qe(yt.shared.vao,".setVAO(null);"),ou(yt,Qe,Kt,sr.attributes,function(){return!0})),Ba(yt,Qe,Kt,sr.uniforms,function(){return!0}),_n(yt,Qe,Qe,Kt)}function fs(yt,Qe){var Kt=yt.proc("draw",1);Yo(yt,Kt),rs(yt,Kt,Qe.context),ko(yt,Kt,Qe.framebuffer),cs(yt,Kt,Qe),Zs(yt,Kt,Qe.state),oi(yt,Kt,Qe,!1,!0);var sr=Qe.shader.progVar.append(yt,Kt);if(Kt(yt.shared.gl,".useProgram(",sr,".program);"),Qe.shader.program)Qi(yt,Kt,Qe,Qe.shader.program);else{Kt(yt.shared.vao,".setVAO(null);");var lr=yt.global.def("{}"),b=Kt.def(sr,".id"),p=Kt.def(lr,"[",b,"]");Kt(yt.cond(p).then(p,".call(this,a0);").else(p,"=",lr,"[",b,"]=",yt.link(function(c){return Fi(Qi,yt,Qe,c,1)}),"(",sr,");",p,".call(this,a0);"))}Object.keys(Qe.state).length>0&&Kt(yt.shared.current,".dirty=true;")}function Ws(yt,Qe,Kt,sr){yt.batchId="a1",Yo(yt,Qe);function lr(){return!0}ou(yt,Qe,Kt,sr.attributes,lr),Ba(yt,Qe,Kt,sr.uniforms,lr),_n(yt,Qe,Qe,Kt)}function Lc(yt,Qe,Kt,sr){Yo(yt,Qe);var lr=Kt.contextDep,b=Qe.def(),p="a0",c="a1",f=Qe.def();yt.shared.props=f,yt.batchId=b;var m=yt.scope(),_=yt.scope();Qe(m.entry,"for(",b,"=0;",b,"<",c,";++",b,"){",f,"=",p,"[",b,"];",_,"}",m.exit);function k(Bt){return Bt.contextDep&&lr||Bt.propDep}function te(Bt){return!k(Bt)}if(Kt.needsContext&&rs(yt,_,Kt.context),Kt.needsFramebuffer&&ko(yt,_,Kt.framebuffer),Zs(yt,_,Kt.state,k),Kt.profile&&k(Kt.profile)&&oi(yt,_,Kt,!1,!0),sr)Kt.useVAO?Kt.drawVAO?k(Kt.drawVAO)?_(yt.shared.vao,".setVAO(",Kt.drawVAO.append(yt,_),");"):m(yt.shared.vao,".setVAO(",Kt.drawVAO.append(yt,m),");"):m(yt.shared.vao,".setVAO(",yt.shared.vao,".targetVAO);"):(m(yt.shared.vao,".setVAO(null);"),ou(yt,m,Kt,sr.attributes,te),ou(yt,_,Kt,sr.attributes,k)),Ba(yt,m,Kt,sr.uniforms,te),Ba(yt,_,Kt,sr.uniforms,k),_n(yt,m,_,Kt);else{var se=yt.global.def("{}"),he=Kt.shader.progVar.append(yt,_),Ye=_.def(he,".id"),Lt=_.def(se,"[",Ye,"]");_(yt.shared.gl,".useProgram(",he,".program);","if(!",Lt,"){",Lt,"=",se,"[",Ye,"]=",yt.link(function(Bt){return Fi(Ws,yt,Kt,Bt,2)}),"(",he,");}",Lt,".call(this,a0[",b,"],",b,");")}}function wt(yt,Qe){var Kt=yt.proc("batch",2);yt.batchId="0",Yo(yt,Kt);var sr=!1,lr=!0;Object.keys(Qe.context).forEach(function(se){sr=sr||Qe.context[se].propDep}),sr||(rs(yt,Kt,Qe.context),lr=!1);var b=Qe.framebuffer,p=!1;b?(b.propDep?sr=p=!0:b.contextDep&&sr&&(p=!0),p||ko(yt,Kt,b)):ko(yt,Kt,null),Qe.state.viewport&&Qe.state.viewport.propDep&&(sr=!0);function c(se){return se.contextDep&&sr||se.propDep}cs(yt,Kt,Qe),Zs(yt,Kt,Qe.state,function(se){return!c(se)}),(!Qe.profile||!c(Qe.profile))&&oi(yt,Kt,Qe,!1,"a1"),Qe.contextDep=sr,Qe.needsContext=lr,Qe.needsFramebuffer=p;var f=Qe.shader.progVar;if(f.contextDep&&sr||f.propDep)Lc(yt,Kt,Qe,null);else{var m=f.append(yt,Kt);if(Kt(yt.shared.gl,".useProgram(",m,".program);"),Qe.shader.program)Lc(yt,Kt,Qe,Qe.shader.program);else{Kt(yt.shared.vao,".setVAO(null);");var _=yt.global.def("{}"),k=Kt.def(m,".id"),te=Kt.def(_,"[",k,"]");Kt(yt.cond(te).then(te,".call(this,a0,a1);").else(te,"=",_,"[",k,"]=",yt.link(function(se){return Fi(Lc,yt,Qe,se,2)}),"(",m,");",te,".call(this,a0,a1);"))}}Object.keys(Qe.state).length>0&&Kt(yt.shared.current,".dirty=true;")}function Tr(yt,Qe){var Kt=yt.proc("scope",3);yt.batchId="a2";var sr=yt.shared,lr=sr.current;rs(yt,Kt,Qe.context),Qe.framebuffer&&Qe.framebuffer.append(yt,Kt),ls(Object.keys(Qe.state)).forEach(function(p){var c=Qe.state[p],f=c.append(yt,Kt);ro(f)?f.forEach(function(m,_){Kt.set(yt.next[p],"["+_+"]",m)}):Kt.set(sr.next,"."+p,f)}),oi(yt,Kt,Qe,!0,!0),[io,Pc,yl,Xc,ts].forEach(function(p){var c=Qe.draw[p];!c||Kt.set(sr.draw,"."+p,""+c.append(yt,Kt))}),Object.keys(Qe.uniforms).forEach(function(p){var c=Qe.uniforms[p].append(yt,Kt);Array.isArray(c)&&(c="["+c.join()+"]"),Kt.set(sr.uniforms,"["+Fe.id(p)+"]",c)}),Object.keys(Qe.attributes).forEach(function(p){var c=Qe.attributes[p].append(yt,Kt),f=yt.scopeAttrib(p);Object.keys(new Sr).forEach(function(m){Kt.set(f,"."+m,c[m])})}),Qe.scopeVAO&&Kt.set(sr.vao,".targetVAO",Qe.scopeVAO.append(yt,Kt));function b(p){var c=Qe.shader[p];c&&Kt.set(sr.shader,"."+p,c.append(yt,Kt))}b(es),b(Ao),Object.keys(Qe.state).length>0&&(Kt(lr,".dirty=true;"),Kt.exit(lr,".dirty=true;")),Kt("a1(",yt.shared.context,",a0,",yt.batchId,");")}function vr(yt){if(!(typeof yt!="object"||ro(yt))){for(var Qe=Object.keys(yt),Kt=0;Kt<Qe.length;++Kt)if($e.isDynamic(yt[Qe[Kt]]))return!0;return!1}}function Dn(yt,Qe,Kt){var sr=Qe.static[Kt];if(!sr||!vr(sr))return;var lr=yt.global,b=Object.keys(sr),p=!1,c=!1,f=!1,m=yt.global.def("{}");b.forEach(function(k){var te=sr[k];if($e.isDynamic(te)){typeof te=="function"&&(te=sr[k]=$e.unbox(te));var se=Bo(te,null);p=p||se.thisDep,f=f||se.propDep,c=c||se.contextDep}else{switch(lr(m,".",k,"="),typeof te){case"number":lr(te);break;case"string":lr('"',te,'"');break;case"object":Array.isArray(te)&&lr("[",te.join(),"]");break;default:lr(yt.link(te));break}lr(";")}});function _(k,te){b.forEach(function(se){var he=sr[se];if(!!$e.isDynamic(he)){var Ye=k.invoke(te,he);te(m,".",se,"=",Ye,";")}})}Qe.dynamic[Kt]=new $e.DynamicVariable(ui,{thisDep:p,contextDep:c,propDep:f,ref:m,append:_}),delete Qe.static[Kt]}function Ui(yt,Qe,Kt,sr,lr){var b=vi();b.stats=b.link(lr),Object.keys(Qe.static).forEach(function(c){Dn(b,Qe,c)}),lh.forEach(function(c){Dn(b,yt,c)});var p=As(yt,Qe,Kt,sr,b);return fs(b,p),Tr(b,p),wt(b,p),v(b.compile(),{destroy:function(){p.shader.program.destroy()}})}return{next:Qn,current:Dr,procs:function(){var yt=vi(),Qe=yt.proc("poll"),Kt=yt.proc("refresh"),sr=yt.block();Qe(sr),Kt(sr);var lr=yt.shared,b=lr.gl,p=lr.next,c=lr.current;sr(c,".dirty=false;"),ko(yt,Qe),ko(yt,Kt,null,!0);var f;Kr&&(f=yt.link(Kr)),At.oes_vertex_array_object&&Kt(yt.link(At.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var m=0;m<xr.maxAttributes;++m){var _=Kt.def(lr.attributes,"[",m,"]"),k=yt.cond(_,".buffer");k.then(b,".enableVertexAttribArray(",m,");",b,".bindBuffer(",xl,",",_,".buffer.buffer);",b,".vertexAttribPointer(",m,",",_,".size,",_,".type,",_,".normalized,",_,".stride,",_,".offset);").else(b,".disableVertexAttribArray(",m,");",b,".vertexAttrib4f(",m,",",_,".x,",_,".y,",_,".z,",_,".w);",_,".buffer=null;"),Kt(k),Kr&&Kt(f,".vertexAttribDivisorANGLE(",m,",",_,".divisor);")}return Kt(yt.shared.vao,".currentVAO=null;",yt.shared.vao,".setVAO(",yt.shared.vao,".targetVAO);"),Object.keys(Gr).forEach(function(te){var se=Gr[te],he=sr.def(p,".",te),Ye=yt.block();Ye("if(",he,"){",b,".enable(",se,")}else{",b,".disable(",se,")}",c,".",te,"=",he,";"),Kt(Ye),Qe("if(",he,"!==",c,".",te,"){",Ye,"}")}),Object.keys(Hr).forEach(function(te){var se=Hr[te],he=Dr[te],Ye,Lt,Bt=yt.block();if(Bt(b,".",se,"("),ro(he)){var mr=he.length;Ye=yt.global.def(p,".",te),Lt=yt.global.def(c,".",te),Bt(pe(mr,function(yr){return Ye+"["+yr+"]"}),");",pe(mr,function(yr){return Lt+"["+yr+"]="+Ye+"["+yr+"];"}).join("")),Qe("if(",pe(mr,function(yr){return Ye+"["+yr+"]!=="+Lt+"["+yr+"]"}).join("||"),"){",Bt,"}")}else Ye=sr.def(p,".",te),Lt=sr.def(c,".",te),Bt(Ye,");",c,".",te,"=",Ye,";"),Qe("if(",Ye,"!==",Lt,"){",Bt,"}");Kt(Bt)}),yt.compile()}(),compile:Ui}}function vh(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Jf=34918,ju=34919,Qf=35007,vf=function(Fe,At){if(!At.ext_disjoint_timer_query)return null;var xr=[];function Rr(){return xr.pop()||At.ext_disjoint_timer_query.createQueryEXT()}function Pr(On){xr.push(On)}var br=[];function Yr(On){var Dr=Rr();At.ext_disjoint_timer_query.beginQueryEXT(Qf,Dr),br.push(Dr),un(br.length-1,br.length,On)}function tn(){At.ext_disjoint_timer_query.endQueryEXT(Qf)}function on(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var rn=[];function cn(){return rn.pop()||new on}function Pn(On){rn.push(On)}var mn=[];function un(On,Dr,Qn){var qr=cn();qr.startQueryIndex=On,qr.endQueryIndex=Dr,qr.sum=0,qr.stats=Qn,mn.push(qr)}var Sr=[],gr=[];function Kr(){var On,Dr,Qn=br.length;if(Qn!==0){gr.length=Math.max(gr.length,Qn+1),Sr.length=Math.max(Sr.length,Qn+1),Sr[0]=0,gr[0]=0;var qr=0;for(On=0,Dr=0;Dr<br.length;++Dr){var Gr=br[Dr];At.ext_disjoint_timer_query.getQueryObjectEXT(Gr,ju)?(qr+=At.ext_disjoint_timer_query.getQueryObjectEXT(Gr,Jf),Pr(Gr)):br[On++]=Gr,Sr[Dr+1]=qr,gr[Dr+1]=On}for(br.length=On,On=0,Dr=0;Dr<mn.length;++Dr){var Hr=mn[Dr],Qr=Hr.startQueryIndex,Yn=Hr.endQueryIndex;Hr.sum+=Sr[Yn]-Sr[Qr];var ai=gr[Qr],ln=gr[Yn];ln===ai?(Hr.stats.gpuTime+=Hr.sum/1e6,Pn(Hr)):(Hr.startQueryIndex=ai,Hr.endQueryIndex=ln,mn[On++]=Hr)}mn.length=On}}return{beginQuery:Yr,endQuery:tn,pushScopeStats:un,update:Kr,getNumPendingQueries:function(){return br.length},clear:function(){xr.push.apply(xr,br);for(var Dr=0;Dr<xr.length;Dr++)At.ext_disjoint_timer_query.deleteQueryEXT(xr[Dr]);br.length=0,xr.length=0},restore:function(){br.length=0,xr.length=0}}},qf=16384,Ph=256,mh=1024,Df=34962,fh="webglcontextlost",eh="webglcontextrestored",gh=1,jh=2,kf=3;function jf(xe,Fe){for(var At=0;At<xe.length;++At)if(xe[At]===Fe)return At;return-1}function _h(xe){var Fe=Gn(xe);if(!Fe)return null;var At=Fe.gl,xr=At.getContextAttributes(),Rr=At.isContextLost(),Pr=Ee(At,Fe);if(!Pr)return null;var br=Zr(),Yr=vh(),tn=Pr.extensions,on=vf(At,tn),rn=dr(),cn=At.drawingBufferWidth,Pn=At.drawingBufferHeight,mn={tick:0,time:0,viewportWidth:cn,viewportHeight:Pn,framebufferWidth:cn,framebufferHeight:Pn,drawingBufferWidth:cn,drawingBufferHeight:Pn,pixelRatio:Fe.pixelRatio},un={},Sr={elements:null,primitive:4,count:-1,offset:0,instances:-1},gr=Lo(At,tn),Kr=Wi(At,Yr,Fe,Dr),On=Ke(At,tn,gr,Yr,Kr);function Dr(_n){return On.destroyBuffer(_n)}var Qn=Nc(At,tn,Kr,Yr),qr=zt(At,br,Yr,Fe),Gr=Lu(At,tn,gr,function(){Yn.procs.poll()},mn,Yr,Fe),Hr=nu(At,tn,gr,Yr,Fe),Qr=B(At,tn,gr,Gr,Hr,Yr),Yn=$f(At,br,tn,gr,Kr,Qn,Gr,Qr,un,On,qr,Sr,mn,on,Fe),ai=pr(At,Qr,Yn.procs.poll,mn,xr,tn,gr),ln=Yn.next,Wr=At.canvas,jr=[],vi=[],di=[],Nn=[Fe.onDestroy],ea=null;function Ai(){if(jr.length===0){on&&on.update(),ea=null;return}ea=Vt.next(Ai),Zs();for(var _n=jr.length-1;_n>=0;--_n){var Fi=jr[_n];Fi&&Fi(mn,null,0)}At.flush(),on&&on.update()}function Ji(){!ea&&jr.length>0&&(ea=Vt.next(Ai))}function ma(){ea&&(Vt.cancel(Ai),ea=null)}function Xo(_n){_n.preventDefault(),Rr=!0,ma(),vi.forEach(function(Fi){Fi()})}function Ts(_n){At.getError(),Rr=!1,Pr.restore(),qr.restore(),Kr.restore(),Gr.restore(),Hr.restore(),Qr.restore(),On.restore(),on&&on.restore(),Yn.procs.refresh(),Ji(),di.forEach(function(Fi){Fi()})}Wr&&(Wr.addEventListener(fh,Xo,!1),Wr.addEventListener(eh,Ts,!1));function ta(){jr.length=0,ma(),Wr&&(Wr.removeEventListener(fh,Xo),Wr.removeEventListener(eh,Ts)),qr.clear(),Qr.clear(),Hr.clear(),Gr.clear(),Qn.clear(),Kr.clear(),On.clear(),on&&on.clear(),Nn.forEach(function(_n){_n()})}function wo(_n){Y(!!_n,"invalid args to regl({...})"),Y.type(_n,"object","invalid args to regl({...})");function Fi(lr){var b=v({},lr);delete b.uniforms,delete b.attributes,delete b.context,delete b.vao,"stencil"in b&&b.stencil.op&&(b.stencil.opBack=b.stencil.opFront=b.stencil.op,delete b.stencil.op);function p(c){if(c in b){var f=b[c];delete b[c],Object.keys(f).forEach(function(m){b[c+"."+m]=f[m]})}}return p("blend"),p("depth"),p("cull"),p("stencil"),p("polygonOffset"),p("scissor"),p("sample"),"vao"in lr&&(b.vao=lr.vao),b}function Qi(lr,b){var p={},c={};return Object.keys(lr).forEach(function(f){var m=lr[f];if($e.isDynamic(m)){c[f]=$e.unbox(m,f);return}else if(b&&Array.isArray(m)){for(var _=0;_<m.length;++_)if($e.isDynamic(m[_])){c[f]=$e.unbox(m,f);return}}p[f]=m}),{dynamic:c,static:p}}var fs=Qi(_n.context||{},!0),Ws=Qi(_n.uniforms||{},!0),Lc=Qi(_n.attributes||{},!1),wt=Qi(Fi(_n),!1),Tr={gpuTime:0,cpuTime:0,count:0},vr=Yn.compile(wt,Lc,Ws,fs,Tr),Dn=vr.draw,Ui=vr.batch,yt=vr.scope,Qe=[];function Kt(lr){for(;Qe.length<lr;)Qe.push(null);return Qe}function sr(lr,b){var p;if(Rr&&Y.raise("context lost"),typeof lr=="function")return yt.call(this,null,lr,0);if(typeof b=="function")if(typeof lr=="number")for(p=0;p<lr;++p)yt.call(this,null,b,p);else if(Array.isArray(lr))for(p=0;p<lr.length;++p)yt.call(this,lr[p],b,p);else return yt.call(this,lr,b,0);else if(typeof lr=="number"){if(lr>0)return Ui.call(this,Kt(lr|0),lr|0)}else if(Array.isArray(lr)){if(lr.length)return Ui.call(this,lr,lr.length)}else return Dn.call(this,lr)}return v(sr,{stats:Tr,destroy:function(){vr.destroy()}})}var Fa=Qr.setFBO=wo({framebuffer:$e.define.call(null,gh,"framebuffer")});function As(_n,Fi){var Qi=0;Yn.procs.poll();var fs=Fi.color;fs&&(At.clearColor(+fs[0]||0,+fs[1]||0,+fs[2]||0,+fs[3]||0),Qi|=qf),"depth"in Fi&&(At.clearDepth(+Fi.depth),Qi|=Ph),"stencil"in Fi&&(At.clearStencil(Fi.stencil|0),Qi|=mh),Y(!!Qi,"called regl.clear with no buffer specified"),At.clear(Qi)}function rs(_n){if(Y(typeof _n=="object"&&_n,"regl.clear() takes an object as input"),"framebuffer"in _n)if(_n.framebuffer&&_n.framebuffer_reglType==="framebufferCube")for(var Fi=0;Fi<6;++Fi)Fa(v({framebuffer:_n.framebuffer.faces[Fi]},_n),As);else Fa(_n,As);else As(null,_n)}function ko(_n){Y.type(_n,"function","regl.frame() callback must be a function"),jr.push(_n);function Fi(){var Qi=jf(jr,_n);Y(Qi>=0,"cannot cancel a frame twice");function fs(){var Ws=jf(jr,fs);jr[Ws]=jr[jr.length-1],jr.length-=1,jr.length<=0&&ma()}jr[Qi]=fs}return Ji(),{cancel:Fi}}function cs(){var _n=ln.viewport,Fi=ln.scissor_box;_n[0]=_n[1]=Fi[0]=Fi[1]=0,mn.viewportWidth=mn.framebufferWidth=mn.drawingBufferWidth=_n[2]=Fi[2]=At.drawingBufferWidth,mn.viewportHeight=mn.framebufferHeight=mn.drawingBufferHeight=_n[3]=Fi[3]=At.drawingBufferHeight}function Zs(){mn.tick+=1,mn.time=oi(),cs(),Yn.procs.poll()}function Yo(){Gr.refresh(),cs(),Yn.procs.refresh(),on&&on.update()}function oi(){return(dr()-rn)/1e3}Yo();function ou(_n,Fi){Y.type(Fi,"function","listener callback must be a function");var Qi;switch(_n){case"frame":return ko(Fi);case"lost":Qi=vi;break;case"restore":Qi=di;break;case"destroy":Qi=Nn;break;default:Y.raise("invalid event, must be one of frame,lost,restore,destroy")}return Qi.push(Fi),{cancel:function(){for(var Ws=0;Ws<Qi.length;++Ws)if(Qi[Ws]===Fi){Qi[Ws]=Qi[Qi.length-1],Qi.pop();return}}}}var Ba=v(wo,{clear:rs,prop:$e.define.bind(null,gh),context:$e.define.bind(null,jh),this:$e.define.bind(null,kf),draw:wo({}),buffer:function(Fi){return Kr.create(Fi,Df,!1,!1)},elements:function(Fi){return Qn.create(Fi,!1)},texture:Gr.create2D,cube:Gr.createCube,renderbuffer:Hr.create,framebuffer:Qr.create,framebufferCube:Qr.createCube,vao:On.createVAO,attributes:xr,frame:ko,on:ou,limits:gr,hasExtension:function(Fi){return gr.extensions.indexOf(Fi.toLowerCase())>=0},read:ai,destroy:ta,_gl:At,_refresh:Yo,poll:function(){Zs(),on&&on.update()},now:oi,stats:Yr});return Fe.onDone(null,Ba),Ba}return _h})},fdMe:function(we,x,a){"use strict";a.d(x,"a",function(){return S});function S(v,Z){var N=Z.callback;return N&&(v.dataArray=v.dataArray.map(N)),v}},fo6e:function(we,x){var a=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function S(v){return a.test(v)}we.exports=S},g4R6:function(we,x){function a(S,v,Z){return S===S&&(Z!==void 0&&(S=S<=Z?S:Z),v!==void 0&&(S=S>=v?S:v)),S}we.exports=a},gFfm:function(we,x){function a(S,v){for(var Z=-1,N=S==null?0:S.length;++Z<N&&v(S[Z],Z,S)!==!1;);return S}we.exports=a},gMG2:function(we,x,a){"use strict";a.d(x,"a",function(){return ar});var S={},v={},Z=34,N=10,o=13;function X($t){return new Function("d","return {"+$t.map(function(Ht,vt){return JSON.stringify(Ht)+": d["+vt+'] || ""'}).join(",")+"}")}function F($t,Ht){var vt=X($t);return function(Ze,Et){return Ht(vt(Ze),Et,$t)}}function K($t){var Ht=Object.create(null),vt=[];return $t.forEach(function(Ze){for(var Et in Ze)Et in Ht||vt.push(Ht[Et]=Et)}),vt}function q($t,Ht){var vt=$t+"",Ze=vt.length;return Ze<Ht?new Array(Ht-Ze+1).join(0)+vt:vt}function Ce($t){return $t<0?"-"+q(-$t,6):$t>9999?"+"+q($t,6):q($t,4)}function $($t){var Ht=$t.getUTCHours(),vt=$t.getUTCMinutes(),Ze=$t.getUTCSeconds(),Et=$t.getUTCMilliseconds();return isNaN($t)?"Invalid Date":Ce($t.getUTCFullYear(),4)+"-"+q($t.getUTCMonth()+1,2)+"-"+q($t.getUTCDate(),2)+(Et?"T"+q(Ht,2)+":"+q(vt,2)+":"+q(Ze,2)+"."+q(Et,3)+"Z":Ze?"T"+q(Ht,2)+":"+q(vt,2)+":"+q(Ze,2)+"Z":vt||Ht?"T"+q(Ht,2)+":"+q(vt,2)+"Z":"")}var He=function($t){var Ht=new RegExp('["'+$t+`
\r]`),vt=$t.charCodeAt(0);function Ze(z,V){var be,me,le=Et(z,function(fe,Ne){if(be)return be(fe,Ne-1);me=fe,be=V?F(fe,V):X(fe)});return le.columns=me||[],le}function Et(z,V){var be=[],me=z.length,le=0,fe=0,Ne,lt=me<=0,rt=!1;z.charCodeAt(me-1)===N&&--me,z.charCodeAt(me-1)===o&&--me;function ue(){if(lt)return v;if(rt)return rt=!1,S;var Ue,ft=le,Oe;if(z.charCodeAt(ft)===Z){for(;le++<me&&z.charCodeAt(le)!==Z||z.charCodeAt(++le)===Z;);return(Ue=le)>=me?lt=!0:(Oe=z.charCodeAt(le++))===N?rt=!0:Oe===o&&(rt=!0,z.charCodeAt(le)===N&&++le),z.slice(ft+1,Ue-1).replace(/""/g,'"')}for(;le<me;){if((Oe=z.charCodeAt(Ue=le++))===N)rt=!0;else if(Oe===o)rt=!0,z.charCodeAt(le)===N&&++le;else if(Oe!==vt)continue;return z.slice(ft,Ue)}return lt=!0,z.slice(ft,me)}for(;(Ne=ue())!==v;){for(var ye=[];Ne!==S&&Ne!==v;)ye.push(Ne),Ne=ue();V&&(ye=V(ye,fe++))==null||be.push(ye)}return be}function Le(z,V){return z.map(function(be){return V.map(function(me){return H(be[me])}).join($t)})}function at(z,V){return V==null&&(V=K(z)),[V.map(H).join($t)].concat(Le(z,V)).join(`
`)}function Wt(z,V){return V==null&&(V=K(z)),Le(z,V).join(`
`)}function St(z){return z.map(dt).join(`
`)}function dt(z){return z.map(H).join($t)}function H(z){return z==null?"":z instanceof Date?$(z):Ht.test(z+="")?'"'+z.replace(/"/g,'""')+'"':z}return{parse:Ze,parseRows:Et,format:at,formatBody:Wt,formatRows:St,formatRow:dt,formatValue:H}},Be=He(","),ce=Be.parse,st=Be.parseRows,ut=Be.format,Me=Be.formatBody,bt=Be.formatRows,xt=Be.formatRow,Mt=Be.formatValue,De=a("5zYK");function ar($t,Ht){var vt=ce($t);return Object(De.a)(vt,Ht)}},gQMU:function(we,x,a){var S=a("0ZTe"),v=S("toUpperCase");we.exports=v},gzZq:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.BindingToSyntax=void 0;var S=a("MON2"),v=a("FV85"),Z=a("D9lx"),N=a("LKzl"),o=function(){function X(F){this._binding=F}return X.prototype.to=function(F){return this._binding.type=v.BindingTypeEnum.Instance,this._binding.implementationType=F,new Z.BindingInWhenOnSyntax(this._binding)},X.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+S.INVALID_TO_SELF_VALUE);var F=this._binding.serviceIdentifier;return this.to(F)},X.prototype.toConstantValue=function(F){return this._binding.type=v.BindingTypeEnum.ConstantValue,this._binding.cache=F,this._binding.dynamicValue=null,this._binding.implementationType=null,new N.BindingWhenOnSyntax(this._binding)},X.prototype.toDynamicValue=function(F){return this._binding.type=v.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=F,this._binding.implementationType=null,new Z.BindingInWhenOnSyntax(this._binding)},X.prototype.toConstructor=function(F){return this._binding.type=v.BindingTypeEnum.Constructor,this._binding.implementationType=F,new N.BindingWhenOnSyntax(this._binding)},X.prototype.toFactory=function(F){return this._binding.type=v.BindingTypeEnum.Factory,this._binding.factory=F,new N.BindingWhenOnSyntax(this._binding)},X.prototype.toFunction=function(F){if(typeof F!="function")throw new Error(S.INVALID_FUNCTION_BINDING);var K=this.toConstantValue(F);return this._binding.type=v.BindingTypeEnum.Function,K},X.prototype.toAutoFactory=function(F){return this._binding.type=v.BindingTypeEnum.Factory,this._binding.factory=function(K){var q=function(){return K.container.get(F)};return q},new N.BindingWhenOnSyntax(this._binding)},X.prototype.toProvider=function(F){return this._binding.type=v.BindingTypeEnum.Provider,this._binding.provider=F,new N.BindingWhenOnSyntax(this._binding)},X.prototype.toService=function(F){this.toDynamicValue(function(K){return K.container.get(F)})},X}();x.BindingToSyntax=o},h1nZ:function(we,x,a){"use strict";var S=a("fX6N");a.d(x,"container",function(){return S.c}),a.d(x,"createSceneContainer",function(){return S.b}),a.d(x,"createLayerContainer",function(){return S.a}),a.d(x,"lazyInject",function(){return S.d});var v=a("+em5"),Z=a("bB6j");a.d(x,"TYPES",function(){return Z.a});var N=a("8/Fi"),o=a("PUg6");a.d(x,"BlendType",function(){return o.a});var X=a("cZlC");a.d(x,"AttributeType",function(){return X.a}),a.d(x,"ScaleTypes",function(){return X.b}),a.d(x,"StyleScaleType",function(){return X.c});var F=a("O1je"),K=a.n(F);a.o(F,"CameraUniform")&&a.d(x,"CameraUniform",function(){return F.CameraUniform}),a.o(F,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return F.CityBuildingLayer}),a.o(F,"Control")&&a.d(x,"Control",function(){return F.Control}),a.o(F,"CoordinateSystem")&&a.d(x,"CoordinateSystem",function(){return F.CoordinateSystem}),a.o(F,"CoordinateUniform")&&a.d(x,"CoordinateUniform",function(){return F.CoordinateUniform}),a.o(F,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return F.HeatmapLayer}),a.o(F,"ImageLayer")&&a.d(x,"ImageLayer",function(){return F.ImageLayer}),a.o(F,"LineLayer")&&a.d(x,"LineLayer",function(){return F.LineLayer}),a.o(F,"Logo")&&a.d(x,"Logo",function(){return F.Logo}),a.o(F,"MapServiceEvent")&&a.d(x,"MapServiceEvent",function(){return F.MapServiceEvent}),a.o(F,"Marker")&&a.d(x,"Marker",function(){return F.Marker}),a.o(F,"PointLayer")&&a.d(x,"PointLayer",function(){return F.PointLayer}),a.o(F,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return F.PolygonLayer}),a.o(F,"Popup")&&a.d(x,"Popup",function(){return F.Popup}),a.o(F,"PositionType")&&a.d(x,"PositionType",function(){return F.PositionType}),a.o(F,"RasterLayer")&&a.d(x,"RasterLayer",function(){return F.RasterLayer}),a.o(F,"Scale")&&a.d(x,"Scale",function(){return F.Scale}),a.o(F,"Scene")&&a.d(x,"Scene",function(){return F.Scene}),a.o(F,"SceneEventList")&&a.d(x,"SceneEventList",function(){return F.SceneEventList}),a.o(F,"Zoom")&&a.d(x,"Zoom",function(){return F.Zoom}),a.o(F,"gl")&&a.d(x,"gl",function(){return F.gl});var q=a("L56e");a.d(x,"MapServiceEvent",function(){return q.a});var Ce=a("HthE");a.d(x,"CoordinateSystem",function(){return Ce.a}),a.d(x,"CoordinateUniform",function(){return Ce.b});var $=a("/33/"),He=a.n($);a.o($,"CameraUniform")&&a.d(x,"CameraUniform",function(){return $.CameraUniform}),a.o($,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return $.CityBuildingLayer}),a.o($,"Control")&&a.d(x,"Control",function(){return $.Control}),a.o($,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return $.HeatmapLayer}),a.o($,"ImageLayer")&&a.d(x,"ImageLayer",function(){return $.ImageLayer}),a.o($,"LineLayer")&&a.d(x,"LineLayer",function(){return $.LineLayer}),a.o($,"Logo")&&a.d(x,"Logo",function(){return $.Logo}),a.o($,"Marker")&&a.d(x,"Marker",function(){return $.Marker}),a.o($,"PointLayer")&&a.d(x,"PointLayer",function(){return $.PointLayer}),a.o($,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return $.PolygonLayer}),a.o($,"Popup")&&a.d(x,"Popup",function(){return $.Popup}),a.o($,"PositionType")&&a.d(x,"PositionType",function(){return $.PositionType}),a.o($,"RasterLayer")&&a.d(x,"RasterLayer",function(){return $.RasterLayer}),a.o($,"Scale")&&a.d(x,"Scale",function(){return $.Scale}),a.o($,"Scene")&&a.d(x,"Scene",function(){return $.Scene}),a.o($,"SceneEventList")&&a.d(x,"SceneEventList",function(){return $.SceneEventList}),a.o($,"Zoom")&&a.d(x,"Zoom",function(){return $.Zoom}),a.o($,"gl")&&a.d(x,"gl",function(){return $.gl});var Be=a("EfZ0");a.d(x,"CameraUniform",function(){return Be.a});var ce=a("riiI"),st=a.n(ce);a.o(ce,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return ce.CityBuildingLayer}),a.o(ce,"Control")&&a.d(x,"Control",function(){return ce.Control}),a.o(ce,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return ce.HeatmapLayer}),a.o(ce,"ImageLayer")&&a.d(x,"ImageLayer",function(){return ce.ImageLayer}),a.o(ce,"LineLayer")&&a.d(x,"LineLayer",function(){return ce.LineLayer}),a.o(ce,"Logo")&&a.d(x,"Logo",function(){return ce.Logo}),a.o(ce,"Marker")&&a.d(x,"Marker",function(){return ce.Marker}),a.o(ce,"PointLayer")&&a.d(x,"PointLayer",function(){return ce.PointLayer}),a.o(ce,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return ce.PolygonLayer}),a.o(ce,"Popup")&&a.d(x,"Popup",function(){return ce.Popup}),a.o(ce,"PositionType")&&a.d(x,"PositionType",function(){return ce.PositionType}),a.o(ce,"RasterLayer")&&a.d(x,"RasterLayer",function(){return ce.RasterLayer}),a.o(ce,"Scale")&&a.d(x,"Scale",function(){return ce.Scale}),a.o(ce,"Scene")&&a.d(x,"Scene",function(){return ce.Scene}),a.o(ce,"SceneEventList")&&a.d(x,"SceneEventList",function(){return ce.SceneEventList}),a.o(ce,"Zoom")&&a.d(x,"Zoom",function(){return ce.Zoom}),a.o(ce,"gl")&&a.d(x,"gl",function(){return ce.gl});var ut=a("eg+a");a.d(x,"SceneEventList",function(){return ut.a});var Me=a("bYl4"),bt=a.n(Me);a.o(Me,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return Me.CityBuildingLayer}),a.o(Me,"Control")&&a.d(x,"Control",function(){return Me.Control}),a.o(Me,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return Me.HeatmapLayer}),a.o(Me,"ImageLayer")&&a.d(x,"ImageLayer",function(){return Me.ImageLayer}),a.o(Me,"LineLayer")&&a.d(x,"LineLayer",function(){return Me.LineLayer}),a.o(Me,"Logo")&&a.d(x,"Logo",function(){return Me.Logo}),a.o(Me,"Marker")&&a.d(x,"Marker",function(){return Me.Marker}),a.o(Me,"PointLayer")&&a.d(x,"PointLayer",function(){return Me.PointLayer}),a.o(Me,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return Me.PolygonLayer}),a.o(Me,"Popup")&&a.d(x,"Popup",function(){return Me.Popup}),a.o(Me,"PositionType")&&a.d(x,"PositionType",function(){return Me.PositionType}),a.o(Me,"RasterLayer")&&a.d(x,"RasterLayer",function(){return Me.RasterLayer}),a.o(Me,"Scale")&&a.d(x,"Scale",function(){return Me.Scale}),a.o(Me,"Scene")&&a.d(x,"Scene",function(){return Me.Scene}),a.o(Me,"Zoom")&&a.d(x,"Zoom",function(){return Me.Zoom}),a.o(Me,"gl")&&a.d(x,"gl",function(){return Me.gl});var xt=a("FI6e"),Mt=a.n(xt);a.o(xt,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return xt.CityBuildingLayer}),a.o(xt,"Control")&&a.d(x,"Control",function(){return xt.Control}),a.o(xt,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return xt.HeatmapLayer}),a.o(xt,"ImageLayer")&&a.d(x,"ImageLayer",function(){return xt.ImageLayer}),a.o(xt,"LineLayer")&&a.d(x,"LineLayer",function(){return xt.LineLayer}),a.o(xt,"Logo")&&a.d(x,"Logo",function(){return xt.Logo}),a.o(xt,"Marker")&&a.d(x,"Marker",function(){return xt.Marker}),a.o(xt,"PointLayer")&&a.d(x,"PointLayer",function(){return xt.PointLayer}),a.o(xt,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return xt.PolygonLayer}),a.o(xt,"Popup")&&a.d(x,"Popup",function(){return xt.Popup}),a.o(xt,"PositionType")&&a.d(x,"PositionType",function(){return xt.PositionType}),a.o(xt,"RasterLayer")&&a.d(x,"RasterLayer",function(){return xt.RasterLayer}),a.o(xt,"Scale")&&a.d(x,"Scale",function(){return xt.Scale}),a.o(xt,"Scene")&&a.d(x,"Scene",function(){return xt.Scene}),a.o(xt,"Zoom")&&a.d(x,"Zoom",function(){return xt.Zoom}),a.o(xt,"gl")&&a.d(x,"gl",function(){return xt.gl});var De=a("D+ow"),ar=a.n(De);a.o(De,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return De.CityBuildingLayer}),a.o(De,"Control")&&a.d(x,"Control",function(){return De.Control}),a.o(De,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return De.HeatmapLayer}),a.o(De,"ImageLayer")&&a.d(x,"ImageLayer",function(){return De.ImageLayer}),a.o(De,"LineLayer")&&a.d(x,"LineLayer",function(){return De.LineLayer}),a.o(De,"Logo")&&a.d(x,"Logo",function(){return De.Logo}),a.o(De,"Marker")&&a.d(x,"Marker",function(){return De.Marker}),a.o(De,"PointLayer")&&a.d(x,"PointLayer",function(){return De.PointLayer}),a.o(De,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return De.PolygonLayer}),a.o(De,"Popup")&&a.d(x,"Popup",function(){return De.Popup}),a.o(De,"PositionType")&&a.d(x,"PositionType",function(){return De.PositionType}),a.o(De,"RasterLayer")&&a.d(x,"RasterLayer",function(){return De.RasterLayer}),a.o(De,"Scale")&&a.d(x,"Scale",function(){return De.Scale}),a.o(De,"Scene")&&a.d(x,"Scene",function(){return De.Scene}),a.o(De,"Zoom")&&a.d(x,"Zoom",function(){return De.Zoom}),a.o(De,"gl")&&a.d(x,"gl",function(){return De.gl});var $t=a("AFH1");a.d(x,"PositionType",function(){return $t.a});var Ht=a("8uyu"),vt=a.n(Ht);a.o(Ht,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return Ht.CityBuildingLayer}),a.o(Ht,"Control")&&a.d(x,"Control",function(){return Ht.Control}),a.o(Ht,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return Ht.HeatmapLayer}),a.o(Ht,"ImageLayer")&&a.d(x,"ImageLayer",function(){return Ht.ImageLayer}),a.o(Ht,"LineLayer")&&a.d(x,"LineLayer",function(){return Ht.LineLayer}),a.o(Ht,"Logo")&&a.d(x,"Logo",function(){return Ht.Logo}),a.o(Ht,"Marker")&&a.d(x,"Marker",function(){return Ht.Marker}),a.o(Ht,"PointLayer")&&a.d(x,"PointLayer",function(){return Ht.PointLayer}),a.o(Ht,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return Ht.PolygonLayer}),a.o(Ht,"Popup")&&a.d(x,"Popup",function(){return Ht.Popup}),a.o(Ht,"RasterLayer")&&a.d(x,"RasterLayer",function(){return Ht.RasterLayer}),a.o(Ht,"Scale")&&a.d(x,"Scale",function(){return Ht.Scale}),a.o(Ht,"Scene")&&a.d(x,"Scene",function(){return Ht.Scene}),a.o(Ht,"Zoom")&&a.d(x,"Zoom",function(){return Ht.Zoom}),a.o(Ht,"gl")&&a.d(x,"gl",function(){return Ht.gl});var Ze=a("J7lC"),Et=a.n(Ze);a.o(Ze,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return Ze.CityBuildingLayer}),a.o(Ze,"Control")&&a.d(x,"Control",function(){return Ze.Control}),a.o(Ze,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return Ze.HeatmapLayer}),a.o(Ze,"ImageLayer")&&a.d(x,"ImageLayer",function(){return Ze.ImageLayer}),a.o(Ze,"LineLayer")&&a.d(x,"LineLayer",function(){return Ze.LineLayer}),a.o(Ze,"Logo")&&a.d(x,"Logo",function(){return Ze.Logo}),a.o(Ze,"Marker")&&a.d(x,"Marker",function(){return Ze.Marker}),a.o(Ze,"PointLayer")&&a.d(x,"PointLayer",function(){return Ze.PointLayer}),a.o(Ze,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return Ze.PolygonLayer}),a.o(Ze,"Popup")&&a.d(x,"Popup",function(){return Ze.Popup}),a.o(Ze,"RasterLayer")&&a.d(x,"RasterLayer",function(){return Ze.RasterLayer}),a.o(Ze,"Scale")&&a.d(x,"Scale",function(){return Ze.Scale}),a.o(Ze,"Scene")&&a.d(x,"Scene",function(){return Ze.Scene}),a.o(Ze,"Zoom")&&a.d(x,"Zoom",function(){return Ze.Zoom}),a.o(Ze,"gl")&&a.d(x,"gl",function(){return Ze.gl});var Le=a("QGbF"),at=a.n(Le);a.o(Le,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return Le.CityBuildingLayer}),a.o(Le,"Control")&&a.d(x,"Control",function(){return Le.Control}),a.o(Le,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return Le.HeatmapLayer}),a.o(Le,"ImageLayer")&&a.d(x,"ImageLayer",function(){return Le.ImageLayer}),a.o(Le,"LineLayer")&&a.d(x,"LineLayer",function(){return Le.LineLayer}),a.o(Le,"Logo")&&a.d(x,"Logo",function(){return Le.Logo}),a.o(Le,"Marker")&&a.d(x,"Marker",function(){return Le.Marker}),a.o(Le,"PointLayer")&&a.d(x,"PointLayer",function(){return Le.PointLayer}),a.o(Le,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return Le.PolygonLayer}),a.o(Le,"Popup")&&a.d(x,"Popup",function(){return Le.Popup}),a.o(Le,"RasterLayer")&&a.d(x,"RasterLayer",function(){return Le.RasterLayer}),a.o(Le,"Scale")&&a.d(x,"Scale",function(){return Le.Scale}),a.o(Le,"Scene")&&a.d(x,"Scene",function(){return Le.Scene}),a.o(Le,"Zoom")&&a.d(x,"Zoom",function(){return Le.Zoom}),a.o(Le,"gl")&&a.d(x,"gl",function(){return Le.gl});var Wt=a("V1cb"),St=a("4kj+"),dt=a.n(St);a.o(St,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return St.CityBuildingLayer}),a.o(St,"Control")&&a.d(x,"Control",function(){return St.Control}),a.o(St,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return St.HeatmapLayer}),a.o(St,"ImageLayer")&&a.d(x,"ImageLayer",function(){return St.ImageLayer}),a.o(St,"LineLayer")&&a.d(x,"LineLayer",function(){return St.LineLayer}),a.o(St,"Logo")&&a.d(x,"Logo",function(){return St.Logo}),a.o(St,"Marker")&&a.d(x,"Marker",function(){return St.Marker}),a.o(St,"PointLayer")&&a.d(x,"PointLayer",function(){return St.PointLayer}),a.o(St,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return St.PolygonLayer}),a.o(St,"Popup")&&a.d(x,"Popup",function(){return St.Popup}),a.o(St,"RasterLayer")&&a.d(x,"RasterLayer",function(){return St.RasterLayer}),a.o(St,"Scale")&&a.d(x,"Scale",function(){return St.Scale}),a.o(St,"Scene")&&a.d(x,"Scene",function(){return St.Scene}),a.o(St,"Zoom")&&a.d(x,"Zoom",function(){return St.Zoom}),a.o(St,"gl")&&a.d(x,"gl",function(){return St.gl});var H=a("bzyH"),z=a.n(H);a.o(H,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return H.CityBuildingLayer}),a.o(H,"Control")&&a.d(x,"Control",function(){return H.Control}),a.o(H,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return H.HeatmapLayer}),a.o(H,"ImageLayer")&&a.d(x,"ImageLayer",function(){return H.ImageLayer}),a.o(H,"LineLayer")&&a.d(x,"LineLayer",function(){return H.LineLayer}),a.o(H,"Logo")&&a.d(x,"Logo",function(){return H.Logo}),a.o(H,"Marker")&&a.d(x,"Marker",function(){return H.Marker}),a.o(H,"PointLayer")&&a.d(x,"PointLayer",function(){return H.PointLayer}),a.o(H,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return H.PolygonLayer}),a.o(H,"Popup")&&a.d(x,"Popup",function(){return H.Popup}),a.o(H,"RasterLayer")&&a.d(x,"RasterLayer",function(){return H.RasterLayer}),a.o(H,"Scale")&&a.d(x,"Scale",function(){return H.Scale}),a.o(H,"Scene")&&a.d(x,"Scene",function(){return H.Scene}),a.o(H,"Zoom")&&a.d(x,"Zoom",function(){return H.Zoom}),a.o(H,"gl")&&a.d(x,"gl",function(){return H.gl});var V=a("0eqD"),be=a.n(V);a.o(V,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return V.CityBuildingLayer}),a.o(V,"Control")&&a.d(x,"Control",function(){return V.Control}),a.o(V,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return V.HeatmapLayer}),a.o(V,"ImageLayer")&&a.d(x,"ImageLayer",function(){return V.ImageLayer}),a.o(V,"LineLayer")&&a.d(x,"LineLayer",function(){return V.LineLayer}),a.o(V,"Logo")&&a.d(x,"Logo",function(){return V.Logo}),a.o(V,"Marker")&&a.d(x,"Marker",function(){return V.Marker}),a.o(V,"PointLayer")&&a.d(x,"PointLayer",function(){return V.PointLayer}),a.o(V,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return V.PolygonLayer}),a.o(V,"Popup")&&a.d(x,"Popup",function(){return V.Popup}),a.o(V,"RasterLayer")&&a.d(x,"RasterLayer",function(){return V.RasterLayer}),a.o(V,"Scale")&&a.d(x,"Scale",function(){return V.Scale}),a.o(V,"Scene")&&a.d(x,"Scene",function(){return V.Scene}),a.o(V,"Zoom")&&a.d(x,"Zoom",function(){return V.Zoom}),a.o(V,"gl")&&a.d(x,"gl",function(){return V.gl});var me=a("/Uc5"),le=a.n(me);a.o(me,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return me.CityBuildingLayer}),a.o(me,"Control")&&a.d(x,"Control",function(){return me.Control}),a.o(me,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return me.HeatmapLayer}),a.o(me,"ImageLayer")&&a.d(x,"ImageLayer",function(){return me.ImageLayer}),a.o(me,"LineLayer")&&a.d(x,"LineLayer",function(){return me.LineLayer}),a.o(me,"Logo")&&a.d(x,"Logo",function(){return me.Logo}),a.o(me,"Marker")&&a.d(x,"Marker",function(){return me.Marker}),a.o(me,"PointLayer")&&a.d(x,"PointLayer",function(){return me.PointLayer}),a.o(me,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return me.PolygonLayer}),a.o(me,"Popup")&&a.d(x,"Popup",function(){return me.Popup}),a.o(me,"RasterLayer")&&a.d(x,"RasterLayer",function(){return me.RasterLayer}),a.o(me,"Scale")&&a.d(x,"Scale",function(){return me.Scale}),a.o(me,"Scene")&&a.d(x,"Scene",function(){return me.Scene}),a.o(me,"Zoom")&&a.d(x,"Zoom",function(){return me.Zoom}),a.o(me,"gl")&&a.d(x,"gl",function(){return me.gl});var fe=a("RMtq"),Ne=a.n(fe);a.o(fe,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return fe.CityBuildingLayer}),a.o(fe,"Control")&&a.d(x,"Control",function(){return fe.Control}),a.o(fe,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return fe.HeatmapLayer}),a.o(fe,"ImageLayer")&&a.d(x,"ImageLayer",function(){return fe.ImageLayer}),a.o(fe,"LineLayer")&&a.d(x,"LineLayer",function(){return fe.LineLayer}),a.o(fe,"Logo")&&a.d(x,"Logo",function(){return fe.Logo}),a.o(fe,"Marker")&&a.d(x,"Marker",function(){return fe.Marker}),a.o(fe,"PointLayer")&&a.d(x,"PointLayer",function(){return fe.PointLayer}),a.o(fe,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return fe.PolygonLayer}),a.o(fe,"Popup")&&a.d(x,"Popup",function(){return fe.Popup}),a.o(fe,"RasterLayer")&&a.d(x,"RasterLayer",function(){return fe.RasterLayer}),a.o(fe,"Scale")&&a.d(x,"Scale",function(){return fe.Scale}),a.o(fe,"Scene")&&a.d(x,"Scene",function(){return fe.Scene}),a.o(fe,"Zoom")&&a.d(x,"Zoom",function(){return fe.Zoom}),a.o(fe,"gl")&&a.d(x,"gl",function(){return fe.gl});var lt=a("1jvM"),rt=a.n(lt);a.o(lt,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return lt.CityBuildingLayer}),a.o(lt,"Control")&&a.d(x,"Control",function(){return lt.Control}),a.o(lt,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return lt.HeatmapLayer}),a.o(lt,"ImageLayer")&&a.d(x,"ImageLayer",function(){return lt.ImageLayer}),a.o(lt,"LineLayer")&&a.d(x,"LineLayer",function(){return lt.LineLayer}),a.o(lt,"Logo")&&a.d(x,"Logo",function(){return lt.Logo}),a.o(lt,"Marker")&&a.d(x,"Marker",function(){return lt.Marker}),a.o(lt,"PointLayer")&&a.d(x,"PointLayer",function(){return lt.PointLayer}),a.o(lt,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return lt.PolygonLayer}),a.o(lt,"Popup")&&a.d(x,"Popup",function(){return lt.Popup}),a.o(lt,"RasterLayer")&&a.d(x,"RasterLayer",function(){return lt.RasterLayer}),a.o(lt,"Scale")&&a.d(x,"Scale",function(){return lt.Scale}),a.o(lt,"Scene")&&a.d(x,"Scene",function(){return lt.Scene}),a.o(lt,"Zoom")&&a.d(x,"Zoom",function(){return lt.Zoom}),a.o(lt,"gl")&&a.d(x,"gl",function(){return lt.gl});var ue=a("bPkA"),ye=a("PSsN"),Ue=a.n(ye);a.o(ye,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return ye.CityBuildingLayer}),a.o(ye,"Control")&&a.d(x,"Control",function(){return ye.Control}),a.o(ye,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return ye.HeatmapLayer}),a.o(ye,"ImageLayer")&&a.d(x,"ImageLayer",function(){return ye.ImageLayer}),a.o(ye,"LineLayer")&&a.d(x,"LineLayer",function(){return ye.LineLayer}),a.o(ye,"Logo")&&a.d(x,"Logo",function(){return ye.Logo}),a.o(ye,"Marker")&&a.d(x,"Marker",function(){return ye.Marker}),a.o(ye,"PointLayer")&&a.d(x,"PointLayer",function(){return ye.PointLayer}),a.o(ye,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return ye.PolygonLayer}),a.o(ye,"Popup")&&a.d(x,"Popup",function(){return ye.Popup}),a.o(ye,"RasterLayer")&&a.d(x,"RasterLayer",function(){return ye.RasterLayer}),a.o(ye,"Scale")&&a.d(x,"Scale",function(){return ye.Scale}),a.o(ye,"Scene")&&a.d(x,"Scene",function(){return ye.Scene}),a.o(ye,"Zoom")&&a.d(x,"Zoom",function(){return ye.Zoom}),a.o(ye,"gl")&&a.d(x,"gl",function(){return ye.gl});var ft=a("6NqC"),Oe=a.n(ft);a.o(ft,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return ft.CityBuildingLayer}),a.o(ft,"Control")&&a.d(x,"Control",function(){return ft.Control}),a.o(ft,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return ft.HeatmapLayer}),a.o(ft,"ImageLayer")&&a.d(x,"ImageLayer",function(){return ft.ImageLayer}),a.o(ft,"LineLayer")&&a.d(x,"LineLayer",function(){return ft.LineLayer}),a.o(ft,"Logo")&&a.d(x,"Logo",function(){return ft.Logo}),a.o(ft,"Marker")&&a.d(x,"Marker",function(){return ft.Marker}),a.o(ft,"PointLayer")&&a.d(x,"PointLayer",function(){return ft.PointLayer}),a.o(ft,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return ft.PolygonLayer}),a.o(ft,"Popup")&&a.d(x,"Popup",function(){return ft.Popup}),a.o(ft,"RasterLayer")&&a.d(x,"RasterLayer",function(){return ft.RasterLayer}),a.o(ft,"Scale")&&a.d(x,"Scale",function(){return ft.Scale}),a.o(ft,"Scene")&&a.d(x,"Scene",function(){return ft.Scene}),a.o(ft,"Zoom")&&a.d(x,"Zoom",function(){return ft.Zoom}),a.o(ft,"gl")&&a.d(x,"gl",function(){return ft.gl});var Ve=a("bTtR"),P=a.n(Ve);a.o(Ve,"CityBuildingLayer")&&a.d(x,"CityBuildingLayer",function(){return Ve.CityBuildingLayer}),a.o(Ve,"Control")&&a.d(x,"Control",function(){return Ve.Control}),a.o(Ve,"HeatmapLayer")&&a.d(x,"HeatmapLayer",function(){return Ve.HeatmapLayer}),a.o(Ve,"ImageLayer")&&a.d(x,"ImageLayer",function(){return Ve.ImageLayer}),a.o(Ve,"LineLayer")&&a.d(x,"LineLayer",function(){return Ve.LineLayer}),a.o(Ve,"Logo")&&a.d(x,"Logo",function(){return Ve.Logo}),a.o(Ve,"Marker")&&a.d(x,"Marker",function(){return Ve.Marker}),a.o(Ve,"PointLayer")&&a.d(x,"PointLayer",function(){return Ve.PointLayer}),a.o(Ve,"PolygonLayer")&&a.d(x,"PolygonLayer",function(){return Ve.PolygonLayer}),a.o(Ve,"Popup")&&a.d(x,"Popup",function(){return Ve.Popup}),a.o(Ve,"RasterLayer")&&a.d(x,"RasterLayer",function(){return Ve.RasterLayer}),a.o(Ve,"Scale")&&a.d(x,"Scale",function(){return Ve.Scale}),a.o(Ve,"Scene")&&a.d(x,"Scene",function(){return Ve.Scene}),a.o(Ve,"Zoom")&&a.d(x,"Zoom",function(){return Ve.Zoom}),a.o(Ve,"gl")&&a.d(x,"gl",function(){return Ve.gl});var R=a("o+pz");a.d(x,"gl",function(){return R.a})},h7MG:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.getBindingDictionary=x.createMockRequest=x.plan=void 0;var S=a("doU7"),v=a("MON2"),Z=a("FV85"),N=a("xfSm"),o=a("qK8v"),X=a("ujMp"),F=a("oy+k"),K=a("GXnB"),q=a("yMAV"),Ce=a("fbrv"),$=a("xiII"),He=a("dX1H");function Be(De){return De._bindingDictionary}x.getBindingDictionary=Be;function ce(De,ar,$t,Ht,vt,Ze){var Et=De?N.MULTI_INJECT_TAG:N.INJECT_TAG,Le=new K.Metadata(Et,$t),at=new He.Target(ar,Ht,$t,Le);if(vt!==void 0){var Wt=new K.Metadata(vt,Ze);at.metadata.push(Wt)}return at}function st(De,ar,$t,Ht,vt){var Ze=bt($t.container,vt.serviceIdentifier),Et=[];return Ze.length===S.BindingCount.NoBindingsAvailable&&$t.container.options.autoBindInjectable&&typeof vt.serviceIdentifier=="function"&&De.getConstructorMetadata(vt.serviceIdentifier).compilerGeneratedMetadata&&($t.container.bind(vt.serviceIdentifier).toSelf(),Ze=bt($t.container,vt.serviceIdentifier)),ar?Et=Ze:Et=Ze.filter(function(Le){var at=new $.Request(Le.serviceIdentifier,$t,Ht,Le,vt);return Le.constraint(at)}),ut(vt.serviceIdentifier,Et,vt,$t.container),Et}function ut(De,ar,$t,Ht){switch(ar.length){case S.BindingCount.NoBindingsAvailable:if($t.isOptional())return ar;var vt=X.getServiceIdentifierAsString(De),Ze=v.NOT_REGISTERED;throw Ze+=X.listMetadataForTarget(vt,$t),Ze+=X.listRegisteredBindingsForServiceIdentifier(Ht,vt,bt),new Error(Ze);case S.BindingCount.OnlyOneBindingAvailable:if(!$t.isArray())return ar;case S.BindingCount.MultipleBindingsAvailable:default:if($t.isArray())return ar;var vt=X.getServiceIdentifierAsString(De),Ze=v.AMBIGUOUS_MATCH+" "+vt;throw Ze+=X.listRegisteredBindingsForServiceIdentifier(Ht,vt,bt),new Error(Ze)}}function Me(De,ar,$t,Ht,vt,Ze){var Et,Le;if(vt===null){Et=st(De,ar,Ht,null,Ze),Le=new $.Request($t,Ht,null,Et,Ze);var at=new q.Plan(Ht,Le);Ht.addPlan(at)}else Et=st(De,ar,Ht,vt,Ze),Le=vt.addChildRequest(Ze.serviceIdentifier,Et,Ze);Et.forEach(function(Wt){var St=null;if(Ze.isArray())St=Le.addChildRequest(Wt.serviceIdentifier,Wt,Ze);else{if(Wt.cache)return;St=Le}if(Wt.type===Z.BindingTypeEnum.Instance&&Wt.implementationType!==null){var dt=Ce.getDependencies(De,Wt.implementationType);if(!Ht.container.options.skipBaseClassChecks){var H=Ce.getBaseClassDependencyCount(De,Wt.implementationType);if(dt.length<H){var z=v.ARGUMENTS_LENGTH_MISMATCH(Ce.getFunctionName(Wt.implementationType));throw new Error(z)}}dt.forEach(function(V){Me(De,!1,V.serviceIdentifier,Ht,St,V)})}})}function bt(De,ar){var $t=[],Ht=Be(De);return Ht.hasKey(ar)?$t=Ht.get(ar):De.parent!==null&&($t=bt(De.parent,ar)),$t}function xt(De,ar,$t,Ht,vt,Ze,Et,Le){Le===void 0&&(Le=!1);var at=new F.Context(ar),Wt=ce($t,Ht,vt,"",Ze,Et);try{return Me(De,Le,vt,at,null,Wt),at}catch(St){throw o.isStackOverflowExeption(St)&&at.plan&&X.circularDependencyToException(at.plan.rootRequest),St}}x.plan=xt;function Mt(De,ar,$t,Ht){var vt=new He.Target(Z.TargetTypeEnum.Variable,"",ar,new K.Metadata($t,Ht)),Ze=new F.Context(De),Et=new $.Request(ar,Ze,null,[],vt);return Et}x.createMockRequest=Mt},heNW:function(we,x){function a(S,v,Z){switch(Z.length){case 0:return S.call(v);case 1:return S.call(v,Z[0]);case 2:return S.call(v,Z[0],Z[1]);case 3:return S.call(v,Z[0],Z[1],Z[2])}return S.apply(v,Z)}we.exports=a},hi0z:function(we,x,a){"use strict";(function(S,v){we.exports=v()})(this,function(){function S(Ce){var $=[];return Ce.AMapUI&&$.push(v(Ce.AMapUI)),Ce.Loca&&$.push(Z(Ce.Loca)),Promise.all($)}function v(Ce){return new Promise(function($,He){var Be=[];if(Ce.plugins)for(var ce=0;ce<Ce.plugins.length;ce+=1)o.AMapUI.plugins.indexOf(Ce.plugins[ce])==-1&&Be.push(Ce.plugins[ce]);if(X.AMapUI===N.failed)He("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(X.AMapUI===N.notload){X.AMapUI=N.loading,o.AMapUI.version=Ce.version||o.AMapUI.version,ce=o.AMapUI.version;var st=document.body||document.head,ut=document.createElement("script");ut.type="text/javascript",ut.src="https://webapi.amap.com/ui/"+ce+"/main.js",ut.onerror=function(Me){X.AMapUI=N.failed,He("\u8BF7\u6C42 AMapUI \u5931\u8D25")},ut.onload=function(){if(X.AMapUI=N.loaded,Be.length)window.AMapUI.loadUI(Be,function(){for(var Me=0,bt=Be.length;Me<bt;Me++){var xt=Be[Me].split("/").slice(-1)[0];window.AMapUI[xt]=arguments[Me]}for($();F.AMapUI.length;)F.AMapUI.splice(0,1)[0]()});else for($();F.AMapUI.length;)F.AMapUI.splice(0,1)[0]()},st.appendChild(ut)}else X.AMapUI===N.loaded?Ce.version&&Ce.version!==o.AMapUI.version?He("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):Be.length?window.AMapUI.loadUI(Be,function(){for(var Me=0,bt=Be.length;Me<bt;Me++){var xt=Be[Me].split("/").slice(-1)[0];window.AMapUI[xt]=arguments[Me]}$()}):$():Ce.version&&Ce.version!==o.AMapUI.version?He("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):F.AMapUI.push(function(Me){Me?He(Me):Be.length?window.AMapUI.loadUI(Be,function(){for(var bt=0,xt=Be.length;bt<xt;bt++){var Mt=Be[bt].split("/").slice(-1)[0];window.AMapUI[Mt]=arguments[bt]}$()}):$()})})}function Z(Ce){return new Promise(function($,He){if(o.AMap.version.startsWith("2.0"))He("Loca \u6682\u4E0D\u9002\u914D JSAPI 2.0,\u8BF7\u4F7F\u7528 1.4.15");else if(X.Loca===N.failed)He("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(X.Loca===N.notload){X.Loca=N.loading,o.Loca.version=Ce.version||o.Loca.version;var Be=o.Loca.version,ce=o.key,st=document.body||document.head,ut=document.createElement("script");ut.type="text/javascript",ut.src="https://webapi.amap.com/loca?v="+Be+"&key="+ce,ut.onerror=function(Me){X.Loca=N.failed,He("\u8BF7\u6C42 AMapUI \u5931\u8D25")},ut.onload=function(){for(X.Loca=N.loaded,$();F.Loca.length;)F.Loca.splice(0,1)[0]()},st.appendChild(ut)}else X.Loca===N.loaded?Ce.version&&Ce.version!==o.Loca.version?He("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):$():Ce.version&&Ce.version!==o.Loca.version?He("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):F.Loca.push(function(Me){Me?He(Me):He()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var N;(function(Ce){Ce.notload="notload",Ce.loading="loading",Ce.loaded="loaded",Ce.failed="failed"})(N||(N={}));var o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},X={AMap:N.notload,AMapUI:N.notload,Loca:N.notload},F={AMap:[],AMapUI:[],Loca:[]},K=[],q=function($){typeof $=="function"&&(X.AMap===N.loaded?$(window.AMap):K.push($))};return{load:function($){return new Promise(function(He,Be){if(X.AMap==N.failed)Be("");else if(X.AMap==N.notload){var ce=$.key,st=$.version,ut=$.plugins;ce?(window.AMap&&location.host!=="lbs.amap.com"&&Be("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),o.key=ce,o.AMap.version=st||o.AMap.version,o.AMap.plugins=ut||o.AMap.plugins,X.AMap=N.loading,st=document.body||document.head,window.___onAPILoaded=function(bt){if(delete window.___onAPILoaded,bt)X.AMap=N.failed,Be(bt);else for(X.AMap=N.loaded,S($).then(function(){He(window.AMap)}).catch(Be);K.length;)K.splice(0,1)[0]()},ut=document.createElement("script"),ut.type="text/javascript",ut.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+o.AMap.version+"&key="+ce+"&plugin="+o.AMap.plugins.join(","),ut.onerror=function(bt){X.AMap=N.failed,Be(bt)},st.appendChild(ut)):Be("\u8BF7\u586B\u5199key")}else if(X.AMap==N.loaded)if($.key&&$.key!==o.key)Be("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if($.version&&$.version!==o.AMap.version)Be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(ce=[],$.plugins)for(st=0;st<$.plugins.length;st+=1)o.AMap.plugins.indexOf($.plugins[st])==-1&&ce.push($.plugins[st]);ce.length?window.AMap.plugin(ce,function(){S($).then(function(){He(window.AMap)}).catch(Be)}):S($).then(function(){He(window.AMap)}).catch(Be)}else if($.key&&$.key!==o.key)Be("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if($.version&&$.version!==o.AMap.version)Be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var Me=[];if($.plugins)for(st=0;st<$.plugins.length;st+=1)o.AMap.plugins.indexOf($.plugins[st])==-1&&Me.push($.plugins[st]);q(function(){Me.length?window.AMap.plugin(Me,function(){S($).then(function(){He(window.AMap)}).catch(Be)}):S($).then(function(){He(window.AMap)}).catch(Be)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},X={AMap:N.notload,AMapUI:N.notload,Loca:N.notload},F={AMap:[],AMapUI:[],Loca:[]}}}})},hypo:function(we,x,a){var S=a("O0oS");function v(Z,N,o){N=="__proto__"&&S?S(Z,N,{configurable:!0,enumerable:!0,value:o,writable:!0}):Z[N]=o}we.exports=v},iWIM:function(we,x,a){var S=a("n3AX");function v(Z,N,o){return typeof Reflect!="undefined"&&Reflect.get?we.exports=v=Reflect.get:we.exports=v=function(F,K,q){var Ce=S(F,K);if(!!Ce){var $=Object.getOwnPropertyDescriptor(Ce,K);return $.get?$.get.call(q):$.value}},v(Z,N,o||Z)}we.exports=v},iegG:function(we,x){function a(S){var v=S.target||S.srcElement;v.__resizeRAF__&&cancelAnimationFrame(v.__resizeRAF__),v.__resizeRAF__=requestAnimationFrame(function(){var Z=v.__resizeTrigger__,N=Z&&Z.__resizeListeners__;N&&N.forEach(function(o){o.call(Z,S)})})}var x=function(v,Z){var N=this,o=N.document,X,F=o.attachEvent;typeof navigator!="undefined"&&(X=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function K(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",a)}if(!v.__resizeListeners__)if(v.__resizeListeners__=[],F)v.__resizeTrigger__=v,v.attachEvent("onresize",a);else{getComputedStyle(v).position==="static"&&(v.style.position="relative");var q=v.__resizeTrigger__=o.createElement("object");q.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),q.setAttribute("class","resize-sensor"),q.setAttribute("tabindex","-1"),q.__resizeElement__=v,q.onload=K,q.type="text/html",X&&v.appendChild(q),q.data="about:blank",X||v.appendChild(q)}v.__resizeListeners__.push(Z)};we.exports=typeof window=="undefined"?x:x.bind(window),we.exports.unbind=function(S,v){var Z=document.attachEvent,N=S.__resizeListeners__||[];if(v){var o=N.indexOf(v);o!==-1&&N.splice(o,1)}else N=S.__resizeListeners__=[];if(!N.length){if(Z)S.detachEvent("onresize",a);else if(S.__resizeTrigger__){var X=S.__resizeTrigger__.contentDocument,F=X&&X.defaultView;F&&(F.removeEventListener("resize",a),delete F.__resizeTrigger__),S.__resizeTrigger__=!S.removeChild(S.__resizeTrigger__)}delete S.__resizeListeners__}}},itsj:function(we,x){function a(S,v){if(!(v==="constructor"&&typeof S[v]=="function")&&v!="__proto__")return S[v]}we.exports=a},"iz+Y":function(we,x,a){we.exports={miniChart:"antd-pro-pages-dashboard-monitor-components-charts-index-miniChart",chartContent:"antd-pro-pages-dashboard-monitor-components-charts-index-chartContent",chartLoading:"antd-pro-pages-dashboard-monitor-components-charts-index-chartLoading"}},jCWc:function(we,x,a){"use strict";var S=a("cIOH"),v=a.n(S),Z=a("1GLa")},"jIg/":function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.multiInject=void 0;var S=a("xfSm"),v=a("GXnB"),Z=a("Ztfv");function N(o){return function(X,F,K){var q=new v.Metadata(S.MULTI_INJECT_TAG,o);typeof K=="number"?Z.tagParameter(X,F,K,q):Z.tagProperty(X,F,q)}}x.multiInject=N},jYQm:function(we,x,a){"use strict";var S=a("q1tI"),v=a.n(S),Z=Object(S.createContext)({});x.a=Z},jYx5:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.optional=void 0;var S=a("xfSm"),v=a("GXnB"),Z=a("Ztfv");function N(){return function(o,X,F){var K=new v.Metadata(S.OPTIONAL_TAG,!0);typeof F=="number"?Z.tagParameter(o,X,F,K):Z.tagProperty(o,X,K)}}x.optional=N},"jbM+":function(we,x,a){var S=a("R/W3");function v(Z,N){var o=Z==null?0:Z.length;return!!o&&S(Z,N,0)>-1}we.exports=v},jeLo:function(we,x,a){var S=a("juv8"),v=a("mTTR");function Z(N){return S(N,v(N))}we.exports=Z},juv8:function(we,x,a){var S=a("MrPd"),v=a("hypo");function Z(N,o,X,F){var K=!X;X||(X={});for(var q=-1,Ce=o.length;++q<Ce;){var $=o[q],He=F?F(X[$],N[$],$,X,N):void 0;He===void 0&&(He=N[$]),K?v(X,$,He):S(X,$,He)}return X}we.exports=Z},"k5/I":function(we,x,a){"use strict";a.d(x,"a",function(){return ar}),a.d(x,"b",function(){return Wt}),a.d(x,"e",function(){return H}),a.d(x,"f",function(){return be}),a.d(x,"c",function(){return lt}),a.d(x,"d",function(){return gt});var S=a("lSNA"),v=a.n(S),Z=a("lwsE"),N=a.n(Z),o=a("W8MJ"),X=a.n(o),F=a("7W2i"),K=a.n(F),q=a("a1gu"),Ce=a.n(q),$=a("Nsbk"),He=a.n($),Be=a("h1nZ"),ce=a("Hel2"),st=a("uhBA");function ut(nt,Nt){var Y=Object.keys(nt);if(Object.getOwnPropertySymbols){var Xe=Object.getOwnPropertySymbols(nt);Nt&&(Xe=Xe.filter(function(re){return Object.getOwnPropertyDescriptor(nt,re).enumerable})),Y.push.apply(Y,Xe)}return Y}function Me(nt){for(var Nt=1;Nt<arguments.length;Nt++){var Y=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?ut(Object(Y),!0).forEach(function(Xe){v()(nt,Xe,Y[Xe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(Y)):ut(Object(Y)).forEach(function(Xe){Object.defineProperty(nt,Xe,Object.getOwnPropertyDescriptor(Y,Xe))})}return nt}function bt(nt){var Nt=xt();return function(){var Xe=He()(nt),re;if(Nt){var Je=He()(this).constructor;re=Reflect.construct(Xe,arguments,Je)}else re=Xe.apply(this,arguments);return Ce()(this,re)}}function xt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var Mt;(function(nt){nt.TOPRIGHT="topright",nt.TOPLEFT="topleft",nt.BOTTOMRIGHT="bottomright",nt.BOTTOMLEFT="bottomleft"})(Mt||(Mt={}));var De=0,ar=function(nt){K()(Y,nt);var Nt=bt(Y);function Y(Xe){var re;return N()(this,Y),re=Nt.call(this),re.controlOption=void 0,re.container=void 0,re.sceneContainer=void 0,re.mapsService=void 0,re.renderService=void 0,re.layerService=void 0,re.controlService=void 0,re.isShow=void 0,re.controlOption=Me(Me({},re.getDefault()),Xe||{}),re}return X()(Y,[{key:"getDefault",value:function(){return{position:Mt.TOPRIGHT,name:"".concat(De++)}}},{key:"setPosition",value:function(re){var Je=this.controlService;return Je&&Je.removeControl(this),this.controlOption.position=re,Je&&Je.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(re){this.mapsService=re.get(Be.TYPES.IMapService),this.renderService=re.get(Be.TYPES.IRendererService),this.layerService=re.get(Be.TYPES.ILayerService),this.controlService=re.get(Be.TYPES.IControlService),this.sceneContainer=re,this.isShow=!0,this.container=this.onAdd();var Je=this.container,Gt=this.controlOption.position,ur=this.controlService.controlCorners[Gt];return ce.a.addClass(Je,"l7-control"),Gt.indexOf("bottom")!==-1?ur.insertBefore(Je,ur.firstChild):ur.appendChild(Je),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var re=this.container;ce.a.addClass(re,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var re=this.container;ce.a.removeClass(re,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;ce.a.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(re){if(this.mapsService&&re&&re.screenX>0&&re.screenY>0){var Je=this.mapsService.getContainer();Je!==null&&Je.focus()}}}]),Y}(st.EventEmitter),$t=a("PJYZ"),Ht=a.n($t);function vt(nt){var Nt=Ze();return function(){var Xe=He()(nt),re;if(Nt){var Je=He()(this).constructor;re=Reflect.construct(Xe,arguments,Je)}else re=Xe.apply(this,arguments);return Ce()(this,re)}}function Ze(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var Et=function(nt){K()(Y,nt);var Nt=vt(Y);function Y(Xe){var re;return N()(this,Y),re=Nt.call(this,Xe),re.layerControlInputs=void 0,re.layers=void 0,re.lastZIndex=void 0,re.handlingClick=void 0,re.layersLink=void 0,re.baseLayersList=void 0,re.separator=void 0,re.overlaysList=void 0,re.form=void 0,re.layerControlInputs=[],re.layers=[],re.lastZIndex=0,re.handlingClick=!1,re.initLayers(),Object(ce.i)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],Ht()(re)),re}return X()(Y,[{key:"getDefault",value:function(){return{collapsed:!0,position:Be.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var re=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(Je){Je.layer.on("remove",re.onLayerChange),Je.layer.on("add",re.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(re,Je){return this.addLayer(re,Je,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var re=this.renderService.getViewportSize(),Je=re.height;ce.a.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var Gt=Je-(this.container.offsetTop+50);return Gt<this.form.clientHeight?(ce.a.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=Gt+"px"):ce.a.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return ce.a.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var re=this;!this.mapsService||(this.mapsService.off("click",this.collapse),this.layers.forEach(function(Je){Je.layer.off("remove",re.onLayerChange),Je.layer.off("add",re.onLayerChange)}))}},{key:"initLayout",value:function(){var re="l7-control-layers",Je=this.container=ce.a.create("div",re),Gt=this.controlOption.collapsed;Je.setAttribute("aria-haspopup","true");var ur=this.form=ce.a.create("form",re+"-list");Gt&&(this.mapsService.on("click",this.collapse),Je.addEventListener("mouseenter",this.expand),Je.addEventListener("mouseleave",this.collapse)),this.layersLink=ce.a.create("a",re+"-toggle",Je);var ct=this.layersLink;ct.title="Layers",Gt||this.expand(),this.baseLayersList=ce.a.create("div",re+"-base",ur),this.separator=ce.a.create("div",re+"-separator",ur),this.overlaysList=ce.a.create("div",re+"-overlays",ur),Je.appendChild(ur)}},{key:"initLayers",value:function(){var re=this,Je=this.controlOption,Gt=Je.baseLayers,ur=Gt===void 0?{}:Gt,ct=Je.overlayers,ht=ct===void 0?{}:ct;Object.keys(ur).forEach(function(Pt,pt){re.addLayer(ur[Pt],Pt,!1)}),Object.keys(ht).forEach(function(Pt,pt){re.addLayer(ht[Pt],Pt,!0)})}},{key:"update",value:function(){if(!this.container)return this;ce.a.empty(this.baseLayersList),ce.a.empty(this.overlaysList),this.layerControlInputs=[];var re,Je,Gt,ur,ct=0;for(Gt=0;Gt<this.layers.length;Gt++)ur=this.layers[Gt],this.addItem(ur),Je=Je||ur.overlay,re=re||!ur.overlay,ct+=ur.overlay?0:1;return this.controlOption.hideSingleBase&&(re=re&&ct>1,this.baseLayersList.style.display=re?"":"none"),this.separator.style.display=Je&&re?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var re=this.layerControlInputs,Je,Gt,ur=this.mapsService.getZoom(),ct=re.length-1;ct>=0;ct--)if(Je=re[ct],Gt=this.layerService.getLayer(Je.layerId),Gt&&Gt.inited){var ht=Gt.getMinZoom(),Pt=Gt.getMaxZoom();Je.disabled=ur<ht||ur>Pt}}},{key:"addLayer",value:function(re,Je,Gt){this.mapsService&&(re.on("add",this.onLayerChange),re.on("remove",this.onLayerChange)),this.layers.push({layer:re,name:Je,overlay:Gt});var ur=this.controlOption,ct=ur.sortLayers,ht=ur.sortFunction,Pt=ur.autoZIndex;ct&&this.layers.sort(function(pt,Pe){return ht(pt.layer,Pe.layer,pt.name,Pe.name)}),Pt&&re.setZIndex&&(this.lastZIndex++,re.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(re){this.handlingClick||this.update();var Je=this.layerService.getLayer(re.target.layerId),Gt=(Je==null?void 0:Je.overlay)?re.type==="add"?"overlayadd":"overlayremove":re.type==="add"?"baselayerchange":null;Gt&&this.emit(Gt,Je)}},{key:"createRadioElement",value:function(re,Je){var Gt='<input type="radio" class="l7-control-layers-selector" name="'+re+'"'+(Je?' checked="checked"':"")+"/>",ur=document.createElement("div");return ur.innerHTML=Gt,ur.firstChild}},{key:"addItem",value:function(re){var Je=document.createElement("label"),Gt=this.layerService.getLayer(re.layer.id),ur=Gt&&Gt.inited&&re.layer.isVisible(),ct;re.overlay?(ct=document.createElement("input"),ct.type="checkbox",ct.className="l7-control-layers-selector",ct.defaultChecked=ur):ct=this.createRadioElement("l7-base-layers",ur),this.layerControlInputs.push(ct),ct.layerId=re.layer.id,ct.addEventListener("click",this.onInputClick);var ht=document.createElement("span");ht.innerHTML=" "+re.name;var Pt=document.createElement("div");Je.appendChild(Pt),Pt.appendChild(ct),Pt.appendChild(ht);var pt=re.overlay?this.overlaysList:this.baseLayersList;return pt.appendChild(Je),this.checkDisabledLayers(),Je}},{key:"onInputClick",value:function(){var re=this.layerControlInputs,Je,Gt,ur=[],ct=[];this.handlingClick=!0;for(var ht=re.length-1;ht>=0;ht--)Je=re[ht],Gt=this.layerService.getLayer(Je.layerId),Je.checked?ur.push(Gt):Je.checked||ct.push(Gt);ct.forEach(function(Pt){Pt.hide()}),ur.forEach(function(Pt){Pt.show()}),this.handlingClick=!1}}]),Y}(ar);function Le(nt){var Nt=at();return function(){var Xe=He()(nt),re;if(Nt){var Je=He()(this).constructor;re=Reflect.construct(Xe,arguments,Je)}else re=Xe.apply(this,arguments);return Ce()(this,re)}}function at(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var Wt=function(nt){K()(Y,nt);var Nt=Le(Y);function Y(){return N()(this,Y),Nt.apply(this,arguments)}return X()(Y,[{key:"getDefault",value:function(){return{position:Mt.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var re="l7-control-logo",Je=ce.a.create("div",re),Gt=ce.a.create("a","l7-ctrl-logo");return Gt.target="_blank",Gt.rel="noopener nofollow",Gt.href="https://antv.alipay.com/l7",Gt.setAttribute("aria-label","AntV logo"),Gt.setAttribute("rel","noopener nofollow"),Je.appendChild(Gt),Je}},{key:"onRemove",value:function(){return null}}]),Y}(ar);function St(nt){var Nt=dt();return function(){var Xe=He()(nt),re;if(Nt){var Je=He()(this).constructor;re=Reflect.construct(Xe,arguments,Je)}else re=Xe.apply(this,arguments);return Ce()(this,re)}}function dt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var H=function(nt){K()(Y,nt);var Nt=St(Y);function Y(Xe){var re;return N()(this,Y),re=Nt.call(this,Xe),re.mScale=void 0,re.iScale=void 0,Object(ce.i)(["update"],Ht()(re)),re}return X()(Y,[{key:"getDefault",value:function(){return{position:Mt.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var re="l7-control-scale",Je=ce.a.create("div",re);this.addScales(re+"-line",Je);var Gt=this.controlOption.updateWhenIdle;return this.mapsService.on(Gt?"moveend":"mapmove",this.update),this.mapsService.on(Gt?"zoomend":"zoomchange",this.update),this.update(),Je}},{key:"onRemove",value:function(){var re=this.controlOption.updateWhenIdle;this.mapsService.off(re?"zoomend":"zoomchange",this.update),this.mapsService.off(re?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var re=this.mapsService,Je=this.controlOption.maxWidth,Gt=re.getSize()[1]/2,ur=re.containerToLngLat([0,Gt]),ct=re.containerToLngLat([Je,Gt]),ht=Object(ce.q)([ur.lng,ur.lat],[ct.lng,ct.lat]);this.updateScales(ht)}},{key:"updateScales",value:function(re){var Je=this.controlOption,Gt=Je.metric,ur=Je.imperial;Gt&&re&&this.updateMetric(re),ur&&re&&this.updateImperial(re)}},{key:"updateMetric",value:function(re){var Je=this.getRoundNum(re),Gt=Je<1e3?Je+" m":Je/1e3+" km";this.updateScale(this.mScale,Gt,Je/re)}},{key:"updateImperial",value:function(re){var Je=re*3.2808399,Gt,ur,ct;Je>5280?(Gt=Je/5280,ur=this.getRoundNum(Gt),this.updateScale(this.iScale,ur+" mi",ur/Gt)):(ct=this.getRoundNum(Je),this.updateScale(this.iScale,ct+" ft",ct/Je))}},{key:"updateScale",value:function(re,Je,Gt){var ur=this.controlOption.maxWidth;re.style.width=Math.round(ur*Gt)+"px",re.innerHTML=Je}},{key:"getRoundNum",value:function(re){var Je=Math.pow(10,(Math.floor(re)+"").length-1),Gt=re/Je;return Gt=Gt>=10?10:Gt>=5?5:Gt>=3?3:Gt>=2?2:1,Je*Gt}},{key:"addScales",value:function(re,Je){var Gt=this.controlOption,ur=Gt.metric,ct=Gt.imperial;ur&&(this.mScale=ce.a.create("div",re,Je)),ct&&(this.iScale=ce.a.create("div",re,Je))}}]),Y}(ar);function z(nt){var Nt=V();return function(){var Xe=He()(nt),re;if(Nt){var Je=He()(this).constructor;re=Reflect.construct(Xe,arguments,Je)}else re=Xe.apply(this,arguments);return Ce()(this,re)}}function V(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var be=function(nt){K()(Y,nt);var Nt=z(Y);function Y(Xe){var re;return N()(this,Y),re=Nt.call(this,Xe),re.disabled=void 0,re.zoomInButton=void 0,re.zoomOutButton=void 0,Object(ce.i)(["updateDisabled","zoomIn","zoomOut"],Ht()(re)),re}return X()(Y,[{key:"getDefault",value:function(){return{position:Mt.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var re="l7-control-zoom",Je=ce.a.create("div",re+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,re+"-in",Je,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,re+"-out",Je,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),Je}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(re,Je,Gt,ur,ct){var ht=ce.a.create("a",Gt,ur);return ht.innerHTML=re,ht.title=Je,ht.href="javascript:void(0)",ht.addEventListener("click",ct),ht}},{key:"updateDisabled",value:function(){var re=this.mapsService,Je="l7-disabled";ce.a.removeClass(this.zoomInButton,Je),ce.a.removeClass(this.zoomOutButton,Je),(this.disabled||re.getZoom()<=re.getMinZoom())&&ce.a.addClass(this.zoomOutButton,Je),(this.disabled||re.getZoom()>=re.getMaxZoom())&&ce.a.addClass(this.zoomInButton,Je)}}]),Y}(ar);function me(nt,Nt){var Y=Object.keys(nt);if(Object.getOwnPropertySymbols){var Xe=Object.getOwnPropertySymbols(nt);Nt&&(Xe=Xe.filter(function(re){return Object.getOwnPropertyDescriptor(nt,re).enumerable})),Y.push.apply(Y,Xe)}return Y}function le(nt){for(var Nt=1;Nt<arguments.length;Nt++){var Y=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?me(Object(Y),!0).forEach(function(Xe){v()(nt,Xe,Y[Xe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(Y)):me(Object(Y)).forEach(function(Xe){Object.defineProperty(nt,Xe,Object.getOwnPropertyDescriptor(Y,Xe))})}return nt}function fe(nt){var Nt=Ne();return function(){var Xe=He()(nt),re;if(Nt){var Je=He()(this).constructor;re=Reflect.construct(Xe,arguments,Je)}else re=Xe.apply(this,arguments);return Ce()(this,re)}}function Ne(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var lt=function(nt){K()(Y,nt);var Nt=fe(Y);function Y(Xe){var re;return N()(this,Y),re=Nt.call(this),re.markerOption=void 0,re.defaultMarker=void 0,re.popup=void 0,re.mapsService=void 0,re.sceneSerive=void 0,re.lngLat=void 0,re.scene=void 0,re.added=!1,re.eventHandle=function(Je){re.emit(Je.type,{target:Je,data:re.markerOption.extData,lngLat:re.lngLat})},re.markerOption=le(le({},re.getDefault()),Xe),Object(ce.i)(["update","onMove","onUp","addDragHandler","onMapClick"],Ht()(re)),re.init(),re}return X()(Y,[{key:"getDefault",value:function(){return{element:void 0,anchor:ce.f.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(re){this.scene=re,this.mapsService=re.get(Be.TYPES.IMapService),this.sceneSerive=re.get(Be.TYPES.ISceneService);var Je=this.markerOption,Gt=Je.element,ur=Je.draggable;return this.mapsService.getMarkerContainer().appendChild(Gt),this.registerMarkerEvent(Gt),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var re=this.markerOption.element;return re&&ce.a.remove(re),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(re){return this.lngLat=re,Array.isArray(re)&&(this.lngLat={lng:re[0],lat:re[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(re){var Je=this;if(!this.added)return this.once("added",function(){Je.setElement(re)}),this;var Gt=this.markerOption.element;return Gt&&ce.a.remove(Gt),this.markerOption.element=re,this.init(),this.mapsService.getMarkerContainer().appendChild(re),this.registerMarkerEvent(re),this.update(),this}},{key:"openPopup",value:function(){var re=this;if(!this.added)return this.once("added",function(){re.openPopup()}),this;var Je=this.popup;return Je?(Je.isOpen()||Je.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var re=this;this.added||this.once("added",function(){re.closePopup()});var Je=this.popup;return Je&&Je.remove(),this}},{key:"setPopup",value:function(re){return this.popup=re,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var re=this.popup;if(re)re.isOpen()?re.remove():re.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(re){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(re){this.markerOption.extData=re}},{key:"update",value:function(){if(!!this.mapsService){var re=this.markerOption,Je=re.element,Gt=re.anchor;this.updatePosition(),ce.a.setTransform(Je,"".concat(ce.e[Gt]))}}},{key:"onMapClick",value:function(re){var Je=this.markerOption.element;this.popup&&Je&&this.togglePopup()}},{key:"updatePosition",value:function(){if(!!this.mapsService){var re=this.markerOption,Je=re.element,Gt=re.offsets,ur=this.lngLat,ct=ur.lng,ht=ur.lat,Pt=this.mapsService.getBounds(),pt=this.mapsService.getZoom();if((ct<Pt[0][0]||ct>Pt[1][0]||ht<Pt[0][1]||ht>Pt[1][1])&&pt>3){Je&&(Je.style.display="none");return}var Pe=this.mapsService.lngLatToContainer([ct,ht]);Je&&(Je.style.display="block",Je.style.left=Pe.x+Gt[0]+"px",Je.style.top=Pe.y-Gt[1]+"px")}}},{key:"init",value:function(){var re=this,Je=this.markerOption.element,Gt=this.markerOption,ur=Gt.color,ct=Gt.anchor;if(!Je){this.defaultMarker=!0,Je=ce.a.create("div"),this.markerOption.element=Je;var ht=document.createElementNS("http://www.w3.org/2000/svg","svg");ht.setAttributeNS(null,"display","block"),ht.setAttributeNS(null,"height","48px"),ht.setAttributeNS(null,"width","48px"),ht.setAttributeNS(null,"viewBox","0 0 1024 1024");var Pt=document.createElementNS("http://www.w3.org/2000/svg","path");Pt.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),Pt.setAttributeNS(null,"fill",ur),ht.appendChild(Pt),Je.appendChild(ht)}ce.a.addClass(Je,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(pt){var Pe,ot,$e=((Pe=re.markerOption)===null||Pe===void 0?void 0:Pe.style)&&((ot=re.markerOption)===null||ot===void 0?void 0:ot.style[pt]);Je&&(Je.style[pt]=$e)}),Je.addEventListener("click",function(pt){re.onMapClick(pt)}),Je.addEventListener("click",this.eventHandle),Object(ce.g)(Je,ct,"marker")}},{key:"registerMarkerEvent",value:function(re){re.addEventListener("mousemove",this.eventHandle),re.addEventListener("click",this.eventHandle),re.addEventListener("mousedown",this.eventHandle),re.addEventListener("mouseup",this.eventHandle),re.addEventListener("dblclick",this.eventHandle),re.addEventListener("contextmenu",this.eventHandle),re.addEventListener("mouseover",this.eventHandle),re.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var re=this.getElement();re.removeEventListener("mousemove",this.eventHandle),re.removeEventListener("click",this.eventHandle),re.removeEventListener("mousedown",this.eventHandle),re.removeEventListener("mouseup",this.eventHandle),re.removeEventListener("dblclick",this.eventHandle),re.removeEventListener("contextmenu",this.eventHandle),re.removeEventListener("mouseover",this.eventHandle),re.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(re){throw new Error("Method not implemented.")}},{key:"onUp",value:function(re){throw new Error("Method not implemented.")}}]),Y}(st.EventEmitter),rt=a("QkVN"),ue=a.n(rt),ye=a("mpbz"),Ue=a.n(ye);function ft(nt,Nt){var Y=Object.keys(nt);if(Object.getOwnPropertySymbols){var Xe=Object.getOwnPropertySymbols(nt);Nt&&(Xe=Xe.filter(function(re){return Object.getOwnPropertyDescriptor(nt,re).enumerable})),Y.push.apply(Y,Xe)}return Y}function Oe(nt){for(var Nt=1;Nt<arguments.length;Nt++){var Y=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?ft(Object(Y),!0).forEach(function(Xe){v()(nt,Xe,Y[Xe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(Y)):ft(Object(Y)).forEach(function(Xe){Object.defineProperty(nt,Xe,Object.getOwnPropertyDescriptor(Y,Xe))})}return nt}function Ve(nt){var Nt=P();return function(){var Xe=He()(nt),re;if(Nt){var Je=He()(this).constructor;re=Reflect.construct(Xe,arguments,Je)}else re=Xe.apply(this,arguments);return Ce()(this,re)}}function P(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var R=function(nt){K()(Y,nt);var Nt=Ve(Y);function Y(Xe){var re,Je;return N()(this,Y),Je=Nt.call(this),Je.markers=[],Je.markerLayerOption=void 0,Je.clusterIndex=void 0,Je.points=[],Je.clusterMarkers=[],Je.mapsService=void 0,Je.scene=void 0,Je.zoom=void 0,Je.bbox=void 0,Je.markerLayerOption=ue()(Je.getDefault(),Xe),Object(ce.i)(["update"],Ht()(Je)),Je.zoom=((re=Je.markerLayerOption.clusterOption)===null||re===void 0?void 0:re.zoom)||-99,Je}return X()(Y,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(re){return this.scene=re,this.mapsService=re.get(Be.TYPES.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(re){var Je=this.markerLayerOption.cluster;Je&&this.addPoint(re,this.markers.length),this.markers.push(re)}},{key:"removeMarker",value:function(re){this.markers.indexOf(re);var Je=this.markers.indexOf(re);Je>-1&&this.markers.splice(Je,1)}},{key:"getMarkers",value:function(){var re=this.markerLayerOption.cluster;return re?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var re=this;this.getMarkers().forEach(function(Je){Je.addTo(re.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(re){re.remove()}),this.clusterMarkers.forEach(function(re){re.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(re,Je){var Gt=re.getLnglat(),ur=Gt.lng,ct=Gt.lat,ht={geometry:{type:"Point",coordinates:[ur,ct]},properties:Oe(Oe({},re.getExtData()),{},{marker_id:Je})};this.points.push(ht)}},{key:"initCluster",value:function(){if(!!this.markerLayerOption.cluster){var re=this.markerLayerOption.clusterOption,Je=re.radius,Gt=re.minZoom,ur=Gt===void 0?0:Gt,ct=re.maxZoom;this.clusterIndex=new Ue.a({radius:Je,minZoom:ur,maxZoom:ct}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(re,Je){var Gt=this,ur=re[0].concat(re[1]),ct=this.clusterIndex.getClusters(ur,Je);this.clusterMarkers.forEach(function(ht){ht.remove()}),this.clusterMarkers=[],ct.forEach(function(ht){var Pt,pt=Gt.markerLayerOption.clusterOption,Pe=pt.field,ot=pt.method;if(ht.properties&&((Pt=ht.properties)===null||Pt===void 0?void 0:Pt.cluster_id)){var $e,Vt=Gt.getLeaves(($e=ht.properties)===null||$e===void 0?void 0:$e.cluster_id);if(ht.properties.clusterData=Vt,Pe&&ot){var dr=Vt==null?void 0:Vt.map(function(ni){var fi=v()({},Pe,ni.properties[Pe]);return fi}),Zr=ce.c.getColumn(dr,Pe),cr=ce.c.getSatByColumn(ot,Zr),Un="point_"+ot;ht.properties[Un]=cr.toFixed(2)}}var Sn=Gt.clusterMarker(ht);Gt.clusterMarkers.push(Sn),Sn.addTo(Gt.scene)})}},{key:"getLeaves",value:function(re){var Je=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,Gt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return re?this.clusterIndex.getLeaves(re,Je,Gt):null}},{key:"clusterMarker",value:function(re){var Je=this.markerLayerOption.clusterOption,Gt=Je,ur=Gt.element,ct=ur===void 0?this.generateElement.bind(this):ur,ht=new lt({element:ct(re)}).setLnglat({lng:re.geometry.coordinates[0],lat:re.geometry.coordinates[1]});return ht}},{key:"normalMarker",value:function(re){var Je=re.properties.marker_id;return this.markers[Je]}},{key:"update",value:function(){var re=this.mapsService.getZoom(),Je=this.mapsService.getBounds();(!this.bbox||Math.abs(re-this.zoom)>=1||!Object(ce.j)(this.bbox,Je))&&(this.bbox=Object(ce.r)(Je,.5),this.zoom=Math.floor(re),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(re){var Je=ce.a.create("div","l7-marker-cluster"),Gt=ce.a.create("div","",Je),ur=ce.a.create("span","",Gt),ct=this.markerLayerOption.clusterOption,ht=ct.field,Pt=ct.method;re.properties.point_count=re.properties.point_count||1;var pt=ht&&Pt?re.properties["point_"+Pt]||re.properties[ht]:re.properties.point_count;return ur.textContent=pt,Je}}]),Y}(st.EventEmitter);function J(nt,Nt){var Y=Object.keys(nt);if(Object.getOwnPropertySymbols){var Xe=Object.getOwnPropertySymbols(nt);Nt&&(Xe=Xe.filter(function(re){return Object.getOwnPropertyDescriptor(nt,re).enumerable})),Y.push.apply(Y,Xe)}return Y}function de(nt){for(var Nt=1;Nt<arguments.length;Nt++){var Y=arguments[Nt]!=null?arguments[Nt]:{};Nt%2?J(Object(Y),!0).forEach(function(Xe){v()(nt,Xe,Y[Xe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(nt,Object.getOwnPropertyDescriptors(Y)):J(Object(Y)).forEach(function(Xe){Object.defineProperty(nt,Xe,Object.getOwnPropertyDescriptor(Y,Xe))})}return nt}function je(nt){var Nt=We();return function(){var Xe=He()(nt),re;if(Nt){var Je=He()(this).constructor;re=Reflect.construct(Xe,arguments,Je)}else re=Xe.apply(this,arguments);return Ce()(this,re)}}function We(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(nt){return!1}}var gt=function(nt){K()(Y,nt);var Nt=je(Y);function Y(Xe){var re;return N()(this,Y),re=Nt.call(this),re.popupOption=void 0,re.mapsService=void 0,re.sceneSerive=void 0,re.lngLat=void 0,re.content=void 0,re.closeButton=void 0,re.timeoutInstance=void 0,re.container=void 0,re.tip=void 0,re.scene=void 0,re.popupOption=de(de({},re.getdefault()),Xe),Object(ce.i)(["update","onClickClose","remove"],Ht()(re)),re}return X()(Y,[{key:"addTo",value:function(re){var Je=this;return this.mapsService=re.get(Be.TYPES.IMapService),this.sceneSerive=re.get(Be.TYPES.ISceneService),this.mapsService.on("camerachange",this.update),this.scene=re,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){Je.mapsService.on("click",Je.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(re){var Je=window.document.createDocumentFragment(),Gt=window.document.createElement("body"),ur;for(Gt.innerHTML=re;ur=Gt.firstChild,!!ur;)Je.appendChild(ur);return this.setDOMContent(Je)}},{key:"setLnglat",value:function(re){return this.lngLat=re,Array.isArray(re)&&(this.lngLat={lng:re[0],lat:re[1]}),this.mapsService&&this.mapsService.on("camerachange",this.update),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(re){return this.setDOMContent(window.document.createTextNode(re))}},{key:"setMaxWidth",value:function(re){return this.popupOption.maxWidth=re,this.update(),this}},{key:"setDOMContent",value:function(re){return this.createContent(),this.content.appendChild(re),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&ce.a.remove(this.content),this.content=ce.a.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=ce.a.create("button","l7-popup-close-button",this.content),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(re,Je,Gt){var ur=window.document.createElement(re);return Je!==void 0&&(ur.className=Je),Gt&&Gt.appendChild(ur),ur}},{key:"removeDom",value:function(re){re.parentNode&&re.parentNode.removeChild(re)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:ce.f.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(re){re.stopPropagation&&re.stopPropagation(),this.remove()}},{key:"update",value:function(){var re=this,Je=this.lngLat,Gt=this.popupOption,ur=Gt.className,ct=Gt.maxWidth,ht=Gt.anchor;if(!(!this.mapsService||!Je||!this.content)){var Pt=this.mapsService.getMarkerContainer();if(!this.container&&Pt){this.container=this.creatDom("div","l7-popup",Pt),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),ur&&ur.split(" ").forEach(function(Pe){return re.container.classList.add(Pe)});var pt=this.popupOption.stopPropagation;pt&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(Pe){re.container.addEventListener(Pe,function(ot){ot.stopPropagation()})})}ct&&this.container.style.maxWidth!==ct&&(this.container.style.maxWidth=ct),this.updatePosition(),ce.a.setTransform(this.container,"".concat(ce.e[ht])),Object(ce.g)(this.container,ht,"popup")}}},{key:"updatePosition",value:function(){if(!!this.mapsService){var re=this.lngLat,Je=re.lng,Gt=re.lat,ur=this.popupOption.offsets,ct=this.mapsService.lngLatToContainer([Je,Gt]);this.container.style.left=ct.x+ur[0]+"px",this.container.style.top=ct.y-ur[1]+"px"}}}]),Y}(st.EventEmitter);a("BGjm")(`/* @antv/l7-component */
.l7-marker-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: absolute;
 }

.l7-marker {
	position: absolute !important;
	top: 0;
	left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  background-clip: padding-box;
  border-radius: 20px;
  background-color: rgba(181, 226, 140, 0.6);
  width: 40px;
  height: 40px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-left: 5px;
  margin-top: 5px;
  text-align: center;
  border-radius: 15px;
  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
  background-color: rgba(110, 204, 57, 0.6);
}
.l7-marker-cluster span {
  line-height: 30px;
}

.l7-popup-anchor-bottom,
.l7-popup-anchor-bottom-left,
.l7-popup-anchor-bottom-right {
    -webkit-flex-direction: column-reverse;
    -webkit-box-orient: vertical;
    -webkit-box-direction: reverse;
        -ms-flex-direction: column-reverse;
            flex-direction: column-reverse;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 5px;
	}
.l7-popup-anchor-top,
.l7-popup-anchor-top-left,
.l7-popup-anchor-top-right {
    -webkit-flex-direction: column;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}


.l7-popup-anchor-left {
    -webkit-flex-direction: row;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
        -ms-flex-direction: row;
            flex-direction: row;
}

.l7-popup-anchor-right {
    -webkit-flex-direction: row-reverse;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: reverse;
        -ms-flex-direction: row-reverse;
            flex-direction: row-reverse;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  display: -webkit-flex;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
  z-index: 5;
}
.l7-popup-tip {
  width: 0;
  height: 0;
  border: 10px solid transparent;
  z-index: 1;
}
.l7-popup-anchor-top .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-top: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-top: none;
	border-left: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-top: none;
	border-right: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-bottom: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-bottom: none;
	border-left: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-bottom: none;
	border-right: none;
	border-top-color: #fff;
}

.l7-popup-anchor-left .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-left: none;
	border-right-color: #fff;
}

.l7-popup-anchor-right .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-right: none;
	border-left-color: #fff;
}

.l7-popup-close-button {
	position: absolute;
	right: 0;
	top: 0;
	border: 0;
	padding: 0;
	font-size: 25px;
	line-height: 20px;
	border-radius: 0 3px 0 0;
	cursor: pointer;
	background-color: transparent;
}

.l7-popup-close-button:hover {
	background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
	position: relative;
	background: #fff;
	border-radius: 3px;
	-webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	padding: 10px 10px 15px;
	pointer-events: auto;
}

.l7-popup-anchor-top-left .l7-popup-content {
	border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
	border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
	border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
	border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
	display: none;
}

.l7-popup-track-pointer * {
	pointer-events: none;
	-webkit-user-select: none;
	   -moz-user-select: none;
	    -ms-user-select: none;
	        user-select: none;
}

.l7-map:hover .l7-popup-track-pointer {
	display: -webkit-box;
	display: -webkit-flex;
	display: -ms-flexbox;
	display: flex;
}

.l7-map:active .l7-popup-track-pointer {
	display: none;
}


.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* general toolbar styles */

.l7-bar {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	border-radius: 4px;
	}
.l7-bar a,
.l7-bar a:hover {
	background-color: #fff;
	width: 30px;
	height: 30px;
  font-size: 20px;
	display: block;
	text-align: center;
	text-decoration: none;
	color: #8E9DAB;
	}
.l7-bar a,
.l7-control-layers-toggle {
	background-position: 50% 50%;
	background-repeat: no-repeat;
	display: block;
	}
.l7-bar a:hover {
	background-color: #f4f4f4;
	}
.l7-bar a:first-child {
	border-top-left-radius: 2px;
	border-top-right-radius: 2px;
	}
.l7-bar a:last-child {
	border-bottom-left-radius: 2px;
	border-bottom-right-radius: 2px;
	border-bottom: none;
	}
.l7-bar a.l7-disabled {
	cursor: default;
	background-color: #f4f4f4;
	color: #bbb;
	}


/* control positioning */

.l7-control-container {
	font: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
}
.l7-control-hide {
	display: none;
}
.l7-control {
	position: relative;
	z-index: 800;
	pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */
	pointer-events: auto;
	}
.l7-control {
	float: left;
	clear: both;
	}.l7-top,
  .l7-bottom {
    position: absolute;
    z-index: 1000;
    pointer-events: none;
    }
  .l7-top {
    top: 0;
    }
  .l7-right {
    right: 0;
    }
  .l7-bottom {
    bottom: 0;
    }
  .l7-left {
    left: 0;
    }

  .l7-control {
    float: left;
    clear: both;
    }
  .l7-right .l7-control {
    float: right;
    }
  .l7-top .l7-control {
    margin-top: 10px;
    }
  .l7-bottom .l7-control {
    margin-bottom: 10px;
    }
  .l7-left .l7-control {
    margin-left: 10px;
    }
  .l7-right .l7-control {
    margin-right: 10px;
    }

  /* attribution and scale controls */

.l7-control-container .l7-control-attribution {
	background: #fff;
	background: rgba(255, 255, 255, 0.7);
	margin: 0;
	}
.l7-control-attribution,
.l7-control-scale-line {
	padding: 0 5px;
  color: #333;
	}
.l7-control-attribution a {
	text-decoration: none;
	}
.l7-control-attribution a:hover {
	text-decoration: underline;
	}
.l7-container .l7-control-attribution,
.l7-container .l7-control-scale {
  font-size: 11px;
  padding: 5px 5px 2px 5px;
  background: rgba(255, 255, 255, 0.7);
	}
.l7-left .l7-control-scale {
	margin-left: 5px;
	}
.l7-bottom .l7-control-scale {
	margin-bottom: 5px;
	}
.l7-control-scale-line {
	border: 2px solid #000;
  border-top: none;
  color: #000;
	line-height: 1.1;
	padding: 2px 5px 1px;
	font-size: 11px;
	white-space: nowrap;
	overflow: hidden;
	-webkit-box-sizing: border-box;
	        box-sizing: border-box;

	background: #fff;
	}
.l7-control-scale-line:not(:first-child) {
	border-top: 2px solid #777;
	border-bottom: none;
	margin-top: -2px;
	}
.l7-control-scale-line:not(:first-child):not(:last-child) {
	border-bottom: 2px solid #777;
	}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	-webkit-box-shadow: none;
	        box-shadow: none;
	}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	border: 2px solid rgba(0,0,0,0.2);
	background-clip: padding-box;
  }
  /*logo */

  .l7-ctrl-logo {
    background-size: 100% 100%;
    width: 89px;
    height: 16px;
    margin: 0 0 -3px -3px;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    background-repeat: no-repeat;
    cursor: pointer;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');
}


	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 2px;
	}
.l7-control-layers-toggle {
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');
	width: 30px;
  height: 30px;
  background-size: 20px 20px;
	}

.l7-touch .l7-control-layers-toggle {
	width: 44px;
	height: 44px;
	}
.l7-control-layers .l7-control-layers-list,
.l7-control-layers-expanded .l7-control-layers-toggle {
	display: none;
	}
.l7-control-layers-expanded .l7-control-layers-list {
	display: block;
	position: relative;
	}
.l7-control-layers-expanded {
	padding: 6px 10px 6px 6px;
	color: #59626B;
	background: #fff;
	}
.l7-control-layers-scrollbar {
	overflow-y: scroll;
	overflow-x: hidden;
	padding-right: 5px;
	}
.l7-control-layers-selector {
	margin-top: 2px;
	position: relative;
	top: 1px;
	}
.l7-control-layers label {
  display: block;
  padding: 8px;
  }
  .l7-control-layers label input[type="radio"],
  .l7-control-layers label input[type="checkbox"] {
  width: 14px;
  height: 14px;
  margin: 0;
}
.l7-control-layers-separator {
	height: 0;
	border-top: 1px solid #D8D8D8;
	margin: 5px -10px 5px -6px;
}
.mapboxgl-ctrl-logo {
  display: none !important;
 }
 .amap-logo{
  display: none !important;
 }


`)},kPKH:function(we,x,a){"use strict";var S=a("/kpp");x.a=S.a},"kQ+U":function(we,x,a){"use strict";a.d(x,"a",function(){return ht});var S=a("lSNA"),v=a.n(S),Z=a("lwsE"),N=a.n(Z),o=a("W8MJ"),X=a.n(o),F=a("k5/I"),K=a("h1nZ"),q=a("o0o1"),Ce=a.n(q),$=a("yXPU"),He=a.n($),Be=a("4cb6"),ce=a("fbvF"),st=a.n(ce),ut=function(){function Pt(pt,Pe){N()(this,Pt),this.attribute=void 0,this.buffer=void 0;var ot=Pe.buffer,$e=Pe.offset,Vt=Pe.stride,dr=Pe.normalized,Zr=Pe.size,cr=Pe.divisor;this.buffer=ot,this.attribute={buffer:ot.get(),offset:$e||0,stride:Vt||0,normalized:dr||!1,divisor:cr||0},Zr&&(this.attribute.size=Zr)}return X()(Pt,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(Pe){this.buffer.subData(Pe)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),Pt}(),Me,bt,xt,Mt,De,ar,$t,Ht,vt,Ze,Et,Le,at,Wt,St=(Me={},v()(Me,K.gl.POINTS,"points"),v()(Me,K.gl.LINES,"lines"),v()(Me,K.gl.LINE_LOOP,"line loop"),v()(Me,K.gl.LINE_STRIP,"line strip"),v()(Me,K.gl.TRIANGLES,"triangles"),v()(Me,K.gl.TRIANGLE_FAN,"triangle fan"),v()(Me,K.gl.TRIANGLE_STRIP,"triangle strip"),Me),dt=(bt={},v()(bt,K.gl.STATIC_DRAW,"static"),v()(bt,K.gl.DYNAMIC_DRAW,"dynamic"),v()(bt,K.gl.STREAM_DRAW,"stream"),bt),H=(xt={},v()(xt,K.gl.BYTE,"int8"),v()(xt,K.gl.UNSIGNED_INT,"int16"),v()(xt,K.gl.INT,"int32"),v()(xt,K.gl.UNSIGNED_BYTE,"uint8"),v()(xt,K.gl.UNSIGNED_SHORT,"uint16"),v()(xt,K.gl.UNSIGNED_INT,"uint32"),v()(xt,K.gl.FLOAT,"float"),xt),z=(Mt={},v()(Mt,K.gl.ALPHA,"alpha"),v()(Mt,K.gl.LUMINANCE,"luminance"),v()(Mt,K.gl.LUMINANCE_ALPHA,"luminance alpha"),v()(Mt,K.gl.RGB,"rgb"),v()(Mt,K.gl.RGBA,"rgba"),v()(Mt,K.gl.RGBA4,"rgba4"),v()(Mt,K.gl.RGB5_A1,"rgb5 a1"),v()(Mt,K.gl.RGB565,"rgb565"),v()(Mt,K.gl.DEPTH_COMPONENT,"depth"),v()(Mt,K.gl.DEPTH_STENCIL,"depth stencil"),Mt),V=(De={},v()(De,K.gl.DONT_CARE,"dont care"),v()(De,K.gl.NICEST,"nice"),v()(De,K.gl.FASTEST,"fast"),De),be=(ar={},v()(ar,K.gl.NEAREST,"nearest"),v()(ar,K.gl.LINEAR,"linear"),v()(ar,K.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),v()(ar,K.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),v()(ar,K.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),v()(ar,K.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),ar),me=($t={},v()($t,K.gl.REPEAT,"repeat"),v()($t,K.gl.CLAMP_TO_EDGE,"clamp"),v()($t,K.gl.MIRRORED_REPEAT,"mirror"),$t),le=(Ht={},v()(Ht,K.gl.NONE,"none"),v()(Ht,K.gl.BROWSER_DEFAULT_WEBGL,"browser"),Ht),fe=(vt={},v()(vt,K.gl.NEVER,"never"),v()(vt,K.gl.ALWAYS,"always"),v()(vt,K.gl.LESS,"less"),v()(vt,K.gl.LEQUAL,"lequal"),v()(vt,K.gl.GREATER,"greater"),v()(vt,K.gl.GEQUAL,"gequal"),v()(vt,K.gl.EQUAL,"equal"),v()(vt,K.gl.NOTEQUAL,"notequal"),vt),Ne=(Ze={},v()(Ze,K.gl.FUNC_ADD,"add"),v()(Ze,K.gl.MIN_EXT,"min"),v()(Ze,K.gl.MAX_EXT,"max"),v()(Ze,K.gl.FUNC_SUBTRACT,"subtract"),v()(Ze,K.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Ze),lt=(Et={},v()(Et,K.gl.ZERO,"zero"),v()(Et,K.gl.ONE,"one"),v()(Et,K.gl.SRC_COLOR,"src color"),v()(Et,K.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),v()(Et,K.gl.SRC_ALPHA,"src alpha"),v()(Et,K.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),v()(Et,K.gl.DST_COLOR,"dst color"),v()(Et,K.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),v()(Et,K.gl.DST_ALPHA,"dst alpha"),v()(Et,K.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),v()(Et,K.gl.CONSTANT_COLOR,"constant color"),v()(Et,K.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),v()(Et,K.gl.CONSTANT_ALPHA,"constant alpha"),v()(Et,K.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),v()(Et,K.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),Et),rt=(Le={},v()(Le,K.gl.NEVER,"never"),v()(Le,K.gl.ALWAYS,"always"),v()(Le,K.gl.LESS,"less"),v()(Le,K.gl.LEQUAL,"lequal"),v()(Le,K.gl.GREATER,"greater"),v()(Le,K.gl.GEQUAL,"gequal"),v()(Le,K.gl.EQUAL,"equal"),v()(Le,K.gl.NOTEQUAL,"notequal"),Le),ue=(at={},v()(at,K.gl.ZERO,"zero"),v()(at,K.gl.KEEP,"keep"),v()(at,K.gl.REPLACE,"replace"),v()(at,K.gl.INVERT,"invert"),v()(at,K.gl.INCR,"increment"),v()(at,K.gl.DECR,"decrement"),v()(at,K.gl.INCR_WRAP,"increment wrap"),v()(at,K.gl.DECR_WRAP,"decrement wrap"),at),ye=(Wt={},v()(Wt,K.gl.FRONT,"front"),v()(Wt,K.gl.BACK,"back"),Wt),Ue=function(){function Pt(pt,Pe){N()(this,Pt),this.buffer=void 0;var ot=Pe.data,$e=Pe.usage,Vt=Pe.type;this.buffer=pt.buffer({data:ot,usage:dt[$e||K.gl.STATIC_DRAW],type:H[Vt||K.gl.UNSIGNED_BYTE]})}return X()(Pt,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(Pe){var ot=Pe.data,$e=Pe.offset;this.buffer.subdata(ot,$e)}}]),Pt}(),ft=function(){function Pt(pt,Pe){N()(this,Pt),this.elements=void 0;var ot=Pe.data,$e=Pe.usage,Vt=Pe.type,dr=Pe.count;this.elements=pt.elements({data:ot,usage:dt[$e||K.gl.STATIC_DRAW],type:H[Vt||K.gl.UNSIGNED_BYTE],count:dr})}return X()(Pt,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(Pe){var ot=Pe.data;this.elements.subdata(ot)}},{key:"destroy",value:function(){}}]),Pt}(),Oe=function(){function Pt(pt,Pe){N()(this,Pt),this.framebuffer=void 0;var ot=Pe.width,$e=Pe.height,Vt=Pe.color,dr=Pe.colors,Zr=Pe.depth,cr=Pe.stencil,Un={width:ot,height:$e};Array.isArray(dr)&&(Un.colors=dr.map(function(Sn){return Sn.get()})),Vt&&typeof Vt!="boolean"&&(Un.color=Vt.get()),this.framebuffer=pt.framebuffer(Un)}return X()(Pt,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(Pe){var ot=Pe.width,$e=Pe.height;this.framebuffer.resize(ot,$e)}}]),Pt}(),Ve=a("cDf5"),P=a.n(Ve),R=a("c6wG"),J=a.n(R),de=a("YO3V"),je=a.n(de);function We(Pt,pt){var Pe=Object.keys(Pt);if(Object.getOwnPropertySymbols){var ot=Object.getOwnPropertySymbols(Pt);pt&&(ot=ot.filter(function($e){return Object.getOwnPropertyDescriptor(Pt,$e).enumerable})),Pe.push.apply(Pe,ot)}return Pe}function gt(Pt){for(var pt=1;pt<arguments.length;pt++){var Pe=arguments[pt]!=null?arguments[pt]:{};pt%2?We(Object(Pe),!0).forEach(function(ot){v()(Pt,ot,Pe[ot])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Pt,Object.getOwnPropertyDescriptors(Pe)):We(Object(Pe)).forEach(function(ot){Object.defineProperty(Pt,ot,Object.getOwnPropertyDescriptor(Pe,ot))})}return Pt}var nt=function(){function Pt(pt,Pe){N()(this,Pt),this.reGl=void 0,this.destroyed=!1,this.drawCommand=void 0,this.drawParams=void 0,this.options=void 0,this.uniforms={},this.reGl=pt;var ot=Pe.vs,$e=Pe.fs,Vt=Pe.attributes,dr=Pe.uniforms,Zr=Pe.primitive,cr=Pe.count,Un=Pe.elements,Sn=Pe.depth,ni=Pe.blend,fi=Pe.stencil,Wn=Pe.cull,Gn=Pe.instances,Ee={};this.options=Pe,dr&&(this.uniforms=this.extractUniforms(dr),Object.keys(dr).forEach(function(ae){Ee[ae]=pt.prop(ae)}));var pe={};Object.keys(Vt).forEach(function(ae){pe[ae]=Vt[ae].get()});var W={attributes:pe,frag:$e,uniforms:Ee,vert:ot,primitive:St[Zr===void 0?K.gl.TRIANGLES:Zr]};Gn&&(W.instances=Gn),cr&&(W.count=cr),Un&&(W.elements=Un.get()),this.initDepthDrawParams({depth:Sn},W),this.initBlendDrawParams({blend:ni},W),this.initStencilDrawParams({stencil:fi},W),this.initCullDrawParams({cull:Wn},W),this.drawCommand=pt(W),this.drawParams=W}return X()(Pt,[{key:"addUniforms",value:function(Pe){this.uniforms=gt(gt({},this.uniforms),this.extractUniforms(Pe))}},{key:"draw",value:function(Pe){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var ot=gt(gt({},this.uniforms),this.extractUniforms(Pe.uniforms||{})),$e={};Object.keys(ot).forEach(function(Vt){var dr=P()(ot[Vt]);dr==="boolean"||dr==="number"||Array.isArray(ot[Vt])||ot[Vt].BYTES_PER_ELEMENT?$e[Vt]=ot[Vt]:$e[Vt]=ot[Vt].get()}),this.drawCommand($e)}}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(Pe){Pe.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(Pe,ot){var $e=Pe.depth;$e&&(ot.depth={enable:$e.enable===void 0?!0:!!$e.enable,mask:$e.mask===void 0?!0:!!$e.mask,func:fe[$e.func||K.gl.LESS],range:$e.range||[0,1]})}},{key:"initBlendDrawParams",value:function(Pe,ot){var $e=Pe.blend;if($e){var Vt=$e.enable,dr=$e.func,Zr=$e.equation,cr=$e.color,Un=cr===void 0?[0,0,0,0]:cr;ot.blend={enable:!!Vt,func:{srcRGB:lt[dr&&dr.srcRGB||K.gl.SRC_ALPHA],srcAlpha:lt[dr&&dr.srcAlpha||K.gl.SRC_ALPHA],dstRGB:lt[dr&&dr.dstRGB||K.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:lt[dr&&dr.dstAlpha||K.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Ne[Zr&&Zr.rgb||K.gl.FUNC_ADD],alpha:Ne[Zr&&Zr.alpha||K.gl.FUNC_ADD]},color:Un}}}},{key:"initStencilDrawParams",value:function(Pe,ot){var $e=Pe.stencil;if($e){var Vt=$e.enable,dr=$e.mask,Zr=dr===void 0?-1:dr,cr=$e.func,Un=cr===void 0?{cmp:K.gl.ALWAYS,ref:0,mask:-1}:cr,Sn=$e.opFront,ni=Sn===void 0?{fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP}:Sn,fi=$e.opBack,Wn=fi===void 0?{fail:K.gl.KEEP,zfail:K.gl.KEEP,zpass:K.gl.KEEP}:fi;ot.stencil={enable:!!Vt,mask:Zr,func:gt(gt({},Un),{},{cmp:rt[Un.cmp]}),opFront:{fail:ue[ni.fail],zfail:ue[ni.zfail],zpass:ue[ni.zpass]},opBack:{fail:ue[Wn.fail],zfail:ue[Wn.zfail],zpass:ue[Wn.zpass]}}}}},{key:"initCullDrawParams",value:function(Pe,ot){var $e=Pe.cull;if($e){var Vt=$e.enable,dr=$e.face,Zr=dr===void 0?K.gl.BACK:dr;ot.cull={enable:!!Vt,face:ye[Zr]}}}},{key:"extractUniforms",value:function(Pe){var ot=this,$e={};return Object.keys(Pe).forEach(function(Vt){ot.extractUniformsRecursively(Vt,Pe[Vt],$e,"")}),$e}},{key:"extractUniformsRecursively",value:function(Pe,ot,$e,Vt){var dr=this;if(ot===null||typeof ot=="number"||typeof ot=="boolean"||Array.isArray(ot)&&typeof ot[0]=="number"||J()(ot)||ot===""||"resize"in ot){$e["".concat(Vt&&Vt+".").concat(Pe)]=ot;return}je()(ot)&&Object.keys(ot).forEach(function(Zr){dr.extractUniformsRecursively(Zr,ot[Zr],$e,"".concat(Vt&&Vt+".").concat(Pe))}),Array.isArray(ot)&&ot.forEach(function(Zr,cr){Object.keys(Zr).forEach(function(Un){dr.extractUniformsRecursively(Un,Zr[Un],$e,"".concat(Vt&&Vt+".").concat(Pe,"[").concat(cr,"]"))})})}}]),Pt}(),Nt=function(){function Pt(pt,Pe){N()(this,Pt),this.texture=void 0,this.width=void 0,this.height=void 0;var ot=Pe.data,$e=Pe.type,Vt=$e===void 0?K.gl.UNSIGNED_BYTE:$e,dr=Pe.width,Zr=Pe.height,cr=Pe.flipY,Un=cr===void 0?!1:cr,Sn=Pe.format,ni=Sn===void 0?K.gl.RGBA:Sn,fi=Pe.mipmap,Wn=fi===void 0?!1:fi,Gn=Pe.wrapS,Ee=Gn===void 0?K.gl.CLAMP_TO_EDGE:Gn,pe=Pe.wrapT,W=pe===void 0?K.gl.CLAMP_TO_EDGE:pe,ae=Pe.aniso,Ie=ae===void 0?0:ae,qe=Pe.alignment,Ct=qe===void 0?1:qe,Re=Pe.premultiplyAlpha,mt=Re===void 0?!1:Re,Qt=Pe.mag,Br=Qt===void 0?K.gl.NEAREST:Qt,Ur=Pe.min,or=Ur===void 0?K.gl.NEAREST:Ur,Vr=Pe.colorSpace,An=Vr===void 0?K.gl.BROWSER_DEFAULT_WEBGL:Vr;this.width=dr,this.height=Zr;var dn={width:dr,height:Zr,type:H[Vt],format:z[ni],wrapS:me[Ee],wrapT:me[W],mag:be[Br],min:be[or],alignment:Ct,flipY:Un,colorSpace:le[An],premultiplyAlpha:mt,aniso:Ie};ot&&(dn.data=ot),typeof Wn=="number"?dn.mipmap=V[Wn]:typeof Wn=="boolean"&&(dn.mipmap=Wn),this.texture=pt.texture(dn)}return X()(Pt,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(Pe)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(Pe){var ot=Pe.width,$e=Pe.height;this.texture.resize(ot,$e),this.width=ot,this.height=$e}},{key:"destroy",value:function(){this.texture.destroy()}}]),Pt}(),Y,Xe,re,Je=(Y=Object(Be.injectable)(),Y(Xe=(re=function(){function Pt(){var pt=this;N()(this,Pt),this.gl=void 0,this.$container=void 0,this.canvas=void 0,this.width=void 0,this.height=void 0,this.isDirty=void 0,this.createModel=function(Pe){return new nt(pt.gl,Pe)},this.createAttribute=function(Pe){return new ut(pt.gl,Pe)},this.createBuffer=function(Pe){return new Ue(pt.gl,Pe)},this.createElements=function(Pe){return new ft(pt.gl,Pe)},this.createTexture2D=function(Pe){return new Nt(pt.gl,Pe)},this.createFramebuffer=function(Pe){return new Oe(pt.gl,Pe)},this.useFramebuffer=function(Pe,ot){pt.gl({framebuffer:Pe?Pe.get():null})(ot)},this.clear=function(Pe){var ot=Pe.color,$e=Pe.depth,Vt=Pe.stencil,dr=Pe.framebuffer,Zr=dr===void 0?null:dr,cr={color:ot,depth:$e,stencil:Vt};cr.framebuffer=Zr===null?Zr:Zr.get(),pt.gl.clear(cr)},this.viewport=function(Pe){var ot=Pe.x,$e=Pe.y,Vt=Pe.width,dr=Pe.height;pt.gl._gl.viewport(ot,$e,Vt,dr),pt.width=Vt,pt.height=dr,pt.gl._refresh()},this.readPixels=function(Pe){var ot=Pe.framebuffer,$e=Pe.x,Vt=Pe.y,dr=Pe.width,Zr=Pe.height,cr={x:$e,y:Vt,width:dr,height:Zr};return ot&&(cr.framebuffer=ot.get()),pt.gl.read(cr)},this.getViewportSize=function(){return{width:pt.gl._gl.drawingBufferWidth,height:pt.gl._gl.drawingBufferHeight}},this.getContainer=function(){var Pe;return(Pe=pt.canvas)===null||Pe===void 0?void 0:Pe.parentElement},this.getCanvas=function(){return pt.canvas},this.getGLContext=function(){return pt.gl._gl},this.destroy=function(){pt.gl.destroy()}}return X()(Pt,[{key:"init",value:function(){var pt=He()(Ce.a.mark(function ot($e,Vt){var dr=this;return Ce.a.wrap(function(cr){for(;;)switch(cr.prev=cr.next){case 0:return this.canvas=$e,cr.next=3,new Promise(function(Un,Sn){st()({canvas:dr.canvas,attributes:{alpha:!0,antialias:Vt.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:Vt.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(fi,Wn){(fi||!Wn)&&Sn(fi),Un(Wn)}})});case 3:this.gl=cr.sent;case 4:case"end":return cr.stop()}},ot,this)}));function Pe(ot,$e){return pt.apply(this,arguments)}return Pe}()},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var Pe=this.getGLContext();Pe.disable(Pe.CULL_FACE)}},{key:"setDirty",value:function(Pe){this.isDirty=Pe}},{key:"getDirty",value:function(){return this.isDirty}}]),Pt}(),re))||Xe),Gt=a("Hel2");function ur(Pt,pt){var Pe=Object.keys(Pt);if(Object.getOwnPropertySymbols){var ot=Object.getOwnPropertySymbols(Pt);pt&&(ot=ot.filter(function($e){return Object.getOwnPropertyDescriptor(Pt,$e).enumerable})),Pe.push.apply(Pe,ot)}return Pe}function ct(Pt){for(var pt=1;pt<arguments.length;pt++){var Pe=arguments[pt]!=null?arguments[pt]:{};pt%2?ur(Object(Pe),!0).forEach(function(ot){v()(Pt,ot,Pe[ot])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Pt,Object.getOwnPropertyDescriptors(Pe)):ur(Object(Pe)).forEach(function(ot){Object.defineProperty(Pt,ot,Object.getOwnPropertyDescriptor(Pe,ot))})}return Pt}var ht=function(){function Pt(pt){N()(this,Pt),this.sceneService=void 0,this.mapService=void 0,this.controlService=void 0,this.layerService=void 0,this.iconService=void 0,this.markerService=void 0,this.popupService=void 0,this.fontService=void 0,this.interactionService=void 0,this.container=void 0;var Pe=pt.id,ot=pt.map,$e=Object(K.createSceneContainer)();this.container=$e,ot.setContainer($e,Pe),$e.bind(K.TYPES.IRendererService).to(Je).inSingletonScope(),this.sceneService=$e.get(K.TYPES.ISceneService),this.mapService=$e.get(K.TYPES.IMapService),this.iconService=$e.get(K.TYPES.IIconService),this.fontService=$e.get(K.TYPES.IFontService),this.controlService=$e.get(K.TYPES.IControlService),this.layerService=$e.get(K.TYPES.ILayerService),this.markerService=$e.get(K.TYPES.IMarkerService),this.interactionService=$e.get(K.TYPES.IInteractionService),this.popupService=$e.get(K.TYPES.IPopupService),this.initComponent(Pe),this.sceneService.init(pt),this.initControl()}return X()(Pt,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(Pe){return this.sceneService.exportPng(Pe)}},{key:"exportMap",value:function(Pe){return this.sceneService.exportPng(Pe)}},{key:"registerRenderService",value:function(Pe){var ot=this;if(this.sceneService.loaded){var $e=new Pe(this);$e.init()}else this.on("loaded",function(){var Vt=new Pe(ot);Vt.init()})}},{key:"addLayer",value:function(Pe){var ot=Object(K.createLayerContainer)(this.container);Pe.setContainer(ot),this.sceneService.addLayer(Pe)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(Pe){return this.layerService.getLayer(Pe)}},{key:"getLayerByName",value:function(Pe){return this.layerService.getLayerByName(Pe)}},{key:"removeLayer",value:function(Pe){this.layerService.remove(Pe)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addImage",value:function(Pe,ot){this.iconService.addImage(Pe,ot)}},{key:"hasImage",value:function(Pe){return this.iconService.hasImage(Pe)}},{key:"removeImage",value:function(Pe){this.iconService.removeImage(Pe)}},{key:"addIconFontGlyphs",value:function(Pe,ot){this.fontService.addIconGlyphs(ot)}},{key:"addControl",value:function(Pe){this.controlService.addControl(Pe,this.container)}},{key:"removeControl",value:function(Pe){this.controlService.removeControl(Pe)}},{key:"getControlByName",value:function(Pe){return this.controlService.getControlByName(Pe)}},{key:"addMarker",value:function(Pe){this.markerService.addMarker(Pe)}},{key:"addMarkerLayer",value:function(Pe){this.markerService.addMarkerLayer(Pe)}},{key:"removeMarkerLayer",value:function(Pe){this.markerService.removeMarkerLayer(Pe)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(Pe){this.popupService.addPopup(Pe)}},{key:"on",value:function(Pe,ot){K.SceneEventList.indexOf(Pe)===-1?this.mapService.on(Pe,ot):this.sceneService.on(Pe,ot)}},{key:"off",value:function(Pe,ot){K.SceneEventList.indexOf(Pe)===-1?this.mapService.off(Pe,ot):this.sceneService.off(Pe,ot)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(){return this.mapService.getCenter()}},{key:"setCenter",value:function(Pe){return this.mapService.setCenter(Pe)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(Pe){return this.mapService.setPitch(Pe)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(Pe){this.mapService.setRotation(Pe)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(Pe){this.mapService.panTo(Pe)}},{key:"panBy",value:function(Pe){this.mapService.panBy(Pe)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(Pe){this.mapService.setZoom(Pe)}},{key:"fitBounds",value:function(Pe,ot){var $e=this.sceneService.getSceneConfig(),Vt=$e.fitBoundsOptions,dr=$e.animate;this.mapService.fitBounds(Pe,ot||ct(ct({},Vt),{},{animate:dr}))}},{key:"setZoomAndCenter",value:function(Pe,ot){this.mapService.setZoomAndCenter(Pe,ot)}},{key:"setMapStyle",value:function(Pe){this.mapService.setMapStyle(Pe)}},{key:"setMapStatus",value:function(Pe){this.mapService.setMapStatus(Pe)}},{key:"pixelToLngLat",value:function(Pe){return this.mapService.pixelToLngLat(Pe)}},{key:"lngLatToPixel",value:function(Pe){return this.mapService.lngLatToPixel(Pe)}},{key:"containerToLngLat",value:function(Pe){return this.mapService.containerToLngLat(Pe)}},{key:"lngLatToContainer",value:function(Pe){return this.mapService.lngLatToContainer(Pe)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(Pe,ot){this.container.bind(K.TYPES.IPostProcessingPass).to(Pe).whenTargetNamed(ot)}},{key:"initComponent",value:function(Pe){this.controlService.init({container:Gt.a.getContainer(Pe)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var Pe=this.sceneService.getSceneConfig(),ot=Pe.logoVisible,$e=Pe.logoPosition;ot&&this.addControl(new F.b({position:$e}))}},{key:"map",get:function(){return this.mapService.map}}]),Pt}()},l94r:function(we,x,a){"use strict";a.d(x,"a",function(){return me});var S=a("lSNA"),v=a.n(S),Z=a("lwsE"),N=a.n(Z),o=a("W8MJ"),X=a.n(o),F=a("7W2i"),K=a.n(F),q=a("a1gu"),Ce=a.n(q),$=a("Nsbk"),He=a.n($),Be=a("JBE3"),ce=a.n(Be),st=a("4qC0"),ut=a.n(st),Me=a("lSCD"),bt=a.n(Me),xt=a("BkRI"),Mt=a.n(xt),De=a("xp6e"),ar=a("Hel2"),$t=a("uhBA"),Ht=a("rlAn"),vt=a("qxNg");function Ze(le){if(le.length===0)throw new Error("max requires at least one data point");for(var fe=le[0],Ne=1;Ne<le.length;Ne++)le[Ne]>fe&&(fe=le[Ne]);return fe}function Et(le){if(le.length===0)throw new Error("min requires at least one data point");for(var fe=le[0],Ne=1;Ne<le.length;Ne++)le[Ne]<fe&&(fe=le[Ne]);return fe}function Le(le){if(le.length===0)return 0;for(var fe=le[0],Ne=0,lt,rt=1;rt<le.length;rt++)lt=fe+le[rt]*1,Math.abs(fe)>=Math.abs(le[rt])?Ne+=fe-lt+le[rt]:Ne+=le[rt]-lt+fe,fe=lt;return fe+Ne*1}function at(le){if(le.length===0)throw new Error("mean requires at least one data point");return Le(le)/le.length}var Wt={min:Et,max:Ze,mean:at,sum:Le};function St(le,fe){return le.map(function(Ne){return Ne[fe]*1})}function dt(le,fe){var Ne=Object.keys(le);if(Object.getOwnPropertySymbols){var lt=Object.getOwnPropertySymbols(le);fe&&(lt=lt.filter(function(rt){return Object.getOwnPropertyDescriptor(le,rt).enumerable})),Ne.push.apply(Ne,lt)}return Ne}function H(le){for(var fe=1;fe<arguments.length;fe++){var Ne=arguments[fe]!=null?arguments[fe]:{};fe%2?dt(Object(Ne),!0).forEach(function(lt){v()(le,lt,Ne[lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(le,Object.getOwnPropertyDescriptors(Ne)):dt(Object(Ne)).forEach(function(lt){Object.defineProperty(le,lt,Object.getOwnPropertyDescriptor(Ne,lt))})}return le}function z(le){var fe=V();return function(){var lt=He()(le),rt;if(fe){var ue=He()(this).constructor;rt=Reflect.construct(lt,arguments,ue)}else rt=lt.apply(this,arguments);return Ce()(this,rt)}}function V(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(le){return!1}}function be(le,fe){if(Array.isArray(fe))return fe}var me=function(le){K()(Ne,le);var fe=z(Ne);function Ne(lt,rt){var ue;return N()(this,Ne),ue=fe.call(this),ue.data=void 0,ue.extent=void 0,ue.hooks={init:new De.c},ue.parser={type:"geojson"},ue.transforms=[],ue.cluster=!1,ue.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},ue.originData=void 0,ue.rawData=void 0,ue.cfg={},ue.clusterIndex=void 0,ue.originData=lt,ue.initCfg(rt),ue.hooks.init.tap("parser",function(){ue.excuteParser()}),ue.hooks.init.tap("cluster",function(){ue.initCluster()}),ue.hooks.init.tap("transform",function(){ue.executeTrans()}),ue.init(),ue}return X()(Ne,[{key:"setData",value:function(rt,ue){this.rawData=rt,this.originData=rt,this.initCfg(ue),this.init(),this.emit("update")}},{key:"getClusters",value:function(rt){return this.clusterIndex.getClusters(this.extent,rt)}},{key:"getClustersLeaves",value:function(rt){return this.clusterIndex.getLeaves(rt,Infinity)}},{key:"updateClusterData",value:function(rt){var ue=this,ye=this.clusterOptions,Ue=ye.method,ft=Ue===void 0?"sum":Ue,Oe=ye.field,Ve=Object(ar.r)(Object(ar.h)(this.extent),2),P=this.clusterIndex.getClusters(Ve[0].concat(Ve[1]),Math.floor(rt));this.clusterOptions.zoom=rt,P.forEach(function(R){R.id||(R.properties.point_count=1)}),(Oe||bt()(ft))&&(P=P.map(function(R){var J=R.id;if(J){var de=ue.clusterIndex.getLeaves(J,Infinity),je=de.map(function(nt){return nt.properties}),We;if(ut()(ft)&&Oe){var gt=St(je,Oe);We=Wt[ft](gt)}bt()(ft)&&(We=ft(je)),R.properties.stat=We}else R.properties.point_count=1;return R})),this.data=Object(Ht.getParser)("geojson")({type:"FeatureCollection",features:P}),this.executeTrans()}},{key:"getFeatureById",value:function(rt){var ue=this.parser.type,ye=ue===void 0?"geojson":ue;if(ye==="geojson"&&!this.cluster){var Ue=rt<this.originData.features.length?this.originData.features[rt]:"null",ft=Mt()(Ue);if(this.transforms.length!==0){var Oe=this.data.dataArray.find(function(Ve){return Ve._id===rt});ft.properties=Oe}return ft}else return rt<this.data.dataArray.length?this.data.dataArray[rt]:"null"}},{key:"getFeatureId",value:function(rt,ue){var ye=this.data.dataArray.find(function(Ue){return Ue[rt]===name});return ye==null?void 0:ye._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"initCfg",value:function(rt){this.cfg=ce()(this.cfg,rt,be);var ue=this.cfg;ue&&(ue.parser&&(this.parser=ue.parser),ue.transforms&&(this.transforms=ue.transforms),this.cluster=ue.cluster||!1,ue.clusterOptions&&(this.cluster=!0,this.clusterOptions=H(H({},this.clusterOptions),ue.clusterOptions)))}},{key:"excuteParser",value:function(){var rt=this.parser,ue=rt.type||"geojson",ye=Object(Ht.getParser)(ue);this.data=ye(this.originData,rt),this.extent=Object(ar.m)(this.data.dataArray)}},{key:"executeTrans",value:function(){var rt=this,ue=this.transforms;ue.forEach(function(ye){var Ue=ye.type,ft=Object(Ht.getTransform)(Ue)(rt.data,ye);Object.assign(rt.data,ft)})}},{key:"initCluster",value:function(){if(!!this.cluster){var rt=this.clusterOptions||{};this.clusterIndex=Object(vt.a)(this.data,rt)}}},{key:"init",value:function(){this.hooks.init.call(this)}}]),Ne}($t.EventEmitter)},lJbI:function(we,x,a){"use strict";a.d(x,"a",function(){return S});function S(v,Z){var N=Z.extent,o=Z.width,X=Z.height,F=Z.min,K=Z.max,q={_id:1,dataArray:[{_id:1,data:Array.from(v),width:o,height:X,min:F,max:K,coordinates:[[N[0],N[1]],[N[2],N[3]]]}]};return q}},lwsE:function(we,x){function a(S,v){if(!(S instanceof v))throw new TypeError("Cannot call a class as a function")}we.exports=a},mNvP:function(we,x,a){(function(S,v){/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Z;(function(N){(function(o){var X=typeof v=="object"?v:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),F=K(N);typeof X.Reflect=="undefined"?X.Reflect=N:F=K(X.Reflect,F),o(F);function K(q,Ce){return function($,He){typeof q[$]!="function"&&Object.defineProperty(q,$,{configurable:!0,writable:!0,value:He}),Ce&&Ce($,He)}}})(function(o){var X=Object.prototype.hasOwnProperty,F=typeof Symbol=="function",K=F&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",q=F&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",Ce=typeof Object.create=="function",$={__proto__:[]}instanceof Array,He=!Ce&&!$,Be={create:Ce?function(){return ur(Object.create(null))}:$?function(){return ur({__proto__:null})}:function(){return ur({})},has:He?function(ct,ht){return X.call(ct,ht)}:function(ct,ht){return ht in ct},get:He?function(ct,ht){return X.call(ct,ht)?ct[ht]:void 0}:function(ct,ht){return ct[ht]}},ce=Object.getPrototypeOf(Function),st=typeof S=="object"&&Object({NODE_ENV:"production"})&&Object({NODE_ENV:"production"}).REFLECT_METADATA_USE_MAP_POLYFILL==="true",ut=!st&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:re(),Me=!st&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Je(),bt=!st&&typeof WeakMap=="function"?WeakMap:Gt(),xt=new bt;function Mt(ct,ht,Pt,pt){if(lt(Pt)){if(!R(ct))throw new TypeError;if(!de(ht))throw new TypeError;return Wt(ct,ht)}else{if(!R(ct))throw new TypeError;if(!ye(ht))throw new TypeError;if(!ye(pt)&&!lt(pt)&&!rt(pt))throw new TypeError;return rt(pt)&&(pt=void 0),Pt=P(Pt),St(ct,ht,Pt,pt)}}o("decorate",Mt);function De(ct,ht){function Pt(pt,Pe){if(!ye(pt))throw new TypeError;if(!lt(Pe)&&!je(Pe))throw new TypeError;me(ct,ht,pt,Pe)}return Pt}o("metadata",De);function ar(ct,ht,Pt,pt){if(!ye(Pt))throw new TypeError;return lt(pt)||(pt=P(pt)),me(ct,ht,Pt,pt)}o("defineMetadata",ar);function $t(ct,ht,Pt){if(!ye(ht))throw new TypeError;return lt(Pt)||(Pt=P(Pt)),H(ct,ht,Pt)}o("hasMetadata",$t);function Ht(ct,ht,Pt){if(!ye(ht))throw new TypeError;return lt(Pt)||(Pt=P(Pt)),z(ct,ht,Pt)}o("hasOwnMetadata",Ht);function vt(ct,ht,Pt){if(!ye(ht))throw new TypeError;return lt(Pt)||(Pt=P(Pt)),V(ct,ht,Pt)}o("getMetadata",vt);function Ze(ct,ht,Pt){if(!ye(ht))throw new TypeError;return lt(Pt)||(Pt=P(Pt)),be(ct,ht,Pt)}o("getOwnMetadata",Ze);function Et(ct,ht){if(!ye(ct))throw new TypeError;return lt(ht)||(ht=P(ht)),le(ct,ht)}o("getMetadataKeys",Et);function Le(ct,ht){if(!ye(ct))throw new TypeError;return lt(ht)||(ht=P(ht)),fe(ct,ht)}o("getOwnMetadataKeys",Le);function at(ct,ht,Pt){if(!ye(ht))throw new TypeError;lt(Pt)||(Pt=P(Pt));var pt=dt(ht,Pt,!1);if(lt(pt)||!pt.delete(ct))return!1;if(pt.size>0)return!0;var Pe=xt.get(ht);return Pe.delete(Pt),Pe.size>0||xt.delete(ht),!0}o("deleteMetadata",at);function Wt(ct,ht){for(var Pt=ct.length-1;Pt>=0;--Pt){var pt=ct[Pt],Pe=pt(ht);if(!lt(Pe)&&!rt(Pe)){if(!de(Pe))throw new TypeError;ht=Pe}}return ht}function St(ct,ht,Pt,pt){for(var Pe=ct.length-1;Pe>=0;--Pe){var ot=ct[Pe],$e=ot(ht,Pt,pt);if(!lt($e)&&!rt($e)){if(!ye($e))throw new TypeError;pt=$e}}return pt}function dt(ct,ht,Pt){var pt=xt.get(ct);if(lt(pt)){if(!Pt)return;pt=new ut,xt.set(ct,pt)}var Pe=pt.get(ht);if(lt(Pe)){if(!Pt)return;Pe=new ut,pt.set(ht,Pe)}return Pe}function H(ct,ht,Pt){var pt=z(ct,ht,Pt);if(pt)return!0;var Pe=Xe(ht);return rt(Pe)?!1:H(ct,Pe,Pt)}function z(ct,ht,Pt){var pt=dt(ht,Pt,!1);return lt(pt)?!1:Oe(pt.has(ct))}function V(ct,ht,Pt){var pt=z(ct,ht,Pt);if(pt)return be(ct,ht,Pt);var Pe=Xe(ht);if(!rt(Pe))return V(ct,Pe,Pt)}function be(ct,ht,Pt){var pt=dt(ht,Pt,!1);if(!lt(pt))return pt.get(ct)}function me(ct,ht,Pt,pt){var Pe=dt(Pt,pt,!0);Pe.set(ct,ht)}function le(ct,ht){var Pt=fe(ct,ht),pt=Xe(ct);if(pt===null)return Pt;var Pe=le(pt,ht);if(Pe.length<=0)return Pt;if(Pt.length<=0)return Pe;for(var ot=new Me,$e=[],Vt=0,dr=Pt;Vt<dr.length;Vt++){var Zr=dr[Vt],cr=ot.has(Zr);cr||(ot.add(Zr),$e.push(Zr))}for(var Un=0,Sn=Pe;Un<Sn.length;Un++){var Zr=Sn[Un],cr=ot.has(Zr);cr||(ot.add(Zr),$e.push(Zr))}return $e}function fe(ct,ht){var Pt=[],pt=dt(ct,ht,!1);if(lt(pt))return Pt;for(var Pe=pt.keys(),ot=gt(Pe),$e=0;;){var Vt=Nt(ot);if(!Vt)return Pt.length=$e,Pt;var dr=nt(Vt);try{Pt[$e]=dr}catch(Zr){try{Y(ot)}finally{throw Zr}}$e++}}function Ne(ct){if(ct===null)return 1;switch(typeof ct){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return ct===null?1:6;default:return 6}}function lt(ct){return ct===void 0}function rt(ct){return ct===null}function ue(ct){return typeof ct=="symbol"}function ye(ct){return typeof ct=="object"?ct!==null:typeof ct=="function"}function Ue(ct,ht){switch(Ne(ct)){case 0:return ct;case 1:return ct;case 2:return ct;case 3:return ct;case 4:return ct;case 5:return ct}var Pt=ht===3?"string":ht===5?"number":"default",pt=We(ct,K);if(pt!==void 0){var Pe=pt.call(ct,Pt);if(ye(Pe))throw new TypeError;return Pe}return ft(ct,Pt==="default"?"number":Pt)}function ft(ct,ht){if(ht==="string"){var Pt=ct.toString;if(J(Pt)){var pt=Pt.call(ct);if(!ye(pt))return pt}var Pe=ct.valueOf;if(J(Pe)){var pt=Pe.call(ct);if(!ye(pt))return pt}}else{var Pe=ct.valueOf;if(J(Pe)){var pt=Pe.call(ct);if(!ye(pt))return pt}var ot=ct.toString;if(J(ot)){var pt=ot.call(ct);if(!ye(pt))return pt}}throw new TypeError}function Oe(ct){return!!ct}function Ve(ct){return""+ct}function P(ct){var ht=Ue(ct,3);return ue(ht)?ht:Ve(ht)}function R(ct){return Array.isArray?Array.isArray(ct):ct instanceof Object?ct instanceof Array:Object.prototype.toString.call(ct)==="[object Array]"}function J(ct){return typeof ct=="function"}function de(ct){return typeof ct=="function"}function je(ct){switch(Ne(ct)){case 3:return!0;case 4:return!0;default:return!1}}function We(ct,ht){var Pt=ct[ht];if(Pt!=null){if(!J(Pt))throw new TypeError;return Pt}}function gt(ct){var ht=We(ct,q);if(!J(ht))throw new TypeError;var Pt=ht.call(ct);if(!ye(Pt))throw new TypeError;return Pt}function nt(ct){return ct.value}function Nt(ct){var ht=ct.next();return ht.done?!1:ht}function Y(ct){var ht=ct.return;ht&&ht.call(ct)}function Xe(ct){var ht=Object.getPrototypeOf(ct);if(typeof ct!="function"||ct===ce||ht!==ce)return ht;var Pt=ct.prototype,pt=Pt&&Object.getPrototypeOf(Pt);if(pt==null||pt===Object.prototype)return ht;var Pe=pt.constructor;return typeof Pe!="function"||Pe===ct?ht:Pe}function re(){var ct={},ht=[],Pt=function(){function $e(Vt,dr,Zr){this._index=0,this._keys=Vt,this._values=dr,this._selector=Zr}return $e.prototype["@@iterator"]=function(){return this},$e.prototype[q]=function(){return this},$e.prototype.next=function(){var Vt=this._index;if(Vt>=0&&Vt<this._keys.length){var dr=this._selector(this._keys[Vt],this._values[Vt]);return Vt+1>=this._keys.length?(this._index=-1,this._keys=ht,this._values=ht):this._index++,{value:dr,done:!1}}return{value:void 0,done:!0}},$e.prototype.throw=function(Vt){throw this._index>=0&&(this._index=-1,this._keys=ht,this._values=ht),Vt},$e.prototype.return=function(Vt){return this._index>=0&&(this._index=-1,this._keys=ht,this._values=ht),{value:Vt,done:!0}},$e}();return function(){function $e(){this._keys=[],this._values=[],this._cacheKey=ct,this._cacheIndex=-2}return Object.defineProperty($e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),$e.prototype.has=function(Vt){return this._find(Vt,!1)>=0},$e.prototype.get=function(Vt){var dr=this._find(Vt,!1);return dr>=0?this._values[dr]:void 0},$e.prototype.set=function(Vt,dr){var Zr=this._find(Vt,!0);return this._values[Zr]=dr,this},$e.prototype.delete=function(Vt){var dr=this._find(Vt,!1);if(dr>=0){for(var Zr=this._keys.length,cr=dr+1;cr<Zr;cr++)this._keys[cr-1]=this._keys[cr],this._values[cr-1]=this._values[cr];return this._keys.length--,this._values.length--,Vt===this._cacheKey&&(this._cacheKey=ct,this._cacheIndex=-2),!0}return!1},$e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=ct,this._cacheIndex=-2},$e.prototype.keys=function(){return new Pt(this._keys,this._values,pt)},$e.prototype.values=function(){return new Pt(this._keys,this._values,Pe)},$e.prototype.entries=function(){return new Pt(this._keys,this._values,ot)},$e.prototype["@@iterator"]=function(){return this.entries()},$e.prototype[q]=function(){return this.entries()},$e.prototype._find=function(Vt,dr){return this._cacheKey!==Vt&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Vt)),this._cacheIndex<0&&dr&&(this._cacheIndex=this._keys.length,this._keys.push(Vt),this._values.push(void 0)),this._cacheIndex},$e}();function pt($e,Vt){return $e}function Pe($e,Vt){return Vt}function ot($e,Vt){return[$e,Vt]}}function Je(){return function(){function ct(){this._map=new ut}return Object.defineProperty(ct.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),ct.prototype.has=function(ht){return this._map.has(ht)},ct.prototype.add=function(ht){return this._map.set(ht,ht),this},ct.prototype.delete=function(ht){return this._map.delete(ht)},ct.prototype.clear=function(){this._map.clear()},ct.prototype.keys=function(){return this._map.keys()},ct.prototype.values=function(){return this._map.values()},ct.prototype.entries=function(){return this._map.entries()},ct.prototype["@@iterator"]=function(){return this.keys()},ct.prototype[q]=function(){return this.keys()},ct}()}function Gt(){var ct=16,ht=Be.create(),Pt=pt();return function(){function dr(){this._key=pt()}return dr.prototype.has=function(Zr){var cr=Pe(Zr,!1);return cr!==void 0?Be.has(cr,this._key):!1},dr.prototype.get=function(Zr){var cr=Pe(Zr,!1);return cr!==void 0?Be.get(cr,this._key):void 0},dr.prototype.set=function(Zr,cr){var Un=Pe(Zr,!0);return Un[this._key]=cr,this},dr.prototype.delete=function(Zr){var cr=Pe(Zr,!1);return cr!==void 0?delete cr[this._key]:!1},dr.prototype.clear=function(){this._key=pt()},dr}();function pt(){var dr;do dr="@@WeakMap@@"+Vt();while(Be.has(ht,dr));return ht[dr]=!0,dr}function Pe(dr,Zr){if(!X.call(dr,Pt)){if(!Zr)return;Object.defineProperty(dr,Pt,{value:Be.create()})}return dr[Pt]}function ot(dr,Zr){for(var cr=0;cr<Zr;++cr)dr[cr]=Math.random()*255|0;return dr}function $e(dr){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(dr)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(dr)):ot(new Uint8Array(dr),dr):ot(new Array(dr),dr)}function Vt(){var dr=$e(ct);dr[6]=dr[6]&79|64,dr[8]=dr[8]&191|128;for(var Zr="",cr=0;cr<ct;++cr){var Un=dr[cr];(cr===4||cr===6||cr===8)&&(Zr+="-"),Un<16&&(Zr+="0"),Zr+=Un.toString(16).toLowerCase()}return Zr}}function ur(ct){return ct.__=void 0,delete ct.__,ct}})})(Z||(Z={}))}).call(this,a("Q2Ig"),a("yLpj"))},mTTR:function(we,x,a){var S=a("b80T"),v=a("QcOe"),Z=a("MMmD");function N(o){return Z(o)?S(o,!0):v(o)}we.exports=N},mc0g:function(we,x){function a(S){return function(v,Z,N){for(var o=-1,X=Object(v),F=N(v),K=F.length;K--;){var q=F[S?K:++o];if(Z(X[q],q,X)===!1)break}return v}}we.exports=a},mhV4:function(we,x,a){var S=a("ZK94");we.exports.geometry=v,we.exports.ring=N;function v(X){var F=0,K;switch(X.type){case"Polygon":return Z(X.coordinates);case"MultiPolygon":for(K=0;K<X.coordinates.length;K++)F+=Z(X.coordinates[K]);return F;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(K=0;K<X.geometries.length;K++)F+=v(X.geometries[K]);return F}}function Z(X){var F=0;if(X&&X.length>0){F+=Math.abs(N(X[0]));for(var K=1;K<X.length;K++)F-=Math.abs(N(X[K]))}return F}function N(X){var F,K,q,Ce,$,He,Be,ce=0,st=X.length;if(st>2){for(Be=0;Be<st;Be++)Be===st-2?(Ce=st-2,$=st-1,He=0):Be===st-1?(Ce=st-1,$=0,He=1):(Ce=Be,$=Be+1,He=Be+2),F=X[Ce],K=X[$],q=X[He],ce+=(o(q[0])-o(F[0]))*Math.sin(o(K[1]));ce=ce*S.RADIUS*S.RADIUS/2}return ce}function o(X){return X*Math.PI/180}},mpbz:function(we,x,a){(function(S,v){we.exports=v()})(this,function(){"use strict";function S(vt,Ze,Et,Le,at,Wt){if(!(at-Le<=Et)){var St=Le+at>>1;v(vt,Ze,St,Le,at,Wt%2),S(vt,Ze,Et,Le,St-1,Wt+1),S(vt,Ze,Et,St+1,at,Wt+1)}}function v(vt,Ze,Et,Le,at,Wt){for(;at>Le;){if(at-Le>600){var St=at-Le+1,dt=Et-Le+1,H=Math.log(St),z=.5*Math.exp(2*H/3),V=.5*Math.sqrt(H*z*(St-z)/St)*(dt-St/2<0?-1:1),be=Math.max(Le,Math.floor(Et-dt*z/St+V)),me=Math.min(at,Math.floor(Et+(St-dt)*z/St+V));v(vt,Ze,Et,be,me,Wt)}var le=Ze[2*Et+Wt],fe=Le,Ne=at;for(Z(vt,Ze,Le,Et),Ze[2*at+Wt]>le&&Z(vt,Ze,Le,at);fe<Ne;){for(Z(vt,Ze,fe,Ne),fe++,Ne--;Ze[2*fe+Wt]<le;)fe++;for(;Ze[2*Ne+Wt]>le;)Ne--}Ze[2*Le+Wt]===le?Z(vt,Ze,Le,Ne):(Ne++,Z(vt,Ze,Ne,at)),Ne<=Et&&(Le=Ne+1),Et<=Ne&&(at=Ne-1)}}function Z(vt,Ze,Et,Le){N(vt,Et,Le),N(Ze,2*Et,2*Le),N(Ze,2*Et+1,2*Le+1)}function N(vt,Ze,Et){var Le=vt[Ze];vt[Ze]=vt[Et],vt[Et]=Le}function o(vt,Ze,Et,Le,at,Wt,St){for(var dt=[0,vt.length-1,0],H=[],z,V;dt.length;){var be=dt.pop(),me=dt.pop(),le=dt.pop();if(me-le<=St){for(var fe=le;fe<=me;fe++)z=Ze[2*fe],V=Ze[2*fe+1],z>=Et&&z<=at&&V>=Le&&V<=Wt&&H.push(vt[fe]);continue}var Ne=Math.floor((le+me)/2);z=Ze[2*Ne],V=Ze[2*Ne+1],z>=Et&&z<=at&&V>=Le&&V<=Wt&&H.push(vt[Ne]);var lt=(be+1)%2;(be===0?Et<=z:Le<=V)&&(dt.push(le),dt.push(Ne-1),dt.push(lt)),(be===0?at>=z:Wt>=V)&&(dt.push(Ne+1),dt.push(me),dt.push(lt))}return H}function X(vt,Ze,Et,Le,at,Wt){for(var St=[0,vt.length-1,0],dt=[],H=at*at;St.length;){var z=St.pop(),V=St.pop(),be=St.pop();if(V-be<=Wt){for(var me=be;me<=V;me++)F(Ze[2*me],Ze[2*me+1],Et,Le)<=H&&dt.push(vt[me]);continue}var le=Math.floor((be+V)/2),fe=Ze[2*le],Ne=Ze[2*le+1];F(fe,Ne,Et,Le)<=H&&dt.push(vt[le]);var lt=(z+1)%2;(z===0?Et-at<=fe:Le-at<=Ne)&&(St.push(be),St.push(le-1),St.push(lt)),(z===0?Et+at>=fe:Le+at>=Ne)&&(St.push(le+1),St.push(V),St.push(lt))}return dt}function F(vt,Ze,Et,Le){var at=vt-Et,Wt=Ze-Le;return at*at+Wt*Wt}var K=function(Ze){return Ze[0]},q=function(Ze){return Ze[1]},Ce=function(Ze,Et,Le,at,Wt){Et===void 0&&(Et=K),Le===void 0&&(Le=q),at===void 0&&(at=64),Wt===void 0&&(Wt=Float64Array),this.nodeSize=at,this.points=Ze;for(var St=Ze.length<65536?Uint16Array:Uint32Array,dt=this.ids=new St(Ze.length),H=this.coords=new Wt(Ze.length*2),z=0;z<Ze.length;z++)dt[z]=z,H[2*z]=Et(Ze[z]),H[2*z+1]=Le(Ze[z]);S(dt,H,at,0,dt.length-1,0)};Ce.prototype.range=function(Ze,Et,Le,at){return o(this.ids,this.coords,Ze,Et,Le,at,this.nodeSize)},Ce.prototype.within=function(Ze,Et,Le){return X(this.ids,this.coords,Ze,Et,Le,this.nodeSize)};var $={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ze){return Ze}},He=Math.fround||function(vt){return function(Ze){return vt[0]=+Ze,vt[0]}}(new Float32Array(1)),Be=function(Ze){this.options=ar(Object.create($),Ze),this.trees=new Array(this.options.maxZoom+1)};Be.prototype.load=function(Ze){var Et=this.options,Le=Et.log,at=Et.minZoom,Wt=Et.maxZoom,St=Et.nodeSize;Le&&console.time("total time");var dt="prepare "+Ze.length+" points";Le&&console.time(dt),this.points=Ze;for(var H=[],z=0;z<Ze.length;z++)!Ze[z].geometry||H.push(st(Ze[z],z));this.trees[Wt+1]=new Ce(H,$t,Ht,St,Float32Array),Le&&console.timeEnd(dt);for(var V=Wt;V>=at;V--){var be=+Date.now();H=this._cluster(H,V),this.trees[V]=new Ce(H,$t,Ht,St,Float32Array),Le&&console.log("z%d: %d clusters in %dms",V,H.length,+Date.now()-be)}return Le&&console.timeEnd("total time"),this},Be.prototype.getClusters=function(Ze,Et){var Le=((Ze[0]+180)%360+360)%360-180,at=Math.max(-90,Math.min(90,Ze[1])),Wt=Ze[2]===180?180:((Ze[2]+180)%360+360)%360-180,St=Math.max(-90,Math.min(90,Ze[3]));if(Ze[2]-Ze[0]>=360)Le=-180,Wt=180;else if(Le>Wt){var dt=this.getClusters([Le,at,180,St],Et),H=this.getClusters([-180,at,Wt,St],Et);return dt.concat(H)}for(var z=this.trees[this._limitZoom(Et)],V=z.range(bt(Le),xt(St),bt(Wt),xt(at)),be=[],me=0,le=V;me<le.length;me+=1){var fe=le[me],Ne=z.points[fe];be.push(Ne.numPoints?ut(Ne):this.points[Ne.index])}return be},Be.prototype.getChildren=function(Ze){var Et=this._getOriginId(Ze),Le=this._getOriginZoom(Ze),at="No cluster with the specified id.",Wt=this.trees[Le];if(!Wt)throw new Error(at);var St=Wt.points[Et];if(!St)throw new Error(at);for(var dt=this.options.radius/(this.options.extent*Math.pow(2,Le-1)),H=Wt.within(St.x,St.y,dt),z=[],V=0,be=H;V<be.length;V+=1){var me=be[V],le=Wt.points[me];le.parentId===Ze&&z.push(le.numPoints?ut(le):this.points[le.index])}if(z.length===0)throw new Error(at);return z},Be.prototype.getLeaves=function(Ze,Et,Le){Et=Et||10,Le=Le||0;var at=[];return this._appendLeaves(at,Ze,Et,Le,0),at},Be.prototype.getTile=function(Ze,Et,Le){var at=this.trees[this._limitZoom(Ze)],Wt=Math.pow(2,Ze),St=this.options,dt=St.extent,H=St.radius,z=H/dt,V=(Le-z)/Wt,be=(Le+1+z)/Wt,me={features:[]};return this._addTileFeatures(at.range((Et-z)/Wt,V,(Et+1+z)/Wt,be),at.points,Et,Le,Wt,me),Et===0&&this._addTileFeatures(at.range(1-z/Wt,V,1,be),at.points,Wt,Le,Wt,me),Et===Wt-1&&this._addTileFeatures(at.range(0,V,z/Wt,be),at.points,-1,Le,Wt,me),me.features.length?me:null},Be.prototype.getClusterExpansionZoom=function(Ze){for(var Et=this._getOriginZoom(Ze)-1;Et<=this.options.maxZoom;){var Le=this.getChildren(Ze);if(Et++,Le.length!==1)break;Ze=Le[0].properties.cluster_id}return Et},Be.prototype._appendLeaves=function(Ze,Et,Le,at,Wt){for(var St=this.getChildren(Et),dt=0,H=St;dt<H.length;dt+=1){var z=H[dt],V=z.properties;if(V&&V.cluster?Wt+V.point_count<=at?Wt+=V.point_count:Wt=this._appendLeaves(Ze,V.cluster_id,Le,at,Wt):Wt<at?Wt++:Ze.push(z),Ze.length===Le)break}return Wt},Be.prototype._addTileFeatures=function(Ze,Et,Le,at,Wt,St){for(var dt=0,H=Ze;dt<H.length;dt+=1){var z=H[dt],V=Et[z],be=V.numPoints,me={type:1,geometry:[[Math.round(this.options.extent*(V.x*Wt-Le)),Math.round(this.options.extent*(V.y*Wt-at))]],tags:be?Me(V):this.points[V.index].properties},le=void 0;be?le=V.id:this.options.generateId?le=V.index:this.points[V.index].id&&(le=this.points[V.index].id),le!==void 0&&(me.id=le),St.features.push(me)}},Be.prototype._limitZoom=function(Ze){return Math.max(this.options.minZoom,Math.min(+Ze,this.options.maxZoom+1))},Be.prototype._cluster=function(Ze,Et){for(var Le=[],at=this.options,Wt=at.radius,St=at.extent,dt=at.reduce,H=at.minPoints,z=Wt/(St*Math.pow(2,Et)),V=0;V<Ze.length;V++){var be=Ze[V];if(!(be.zoom<=Et)){be.zoom=Et;for(var me=this.trees[Et+1],le=me.within(be.x,be.y,z),fe=be.numPoints||1,Ne=fe,lt=0,rt=le;lt<rt.length;lt+=1){var ue=rt[lt],ye=me.points[ue];ye.zoom>Et&&(Ne+=ye.numPoints||1)}if(Ne>=H){for(var Ue=be.x*fe,ft=be.y*fe,Oe=dt&&fe>1?this._map(be,!0):null,Ve=(V<<5)+(Et+1)+this.points.length,P=0,R=le;P<R.length;P+=1){var J=R[P],de=me.points[J];if(!(de.zoom<=Et)){de.zoom=Et;var je=de.numPoints||1;Ue+=de.x*je,ft+=de.y*je,de.parentId=Ve,dt&&(Oe||(Oe=this._map(be,!0)),dt(Oe,this._map(de)))}}be.parentId=Ve,Le.push(ce(Ue/Ne,ft/Ne,Ve,Ne,Oe))}else if(Le.push(be),Ne>1)for(var We=0,gt=le;We<gt.length;We+=1){var nt=gt[We],Nt=me.points[nt];Nt.zoom<=Et||(Nt.zoom=Et,Le.push(Nt))}}}return Le},Be.prototype._getOriginId=function(Ze){return Ze-this.points.length>>5},Be.prototype._getOriginZoom=function(Ze){return(Ze-this.points.length)%32},Be.prototype._map=function(Ze,Et){if(Ze.numPoints)return Et?ar({},Ze.properties):Ze.properties;var Le=this.points[Ze.index].properties,at=this.options.map(Le);return Et&&at===Le?ar({},at):at};function ce(vt,Ze,Et,Le,at){return{x:He(vt),y:He(Ze),zoom:Infinity,id:Et,parentId:-1,numPoints:Le,properties:at}}function st(vt,Ze){var Et=vt.geometry.coordinates,Le=Et[0],at=Et[1];return{x:He(bt(Le)),y:He(xt(at)),zoom:Infinity,index:Ze,parentId:-1}}function ut(vt){return{type:"Feature",id:vt.id,properties:Me(vt),geometry:{type:"Point",coordinates:[Mt(vt.x),De(vt.y)]}}}function Me(vt){var Ze=vt.numPoints,Et=Ze>=1e4?Math.round(Ze/1e3)+"k":Ze>=1e3?Math.round(Ze/100)/10+"k":Ze;return ar(ar({},vt.properties),{cluster:!0,cluster_id:vt.id,point_count:Ze,point_count_abbreviated:Et})}function bt(vt){return vt/360+.5}function xt(vt){var Ze=Math.sin(vt*Math.PI/180),Et=.5-.25*Math.log((1+Ze)/(1-Ze))/Math.PI;return Et<0?0:Et>1?1:Et}function Mt(vt){return(vt-.5)*360}function De(vt){var Ze=(180-vt*360)*Math.PI/180;return 360*Math.atan(Math.exp(Ze))/Math.PI-90}function ar(vt,Ze){for(var Et in Ze)vt[Et]=Ze[Et];return vt}function $t(vt){return vt.x}function Ht(vt){return vt.y}return Be})},"mv/X":function(we,x,a){var S=a("ljhN"),v=a("MMmD"),Z=a("wJg7"),N=a("GoyQ");function o(X,F,K){if(!N(K))return!1;var q=typeof F;return(q=="number"?v(K)&&Z(F,K.length):q=="string"&&F in K)?S(K[F],X):!1}we.exports=o},"n+fv":function(we,x,a){"use strict";a.r(x),a.d(x,"create",function(){return v}),a.d(x,"clone",function(){return Z}),a.d(x,"length",function(){return N}),a.d(x,"fromValues",function(){return o}),a.d(x,"copy",function(){return X}),a.d(x,"set",function(){return F}),a.d(x,"add",function(){return K}),a.d(x,"subtract",function(){return q}),a.d(x,"multiply",function(){return Ce}),a.d(x,"divide",function(){return $}),a.d(x,"ceil",function(){return He}),a.d(x,"floor",function(){return Be}),a.d(x,"min",function(){return ce}),a.d(x,"max",function(){return st}),a.d(x,"round",function(){return ut}),a.d(x,"scale",function(){return Me}),a.d(x,"scaleAndAdd",function(){return bt}),a.d(x,"distance",function(){return xt}),a.d(x,"squaredDistance",function(){return Mt}),a.d(x,"squaredLength",function(){return De}),a.d(x,"negate",function(){return ar}),a.d(x,"inverse",function(){return $t}),a.d(x,"normalize",function(){return Ht}),a.d(x,"dot",function(){return vt}),a.d(x,"cross",function(){return Ze}),a.d(x,"lerp",function(){return Et}),a.d(x,"hermite",function(){return Le}),a.d(x,"bezier",function(){return at}),a.d(x,"random",function(){return Wt}),a.d(x,"transformMat4",function(){return St}),a.d(x,"transformMat3",function(){return dt}),a.d(x,"transformQuat",function(){return H}),a.d(x,"rotateX",function(){return z}),a.d(x,"rotateY",function(){return V}),a.d(x,"rotateZ",function(){return be}),a.d(x,"angle",function(){return me}),a.d(x,"zero",function(){return le}),a.d(x,"str",function(){return fe}),a.d(x,"exactEquals",function(){return Ne}),a.d(x,"equals",function(){return lt}),a.d(x,"sub",function(){return rt}),a.d(x,"mul",function(){return ue}),a.d(x,"div",function(){return ye}),a.d(x,"dist",function(){return Ue}),a.d(x,"sqrDist",function(){return ft}),a.d(x,"len",function(){return Oe}),a.d(x,"sqrLen",function(){return Ve}),a.d(x,"forEach",function(){return P});var S=a("yU0y");function v(){var R=new S.a(3);return S.a!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function Z(R){var J=new S.a(3);return J[0]=R[0],J[1]=R[1],J[2]=R[2],J}function N(R){var J=R[0],de=R[1],je=R[2];return Math.hypot(J,de,je)}function o(R,J,de){var je=new S.a(3);return je[0]=R,je[1]=J,je[2]=de,je}function X(R,J){return R[0]=J[0],R[1]=J[1],R[2]=J[2],R}function F(R,J,de,je){return R[0]=J,R[1]=de,R[2]=je,R}function K(R,J,de){return R[0]=J[0]+de[0],R[1]=J[1]+de[1],R[2]=J[2]+de[2],R}function q(R,J,de){return R[0]=J[0]-de[0],R[1]=J[1]-de[1],R[2]=J[2]-de[2],R}function Ce(R,J,de){return R[0]=J[0]*de[0],R[1]=J[1]*de[1],R[2]=J[2]*de[2],R}function $(R,J,de){return R[0]=J[0]/de[0],R[1]=J[1]/de[1],R[2]=J[2]/de[2],R}function He(R,J){return R[0]=Math.ceil(J[0]),R[1]=Math.ceil(J[1]),R[2]=Math.ceil(J[2]),R}function Be(R,J){return R[0]=Math.floor(J[0]),R[1]=Math.floor(J[1]),R[2]=Math.floor(J[2]),R}function ce(R,J,de){return R[0]=Math.min(J[0],de[0]),R[1]=Math.min(J[1],de[1]),R[2]=Math.min(J[2],de[2]),R}function st(R,J,de){return R[0]=Math.max(J[0],de[0]),R[1]=Math.max(J[1],de[1]),R[2]=Math.max(J[2],de[2]),R}function ut(R,J){return R[0]=Math.round(J[0]),R[1]=Math.round(J[1]),R[2]=Math.round(J[2]),R}function Me(R,J,de){return R[0]=J[0]*de,R[1]=J[1]*de,R[2]=J[2]*de,R}function bt(R,J,de,je){return R[0]=J[0]+de[0]*je,R[1]=J[1]+de[1]*je,R[2]=J[2]+de[2]*je,R}function xt(R,J){var de=J[0]-R[0],je=J[1]-R[1],We=J[2]-R[2];return Math.hypot(de,je,We)}function Mt(R,J){var de=J[0]-R[0],je=J[1]-R[1],We=J[2]-R[2];return de*de+je*je+We*We}function De(R){var J=R[0],de=R[1],je=R[2];return J*J+de*de+je*je}function ar(R,J){return R[0]=-J[0],R[1]=-J[1],R[2]=-J[2],R}function $t(R,J){return R[0]=1/J[0],R[1]=1/J[1],R[2]=1/J[2],R}function Ht(R,J){var de=J[0],je=J[1],We=J[2],gt=de*de+je*je+We*We;return gt>0&&(gt=1/Math.sqrt(gt)),R[0]=J[0]*gt,R[1]=J[1]*gt,R[2]=J[2]*gt,R}function vt(R,J){return R[0]*J[0]+R[1]*J[1]+R[2]*J[2]}function Ze(R,J,de){var je=J[0],We=J[1],gt=J[2],nt=de[0],Nt=de[1],Y=de[2];return R[0]=We*Y-gt*Nt,R[1]=gt*nt-je*Y,R[2]=je*Nt-We*nt,R}function Et(R,J,de,je){var We=J[0],gt=J[1],nt=J[2];return R[0]=We+je*(de[0]-We),R[1]=gt+je*(de[1]-gt),R[2]=nt+je*(de[2]-nt),R}function Le(R,J,de,je,We,gt){var nt=gt*gt,Nt=nt*(2*gt-3)+1,Y=nt*(gt-2)+gt,Xe=nt*(gt-1),re=nt*(3-2*gt);return R[0]=J[0]*Nt+de[0]*Y+je[0]*Xe+We[0]*re,R[1]=J[1]*Nt+de[1]*Y+je[1]*Xe+We[1]*re,R[2]=J[2]*Nt+de[2]*Y+je[2]*Xe+We[2]*re,R}function at(R,J,de,je,We,gt){var nt=1-gt,Nt=nt*nt,Y=gt*gt,Xe=Nt*nt,re=3*gt*Nt,Je=3*Y*nt,Gt=Y*gt;return R[0]=J[0]*Xe+de[0]*re+je[0]*Je+We[0]*Gt,R[1]=J[1]*Xe+de[1]*re+je[1]*Je+We[1]*Gt,R[2]=J[2]*Xe+de[2]*re+je[2]*Je+We[2]*Gt,R}function Wt(R,J){J=J||1;var de=S.c()*2*Math.PI,je=S.c()*2-1,We=Math.sqrt(1-je*je)*J;return R[0]=Math.cos(de)*We,R[1]=Math.sin(de)*We,R[2]=je*J,R}function St(R,J,de){var je=J[0],We=J[1],gt=J[2],nt=de[3]*je+de[7]*We+de[11]*gt+de[15];return nt=nt||1,R[0]=(de[0]*je+de[4]*We+de[8]*gt+de[12])/nt,R[1]=(de[1]*je+de[5]*We+de[9]*gt+de[13])/nt,R[2]=(de[2]*je+de[6]*We+de[10]*gt+de[14])/nt,R}function dt(R,J,de){var je=J[0],We=J[1],gt=J[2];return R[0]=je*de[0]+We*de[3]+gt*de[6],R[1]=je*de[1]+We*de[4]+gt*de[7],R[2]=je*de[2]+We*de[5]+gt*de[8],R}function H(R,J,de){var je=de[0],We=de[1],gt=de[2],nt=de[3],Nt=J[0],Y=J[1],Xe=J[2],re=We*Xe-gt*Y,Je=gt*Nt-je*Xe,Gt=je*Y-We*Nt,ur=We*Gt-gt*Je,ct=gt*re-je*Gt,ht=je*Je-We*re,Pt=nt*2;return re*=Pt,Je*=Pt,Gt*=Pt,ur*=2,ct*=2,ht*=2,R[0]=Nt+re+ur,R[1]=Y+Je+ct,R[2]=Xe+Gt+ht,R}function z(R,J,de,je){var We=[],gt=[];return We[0]=J[0]-de[0],We[1]=J[1]-de[1],We[2]=J[2]-de[2],gt[0]=We[0],gt[1]=We[1]*Math.cos(je)-We[2]*Math.sin(je),gt[2]=We[1]*Math.sin(je)+We[2]*Math.cos(je),R[0]=gt[0]+de[0],R[1]=gt[1]+de[1],R[2]=gt[2]+de[2],R}function V(R,J,de,je){var We=[],gt=[];return We[0]=J[0]-de[0],We[1]=J[1]-de[1],We[2]=J[2]-de[2],gt[0]=We[2]*Math.sin(je)+We[0]*Math.cos(je),gt[1]=We[1],gt[2]=We[2]*Math.cos(je)-We[0]*Math.sin(je),R[0]=gt[0]+de[0],R[1]=gt[1]+de[1],R[2]=gt[2]+de[2],R}function be(R,J,de,je){var We=[],gt=[];return We[0]=J[0]-de[0],We[1]=J[1]-de[1],We[2]=J[2]-de[2],gt[0]=We[0]*Math.cos(je)-We[1]*Math.sin(je),gt[1]=We[0]*Math.sin(je)+We[1]*Math.cos(je),gt[2]=We[2],R[0]=gt[0]+de[0],R[1]=gt[1]+de[1],R[2]=gt[2]+de[2],R}function me(R,J){var de=R[0],je=R[1],We=R[2],gt=J[0],nt=J[1],Nt=J[2],Y=Math.sqrt(de*de+je*je+We*We),Xe=Math.sqrt(gt*gt+nt*nt+Nt*Nt),re=Y*Xe,Je=re&&vt(R,J)/re;return Math.acos(Math.min(Math.max(Je,-1),1))}function le(R){return R[0]=0,R[1]=0,R[2]=0,R}function fe(R){return"vec3("+R[0]+", "+R[1]+", "+R[2]+")"}function Ne(R,J){return R[0]===J[0]&&R[1]===J[1]&&R[2]===J[2]}function lt(R,J){var de=R[0],je=R[1],We=R[2],gt=J[0],nt=J[1],Nt=J[2];return Math.abs(de-gt)<=S.b*Math.max(1,Math.abs(de),Math.abs(gt))&&Math.abs(je-nt)<=S.b*Math.max(1,Math.abs(je),Math.abs(nt))&&Math.abs(We-Nt)<=S.b*Math.max(1,Math.abs(We),Math.abs(Nt))}var rt=q,ue=Ce,ye=$,Ue=xt,ft=Mt,Oe=N,Ve=De,P=function(){var R=v();return function(J,de,je,We,gt,nt){var Nt,Y;for(de||(de=3),je||(je=0),We?Y=Math.min(We*de+je,J.length):Y=J.length,Nt=je;Nt<Y;Nt+=de)R[0]=J[Nt],R[1]=J[Nt+1],R[2]=J[Nt+2],gt(R,R,nt),J[Nt]=R[0],J[Nt+1]=R[1],J[Nt+2]=R[2];return J}}()},n2J3:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.unmanaged=void 0;var S=a("xfSm"),v=a("GXnB"),Z=a("Ztfv");function N(){return function(o,X,F){var K=new v.Metadata(S.UNMANAGED_TAG,!0);Z.tagParameter(o,X,F,K)}}x.unmanaged=N},n3AX:function(we,x,a){var S=a("Nsbk");function v(Z,N){for(;!Object.prototype.hasOwnProperty.call(Z,N)&&(Z=S(Z),Z!==null););return Z}we.exports=v},"o+pz":function(we,x,a){"use strict";a.d(x,"a",function(){return S});var S;(function(v){v[v.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",v[v.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",v[v.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",v[v.POINTS=0]="POINTS",v[v.LINES=1]="LINES",v[v.LINE_LOOP=2]="LINE_LOOP",v[v.LINE_STRIP=3]="LINE_STRIP",v[v.TRIANGLES=4]="TRIANGLES",v[v.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",v[v.TRIANGLE_FAN=6]="TRIANGLE_FAN",v[v.ZERO=0]="ZERO",v[v.ONE=1]="ONE",v[v.SRC_COLOR=768]="SRC_COLOR",v[v.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",v[v.SRC_ALPHA=770]="SRC_ALPHA",v[v.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",v[v.DST_ALPHA=772]="DST_ALPHA",v[v.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",v[v.DST_COLOR=774]="DST_COLOR",v[v.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",v[v.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",v[v.FUNC_ADD=32774]="FUNC_ADD",v[v.BLEND_EQUATION=32777]="BLEND_EQUATION",v[v.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",v[v.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",v[v.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",v[v.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",v[v.MAX_EXT=32776]="MAX_EXT",v[v.MIN_EXT=32775]="MIN_EXT",v[v.BLEND_DST_RGB=32968]="BLEND_DST_RGB",v[v.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",v[v.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",v[v.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",v[v.CONSTANT_COLOR=32769]="CONSTANT_COLOR",v[v.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",v[v.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",v[v.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",v[v.BLEND_COLOR=32773]="BLEND_COLOR",v[v.ARRAY_BUFFER=34962]="ARRAY_BUFFER",v[v.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",v[v.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",v[v.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",v[v.STREAM_DRAW=35040]="STREAM_DRAW",v[v.STATIC_DRAW=35044]="STATIC_DRAW",v[v.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",v[v.BUFFER_SIZE=34660]="BUFFER_SIZE",v[v.BUFFER_USAGE=34661]="BUFFER_USAGE",v[v.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",v[v.FRONT=1028]="FRONT",v[v.BACK=1029]="BACK",v[v.FRONT_AND_BACK=1032]="FRONT_AND_BACK",v[v.CULL_FACE=2884]="CULL_FACE",v[v.BLEND=3042]="BLEND",v[v.DITHER=3024]="DITHER",v[v.STENCIL_TEST=2960]="STENCIL_TEST",v[v.DEPTH_TEST=2929]="DEPTH_TEST",v[v.SCISSOR_TEST=3089]="SCISSOR_TEST",v[v.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",v[v.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",v[v.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",v[v.NO_ERROR=0]="NO_ERROR",v[v.INVALID_ENUM=1280]="INVALID_ENUM",v[v.INVALID_VALUE=1281]="INVALID_VALUE",v[v.INVALID_OPERATION=1282]="INVALID_OPERATION",v[v.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",v[v.CW=2304]="CW",v[v.CCW=2305]="CCW",v[v.LINE_WIDTH=2849]="LINE_WIDTH",v[v.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",v[v.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",v[v.CULL_FACE_MODE=2885]="CULL_FACE_MODE",v[v.FRONT_FACE=2886]="FRONT_FACE",v[v.DEPTH_RANGE=2928]="DEPTH_RANGE",v[v.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",v[v.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",v[v.DEPTH_FUNC=2932]="DEPTH_FUNC",v[v.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",v[v.STENCIL_FUNC=2962]="STENCIL_FUNC",v[v.STENCIL_FAIL=2964]="STENCIL_FAIL",v[v.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",v[v.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",v[v.STENCIL_REF=2967]="STENCIL_REF",v[v.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",v[v.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",v[v.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",v[v.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",v[v.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",v[v.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",v[v.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",v[v.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",v[v.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",v[v.VIEWPORT=2978]="VIEWPORT",v[v.SCISSOR_BOX=3088]="SCISSOR_BOX",v[v.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",v[v.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",v[v.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",v[v.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",v[v.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",v[v.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",v[v.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",v[v.RED_BITS=3410]="RED_BITS",v[v.GREEN_BITS=3411]="GREEN_BITS",v[v.BLUE_BITS=3412]="BLUE_BITS",v[v.ALPHA_BITS=3413]="ALPHA_BITS",v[v.DEPTH_BITS=3414]="DEPTH_BITS",v[v.STENCIL_BITS=3415]="STENCIL_BITS",v[v.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",v[v.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",v[v.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",v[v.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",v[v.SAMPLES=32937]="SAMPLES",v[v.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",v[v.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",v[v.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",v[v.DONT_CARE=4352]="DONT_CARE",v[v.FASTEST=4353]="FASTEST",v[v.NICEST=4354]="NICEST",v[v.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",v[v.BYTE=5120]="BYTE",v[v.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",v[v.SHORT=5122]="SHORT",v[v.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",v[v.INT=5124]="INT",v[v.UNSIGNED_INT=5125]="UNSIGNED_INT",v[v.FLOAT=5126]="FLOAT",v[v.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",v[v.ALPHA=6406]="ALPHA",v[v.RGB=6407]="RGB",v[v.RGBA=6408]="RGBA",v[v.LUMINANCE=6409]="LUMINANCE",v[v.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",v[v.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",v[v.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",v[v.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",v[v.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",v[v.VERTEX_SHADER=35633]="VERTEX_SHADER",v[v.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",v[v.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",v[v.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",v[v.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",v[v.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",v[v.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",v[v.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",v[v.SHADER_TYPE=35663]="SHADER_TYPE",v[v.DELETE_STATUS=35712]="DELETE_STATUS",v[v.LINK_STATUS=35714]="LINK_STATUS",v[v.VALIDATE_STATUS=35715]="VALIDATE_STATUS",v[v.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",v[v.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",v[v.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",v[v.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",v[v.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",v[v.NEVER=512]="NEVER",v[v.LESS=513]="LESS",v[v.EQUAL=514]="EQUAL",v[v.LEQUAL=515]="LEQUAL",v[v.GREATER=516]="GREATER",v[v.NOTEQUAL=517]="NOTEQUAL",v[v.GEQUAL=518]="GEQUAL",v[v.ALWAYS=519]="ALWAYS",v[v.KEEP=7680]="KEEP",v[v.REPLACE=7681]="REPLACE",v[v.INCR=7682]="INCR",v[v.DECR=7683]="DECR",v[v.INVERT=5386]="INVERT",v[v.INCR_WRAP=34055]="INCR_WRAP",v[v.DECR_WRAP=34056]="DECR_WRAP",v[v.VENDOR=7936]="VENDOR",v[v.RENDERER=7937]="RENDERER",v[v.VERSION=7938]="VERSION",v[v.NEAREST=9728]="NEAREST",v[v.LINEAR=9729]="LINEAR",v[v.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",v[v.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",v[v.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",v[v.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",v[v.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",v[v.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",v[v.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",v[v.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",v[v.TEXTURE_2D=3553]="TEXTURE_2D",v[v.TEXTURE=5890]="TEXTURE",v[v.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",v[v.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",v[v.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",v[v.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",v[v.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",v[v.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",v[v.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",v[v.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",v[v.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",v[v.TEXTURE0=33984]="TEXTURE0",v[v.TEXTURE1=33985]="TEXTURE1",v[v.TEXTURE2=33986]="TEXTURE2",v[v.TEXTURE3=33987]="TEXTURE3",v[v.TEXTURE4=33988]="TEXTURE4",v[v.TEXTURE5=33989]="TEXTURE5",v[v.TEXTURE6=33990]="TEXTURE6",v[v.TEXTURE7=33991]="TEXTURE7",v[v.TEXTURE8=33992]="TEXTURE8",v[v.TEXTURE9=33993]="TEXTURE9",v[v.TEXTURE10=33994]="TEXTURE10",v[v.TEXTURE11=33995]="TEXTURE11",v[v.TEXTURE12=33996]="TEXTURE12",v[v.TEXTURE13=33997]="TEXTURE13",v[v.TEXTURE14=33998]="TEXTURE14",v[v.TEXTURE15=33999]="TEXTURE15",v[v.TEXTURE16=34e3]="TEXTURE16",v[v.TEXTURE17=34001]="TEXTURE17",v[v.TEXTURE18=34002]="TEXTURE18",v[v.TEXTURE19=34003]="TEXTURE19",v[v.TEXTURE20=34004]="TEXTURE20",v[v.TEXTURE21=34005]="TEXTURE21",v[v.TEXTURE22=34006]="TEXTURE22",v[v.TEXTURE23=34007]="TEXTURE23",v[v.TEXTURE24=34008]="TEXTURE24",v[v.TEXTURE25=34009]="TEXTURE25",v[v.TEXTURE26=34010]="TEXTURE26",v[v.TEXTURE27=34011]="TEXTURE27",v[v.TEXTURE28=34012]="TEXTURE28",v[v.TEXTURE29=34013]="TEXTURE29",v[v.TEXTURE30=34014]="TEXTURE30",v[v.TEXTURE31=34015]="TEXTURE31",v[v.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",v[v.REPEAT=10497]="REPEAT",v[v.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",v[v.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",v[v.FLOAT_VEC2=35664]="FLOAT_VEC2",v[v.FLOAT_VEC3=35665]="FLOAT_VEC3",v[v.FLOAT_VEC4=35666]="FLOAT_VEC4",v[v.INT_VEC2=35667]="INT_VEC2",v[v.INT_VEC3=35668]="INT_VEC3",v[v.INT_VEC4=35669]="INT_VEC4",v[v.BOOL=35670]="BOOL",v[v.BOOL_VEC2=35671]="BOOL_VEC2",v[v.BOOL_VEC3=35672]="BOOL_VEC3",v[v.BOOL_VEC4=35673]="BOOL_VEC4",v[v.FLOAT_MAT2=35674]="FLOAT_MAT2",v[v.FLOAT_MAT3=35675]="FLOAT_MAT3",v[v.FLOAT_MAT4=35676]="FLOAT_MAT4",v[v.SAMPLER_2D=35678]="SAMPLER_2D",v[v.SAMPLER_CUBE=35680]="SAMPLER_CUBE",v[v.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",v[v.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",v[v.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",v[v.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",v[v.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",v[v.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",v[v.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",v[v.COMPILE_STATUS=35713]="COMPILE_STATUS",v[v.LOW_FLOAT=36336]="LOW_FLOAT",v[v.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",v[v.HIGH_FLOAT=36338]="HIGH_FLOAT",v[v.LOW_INT=36339]="LOW_INT",v[v.MEDIUM_INT=36340]="MEDIUM_INT",v[v.HIGH_INT=36341]="HIGH_INT",v[v.FRAMEBUFFER=36160]="FRAMEBUFFER",v[v.RENDERBUFFER=36161]="RENDERBUFFER",v[v.RGBA4=32854]="RGBA4",v[v.RGB5_A1=32855]="RGB5_A1",v[v.RGB565=36194]="RGB565",v[v.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",v[v.STENCIL_INDEX=6401]="STENCIL_INDEX",v[v.STENCIL_INDEX8=36168]="STENCIL_INDEX8",v[v.DEPTH_STENCIL=34041]="DEPTH_STENCIL",v[v.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",v[v.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",v[v.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",v[v.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",v[v.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",v[v.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",v[v.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",v[v.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",v[v.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",v[v.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",v[v.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",v[v.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",v[v.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",v[v.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",v[v.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",v[v.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",v[v.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",v[v.NONE=0]="NONE",v[v.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",v[v.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",v[v.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",v[v.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",v[v.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",v[v.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",v[v.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",v[v.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",v[v.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",v[v.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",v[v.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",v[v.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",v[v.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",v[v.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(S||(S={}))},"oCl/":function(we,x,a){var S=a("CH3K"),v=a("LcsW"),Z=a("MvSz"),N=a("0ycA"),o=Object.getOwnPropertySymbols,X=o?function(F){for(var K=[];F;)S(K,Z(F)),F=v(F);return K}:N;we.exports=X},oIFs:function(we,x,a){we.exports={"ant-skeleton":"ant-skeleton","ant-skeleton-header":"ant-skeleton-header","ant-skeleton-avatar":"ant-skeleton-avatar","ant-skeleton-avatar-circle":"ant-skeleton-avatar-circle","ant-skeleton-avatar-lg":"ant-skeleton-avatar-lg","ant-skeleton-avatar-sm":"ant-skeleton-avatar-sm","ant-skeleton-content":"ant-skeleton-content","ant-skeleton-title":"ant-skeleton-title","ant-skeleton-paragraph":"ant-skeleton-paragraph","ant-skeleton-with-avatar":"ant-skeleton-with-avatar","ant-skeleton-round":"ant-skeleton-round","ant-skeleton-active":"ant-skeleton-active","ant-skeleton-loading":"ant-skeleton-loading","ant-skeleton-button":"ant-skeleton-button","ant-skeleton-input":"ant-skeleton-input","ant-skeleton-image":"ant-skeleton-image","ant-skeleton-element":"ant-skeleton-element","ant-skeleton-button-circle":"ant-skeleton-button-circle","ant-skeleton-button-round":"ant-skeleton-button-round","ant-skeleton-button-lg":"ant-skeleton-button-lg","ant-skeleton-button-sm":"ant-skeleton-button-sm","ant-skeleton-input-lg":"ant-skeleton-input-lg","ant-skeleton-input-sm":"ant-skeleton-input-sm","ant-skeleton-image-circle":"ant-skeleton-image-circle","ant-skeleton-image-path":"ant-skeleton-image-path","ant-skeleton-image-svg":"ant-skeleton-image-svg","ant-skeleton-rtl":"ant-skeleton-rtl","ant-skeleton-loading-rtl":"ant-skeleton-loading-rtl"}},oShl:function(we,x,a){var S=a("Nsbk"),v=a("SksO"),Z=a("xfeJ"),N=a("sXyB");function o(X){var F=typeof Map=="function"?new Map:void 0;return we.exports=o=function(q){if(q===null||!Z(q))return q;if(typeof q!="function")throw new TypeError("Super expression must either be null or a function");if(typeof F!="undefined"){if(F.has(q))return F.get(q);F.set(q,Ce)}function Ce(){return N(q,arguments,S(this).constructor)}return Ce.prototype=Object.create(q.prototype,{constructor:{value:Ce,enumerable:!1,writable:!0,configurable:!0}}),v(Ce,q)},o(X)}we.exports=o},oaX6:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.targetName=void 0;var S=a("xfSm"),v=a("GXnB"),Z=a("Ztfv");function N(o){return function(X,F,K){var q=new v.Metadata(S.NAME_TAG,o);Z.tagParameter(X,F,K,q)}}x.targetName=N},"otv/":function(we,x,a){var S=a("nmnc"),v=S?S.prototype:void 0,Z=v?v.valueOf:void 0;function N(o){return Z?Object(Z.call(o)):{}}we.exports=N},"oy+k":function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.Context=void 0;var S=a("d9O0"),v=function(){function Z(N){this.id=S.id(),this.container=N}return Z.prototype.addPlan=function(N){this.plan=N},Z.prototype.setCurrentRequest=function(N){this.currentRequest=N},Z}();x.Context=v},pFRH:function(we,x,a){var S=a("cvCv"),v=a("O0oS"),Z=a("zZ0H"),N=v?function(o,X){return v(o,"toString",{configurable:!0,enumerable:!1,value:S(X),writable:!0})}:Z;we.exports=N},q4HE:function(we,x){var a="\\ud800-\\udfff",S="\\u0300-\\u036f",v="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",N=S+v+Z,o="\\ufe0e\\ufe0f",X="["+a+"]",F="["+N+"]",K="\\ud83c[\\udffb-\\udfff]",q="(?:"+F+"|"+K+")",Ce="[^"+a+"]",$="(?:\\ud83c[\\udde6-\\uddff]){2}",He="[\\ud800-\\udbff][\\udc00-\\udfff]",Be="\\u200d",ce=q+"?",st="["+o+"]?",ut="(?:"+Be+"(?:"+[Ce,$,He].join("|")+")"+st+ce+")*",Me=st+ce+ut,bt="(?:"+[Ce+F+"?",F,$,He,X].join("|")+")",xt=RegExp(K+"(?="+K+")|"+bt+Me,"g");function Mt(De){for(var ar=xt.lastIndex=0;xt.test(De);)++ar;return ar}we.exports=Mt},qK8v:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.isStackOverflowExeption=void 0;var S=a("MON2");function v(Z){return Z instanceof RangeError||Z.message===S.STACK_OVERFLOW}x.isStackOverflowExeption=v},qRkn:function(we,x,a){var S=a("3cYt"),v={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Z=S(v);we.exports=Z},qd8s:function(we,x,a){(function(S,v){var Z=200,N="__lodash_hash_undefined__",o=800,X=16,F=9007199254740991,K="[object Arguments]",q="[object Array]",Ce="[object AsyncFunction]",$="[object Boolean]",He="[object Date]",Be="[object Error]",ce="[object Function]",st="[object GeneratorFunction]",ut="[object Map]",Me="[object Number]",bt="[object Null]",xt="[object Object]",Mt="[object Proxy]",De="[object RegExp]",ar="[object Set]",$t="[object String]",Ht="[object Undefined]",vt="[object WeakMap]",Ze="[object ArrayBuffer]",Et="[object DataView]",Le="[object Float32Array]",at="[object Float64Array]",Wt="[object Int8Array]",St="[object Int16Array]",dt="[object Int32Array]",H="[object Uint8Array]",z="[object Uint8ClampedArray]",V="[object Uint16Array]",be="[object Uint32Array]",me=/[\\^$.*+?()[\]{}|]/g,le=/^\[object .+?Constructor\]$/,fe=/^(?:0|[1-9]\d*)$/,Ne={};Ne[Le]=Ne[at]=Ne[Wt]=Ne[St]=Ne[dt]=Ne[H]=Ne[z]=Ne[V]=Ne[be]=!0,Ne[K]=Ne[q]=Ne[Ze]=Ne[$]=Ne[Et]=Ne[He]=Ne[Be]=Ne[ce]=Ne[ut]=Ne[Me]=Ne[xt]=Ne[De]=Ne[ar]=Ne[$t]=Ne[vt]=!1;var lt=typeof S=="object"&&S&&S.Object===Object&&S,rt=typeof self=="object"&&self&&self.Object===Object&&self,ue=lt||rt||Function("return this")(),ye=x&&!x.nodeType&&x,Ue=ye&&typeof v=="object"&&v&&!v.nodeType&&v,ft=Ue&&Ue.exports===ye,Oe=ft&&lt.process,Ve=function(){try{var Ot=Ue&&Ue.require&&Ue.require("util").types;return Ot||Oe&&Oe.binding&&Oe.binding("util")}catch(tr){}}(),P=Ve&&Ve.isTypedArray;function R(Ot,tr,Mr){switch(Mr.length){case 0:return Ot.call(tr);case 1:return Ot.call(tr,Mr[0]);case 2:return Ot.call(tr,Mr[0],Mr[1]);case 3:return Ot.call(tr,Mr[0],Mr[1],Mr[2])}return Ot.apply(tr,Mr)}function J(Ot,tr){for(var Mr=-1,Xn=Array(Ot);++Mr<Ot;)Xn[Mr]=tr(Mr);return Xn}function de(Ot){return function(tr){return Ot(tr)}}function je(Ot,tr){return Ot==null?void 0:Ot[tr]}function We(Ot,tr){return function(Mr){return Ot(tr(Mr))}}var gt=Array.prototype,nt=Function.prototype,Nt=Object.prototype,Y=ue["__core-js_shared__"],Xe=nt.toString,re=Nt.hasOwnProperty,Je=function(){var Ot=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||"");return Ot?"Symbol(src)_1."+Ot:""}(),Gt=Nt.toString,ur=Xe.call(Object),ct=RegExp("^"+Xe.call(re).replace(me,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ht=ft?ue.Buffer:void 0,Pt=ue.Symbol,pt=ue.Uint8Array,Pe=ht?ht.allocUnsafe:void 0,ot=We(Object.getPrototypeOf,Object),$e=Object.create,Vt=Nt.propertyIsEnumerable,dr=gt.splice,Zr=Pt?Pt.toStringTag:void 0,cr=function(){try{var Ot=Tu(Object,"defineProperty");return Ot({},"",{}),Ot}catch(tr){}}(),Un=ht?ht.isBuffer:void 0,Sn=Math.max,ni=Date.now,fi=Tu(ue,"Map"),Wn=Tu(Object,"create"),Gn=function(){function Ot(){}return function(tr){if(!bo(tr))return{};if($e)return $e(tr);Ot.prototype=tr;var Mr=new Ot;return Ot.prototype=void 0,Mr}}();function Ee(Ot){var tr=-1,Mr=Ot==null?0:Ot.length;for(this.clear();++tr<Mr;){var Xn=Ot[tr];this.set(Xn[0],Xn[1])}}function pe(){this.__data__=Wn?Wn(null):{},this.size=0}function W(Ot){var tr=this.has(Ot)&&delete this.__data__[Ot];return this.size-=tr?1:0,tr}function ae(Ot){var tr=this.__data__;if(Wn){var Mr=tr[Ot];return Mr===N?void 0:Mr}return re.call(tr,Ot)?tr[Ot]:void 0}function Ie(Ot){var tr=this.__data__;return Wn?tr[Ot]!==void 0:re.call(tr,Ot)}function qe(Ot,tr){var Mr=this.__data__;return this.size+=this.has(Ot)?0:1,Mr[Ot]=Wn&&tr===void 0?N:tr,this}Ee.prototype.clear=pe,Ee.prototype.delete=W,Ee.prototype.get=ae,Ee.prototype.has=Ie,Ee.prototype.set=qe;function Ct(Ot){var tr=-1,Mr=Ot==null?0:Ot.length;for(this.clear();++tr<Mr;){var Xn=Ot[tr];this.set(Xn[0],Xn[1])}}function Re(){this.__data__=[],this.size=0}function mt(Ot){var tr=this.__data__,Mr=eo(tr,Ot);if(Mr<0)return!1;var Xn=tr.length-1;return Mr==Xn?tr.pop():dr.call(tr,Mr,1),--this.size,!0}function Qt(Ot){var tr=this.__data__,Mr=eo(tr,Ot);return Mr<0?void 0:tr[Mr][1]}function Br(Ot){return eo(this.__data__,Ot)>-1}function Ur(Ot,tr){var Mr=this.__data__,Xn=eo(Mr,Ot);return Xn<0?(++this.size,Mr.push([Ot,tr])):Mr[Xn][1]=tr,this}Ct.prototype.clear=Re,Ct.prototype.delete=mt,Ct.prototype.get=Qt,Ct.prototype.has=Br,Ct.prototype.set=Ur;function or(Ot){var tr=-1,Mr=Ot==null?0:Ot.length;for(this.clear();++tr<Mr;){var Xn=Ot[tr];this.set(Xn[0],Xn[1])}}function Vr(){this.size=0,this.__data__={hash:new Ee,map:new(fi||Ct),string:new Ee}}function An(Ot){var tr=co(this,Ot).delete(Ot);return this.size-=tr?1:0,tr}function dn(Ot){return co(this,Ot).get(Ot)}function Cr(Ot){return co(this,Ot).has(Ot)}function Tn(Ot,tr){var Mr=co(this,Ot),Xn=Mr.size;return Mr.set(Ot,tr),this.size+=Mr.size==Xn?0:1,this}or.prototype.clear=Vr,or.prototype.delete=An,or.prototype.get=dn,or.prototype.has=Cr,or.prototype.set=Tn;function fn(Ot){var tr=this.__data__=new Ct(Ot);this.size=tr.size}function En(){this.__data__=new Ct,this.size=0}function Cn(Ot){var tr=this.__data__,Mr=tr.delete(Ot);return this.size=tr.size,Mr}function pn(Ot){return this.__data__.get(Ot)}function Lr(Ot){return this.__data__.has(Ot)}function hi(Ot,tr){var Mr=this.__data__;if(Mr instanceof Ct){var Xn=Mr.__data__;if(!fi||Xn.length<Z-1)return Xn.push([Ot,tr]),this.size=++Mr.size,this;Mr=this.__data__=new or(Xn)}return Mr.set(Ot,tr),this.size=Mr.size,this}fn.prototype.clear=En,fn.prototype.delete=Cn,fn.prototype.get=pn,fn.prototype.has=Lr,fn.prototype.set=hi;function xi(Ot,tr){var Mr=zl(Ot),Xn=!Mr&&Hu(Ot),Wi=!Mr&&!Xn&&Nl(Ot),oa=!Mr&&!Xn&&!Wi&&Js(Ot),Xa=Mr||Xn||Wi||oa,zi=Xa?J(Ot.length,String):[],La=zi.length;for(var Do in Ot)(tr||re.call(Ot,Do))&&!(Xa&&(Do=="length"||Wi&&(Do=="offset"||Do=="parent")||oa&&(Do=="buffer"||Do=="byteLength"||Do=="byteOffset")||_s(Do,La)))&&zi.push(Do);return zi}function ki(Ot,tr,Mr){(Mr!==void 0&&!Ro(Ot[tr],Mr)||Mr===void 0&&!(tr in Ot))&&pi(Ot,tr,Mr)}function _i(Ot,tr,Mr){var Xn=Ot[tr];(!(re.call(Ot,tr)&&Ro(Xn,Mr))||Mr===void 0&&!(tr in Ot))&&pi(Ot,tr,Mr)}function eo(Ot,tr){for(var Mr=Ot.length;Mr--;)if(Ro(Ot[Mr][0],tr))return Mr;return-1}function pi(Ot,tr,Mr){tr=="__proto__"&&cr?cr(Ot,tr,{configurable:!0,enumerable:!0,value:Mr,writable:!0}):Ot[tr]=Mr}var Ta=yo();function Di(Ot){return Ot==null?Ot===void 0?Ht:bt:Zr&&Zr in Object(Ot)?as(Ot):nn(Ot)}function bi(Ot){return $s(Ot)&&Di(Ot)==K}function ci(Ot){if(!bo(Ot)||ze(Ot))return!1;var tr=vs(Ot)?ct:le;return tr.test(_o(Ot))}function ja(Ot){return $s(Ot)&&fu(Ot.length)&&!!Ne[Di(Ot)]}function ps(Ot){if(!bo(Ot))return fr(Ot);var tr=It(Ot),Mr=[];for(var Xn in Ot)Xn=="constructor"&&(tr||!re.call(Ot,Xn))||Mr.push(Xn);return Mr}function to(Ot,tr,Mr,Xn,Wi){Ot!==tr&&Ta(tr,function(oa,Xa){if(Wi||(Wi=new fn),bo(oa))lo(Ot,tr,Xa,Mr,to,Xn,Wi);else{var zi=Xn?Xn(Vn(Ot,Xa),oa,Xa+"",Ot,tr,Wi):void 0;zi===void 0&&(zi=oa),ki(Ot,Xa,zi)}},wa)}function lo(Ot,tr,Mr,Xn,Wi,oa,Xa){var zi=Vn(Ot,Mr),La=Vn(tr,Mr),Do=Xa.get(La);if(Do){ki(Ot,Mr,Do);return}var ms=oa?oa(zi,La,Mr+"",Ot,tr,Xa):void 0,Aa=ms===void 0;if(Aa){var Sl=zl(La),du=!Sl&&Nl(La),os=!Sl&&!du&&Js(La);ms=La,Sl||du||os?zl(zi)?ms=zi:nf(zi)?ms=Ya(zi):du?(Aa=!1,ms=Oa(La,!0)):os?(Aa=!1,ms=ca(La,!0)):ms=[]:Zu(La)||Hu(La)?(ms=zi,Hu(zi)?ms=Wu(zi):(!bo(zi)||vs(zi))&&(ms=bl(La))):Aa=!1}Aa&&(Xa.set(La,ms),Wi(ms,La,Xn,oa,Xa),Xa.delete(La)),ki(Ot,Mr,ms)}function Gu(Ot,tr){return Ua(yn(Ot,tr,Xu),Ot+"")}var qi=cr?function(Ot,tr){return cr(Ot,"toString",{configurable:!0,enumerable:!1,value:hu(tr),writable:!0})}:Xu;function Oa(Ot,tr){if(tr)return Ot.slice();var Mr=Ot.length,Xn=Pe?Pe(Mr):new Ot.constructor(Mr);return Ot.copy(Xn),Xn}function is(Ot){var tr=new Ot.constructor(Ot.byteLength);return new pt(tr).set(new pt(Ot)),tr}function ca(Ot,tr){var Mr=tr?is(Ot.buffer):Ot.buffer;return new Ot.constructor(Mr,Ot.byteOffset,Ot.length)}function Ya(Ot,tr){var Mr=-1,Xn=Ot.length;for(tr||(tr=Array(Xn));++Mr<Xn;)tr[Mr]=Ot[Mr];return tr}function qo(Ot,tr,Mr,Xn){var Wi=!Mr;Mr||(Mr={});for(var oa=-1,Xa=tr.length;++oa<Xa;){var zi=tr[oa],La=Xn?Xn(Mr[zi],Ot[zi],zi,Mr,Ot):void 0;La===void 0&&(La=Ot[zi]),Wi?pi(Mr,zi,La):_i(Mr,zi,La)}return Mr}function sa(Ot){return Gu(function(tr,Mr){var Xn=-1,Wi=Mr.length,oa=Wi>1?Mr[Wi-1]:void 0,Xa=Wi>2?Mr[2]:void 0;for(oa=Ot.length>3&&typeof oa=="function"?(Wi--,oa):void 0,Xa&&Lo(Mr[0],Mr[1],Xa)&&(oa=Wi<3?void 0:oa,Wi=1),tr=Object(tr);++Xn<Wi;){var zi=Mr[Xn];zi&&Ot(tr,zi,Xn,oa)}return tr})}function yo(Ot){return function(tr,Mr,Xn){for(var Wi=-1,oa=Object(tr),Xa=Xn(tr),zi=Xa.length;zi--;){var La=Xa[Ot?zi:++Wi];if(Mr(oa[La],La,oa)===!1)break}return tr}}function co(Ot,tr){var Mr=Ot.__data__;return kt(tr)?Mr[typeof tr=="string"?"string":"hash"]:Mr.map}function Tu(Ot,tr){var Mr=je(Ot,tr);return ci(Mr)?Mr:void 0}function as(Ot){var tr=re.call(Ot,Zr),Mr=Ot[Zr];try{Ot[Zr]=void 0;var Xn=!0}catch(oa){}var Wi=Gt.call(Ot);return Xn&&(tr?Ot[Zr]=Mr:delete Ot[Zr]),Wi}function bl(Ot){return typeof Ot.constructor=="function"&&!It(Ot)?Gn(ot(Ot)):{}}function _s(Ot,tr){var Mr=typeof Ot;return tr=tr==null?F:tr,!!tr&&(Mr=="number"||Mr!="symbol"&&fe.test(Ot))&&Ot>-1&&Ot%1==0&&Ot<tr}function Lo(Ot,tr,Mr){if(!bo(Mr))return!1;var Xn=typeof tr;return(Xn=="number"?Ks(Mr)&&_s(tr,Mr.length):Xn=="string"&&tr in Mr)?Ro(Mr[tr],Ot):!1}function kt(Ot){var tr=typeof Ot;return tr=="string"||tr=="number"||tr=="symbol"||tr=="boolean"?Ot!=="__proto__":Ot===null}function ze(Ot){return!!Je&&Je in Ot}function It(Ot){var tr=Ot&&Ot.constructor,Mr=typeof tr=="function"&&tr.prototype||Nt;return Ot===Mr}function fr(Ot){var tr=[];if(Ot!=null)for(var Mr in Object(Ot))tr.push(Mr);return tr}function nn(Ot){return Gt.call(Ot)}function yn(Ot,tr,Mr){return tr=Sn(tr===void 0?Ot.length-1:tr,0),function(){for(var Xn=arguments,Wi=-1,oa=Sn(Xn.length-tr,0),Xa=Array(oa);++Wi<oa;)Xa[Wi]=Xn[tr+Wi];Wi=-1;for(var zi=Array(tr+1);++Wi<tr;)zi[Wi]=Xn[Wi];return zi[tr]=Mr(Xa),R(Ot,this,zi)}}function Vn(Ot,tr){if(!(tr==="constructor"&&typeof Ot[tr]=="function")&&tr!="__proto__")return Ot[tr]}var Ua=xo(qi);function xo(Ot){var tr=0,Mr=0;return function(){var Xn=ni(),Wi=X-(Xn-Mr);if(Mr=Xn,Wi>0){if(++tr>=o)return arguments[0]}else tr=0;return Ot.apply(void 0,arguments)}}function _o(Ot){if(Ot!=null){try{return Xe.call(Ot)}catch(tr){}try{return Ot+""}catch(tr){}}return""}function Ro(Ot,tr){return Ot===tr||Ot!==Ot&&tr!==tr}var Hu=bi(function(){return arguments}())?bi:function(Ot){return $s(Ot)&&re.call(Ot,"callee")&&!Vt.call(Ot,"callee")},zl=Array.isArray;function Ks(Ot){return Ot!=null&&fu(Ot.length)&&!vs(Ot)}function nf(Ot){return $s(Ot)&&Ks(Ot)}var Nl=Un||nc;function vs(Ot){if(!bo(Ot))return!1;var tr=Di(Ot);return tr==ce||tr==st||tr==Ce||tr==Mt}function fu(Ot){return typeof Ot=="number"&&Ot>-1&&Ot%1==0&&Ot<=F}function bo(Ot){var tr=typeof Ot;return Ot!=null&&(tr=="object"||tr=="function")}function $s(Ot){return Ot!=null&&typeof Ot=="object"}function Zu(Ot){if(!$s(Ot)||Di(Ot)!=xt)return!1;var tr=ot(Ot);if(tr===null)return!0;var Mr=re.call(tr,"constructor")&&tr.constructor;return typeof Mr=="function"&&Mr instanceof Mr&&Xe.call(Mr)==ur}var Js=P?de(P):ja;function Wu(Ot){return qo(Ot,wa(Ot))}function wa(Ot){return Ks(Ot)?xi(Ot,!0):ps(Ot)}var Ka=sa(function(Ot,tr,Mr,Xn){to(Ot,tr,Mr,Xn)});function hu(Ot){return function(){return Ot}}function Xu(Ot){return Ot}function nc(){return!1}v.exports=Ka}).call(this,a("yLpj"),a("YuTi")(we))},quyA:function(we,x){var a="\\ud800-\\udfff",S="\\u0300-\\u036f",v="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",N=S+v+Z,o="\\ufe0e\\ufe0f",X="\\u200d",F=RegExp("["+X+a+N+o+"]");function K(q){return F.test(q)}we.exports=K},qxNg:function(we,x,a){"use strict";a.d(x,"a",function(){return F});var S=a("lSNA"),v=a.n(S),Z=a("mpbz"),N=a.n(Z);function o(q,Ce){var $=Object.keys(q);if(Object.getOwnPropertySymbols){var He=Object.getOwnPropertySymbols(q);Ce&&(He=He.filter(function(Be){return Object.getOwnPropertyDescriptor(q,Be).enumerable})),$.push.apply($,He)}return $}function X(q){for(var Ce=1;Ce<arguments.length;Ce++){var $=arguments[Ce]!=null?arguments[Ce]:{};Ce%2?o(Object($),!0).forEach(function(He){v()(q,He,$[He])}):Object.getOwnPropertyDescriptors?Object.defineProperties(q,Object.getOwnPropertyDescriptors($)):o(Object($)).forEach(function(He){Object.defineProperty(q,He,Object.getOwnPropertyDescriptor($,He))})}return q}function F(q,Ce){var $=Ce.radius,He=$===void 0?40:$,Be=Ce.maxZoom,ce=Be===void 0?18:Be,st=Ce.minZoom,ut=st===void 0?0:st,Me=Ce.zoom,bt=Me===void 0?2:Me;if(q.pointIndex){var xt=q.pointIndex.getClusters(q.extent,Math.floor(bt));return q.dataArray=K(xt),q}var Mt=new N.a({radius:He,minZoom:ut,maxZoom:ce}),De={type:"FeatureCollection",features:[]};return De.features=q.dataArray.map(function(ar){return{type:"Feature",geometry:{type:"Point",coordinates:ar.coordinates},properties:X({},ar)}}),Mt.load(De.features),Mt}function K(q){return q.map(function(Ce,$){return X({coordinates:Ce.geometry.coordinates,_id:$+1},Ce.properties)})}},riiI:function(we,x){},rlAn:function(we,x,a){"use strict";var S=a("ISu3"),v=a("gMG2"),Z=a("5gLl"),N=a("BpBL"),o=a("5zYK"),X=a("lJbI"),F=a("l94r"),K=a("qxNg"),q=a("Y8BV"),Ce=a("VIsB"),$=a("+VLl"),He=a("aF1E"),Be=a("fdMe");a.d(x,"getTransform",function(){return S.b}),a.d(x,"getParser",function(){return S.a});var ce=a("U1ZX"),st=a.n(ce);x.default=F.a,Object(S.c)("geojson",Z.a),Object(S.c)("image",N.a),Object(S.c)("csv",v.a),Object(S.c)("json",o.a),Object(S.c)("raster",X.a),Object(S.d)("cluster",K.a),Object(S.d)("filter",q.a),Object(S.d)("join",He.a),Object(S.d)("map",Be.a),Object(S.d)("grid",Ce.a),Object(S.d)("hexagon",$.a)},rxlC:function(we,x,a){"use strict";we.exports=v,we.exports.default=v;var S=1e20;function v(F,K,q,Ce,$,He){this.fontSize=F||24,this.buffer=K===void 0?3:K,this.cutoff=Ce||.25,this.fontFamily=$||"sans-serif",this.fontWeight=He||"normal",this.radius=q||8;var Be=this.size=this.fontSize+this.buffer*2,ce=Be+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Be,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(ce*ce),this.gridInner=new Float64Array(ce*ce),this.f=new Float64Array(Be),this.z=new Float64Array(Be+1),this.v=new Uint16Array(Be),this.middle=Math.round(Be/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Z(F,K,q,Ce,$,He,Be){He.fill(S,0,K*q),Be.fill(0,0,K*q);for(var ce=(K-Ce)/2,st=0;st<$;st++)for(var ut=0;ut<Ce;ut++){var Me=(st+ce)*K+ut+ce,bt=F.data[4*(st*Ce+ut)+3]/255;if(bt===1)He[Me]=0,Be[Me]=S;else if(bt===0)He[Me]=S,Be[Me]=0;else{var xt=Math.max(0,.5-bt),Mt=Math.max(0,bt-.5);He[Me]=xt*xt,Be[Me]=Mt*Mt}}}function N(F,K,q,Ce,$,He,Be){for(var ce=0;ce<K*q;ce++){var st=Math.sqrt(Ce[ce])-Math.sqrt($[ce]);F[ce]=Math.round(255-255*(st/He+Be))}}v.prototype._draw=function(F,K){var q=this.ctx.measureText(F),Ce=q.width,$=2*this.buffer,He,Be,ce,st,ut,Me,bt;K&&q.actualBoundingBoxLeft!==void 0?(ut=Math.floor(q.actualBoundingBoxAscent)-this.middle,Me=Math.max(0,this.middle-Math.ceil(q.actualBoundingBoxAscent)),bt=this.buffer,Be=Math.min(this.size,Math.ceil(q.actualBoundingBoxRight-q.actualBoundingBoxLeft)),st=Math.min(this.size-Me,Math.ceil(q.actualBoundingBoxAscent+q.actualBoundingBoxDescent)),He=Be+$,ce=st+$):(He=Be=this.size,ce=st=this.size,ut=0,Me=bt=0);var xt;Be&&st&&(this.ctx.clearRect(bt,Me,Be,st),this.ctx.fillText(F,this.buffer,this.middle),xt=this.ctx.getImageData(bt,Me,Be,st));var Mt=new Uint8ClampedArray(He*ce);return Z(xt,He,ce,Be,st,this.gridOuter,this.gridInner),o(this.gridOuter,He,ce,this.f,this.v,this.z),o(this.gridInner,He,ce,this.f,this.v,this.z),N(Mt,He,ce,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:Mt,metrics:{width:Be,height:st,sdfWidth:He,sdfHeight:ce,top:ut,left:0,advance:Ce,fontAscent:q.fontBoundingBoxAscent}}},v.prototype.draw=function(F){return this._draw(F,!1).data},v.prototype.drawWithMetrics=function(F){return this._draw(F,!0)};function o(F,K,q,Ce,$,He){for(var Be=0;Be<K;Be++)X(F,Be,K,q,Ce,$,He);for(var ce=0;ce<q;ce++)X(F,ce*K,1,K,Ce,$,He)}function X(F,K,q,Ce,$,He,Be){var ce,st,ut,Me;for(He[0]=0,Be[0]=-S,Be[1]=S,ce=0;ce<Ce;ce++)$[ce]=F[K+ce*q];for(ce=1,st=0,ut=0;ce<Ce;ce++){do Me=He[st],ut=($[ce]-$[Me]+ce*ce-Me*Me)/(ce-Me)/2;while(ut<=Be[st]&&--st>-1);st++,He[st]=ce,Be[st]=ut,Be[st+1]=S}for(ce=0,st=0;ce<Ce;ce++){for(;Be[st+1]<ce;)st++;Me=He[st],F[K+ce*q]=$[Me]+(ce-Me)*(ce-Me)}}},sGsY:function(we,x,a){"use strict";var S=a("rePB"),v=a("wx14"),Z=a("q1tI"),N=a("TSYQ"),o=a.n(N),X=a("H84U"),F=a("/ezw"),K=a("B6l+"),q=a.n(K),Ce=function(dt){var H=dt.value,z=dt.formatter,V=dt.precision,be=dt.decimalSeparator,me=dt.groupSeparator,le=me===void 0?"":me,fe=dt.prefixCls,Ne;if(typeof z=="function")Ne=z(H);else{var lt=String(H),rt=lt.match(/^(-?)(\d*)(\.(\d+))?$/);if(!rt||lt==="-")Ne=lt;else{var ue=rt[1],ye=rt[2]||"0",Ue=rt[4]||"";ye=ye.replace(/\B(?=(\d{3})+(?!\d))/g,le),typeof V=="number"&&(Ue=q()(Ue,V,"0").slice(0,V)),Ue&&(Ue="".concat(be).concat(Ue)),Ne=[Z.createElement("span",{key:"int",className:"".concat(fe,"-content-value-int")},ue,ye),Ue&&Z.createElement("span",{key:"decimal",className:"".concat(fe,"-content-value-decimal")},Ue)]}}return Z.createElement("span",{className:"".concat(fe,"-content-value")},Ne)},$=Ce,He=function(dt){var H=dt.prefixCls,z=dt.className,V=dt.style,be=dt.valueStyle,me=dt.value,le=me===void 0?0:me,fe=dt.title,Ne=dt.valueRender,lt=dt.prefix,rt=dt.suffix,ue=dt.loading,ye=dt.direction,Ue=dt.onMouseEnter,ft=dt.onMouseLeave,Oe=Z.createElement($,Object(v.a)({},dt,{value:le})),Ve=o()(H,Object(S.a)({},"".concat(H,"-rtl"),ye==="rtl"),z);return Z.createElement("div",{className:Ve,style:V,onMouseEnter:Ue,onMouseLeave:ft},fe&&Z.createElement("div",{className:"".concat(H,"-title")},fe),Z.createElement(F.a,{paragraph:!1,loading:ue},Z.createElement("div",{style:be,className:"".concat(H,"-content")},lt&&Z.createElement("span",{className:"".concat(H,"-content-prefix")},lt),Ne?Ne(Oe):Oe,rt&&Z.createElement("span",{className:"".concat(H,"-content-suffix")},rt))))};He.defaultProps={decimalSeparator:".",groupSeparator:",",loading:!1};var Be=Object(X.c)({prefixCls:"statistic"})(He),ce=Be,st=a("1OyB"),ut=a("vuIU"),Me=a("Ji7U"),bt=a("LK+K"),xt=a("ODXe"),Mt=a("QQZ/"),De=a.n(Mt),ar=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function $t(St,dt){var H=St,z=/\[[^\]]*]/g,V=(dt.match(z)||[]).map(function(fe){return fe.slice(1,-1)}),be=dt.replace(z,"[]"),me=ar.reduce(function(fe,Ne){var lt=Object(xt.a)(Ne,2),rt=lt[0],ue=lt[1];if(fe.indexOf(rt)!==-1){var ye=Math.floor(H/ue);return H-=ye*ue,fe.replace(new RegExp("".concat(rt,"+"),"g"),function(Ue){var ft=Ue.length;return De()(ye.toString(),ft,"0")})}return fe},be),le=0;return me.replace(z,function(){var fe=V[le];return le+=1,fe})}function Ht(St,dt){var H=dt.format,z=H===void 0?"":H,V=new Date(St).getTime(),be=Date.now(),me=Math.max(V-be,0);return $t(me,z)}var vt=a("0n0R"),Ze=1e3/30;function Et(St){return new Date(St).getTime()}var Le=function(St){Object(Me.a)(H,St);var dt=Object(bt.a)(H);function H(){var z;return Object(st.a)(this,H),z=dt.apply(this,arguments),z.syncTimer=function(){var V=z.props.value,be=Et(V);be>=Date.now()?z.startTimer():z.stopTimer()},z.startTimer=function(){z.countdownId||(z.countdownId=window.setInterval(function(){z.forceUpdate()},Ze))},z.stopTimer=function(){var V=z.props,be=V.onFinish,me=V.value;if(z.countdownId){clearInterval(z.countdownId),z.countdownId=void 0;var le=Et(me);be&&le<Date.now()&&be()}},z.formatCountdown=function(V,be){var me=z.props.format;return Ht(V,Object(v.a)(Object(v.a)({},be),{format:me}))},z.valueRender=function(V){return Object(vt.a)(V,{title:void 0})},z}return Object(ut.a)(H,[{key:"componentDidMount",value:function(){this.syncTimer()}},{key:"componentDidUpdate",value:function(){this.syncTimer()}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"render",value:function(){return Z.createElement(ce,Object(v.a)({valueRender:this.valueRender},this.props,{formatter:this.formatCountdown}))}}]),H}(Z.Component);Le.defaultProps={format:"HH:mm:ss"};var at=Le;ce.Countdown=at;var Wt=x.a=ce},sKgW:function(we,x){var a=9007199254740991,S=Math.floor;function v(Z,N){var o="";if(!Z||N<1||N>a)return o;do N%2&&(o+=Z),N=S(N/2),N&&(Z+=Z);while(N);return o}we.exports=v},sXyB:function(we,x,a){var S=a("SksO"),v=a("b48C");function Z(N,o,X){return v()?we.exports=Z=Reflect.construct:we.exports=Z=function(K,q,Ce){var $=[null];$.push.apply($,q);var He=Function.bind.apply(K,$),Be=new He;return Ce&&S(Be,Ce.prototype),Be},Z.apply(null,arguments)}we.exports=Z},sgoq:function(we,x,a){var S=a("asDA"),v=a("TKrE"),Z=a("6nK8"),N="['\u2019]",o=RegExp(N,"g");function X(F){return function(K){return S(Z(v(K).replace(o,"")),F,"")}}we.exports=X},sxDa:function(we,x,a){"use strict";a.d(x,"e",function(){return Ki}),a.d(x,"f",function(){return Wl}),a.d(x,"d",function(){return $u}),a.d(x,"a",function(){return co}),a.d(x,"c",function(){return La}),a.d(x,"g",function(){return Ho}),a.d(x,"b",function(){return Xu});var S=a("h1nZ"),v=a("lwsE"),Z=a.n(v),N=a("W8MJ"),o=a.n(N),X=a("7W2i"),F=a.n(X),K=a("a1gu"),q=a.n(K),Ce=a("Nsbk"),$=a.n(Ce),He=a("QILm"),Be=a.n(He),ce=a("lSNA"),st=a.n(ce),ut=a("yG8O"),Me=a.n(ut),bt=a("PJYZ"),xt=a.n(bt),Mt=a("U+yc"),De=a.n(Mt),ar=a("1ABj"),$t=a("GoyQ"),Ht=a.n($t),vt=a("lSCD"),Ze=a.n(vt),Et=a("xp6e"),Le=a("Hel2"),at=a("uhBA"),Wt=a("4U9+"),St=a.n(Wt),dt=a("4cb6"),H,z,V,be,me,le;function fe(d){return d.map(function(A){return typeof A=="string"&&(A=[A,{}]),A})}var Ne=(H=Object(dt.injectable)(),z=Object(dt.inject)(S.TYPES.IGlobalConfigService),H(V=(be=(le=function(){function d(){Z()(this,d),Me()(this,"configService",me,this),this.enabled=void 0}return o()(d,[{key:"apply",value:function(T,E){var w=this,I=E.rendererService,j=E.postProcessingPassFactory,ne=E.normalPassFactory;T.hooks.init.tap("MultiPassRendererPlugin",function(){var ge=T.getLayerConfig(),ke=ge.enableMultiPassRenderer,Dt=ge.passes,Jt=Dt===void 0?[]:Dt;w.enabled=!!ke&&T.getLayerConfig().enableMultiPassRenderer!==!1,w.enabled&&(T.multiPassRenderer=w.createMultiPassRenderer(T,Jt,j,ne),T.multiPassRenderer.setRenderFlag(!0))}),T.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){})}},{key:"createMultiPassRenderer",value:function(T,E,w,I){var j=T.multiPassRenderer,ne=T.getLayerConfig(),ge=ne.enablePicking,ke=ne.enableTAA;return ge&&j.add(I("pixelPicking")),j}}]),d}(),le),me=De()(be.prototype,"configService",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),be))||V),lt,rt=(lt={},st()(lt,S.BlendType.additive,{enable:!0,func:{srcRGB:S.gl.ONE,dstRGB:S.gl.ONE,srcAlpha:1,dstAlpha:1}}),st()(lt,S.BlendType.none,{enable:!1}),st()(lt,S.BlendType.normal,{enable:!0,func:{srcRGB:S.gl.SRC_ALPHA,dstRGB:S.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),st()(lt,S.BlendType.subtractive,{enable:!0,func:{srcRGB:S.gl.ONE,dstRGB:S.gl.ONE,srcAlpha:S.gl.ZERO,dstAlpha:S.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:S.gl.FUNC_SUBTRACT,alpha:S.gl.FUNC_SUBTRACT}}),st()(lt,S.BlendType.max,{enable:!0,func:{srcRGB:S.gl.ONE,dstRGB:S.gl.ONE},equation:{rgb:S.gl.MAX_EXT}}),st()(lt,S.BlendType.min,{enable:!0,func:{srcRGB:S.gl.ONE,dstRGB:S.gl.ONE},equation:{rgb:S.gl.MIN_EXT}}),lt),ue={properties:{enablePicking:{type:"boolean"},enableHighlight:{type:"boolean"},highlightColor:{oneOf:[{type:"array",items:{type:"number",minimum:0,maximum:1}},{type:"string"}]}}},ye,Ue,ft,Oe,Ve,P,R,J;function de(d,A){var T;if(typeof Symbol=="undefined"||d[Symbol.iterator]==null){if(Array.isArray(d)||(T=je(d))||A&&d&&typeof d.length=="number"){T&&(d=T);var E=0,w=function(){};return{s:w,n:function(){return E>=d.length?{done:!0}:{done:!1,value:d[E++]}},e:function(ke){throw ke},f:w}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,j=!1,ne;return{s:function(){T=d[Symbol.iterator]()},n:function(){var ke=T.next();return I=ke.done,ke},e:function(ke){j=!0,ne=ke},f:function(){try{!I&&T.return!=null&&T.return()}finally{if(j)throw ne}}}}function je(d,A){if(!!d){if(typeof d=="string")return We(d,A);var T=Object.prototype.toString.call(d).slice(8,-1);if(T==="Object"&&d.constructor&&(T=d.constructor.name),T==="Map"||T==="Set")return Array.from(d);if(T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T))return We(d,A)}}function We(d,A){(A==null||A>d.length)&&(A=d.length);for(var T=0,E=new Array(A);T<A;T++)E[T]=d[T];return E}function gt(d,A){var T=Object.keys(d);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(d);A&&(E=E.filter(function(w){return Object.getOwnPropertyDescriptor(d,w).enumerable})),T.push.apply(T,E)}return T}function nt(d){for(var A=1;A<arguments.length;A++){var T=arguments[A]!=null?arguments[A]:{};A%2?gt(Object(T),!0).forEach(function(E){st()(d,E,T[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(T)):gt(Object(T)).forEach(function(E){Object.defineProperty(d,E,Object.getOwnPropertyDescriptor(T,E))})}return d}function Nt(d){var A=Y();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function Y(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Xe=0,re=(ye=Object(S.lazyInject)(S.TYPES.ILogService),Ue=Object(S.lazyInject)(S.TYPES.IGlobalConfigService),ft=Object(S.lazyInject)(S.TYPES.IShaderModuleService),Oe=(J=function(d){F()(T,d);var A=Nt(T);function T(){var E,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Z()(this,T),E=A.call(this),E.id="".concat(Xe++),E.name="".concat(Xe),E.type=void 0,E.visible=!0,E.zIndex=0,E.minZoom=void 0,E.maxZoom=void 0,E.inited=!1,E.layerModelNeedUpdate=!1,E.pickedFeatureID=null,E.selectedFeatureID=null,E.styleNeedUpdate=!1,E.dataState={dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1},E.hooks={init:new Et.b,afterInit:new Et.b,beforeRender:new Et.b,beforeRenderData:new Et.d,afterRender:new Et.c,beforePickingEncode:new Et.c,afterPickingEncode:new Et.c,beforeHighlight:new Et.c(["pickedColor"]),afterHighlight:new Et.c,beforeSelect:new Et.c(["pickedColor"]),afterSelect:new Et.c,beforeDestroy:new Et.c,afterDestroy:new Et.c},E.models=[],E.multiPassRenderer=void 0,E.plugins=void 0,E.sourceOption=void 0,E.layerModel=void 0,Me()(E,"logger",Ve,xt()(E)),Me()(E,"configService",P,xt()(E)),Me()(E,"shaderModuleService",R,xt()(E)),E.cameraService=void 0,E.coordinateService=void 0,E.iconService=void 0,E.fontService=void 0,E.pickingService=void 0,E.rendererService=void 0,E.layerService=void 0,E.interactionService=void 0,E.mapService=void 0,E.styleAttributeService=void 0,E.layerSource=void 0,E.postProcessingPassFactory=void 0,E.normalPassFactory=void 0,E.animateOptions={enable:!1},E.container=void 0,E.encodedData=void 0,E.configSchema=void 0,E.currentPickId=null,E.rawConfig=void 0,E.needUpdateConfig=void 0,E.pendingStyleAttributes=[],E.scaleOptions={},E.animateStartTime=void 0,E.aniamateStatus=!1,E.sourceEvent=function(){E.dataState.dataSourceNeedUpdate=!0;var I=E.getLayerConfig(),j=I.autoFit,ne=I.fitBoundsOptions;j&&E.fitBounds(ne),E.emit("dataUpdate"),E.reRender()},E.name=w.name||E.id,E.zIndex=w.zIndex||0,E.rawConfig=w,E}return o()(T,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(w){if(!this.inited)this.needUpdateConfig=nt(nt({},this.needUpdateConfig),w);else{var I=this.container.get(S.TYPES.SceneID);this.configService.setLayerConfig(I,this.id,nt(nt(nt({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),w)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(w){this.container=w}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(w){return this.plugins.push(w),this}},{key:"init",value:function(){var w=this,I=this.container.get(S.TYPES.SceneID),j=this.rawConfig.enableMultiPassRenderer,ne=j===void 0?!1:j;this.configService.setLayerConfig(I,this.id,{enableMultiPassRenderer:ne}),this.iconService=this.container.get(S.TYPES.IIconService),this.fontService=this.container.get(S.TYPES.IFontService),this.rendererService=this.container.get(S.TYPES.IRendererService),this.layerService=this.container.get(S.TYPES.ILayerService),this.interactionService=this.container.get(S.TYPES.IInteractionService),this.pickingService=this.container.get(S.TYPES.IPickingService),this.mapService=this.container.get(S.TYPES.IMapService),this.cameraService=this.container.get(S.TYPES.ICameraService),this.coordinateService=this.container.get(S.TYPES.ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(S.TYPES.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(S.TYPES.IFactoryNormalPass),this.styleAttributeService=this.container.get(S.TYPES.IStyleAttributeService),this.multiPassRenderer=this.container.get(S.TYPES.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(Jt){var Or=Jt.attributeName,Fr=Jt.attributeField,bn=Jt.attributeValues,gn=Jt.updateOptions;w.styleAttributeService.updateStyleAttribute(Or,{scale:nt({field:Fr},w.splitValuesAndCallbackInAttribute(bn,w.getLayerConfig()[Or]))},gn)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(S.TYPES.ILayerPlugin);var ge=de(this.plugins),ke;try{for(ge.s();!(ke=ge.n()).done;){var Dt=ke.value;Dt.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(Jt){ge.e(Jt)}finally{ge.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(nt(nt({},this.getDefaultConfig()),this.rawConfig));var w=this.getLayerConfig(),I=w.animateOption;(I==null?void 0:I.enable)&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(w,I,j){return this.updateStyleAttribute("color",w,I,j),this}},{key:"rotate",value:function(w,I,j){return this.updateStyleAttribute("rotate",w,I,j),this}},{key:"size",value:function(w,I,j){return this.updateStyleAttribute("size",w,I,j),this}},{key:"filter",value:function(w,I,j){return this.updateStyleAttribute("filter",w,I,j),this}},{key:"shape",value:function(w,I,j){return this.updateStyleAttribute("shape",w,I,j),this}},{key:"label",value:function(w,I,j){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:w,attributeValues:I,updateOptions:j}),this}},{key:"animate",value:function(w){var I={};return Ht()(w)?(I.enable=!0,I=nt(nt({},I),w)):I.enable=w,this.updateLayerConfig({animateOption:I}),this}},{key:"source",value:function(w,I){return this.sourceOption={data:w,options:I},this}},{key:"setData",value:function(w,I){var j=this;return this.inited?this.layerSource.setData(w,I):this.on("inited",function(){j.layerSource.setData(w,I)}),this}},{key:"style",value:function(w){var I=this,j=w.passes,ne=Be()(w,["passes"]);return j&&fe(j).forEach(function(ge){var ke=I.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(ge[0]);ke&&ke.updateOptions(ge[1])}),this.rawConfig=nt(nt({},this.rawConfig),ne),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(w,I){return Ht()(w)?this.scaleOptions=nt(nt({},this.scaleOptions),w):this.scaleOptions[w]=I,this}},{key:"render",value:function(){return this.renderModels(),this}},{key:"active",value:function(w){var I={};return I.enableHighlight=Ht()(w)?!0:w,Ht()(w)?(I.enableHighlight=!0,w.color&&(I.highlightColor=w.color)):I.enableHighlight=!!w,this.updateLayerConfig(I),this}},{key:"setActive",value:function(w,I){var j=this;if(Ht()(w)){var ne=w.x,ge=ne===void 0?0:ne,ke=w.y,Dt=ke===void 0?0:ke;this.updateLayerConfig({highlightColor:Ht()(I)?I.color:this.getLayerConfig().highlightColor}),this.pick({x:ge,y:Dt})}else this.updateLayerConfig({pickedFeatureID:w,highlightColor:Ht()(I)?I.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call(Object(Le.l)(w)).then(function(){setTimeout(function(){j.reRender()},1)})}},{key:"select",value:function(w){var I={};return I.enableSelect=Ht()(w)?!0:w,Ht()(w)?(I.enableSelect=!0,w.color&&(I.selectColor=w.color)):I.enableSelect=!!w,this.updateLayerConfig(I),this}},{key:"setSelect",value:function(w,I){var j=this;if(Ht()(w)){var ne=w.x,ge=ne===void 0?0:ne,ke=w.y,Dt=ke===void 0?0:ke;this.updateLayerConfig({selectColor:Ht()(I)?I.color:this.getLayerConfig().selectColor}),this.pick({x:ge,y:Dt})}else this.updateLayerConfig({pickedFeatureID:w,selectColor:Ht()(I)?I.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call(Object(Le.l)(w)).then(function(){setTimeout(function(){j.reRender()},1)})}},{key:"setBlend",value:function(w){this.updateLayerConfig({blend:w}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(w){return this.zIndex=w,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(w){this.currentPickId=w}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(w){this.selectedFeatureID=w}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var w=this.mapService.getZoom(),I=this.getLayerConfig(),j=I.visible,ne=I.minZoom,ge=ne===void 0?-Infinity:ne,ke=I.maxZoom,Dt=ke===void 0?Infinity:ke;return!!j&&w>=ge&&w<=Dt}},{key:"setMinZoom",value:function(w){return this.updateLayerConfig({minZoom:w}),this}},{key:"getMinZoom",value:function(){var w=this.getLayerConfig(),I=w.minZoom;return I}},{key:"getMaxZoom",value:function(){var w=this.getLayerConfig(),I=w.maxZoom;return I}},{key:"get",value:function(w){var I=this.getLayerConfig();return I[w]}},{key:"setMaxZoom",value:function(w){return this.updateLayerConfig({maxZoom:w}),this}},{key:"fitBounds",value:function(w){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var I=this.getSource(),j=I.extent,ne=j.some(function(ge){return Math.abs(ge)===Infinity});return ne?this:(this.mapService.fitBounds([[j[0],j[1]],[j[2],j[3]]],w),this)}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(w){return w.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(w){return w.needRescale||w.needRemapping||w.needRegenerateVertices}).length}},{key:"setSource",value:function(w){this.layerSource=w;var I=this.mapService.getZoom();this.layerSource.cluster&&this.layerSource.updateClusterData(I),this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(w){this.encodedData=w}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getConfigSchemaForValidation",value:function(){return this.configSchema||(this.configSchema=St()([ue,this.getConfigSchema()])),this.configSchema}},{key:"getLegendItems",value:function(w){var I=this.styleAttributeService.getLayerAttributeScale(w);if(I){if(I.ticks){var j=I.ticks().map(function(ge){return st()({value:ge},w,I(ge))});return j}else if(I.invertExtent){var ne=I.range().map(function(ge){return st()({value:I.invertExtent(ge)},w,ge)});return ne}}else return[]}},{key:"pick",value:function(w){var I=w.x,j=w.y;this.interactionService.triggerHover({x:I,y:j})}},{key:"boxSelect",value:function(w,I){this.pickingService.boxPickLayer(this,w,I)}},{key:"buildLayerModel",value:function(w){var I=w.moduleName,j=w.vertexShader,ne=w.fragmentShader,ge=w.triangulation,ke=Be()(w,["moduleName","vertexShader","fragmentShader","triangulation"]);this.shaderModuleService.registerModule(I,{vs:j,fs:ne});var Dt=this.shaderModuleService.getModule(I),Jt=Dt.vs,Or=Dt.fs,Fr=Dt.uniforms,bn=this.rendererService.createModel,gn=this.styleAttributeService.createAttributesAndIndices(this.encodedData,ge),kn=gn.attributes,Pi=gn.elements;return bn(nt({attributes:kn,uniforms:Fr,fs:Or,vs:Jt,elements:Pi,blend:rt[S.BlendType.normal]},ke))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(w){var I=this.getLayerConfig(),j=I.enableHighlight,ne=j===void 0?!0:j,ge=I.enableSelect,ke=ge===void 0?!0:ge,Dt=this.eventNames().indexOf(w)!==-1||this.eventNames().indexOf("un"+w)!==-1;return(w==="click"||w==="dblclick")&&ke&&(Dt=!0),w==="mousemove"&&(ne||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(Dt=!0),this.isVisible()&&Dt}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var w=this;return this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(I){I.draw({uniforms:w.layerModel.getUninforms()})}),this}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(w,I){return{values:Ze()(w)?void 0:w||I,callback:Ze()(w)?w:void 0}}},{key:"updateStyleAttribute",value:function(w,I,j,ne){this.inited?this.styleAttributeService.updateStyleAttribute(w,{scale:nt({field:I},this.splitValuesAndCallbackInAttribute(j,this.getLayerConfig()[I]))},ne):this.pendingStyleAttributes.push({attributeName:w,attributeField:I,attributeValues:j,updateOptions:ne})}}]),T}(at.EventEmitter),J),Ve=De()(Oe.prototype,"logger",[ye],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=De()(Oe.prototype,"configService",[Ue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=De()(Oe.prototype,"shaderModuleService",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe),Je,Gt,ur,ct,ht,Pt,pt=(Je=Object(S.lazyInject)(S.TYPES.IGlobalConfigService),Gt=Object(S.lazyInject)(S.TYPES.IShaderModuleService),ur=(Pt=function(){function d(A){Z()(this,d),this.triangulation=void 0,this.layer=void 0,Me()(this,"configService",ct,this),Me()(this,"shaderModuleService",ht,this),this.rendererService=void 0,this.iconService=void 0,this.fontService=void 0,this.styleAttributeService=void 0,this.mapService=void 0,this.cameraService=void 0,this.layerService=void 0,this.layer=A,this.rendererService=A.getContainer().get(S.TYPES.IRendererService),this.styleAttributeService=A.getContainer().get(S.TYPES.IStyleAttributeService),this.mapService=A.getContainer().get(S.TYPES.IMapService),this.iconService=A.getContainer().get(S.TYPES.IIconService),this.fontService=A.getContainer().get(S.TYPES.IFontService),this.cameraService=A.getContainer().get(S.TYPES.ICameraService),this.layerService=A.getContainer().get(S.TYPES.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate()}return o()(d,[{key:"getBlend",value:function(){var T=this.layer.getLayerConfig(),E=T.blend,w=E===void 0?"normal":E;return rt[S.BlendType[w]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(T){return[T.enable?0:1,T.duration||4,T.interval||.2,T.trailLength||.1]}},{key:"startModelAnimate",value:function(){var T=this.layer.getLayerConfig(),E=T.animateOption;E.enable&&this.layer.setAnimateStartTime()}}]),d}(),Pt),ct=De()(ur.prototype,"configService",[Je],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ht=De()(ur.prototype,"shaderModuleService",[Gt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ur),Pe=a("J4zp"),ot=a.n(Pe),$e=a("RIqP"),Vt=a.n($e),dr=a("VmRL"),Zr=a.n(dr),cr=a("IOcx"),Un=cr.c.create(),Sn=cr.c.create(),ni=cr.c.create(),fi=cr.c.create(),Wn=cr.c.create();function Gn(d,A,T,E,w){cr.c.add(d,T,E),cr.c.normalize(d,d),A=cr.c.fromValues(-d[1],d[0]);var I=cr.c.fromValues(-T[1],T[0]);return[w/cr.c.dot(A,I),A]}function Ee(d,A){return cr.c.set(d,-A[1],A[0])}function pe(d,A,T){return cr.c.sub(d,A,T),cr.c.normalize(d,d),d}function W(d,A){return d[0]===A[0]&&d[1]===A[1]}function ae(d){for(var A=new Map,T=0;T<d.length;T++){var E=d[0].toString()+"-"+d[1].toString();A.get(E)?(d.splice(T,1),T++):A.set(E,E)}return d}var Ie=function(){function d(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Z()(this,d),this.complex=void 0,this.join=void 0,this.cap=void 0,this.miterLimit=void 0,this.thickness=void 0,this.normal=void 0,this.lastFlip=-1,this.miter=cr.c.fromValues(0,0),this.started=!1,this.dash=!1,this.totalDistance=0,this.join=A.join||"miter",this.cap=A.cap||"butt",this.miterLimit=A.miterLimit||10,this.thickness=A.thickness||1,this.dash=A.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return o()(d,[{key:"extrude",value:function(T){var E=this.complex;if(T.length<=1)return E;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var w=T.length,I=E.startIndex,j=1;j<w;j++){var ne=T[j-1],ge=T[j],ke=j<T.length-1?T[j+1]:null,Dt=this.segment(E,I,ne,ge,ke);I+=Dt}if(this.dash)for(var Jt=0;Jt<E.positions.length/6;Jt++)E.positions[Jt*6+5]=this.totalDistance;return E.startIndex=E.positions.length/6,E}},{key:"segment",value:function(T,E,w,I,j){var ne=0,ge=T.indices,ke=T.positions,Dt=T.normals,Jt=this.cap==="square",Or=this.join==="bevel",Fr=Object(Le.d)([I[0],I[1]]),bn=Object(Le.d)([w[0],w[1]]);pe(ni,Fr,bn);var gn=0;if(this.dash&&(gn=this.lineSegmentDistance(Fr,bn),this.totalDistance+=gn),this.normal||(this.normal=cr.c.create(),Ee(this.normal,ni)),!this.started)if(this.started=!0,Jt){var kn=cr.c.create(),Pi=cr.c.create();cr.c.add(kn,this.normal,ni),cr.c.add(Pi,this.normal,ni),Dt.push(Pi[0],Pi[1],0),Dt.push(kn[0],kn[1],0),ke.push(w[0],w[1],0,this.totalDistance-gn,-this.thickness,0),ke.push(w[0],w[1],0,this.totalDistance-gn,this.thickness,0)}else this.extrusions(ke,Dt,w,this.normal,this.thickness,this.totalDistance-gn);if(ge.push(E+0,E+1,E+2),j){var pa=Object(Le.d)([j[0],j[1]]);W(Fr,pa)&&cr.c.add(pa,Fr,cr.c.normalize(pa,cr.c.subtract(pa,Fr,bn))),pe(fi,pa,Fr);var va=Gn(Wn,cr.c.create(),ni,fi,this.thickness),so=ot()(va,2),Li=so[0],uo=so[1],Oo=cr.c.dot(Wn,this.normal)<0?-1:1,Ys=Or;if(!Ys&&this.join==="miter"){var ra=Li;ra>this.miterLimit&&(Ys=!0)}Ys?(Dt.push(this.normal[0],this.normal[1],0),Dt.push(uo[0],uo[1],0),ke.push(I[0],I[1],0,this.totalDistance,-this.thickness*Oo,0),ke.push(I[0],I[1],0,this.totalDistance,this.thickness*Oo,0),ge.push.apply(ge,Vt()(this.lastFlip!==-Oo?[E,E+2,E+3]:[E+2,E+1,E+3])),ge.push(E+2,E+3,E+4),Ee(Un,fi),cr.c.copy(this.normal,Un),Dt.push(this.normal[0],this.normal[1],0),ke.push(I[0],I[1],0,this.totalDistance,-this.thickness*Oo,0),ne+=3):(this.extrusions(ke,Dt,I,uo,Li,this.totalDistance),ge.push.apply(ge,Vt()(this.lastFlip===1?[E,E+2,E+3]:[E+2,E+1,E+3])),Oo=-1,cr.c.copy(this.normal,uo),ne+=2),this.lastFlip=Oo}else{if(Ee(this.normal,ni),Jt){var Oi=cr.c.create(),Ga=cr.c.create();cr.c.sub(Ga,ni,this.normal),cr.c.add(Oi,ni,this.normal),Dt.push(Ga[0],Ga[1],0),Dt.push(Oi[0],Oi[1],0),ke.push(I[0],I[1],0,this.totalDistance,this.thickness,0),ke.push(I[0],I[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(ke,Dt,I,this.normal,this.thickness,this.totalDistance);ge.push.apply(ge,Vt()(this.lastFlip===1?[E,E+2,E+3]:[E+2,E+1,E+3])),ne+=2}return ne}},{key:"extrusions",value:function(T,E,w,I,j,ne){E.push(I[0],I[1],0),E.push(I[0],I[1],0),T.push(w[0],w[1],0,ne,-j,0),T.push(w[0],w[1],0,ne,j,0)}},{key:"lineSegmentDistance",value:function(T,E){var w=E[0]-T[0],I=E[1]-T[1];return Math.sqrt(w*w+I*I)}}]),d}(),qe=a("UB5X"),Ct=a.n(qe);function Re(d){if(Ct()(d[0]))return d;if(Ct()(d[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Ct()(d[0][0][0])){var A=d,T=0,E=0,w=0;return A.forEach(function(I){I.forEach(function(j){T+=j[0],E+=j[1],w++})}),[T/w,E/w,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function mt(d){var A=d[0][0],T=d[0][d[0].length-1];A[0]===T[0]&&A[1]===T[1]&&(d[0]=d[0].slice(0,d[0].length-1));for(var E=d[0].length,w=Zr.a.flatten(d),I=w.vertices,j=w.dimensions,ne=[],ge=[],ke=0;ke<I.length/j;ke++)j===2?ne.push(I[ke*2],I[ke*2+1],1):ne.push(I[ke*3],I[ke*3+1],1);var Dt=Zr()(w.vertices,w.holes,w.dimensions);ge.push.apply(ge,Vt()(Dt));for(var Jt=function(bn){var gn=w.vertices.slice(bn*j,(bn+1)*j),kn=w.vertices.slice((bn+1)*j,(bn+2)*j);kn.length===0&&(kn=w.vertices.slice(0,j));var Pi=ne.length/3;ne.push(gn[0],gn[1],1,kn[0],kn[1],1,gn[0],gn[1],0,kn[0],kn[1],0),ge.push.apply(ge,Vt()([0,2,1,2,3,1].map(function(Oi){return Oi+Pi})))},Or=0;Or<E;Or++)Jt(Or);return{positions:ne,index:ge}}function Qt(d){var A=Zr.a.flatten(d),T=Zr()(A.vertices,A.holes,A.dimensions);return{positions:A.vertices,index:T}}function Br(d){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,T=d[0][0],E=d[0][d[0].length-1];T[0]===E[0]&&T[1]===E[1]&&(d[0]=d[0].slice(0,d[0].length-1));for(var w=d[0].length,I=Zr.a.flatten(d),j=I.vertices,ne=I.dimensions,ge=[],ke=[],Dt=[],Jt=0;Jt<j.length/ne;Jt++)ne===2?ge.push(j[Jt*2],j[Jt*2+1],1,-1,-1):ge.push(j[Jt*3],j[Jt*3+1],1,-1,-1),Dt.push(0,0,1);var Or=Zr()(I.vertices,I.holes,I.dimensions);ke.push.apply(ke,Vt()(Or));for(var Fr=function(kn){var Pi=I.vertices.slice(kn*ne,(kn+1)*ne),Oi=I.vertices.slice((kn+1)*ne,(kn+2)*ne);Oi.length===0&&(Oi=I.vertices.slice(0,ne));var Ga=ge.length/5;ge.push(Pi[0],Pi[1],1,0,0,Oi[0],Oi[1],1,.1,0,Pi[0],Pi[1],0,0,.8,Oi[0],Oi[1],0,.1,.8);var pa=Ur([Oi[0],Oi[1],1],[Pi[0],Pi[1],0],[Pi[0],Pi[1],1],A);Dt.push.apply(Dt,Vt()(pa).concat(Vt()(pa),Vt()(pa),Vt()(pa))),ke.push.apply(ke,Vt()([1,2,0,3,2,1].map(function(va){return va+Ga})))},bn=0;bn<w;bn++)Fr(bn);return{positions:ge,index:ke,normals:Dt}}function Ur(d,A,T){var E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,w=cr.d.create(),I=cr.d.create(),j=cr.d.create();E&&(d=Object(Le.p)(d),A=Object(Le.p)(A),T=Object(Le.p)(T));var ne=cr.d.fromValues.apply(cr.d,Vt()(d)),ge=cr.d.fromValues.apply(cr.d,Vt()(A)),ke=cr.d.fromValues.apply(cr.d,Vt()(T));cr.d.sub(w,ke,ge),cr.d.sub(I,ne,ge),cr.d.cross(j,w,I);var Dt=cr.d.create();return cr.d.normalize(Dt,j),Dt}var or,Vr;(function(d){d.CYLINDER="cylinder",d.SQUARECOLUMN="squareColumn",d.TRIANGLECOLUMN="triangleColumn",d.HEXAGONCOLUMN="hexagonColumn",d.PENTAGONCOLUMN="pentagonColumn"})(Vr||(Vr={}));var An;(function(d){d.CIRCLE="circle",d.SQUARE="square",d.TRIANGLE="triangle",d.HEXAGON="hexagon",d.PENTAGON="pentagon"})(An||(An={}));function dn(d){for(var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,T=Math.PI*2/d,E=[],w=0;w<d;w++)E.push(T*w+A*Math.PI/12);var I=E.map(function(j){var ne=Math.sin(j+Math.PI/4),ge=Math.cos(j+Math.PI/4);return[ne,ge,0]});return I}function Cr(){return dn(30)}function Tn(){return dn(4)}function fn(){return dn(3)}function En(){return dn(6,1)}function Cn(){return dn(5)}var pn=(or={},st()(or,An.CIRCLE,Cr),st()(or,An.HEXAGON,En),st()(or,An.TRIANGLE,fn),st()(or,An.SQUARE,Tn),st()(or,An.PENTAGON,Cn),st()(or,Vr.CYLINDER,Cr),st()(or,Vr.HEXAGONCOLUMN,En),st()(or,Vr.TRIANGLECOLUMN,fn),st()(or,Vr.SQUARECOLUMN,Tn),st()(or,Vr.PENTAGONCOLUMN,Cn),or),Lr={};function hi(d){var A=Re(d.coordinates);return{vertices:[].concat(Vt()(A),Vt()(A),Vt()(A),Vt()(A)),indices:[0,1,2,2,3,0],size:A.length}}function xi(d){var A=d.shape,T=ja(A,!1),E=T.positions,w=T.index,I=T.normals;return{vertices:E,indices:w,normals:I,size:5}}function ki(d){var A=Re(d.coordinates);return{vertices:Vt()(A),indices:[0],size:A.length}}function _i(d){var A=d.coordinates,T=A;Array.isArray(T[0][0])||(T=[A]);var E=new Ie({dash:!0,join:"bevel"});T.forEach(function(I){E.extrude(I)});var w=E.complex;return{vertices:w.positions,indices:w.indices,normals:w.normals,size:6}}function eo(d){var A=d.coordinates,T=Zr.a.flatten(A),E=T.vertices,w=T.dimensions,I=T.holes;return{indices:Zr()(E,I,w),vertices:E,size:w}}function pi(d){var A=d.coordinates,T=Br(A,!0),E=T.positions,w=T.index,I=T.normals;return{vertices:E,indices:w,normals:I,size:5}}function Ta(d){var A=d.shape,T=Gu(A),E=T.positions,w=T.index;return{vertices:E,indices:w,size:3}}function Di(d){var A=d.coordinates,T=[].concat(Vt()(A[0]),[0,0,1,A[1][0],A[0][1],0,1,1],Vt()(A[1]),[0,1,0],Vt()(A[0]),[0,0,1],Vt()(A[1]),[0,1,0,A[0][0],A[1][1],0,0,0]),E=[0,1,2,3,4,5];return{vertices:T,indices:E,size:5}}function bi(d){for(var A=30,T=d.coordinates,E=[],w=[],I=function(ge){E.push(ge,1,ge,T[0][0],T[0][1],T[1][0],T[1][1],ge,-1,ge,T[0][0],T[0][1],T[1][0],T[1][1]),ge!==A-1&&w.push.apply(w,Vt()([0,1,2,1,3,2].map(function(ke){return ge*2+ke})))},j=0;j<A;j++)I(j);return{vertices:E,indices:w,size:7}}function ci(d){var A=d.coordinates;A.length===2&&A.push(0);var T=d.size,E=qi(-1,1),w=qi(1,1),I=qi(-1,-1),j=qi(1,-1),ne=[].concat(Vt()(A),Vt()(E),Vt()(A),Vt()(I),Vt()(A),Vt()(j),Vt()(A),Vt()(w)),ge=[0,1,2,3,0,2];return{vertices:ne,indices:ge,size:5}}function ja(d){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Lr&&Lr[d])return Lr[d];var T=pn[d]?pn[d]():pn.cylinder(),E=Br([T],A);return Lr[d]=E,E}function ps(d,A){for(var T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,w=new Float32Array(d.length/T*3),I,j,ne,ge=cr.d.create(),ke=cr.d.create(),Dt=cr.d.create(),Jt=0,Or=A.length;Jt<Or;Jt+=3){I=A[Jt+0]*3,j=A[Jt+1]*3,ne=A[Jt+2]*3;var Fr=[d[I],d[I+1]],bn=[d[j],d[j+1]],gn=[d[ne],d[ne+1]];E&&(Fr=Object(Le.p)(Fr),bn=Object(Le.p)(bn),gn=Object(Le.p)(gn));var kn=Fr,Pi=ot()(kn,2),Oi=Pi[0],Ga=Pi[1],pa=cr.d.fromValues(Oi,Ga,d[I+2]),va=bn,so=ot()(va,2),Li=so[0],uo=so[1],Oo=cr.d.fromValues(Li,uo,d[j+2]),Ys=gn,ra=ot()(Ys,2),Ds=ra[0],ns=ra[1],xf=cr.d.fromValues(Ds,ns,d[ne+2]);cr.d.sub(ge,xf,Oo),cr.d.sub(ke,pa,Oo),cr.d.cross(Dt,ge,ke),w[I]+=ge[0],w[I+1]+=ge[1],w[I+2]+=ge[2],w[j]+=ge[0],w[j+1]+=ge[1],w[j+2]+=ge[2],w[ne]+=ge[0],w[ne+1]+=ge[1],w[ne+2]+=ge[2]}return to(w),w}function to(d){for(var A=0,T=d.length;A<T;A+=3){var E=cr.d.fromValues(d[A],d[A+1],d[A+2]),w=cr.d.create();cr.d.normalize(w,E),d.set(w,A)}}function lo(d){var A=d[0][0],T=d[0][d[0].length-1];return A[0]===T[0]&&A[1]===T[1]}function Gu(d){var A=["cylinder","triangleColumn","hexagonColumn","squareColumn"],T=pn[d]?pn[d]():pn.circle(),E=A.indexOf(d)===-1?Qt([T]):mt([T]);return E}function qi(d,A){var T=(d+1)/2,E=(A+1)/2;return[T,E]}function Oa(d){var A=is();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function is(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var ca=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Ya=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);
   v_texCoord = a_Uv;
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,qo=function(d){F()(T,d);var A=Oa(T);function T(){return Z()(this,T),A.apply(this,arguments)}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=I===void 0?1:I,ne=w.baseColor,ge=ne===void 0?"rgb(16,16,16)":ne,ke=w.brightColor,Dt=ke===void 0?"rgb(255,176,38)":ke,Jt=w.windowColor,Or=Jt===void 0?"rgb(30,60,89)":Jt,Fr=w.time,bn=Fr===void 0?0:Fr;return{u_opacity:j,u_baseColor:Object(Le.s)(ge),u_brightColor:Object(Le.s)(Dt),u_windowColor:Object(Le.s)(Or),u_time:this.layer.getLayerAnimateTime()||bn}}},{key:"initModels",value:function(){return this.startModelAnimate(),[this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:Ya,fragmentShader:ca,triangulation:pi})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:S.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(I,j,ne,ge,ke){return ke}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(I,j,ne,ge){var ke=I.size,Dt=ke===void 0?10:ke;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(I,j,ne,ge){var ke=I.size;return[ne[3],ne[4]]}}})}}]),T}(pt);function sa(d){var A=yo();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function yo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var co=function(d){F()(T,d);var A=sa(T);function T(){var E;Z()(this,T);for(var w=arguments.length,I=new Array(w),j=0;j<w;j++)I[j]=arguments[j];return E=A.call.apply(A,[this].concat(I)),E.type="PolygonLayer",E}return o()(T,[{key:"buildModels",value:function(){this.layerModel=new qo(this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"setLight",value:function(w){this.updateLayerConfig({time:w})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"citybuilding"}}]),T}(re);function Tu(d){var A=as();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function as(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var bl=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
varying vec4 v_color;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,_s=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Lo=function(d){F()(T,d);var A=Tu(T);function T(){return Z()(this,T),A.apply(this,arguments)}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=w.coverage,ne=w.angle;return{u_opacity:I||1,u_coverage:j||.9,u_angle:ne||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"gridheatmap",vertexShader:bl,fragmentShader:_s,triangulation:Ta,depth:{enable:!1},primitive:S.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:S.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(I,j){var ne=I.coordinates;return[ne[0],ne[1],0]}}})}}]),T}(pt);function kt(d){var A=ze();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function ze(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var It=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"

void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(project_pos);
  setPickingColor(a_PickingColor);
}
`,fr=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,nn=function(d){F()(T,d);var A=kt(T);function T(){return Z()(this,T),A.apply(this,arguments)}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=w.coverage,ne=w.angle;return{u_opacity:I||1,u_coverage:j||1,u_angle:ne||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"grid3dheatmap",vertexShader:It,fragmentShader:fr,triangulation:xi,depth:{enable:!0},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(I,j,ne,ge){var ke=I.size;return Array.isArray(ke)?[ke[0]]:[ke]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:S.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(I,j,ne,ge,ke){return ke}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:S.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(I,j){var ne=I.coordinates;return[ne[0],ne[1],0]}}})}}]),T}(pt);function yn(d,A){for(var T=[],E=[],w=[],I=d+1,j=A+1,ne=d/2,ge=A/2,ke=0;ke<j;ke++)for(var Dt=ke-ge,Jt=0;Jt<I;Jt++){var Or=Jt-ne;E.push(Or/ne,-Dt/ge,0),w.push(Jt/d),w.push(1-ke/A)}for(var Fr=0;Fr<A;Fr++)for(var bn=0;bn<d;bn++){var gn=bn+I*Fr,kn=bn+I*(Fr+1),Pi=bn+1+I*(Fr+1),Oi=bn+1+I*Fr;T.push(gn,kn,Oi),T.push(kn,Pi,Oi)}return{vertices:E,indices:T,uvs:w}}function Vn(d,A){var T=Object.keys(d);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(d);A&&(E=E.filter(function(w){return Object.getOwnPropertyDescriptor(d,w).enumerable})),T.push.apply(T,E)}return T}function Ua(d){for(var A=1;A<arguments.length;A++){var T=arguments[A]!=null?arguments[A]:{};A%2?Vn(Object(T),!0).forEach(function(E){st()(d,E,T[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(T)):Vn(Object(T)).forEach(function(E){Object.defineProperty(d,E,Object.getOwnPropertyDescriptor(T,E))})}return d}function xo(d){var A=_o();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function _o(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Ro=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,Hu=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;

vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos =(a_Uv * vec2(2.0) - vec2(1.0));


  vec4 p1 = vec4(pos, 0.0, 1.0);
	vec4 p2 = vec4(pos, 1.0, 1.0);

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1;
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w;
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z);
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0, 1, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);

}
`,zl=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,Ks=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,nf=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 3.0;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
}
`,Nl=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
varying float v_intensity;
void main() {
  v_texCoord = a_Uv;
  v_intensity = texture2D(u_texture, v_texCoord).r;
  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,vs=function(d){F()(T,d);var A=xo(T);function T(){var E;Z()(this,T);for(var w=arguments.length,I=new Array(w),j=0;j<w;j++)I[j]=arguments[j];return E=A.call.apply(A,[this].concat(I)),E.texture=void 0,E.colorTexture=void 0,E.heatmapFramerBuffer=void 0,E.intensityModel=void 0,E.colorModel=void 0,E.shapeType=void 0,E}return o()(T,[{key:"render",value:function(){var w=this,I=this.rendererService,j=I.clear,ne=I.useFramebuffer;ne(this.heatmapFramerBuffer,function(){j({color:[0,0,0,0],depth:1,stencil:0,framebuffer:w.heatmapFramerBuffer}),w.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var w,I=this.rendererService,j=I.createFramebuffer,ne=I.clear,ge=I.getViewportSize,ke=I.createTexture2D,Dt=I.useFramebuffer,Jt=this.styleAttributeService.getLayerStyleAttribute("shape"),Or=(Jt==null||(w=Jt.scale)===null||w===void 0?void 0:w.field)||"heatmap";this.shapeType=Or,this.intensityModel=this.buildHeatMapIntensity(),this.colorModel=Or==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap();var Fr=this.layer.getLayerConfig(),bn=Fr.rampColors,gn=Object(Le.n)(bn),kn=ge(),Pi=kn.width,Oi=kn.height;return this.heatmapFramerBuffer=j({color:ke({width:Math.floor(Pi/4),height:Math.floor(Oi/4),wrapS:S.gl.CLAMP_TO_EDGE,wrapT:S.gl.CLAMP_TO_EDGE,min:S.gl.LINEAR,mag:S.gl.LINEAR}),depth:!1}),this.updateColorTexture(),[this.intensityModel,this.colorModel]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:S.AttributeType.Attribute,descriptor:{name:"a_Dir",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(I,j,ne,ge){return[ne[3],ne[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(I,j,ne,ge){var ke=I.size,Dt=ke===void 0?1:ke;return[Dt]}}})}},{key:"buildHeatMapIntensity",value:function(){return this.layer.buildLayerModel({moduleName:"heatmapintensity",vertexShader:nf,fragmentShader:Ks,triangulation:ci,depth:{enable:!1},blend:{enable:!0,func:{srcRGB:S.gl.ONE,srcAlpha:1,dstRGB:S.gl.ONE,dstAlpha:1}}})}},{key:"buildHeatmapColor",value:function(){this.shaderModuleService.registerModule("heatmapColor",{vs:Nl,fs:zl});var w=this.shaderModuleService.getModule("heatmapColor"),I=w.vs,j=w.fs,ne=w.uniforms,ge=this.rendererService,ke=ge.createAttribute,Dt=ge.createElements,Jt=ge.createBuffer,Or=ge.createModel;return Or({vs:I,fs:j,attributes:{a_Position:ke({buffer:Jt({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:S.gl.FLOAT}),size:3}),a_Uv:ke({buffer:Jt({data:[0,1,1,1,0,0,1,0],type:S.gl.FLOAT}),size:2})},uniforms:Ua({},ne),depth:{enable:!1},blend:this.getBlend(),count:6,elements:Dt({data:[0,2,1,2,3,1],type:S.gl.UNSIGNED_INT,count:6})})}},{key:"drawIntensityMode",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=w.intensity,ne=j===void 0?10:j,ge=w.radius,ke=ge===void 0?5:ge;this.intensityModel.draw({uniforms:{u_opacity:I||1,u_radius:ke,u_intensity:ne}})}},{key:"drawColorMode",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity;this.colorModel.draw({uniforms:{u_opacity:I||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=cr.b.invert(cr.b.create(),cr.b.fromValues.apply(cr.b,Vt()(this.cameraService.getViewProjectionMatrixUncentered())));this.colorModel.draw({uniforms:{u_opacity:I||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:Vt()(j)}})}},{key:"build3dHeatMap",value:function(){var w=this.rendererService.getViewportSize,I=w(),j=I.width,ne=I.height,ge=yn(j/4,ne/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:Hu,fs:Ro});var ke=this.shaderModuleService.getModule("heatmap3dColor"),Dt=ke.vs,Jt=ke.fs,Or=ke.uniforms,Fr=this.rendererService,bn=Fr.createAttribute,gn=Fr.createElements,kn=Fr.createBuffer,Pi=Fr.createModel;return Pi({vs:Dt,fs:Jt,attributes:{a_Position:bn({buffer:kn({data:ge.vertices,type:S.gl.FLOAT}),size:3}),a_Uv:bn({buffer:kn({data:ge.uvs,type:S.gl.FLOAT}),size:2})},primitive:S.gl.TRIANGLES,uniforms:Ua({},Or),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:S.gl.SRC_ALPHA,srcAlpha:1,dstRGB:S.gl.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:gn({data:ge.indices,type:S.gl.UNSIGNED_INT,count:ge.indices.length})})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var w=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var I=this.layer.getLayerConfig(),j=I.rampColors,ne=Object(Le.n)(j);this.colorTexture=w({data:new Uint8Array(ne.data),width:ne.width,height:ne.height,wrapS:S.gl.CLAMP_TO_EDGE,wrapT:S.gl.CLAMP_TO_EDGE,min:S.gl.NEAREST,mag:S.gl.NEAREST,flipY:!1})}}]),T}(pt);function fu(d){var A=bo();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function bo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var $s=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Zu=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  setPickingColor(a_PickingColor);
}
`,Js=function(d){F()(T,d);var A=fu(T);function T(){return Z()(this,T),A.apply(this,arguments)}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=w.coverage,ne=w.angle;return{u_opacity:I||1,u_coverage:j||.9,u_angle:ne||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"hexagonheatmap",vertexShader:Zu,fragmentShader:$s,triangulation:Ta,depth:{enable:!1},primitive:S.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:S.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(I,j){var ne=I.coordinates;return[ne[0],ne[1],0]}}})}}]),T}(pt),Wu={heatmap:vs,heatmap3d:vs,grid:Lo,grid3d:nn,hexagon:Js},wa=Wu;function Ka(d){var A=hu();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function hu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Xu=function(d){F()(T,d);var A=Ka(T);function T(){var E;Z()(this,T);for(var w=arguments.length,I=new Array(w),j=0;j<w;j++)I[j]=arguments[j];return E=A.call.apply(A,[this].concat(I)),E.type="HeatMapLayer",E}return o()(T,[{key:"buildModels",value:function(){var w=this.getModelType();this.layerModel=new wa[w](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){var w=this,I=this.getModelType();return I==="heatmap"?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.models=this.layerModel.buildModels(),this.layerModelNeedUpdate=!1),this.models.forEach(function(j){return j.draw({uniforms:w.layerModel.getUninforms()})}),this)}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var w,I=this.styleAttributeService.getLayerStyleAttribute("shape"),j=this.getLayerConfig(),ne=j.shape3d,ge=this.getSource(),ke=ge.data.type,Dt=(I==null||(w=I.scale)===null||w===void 0?void 0:w.field)||"heatmap";return Dt==="heatmap"||Dt==="heatmap3d"?"heatmap":ke==="hexagon"?(ne==null?void 0:ne.indexOf(Dt))===-1?"hexagon":"grid3d":ke==="grid"?(ne==null?void 0:ne.indexOf(Dt))===-1?"grid":"grid3d":"heatmap"}}]),T}(re);function nc(d){var A=Ot();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function Ot(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var tr=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,Mr=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Xn=function(d){F()(T,d);var A=nc(T);function T(){var E;Z()(this,T);for(var w=arguments.length,I=new Array(w),j=0;j<w;j++)I[j]=arguments[j];return E=A.call.apply(A,[this].concat(I)),E.texture=void 0,E}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity;return{u_opacity:I||1,u_texture:this.texture}}},{key:"initModels",value:function(){var w=this,I=this.layer.getSource(),j=this.rendererService.createTexture2D;return this.texture=j({height:0,width:0}),I.data.images.then(function(ne){w.texture=j({data:ne[0],width:ne[0].width,height:ne[0].height}),w.layerService.renderLayers()}),[this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:Mr,fragmentShader:tr,triangulation:Di,primitive:S.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(I,j,ne,ge){return[ne[3],ne[4]]}}})}}]),T}(pt),Wi={image:Xn},oa=Wi;function Xa(d){var A=zi();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function zi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var La=function(d){F()(T,d);var A=Xa(T);function T(){var E;Z()(this,T);for(var w=arguments.length,I=new Array(w),j=0;j<w;j++)I[j]=arguments[j];return E=A.call.apply(A,[this].concat(I)),E.type="ImageLayer",E}return o()(T,[{key:"buildModels",value:function(){var w=this.getModelType();this.layerModel=new oa[w](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var w=this.getModelType(),I={image:{}};return I[w]}},{key:"getModelType",value:function(){return"image"}}]),T}(re);function Do(d){var A=ms();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function ms(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Aa=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Sl=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;
#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = a_Instance.rg;
  vec2 target =  a_Instance.ba;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  if(u_line_type == LineTypeDash) {
      v_distance_ratio = segmentIndex / segmentNumber;
      float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
      v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
    }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}
`,du={solid:0,dash:1},os=function(d){F()(T,d);var A=Do(T);function T(){return Z()(this,T),A.apply(this,arguments)}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=w.lineType,ne=j===void 0?"solid":j,ge=w.dashArray,ke=ge===void 0?[10,5]:ge;return ke.length===2&&ke.push(0,0),{u_opacity:I||1,segmentNumber:30,u_line_type:du[ne||"solid"],u_dash_array:ke,u_blur:.9}}},{key:"getAnimateUniforms",value:function(){var w=this.layer.getLayerConfig(),I=w.animateOption;return{u_aimate:this.animateOption2Array(I),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Sl,fragmentShader:Aa,triangulation:bi,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(I,j,ne,ge){var ke=I.size,Dt=ke===void 0?1:ke;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:S.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:4,update:function(I,j,ne,ge){return[ne[3],ne[4],ne[5],ne[6]]}}})}}]),T}(pt);function Yu(d){var A=Au();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function Au(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Ku=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;
varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

   if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  setPickingColor(a_PickingColor);
}
`,Cu=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,ol={solid:0,dash:1},pu=function(d){F()(T,d);var A=Yu(T);function T(){return Z()(this,T),A.apply(this,arguments)}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=w.lineType,ne=j===void 0?"solid":j,ge=w.dashArray,ke=ge===void 0?[10,5]:ge;return ke.length===2&&ke.push(0,0),{u_opacity:I||1,segmentNumber:30,u_line_type:ol[ne]||0,u_dash_array:ke}}},{key:"getAnimateUniforms",value:function(){var w=this.layer.getLayerConfig(),I=w.animateOption;return{u_aimate:this.animateOption2Array(I),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc3Dline",vertexShader:Ku,fragmentShader:Cu,triangulation:bi,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(I,j,ne,ge){var ke=I.size,Dt=ke===void 0?1:ke;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:S.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:4,update:function(I,j,ne,ge){return[ne[3],ne[4],ne[5],ne[6]]}}})}}]),T}(pt);function af(d){var A=Nf();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function Nf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var ba=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Nc=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}
vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
}

void main() {
  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  setPickingColor(a_PickingColor);
}

`,Fc={solid:0,dash:1},bf=function(d){F()(T,d);var A=af(T);function T(){return Z()(this,T),A.apply(this,arguments)}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=w.lineType,ne=j===void 0?"solid":j,ge=w.dashArray,ke=ge===void 0?[10,5]:ge;return ke.length===2&&ke.push(0,0),{u_opacity:I||1,segmentNumber:30,u_line_type:Fc[ne]||0,u_dash_array:ke}}},{key:"getAnimateUniforms",value:function(){var w=this.layer.getLayerConfig(),I=w.animateOption;return{u_aimate:this.animateOption2Array(I),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Nc,fragmentShader:ba,triangulation:bi,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(I,j,ne,ge){var ke=I.size,Dt=ke===void 0?1:ke;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:S.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:4,update:function(I,j,ne,ge){return[ne[3],ne[4],ne[5],ne[6]]}}})}}]),T}(pt);function Bc(d){var A=Sf();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function Sf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var ro=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
uniform float u_blur : 0.99;
uniform float u_line_type: 0.0;
uniform float u_opacity : 1.0;
varying vec4 v_color;
varying vec2 v_normal;


// dash
uniform float u_dash_offset : 0.0;
uniform float u_dash_ratio : 0.1;
varying float v_distance_ratio;
varying vec4 v_dash_array;
varying float v_side;


#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
// [animate, duration, interval, trailLength],
void main() {
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
 // dash line
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
    // gl_FragColor.a *=(1.0- step(v_dash_array.x, mod(v_distance_ratio, dashLength)));
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,wu=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5.\uFF0C0, 0];
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;
varying vec2 v_normal;
varying float v_distance_ratio;
varying float v_side;


void main() {

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = a_Distance / a_Total_Distance;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = a_Distance / a_Total_Distance;
  }
  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));
  v_color = a_Color;
  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);
  v_side = a_Miter * a_Size.x;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  setPickingColor(a_PickingColor);
}
`,El={solid:0,dash:1},gs=function(d){F()(T,d);var A=Bc(T);function T(){return Z()(this,T),A.apply(this,arguments)}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=w.lineType,ne=j===void 0?"solid":j,ge=w.dashArray,ke=ge===void 0?[10,5,0,0]:ge;return ke.length===2&&ke.push(0,0),{u_opacity:I||1,u_line_type:El[ne],u_dash_array:ke}}},{key:"getAnimateUniforms",value:function(){var w=this.layer.getLayerConfig(),I=w.animateOption;return{u_aimate:this.animateOption2Array(I),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:wu,fragmentShader:ro,triangulation:_i,primitive:S.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var w=this.layer.getLayerConfig(),I=w.lineType,j=I===void 0?"solid":I;this.styleAttributeService.registerStyleAttribute({name:"distance",type:S.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(ge,ke,Dt,Jt){return[Dt[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:S.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(ge,ke,Dt,Jt){return[Dt[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(ge,ke,Dt,Jt){var Or=ge.size,Fr=Or===void 0?1:Or;return Array.isArray(Fr)?[Fr[0],Fr[1]]:[Fr,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:S.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(ge,ke,Dt,Jt,Or){return Or}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:S.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(ge,ke,Dt,Jt){return[Dt[4]]}}})}}]),T}(pt),kc={arc:os,arc3d:pu,greatcircle:bf,line:gs},bc=kc;function Tl(d){var A=sl();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function sl(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var $u=function(d){F()(T,d);var A=Tl(T);function T(){var E;Z()(this,T);for(var w=arguments.length,I=new Array(w),j=0;j<w;j++)I[j]=arguments[j];return E=A.call.apply(A,[this].concat(I)),E.type="LineLayer",E}return o()(T,[{key:"buildModels",value:function(){var w=this.getModelType();this.layerModel=new bc[w](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var w=this.getModelType(),I={line:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"}};return I[w]}},{key:"getModelType",value:function(){var w,I=this.styleAttributeService.getLayerStyleAttribute("shape"),j=I==null||(w=I.scale)===null||w===void 0?void 0:w.field;return j||"line"}}]),T}(re);function Qs(d){var A=Pu();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function Pu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var jc=`varying vec4 v_color;
uniform float u_opacity: 1.0;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Fl=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform mat4 u_ModelMatrix;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec3 size = a_Size * a_Position;

  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);

  float lightWeight = calc_lighting(pos);
  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(pos);
  setPickingColor(a_PickingColor);
}
`,Pa=function(d){F()(T,d);var A=Qs(T);function T(){return Z()(this,T),A.apply(this,arguments)}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=w.offsets;return{u_opacity:I||1,u_offsets:j||[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:Fl,fragmentShader:jc,triangulation:xi,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(I,j,ne,ge){var ke=I.size;if(ke){var Dt=[];return Array.isArray(ke)&&(Dt=ke.length===2?[ke[0],ke[0],ke[1]]:ke),Array.isArray(ke)||(Dt=[ke]),Dt}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:S.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(I,j,ne,ge,ke){return ke}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:S.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(I,j){var ne=Re(I.coordinates);return[ne[0],ne[1],0]}}})}}]),T}(pt);function Uc(d){var A=Ef();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function Ef(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Sc=`#define Animate 0.0

uniform float u_blur : 0;
uniform float u_opacity : 1;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  lowp float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);
  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  // gl_FragColor = v_color * color_t;
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;
  if(u_aimate.x == Animate) {
    float d = length(v_data.xy);
    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);
    gl_FragColor = vec4(gl_FragColor.xyz, intensity);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Ec=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec2 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;

uniform float u_stroke_width : 2;
uniform vec2 u_offsets;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "projection"
#pragma include "picking"

void main() {
  // unpack color(vec2)
  v_color = a_Color;
  vec2 extrude = a_Extrude;

  float shape_type = a_Shape;

  float newSize = setPickingSize(a_Size);

  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = project_pixel(extrude * (newSize + u_stroke_width) + u_offsets);
  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  // TODO: billboard
  // anti-alias
  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);

  // construct point coords
  v_data = vec4(extrude, antialiasblur,shape_type);

  setPickingColor(a_PickingColor);
}
`,ic=function(d){F()(T,d);var A=Uc(T);function T(){return Z()(this,T),A.apply(this,arguments)}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=I===void 0?1:I,ne=w.stroke,ge=ne===void 0?"rgb(0,0,0,0)":ne,ke=w.strokeWidth,Dt=ke===void 0?1:ke,Jt=w.strokeOpacity,Or=Jt===void 0?1:Jt,Fr=w.offsets,bn=Fr===void 0?[0,0]:Fr;return{u_opacity:j,u_stroke_width:Dt,u_stroke_color:Object(Le.s)(ge),u_stroke_opacity:Or,u_offsets:[-bn[0],bn[1]]}}},{key:"getAnimateUniforms",value:function(){var w=this.layer.getLayerConfig(),I=w.animateOption;return{u_aimate:this.animateOption2Array(I),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),hi)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:Ec,fragmentShader:Sc,triangulation:hi,depth:{enable:!1},blend:this.getBlend()})]}},{key:"animateOption2Array",value:function(w){return[w.enable?0:1,w.speed||1,w.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var w=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:S.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(j,ne,ge,ke){var Dt=[1,1,-1,1,-1,-1,1,-1],Jt=ke%4*2;return[Dt[Jt],Dt[Jt+1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(j,ne,ge,ke){var Dt=j.size,Jt=Dt===void 0?5:Dt;return Array.isArray(Jt)?[Jt[0]]:[Jt]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:S.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(j,ne,ge,ke){var Dt=j.shape,Jt=Dt===void 0?2:Dt,Or=w.layer.getLayerConfig().shape2d,Fr=Or.indexOf(Jt);return[Fr]}}})}}]),T}(pt);function ul(d){var A=_u();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function _u(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Bl=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec4 textureColor=texture2D(u_texture,pos);
if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
      gl_FragColor= textureColor;
}else {
      gl_FragColor= step(0.01, textureColor.z) * v_color;
}
gl_FragColor.a =gl_FragColor.a * u_opacity;
gl_FragColor = filterColor(gl_FragColor);
}
`,Vo=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,ac=function(d){F()(T,d);var A=ul(T);function T(){var E;Z()(this,T);for(var w=arguments.length,I=new Array(w),j=0;j<w;j++)I[j]=arguments[j];return E=A.call.apply(A,[this].concat(I)),E.texture=void 0,E}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity;return{u_opacity:I||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var w=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){w.updateTexture(),w.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:Vo,fragmentShader:Bl,triangulation:ki,primitive:S.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var w=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(j,ne,ge,ke){var Dt=j.size;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(j,ne,ge,ke){var Dt=w.fontService.mapping,Jt=j.shape,Or=w.fontService.getGlyph(Jt),Fr=Dt[Or],bn=Fr.x,gn=Fr.y;return[bn,gn]}}})}},{key:"updateTexture",value:function(){var w=this.rendererService.createTexture2D,I=this.fontService.canvas;this.texture=w({data:I,mag:S.gl.LINEAR,min:S.gl.LINEAR,width:I.width,height:I.height})}},{key:"initIconFontGlyphs",value:function(){var w=this,I=this.layer.getLayerConfig(),j=I.fontWeight,ne=j===void 0?"normal":j,ge=I.fontFamily,ke=ge===void 0?"sans-serif":ge,Dt=this.layer.getEncodedData(),Jt=[];Dt.forEach(function(Or){var Fr=Or.shape,bn=Fr===void 0?"":Fr;bn=bn.toString();var gn=w.fontService.getGlyph(bn);Jt.indexOf(gn)===-1&&Jt.push(gn)}),this.fontService.setFontOptions({characterSet:Jt,fontWeight:ne,fontFamily:ke,fontSize:48})}}]),T}(pt);function kl(d){var A=Al();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function Al(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Tc=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec4 textureColor=texture2D(u_texture,pos);
if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
      gl_FragColor= textureColor;
}else {
      gl_FragColor= step(0.01, textureColor.z) * v_color;
}
gl_FragColor.a =gl_FragColor.a * u_opacity;
gl_FragColor = filterColor(gl_FragColor);
}
`,jl=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,qs=function(d){F()(T,d);var A=kl(T);function T(){var E;Z()(this,T);for(var w=arguments.length,I=new Array(w),j=0;j<w;j++)I[j]=arguments[j];return E=A.call.apply(A,[this].concat(I)),E.texture=void 0,E.updateTexture=function(){var ne=E.rendererService.createTexture2D;if(E.texture){E.texture.update({data:E.iconService.getCanvas()}),E.layer.render();return}E.texture=ne({data:E.iconService.getCanvas(),mag:S.gl.NEAREST,min:S.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:E.iconService.canvasHeight||128})},E}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=w.offsets,ne=j===void 0?[0,0]:j;return this.rendererService.getDirty()&&this.texture.bind(),{u_opacity:I||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_offsets:[-ne[0],ne[1]]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){this.texture&&this.texture.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:jl,fragmentShader:Tc,triangulation:ki,primitive:S.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var w=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(j,ne,ge,ke){var Dt=j.size,Jt=Dt===void 0?5:Dt;return Array.isArray(Jt)?[Jt[0]]:[Jt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(j,ne,ge,ke){var Dt=w.iconService.getIconMap(),Jt=j.shape,Or=Dt[Jt]||{x:0,y:0},Fr=Or.x,bn=Or.y;return[Fr,bn]}}})}}]),T}(pt);function Tf(d){var A=Af();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function Af(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var of=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "picking"
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a =gl_FragColor.a * u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Cl=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform vec2 u_offsets;

#pragma include "projection"
#pragma include "picking"
void main() {
  v_color = a_Color;
  vec2 offset = project_pixel(u_offsets);
  vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
    setPickingColor(a_PickingColor);
}
`;function oc(d){var A=d.coordinates;return{vertices:Vt()(A),indices:[0],size:A.length}}var ll=function(d){F()(T,d);var A=Tf(T);function T(){return Z()(this,T),A.apply(this,arguments)}return o()(T,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=I===void 0?1:I,ne=w.stroke,ge=ne===void 0?"rgb(0,0,0,0)":ne,ke=w.strokeWidth,Dt=ke===void 0?1:ke,Jt=w.offsets,Or=Jt===void 0?[0,0]:Jt;return{u_opacity:j,u_stroke_width:Dt,u_stroke_color:Object(Le.s)(ge),u_offsets:[-Or[0],Or[1]]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:Cl,fragmentShader:of,triangulation:oc,depth:{enable:!1},primitive:S.gl.POINTS,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(I,j,ne,ge){var ke=I.size,Dt=ke===void 0?1:ke;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:S.BlendType.additive}}}]),T}(pt);function Ul(d,A){var T;if(typeof Symbol=="undefined"||d[Symbol.iterator]==null){if(Array.isArray(d)||(T=Ac(d))||A&&d&&typeof d.length=="number"){T&&(d=T);var E=0,w=function(){};return{s:w,n:function(){return E>=d.length?{done:!0}:{done:!1,value:d[E++]}},e:function(ke){throw ke},f:w}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,j=!1,ne;return{s:function(){T=d[Symbol.iterator]()},n:function(){var ke=T.next();return I=ke.done,ke},e:function(ke){j=!0,ne=ke},f:function(){try{!I&&T.return!=null&&T.return()}finally{if(j)throw ne}}}}function Ac(d,A){if(!!d){if(typeof d=="string")return Cc(d,A);var T=Object.prototype.toString.call(d).slice(8,-1);if(T==="Object"&&d.constructor&&(T=d.constructor.name),T==="Map"||T==="Set")return Array.from(d);if(T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T))return Cc(d,A)}}function Cc(d,A){(A==null||A>d.length)&&(A=d.length);for(var T=0,E=new Array(A);T<A;T++)E[T]=d[T];return E}var Vl=function(){function d(A,T,E){Z()(this,d),this.boxCells=[],this.xCellCount=void 0,this.yCellCount=void 0,this.boxKeys=void 0,this.bboxes=void 0,this.width=void 0,this.height=void 0,this.xScale=void 0,this.yScale=void 0,this.boxUid=void 0;var w=this.boxCells;this.xCellCount=Math.ceil(A/E),this.yCellCount=Math.ceil(T/E);for(var I=0;I<this.xCellCount*this.yCellCount;I++)w.push([]);this.boxKeys=[],this.bboxes=[],this.width=A,this.height=T,this.xScale=this.xCellCount/A,this.yScale=this.yCellCount/T,this.boxUid=0}return o()(d,[{key:"insert",value:function(T,E,w,I,j){this.forEachCell(E,w,I,j,this.insertBoxCell,this.boxUid++),this.boxKeys.push(T),this.bboxes.push(E),this.bboxes.push(w),this.bboxes.push(I),this.bboxes.push(j)}},{key:"query",value:function(T,E,w,I,j){return this.queryHitTest(T,E,w,I,!1,j)}},{key:"hitTest",value:function(T,E,w,I,j){return this.queryHitTest(T,E,w,I,!0,j)}},{key:"insertBoxCell",value:function(T,E,w,I,j,ne){this.boxCells[j].push(ne)}},{key:"queryHitTest",value:function(T,E,w,I,j,ne){if(w<0||T>this.width||I<0||E>this.height)return j?!1:[];var ge=[];if(T<=0&&E<=0&&this.width<=w&&this.height<=I){if(j)return!0;for(var ke=0;ke<this.boxKeys.length;ke++)ge.push({key:this.boxKeys[ke],x1:this.bboxes[ke*4],y1:this.bboxes[ke*4+1],x2:this.bboxes[ke*4+2],y2:this.bboxes[ke*4+3]});return ne?ge.filter(ne):ge}var Dt={hitTest:j,seenUids:{box:{},circle:{}}};return this.forEachCell(T,E,w,I,this.queryCell,ge,Dt,ne),j?ge.length>0:ge}},{key:"queryCell",value:function(T,E,w,I,j,ne,ge,ke){var Dt=ge.seenUids,Jt=this.boxCells[j];if(Jt!==null){var Or=this.bboxes,Fr=Ul(Jt),bn;try{for(Fr.s();!(bn=Fr.n()).done;){var gn=bn.value;if(!Dt.box[gn]){Dt.box[gn]=!0;var kn=gn*4;if(T<=Or[kn+2]&&E<=Or[kn+3]&&w>=Or[kn+0]&&I>=Or[kn+1]&&(!ke||ke(this.boxKeys[gn]))){if(ge.hitTest)return ne.push(!0),!0;ne.push({key:this.boxKeys[gn],x1:Or[kn],y1:Or[kn+1],x2:Or[kn+2],y2:Or[kn+3]})}}}}catch(Pi){Fr.e(Pi)}finally{Fr.f()}}return!1}},{key:"forEachCell",value:function(T,E,w,I,j,ne,ge,ke){for(var Dt=this.convertToXCellCoord(T),Jt=this.convertToYCellCoord(E),Or=this.convertToXCellCoord(w),Fr=this.convertToYCellCoord(I),bn=Dt;bn<=Or;bn++)for(var gn=Jt;gn<=Fr;gn++){var kn=this.xCellCount*gn+bn;if(j.call(this,T,E,w,I,kn,ne,ge,ke))return}}},{key:"convertToXCellCoord",value:function(T){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(T*this.xScale)))}},{key:"convertToYCellCoord",value:function(T){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(T*this.yScale)))}}]),d}(),So=Vl,Ff=function(){function d(A,T){Z()(this,d),this.width=void 0,this.height=void 0,this.grid=void 0,this.viewportPadding=100,this.screenRightBoundary=void 0,this.screenBottomBoundary=void 0,this.gridRightBoundary=void 0,this.gridBottomBoundary=void 0,this.width=A,this.height=T,this.viewportPadding=Math.max(A,T),this.grid=new So(A+this.viewportPadding,T+this.viewportPadding,25),this.screenRightBoundary=A+this.viewportPadding,this.screenBottomBoundary=T+this.viewportPadding,this.gridRightBoundary=A+2*this.viewportPadding,this.gridBottomBoundary=T+2*this.viewportPadding}return o()(d,[{key:"placeCollisionBox",value:function(T){var E=T.x1+T.anchorPointX+this.viewportPadding,w=T.y1+T.anchorPointY+this.viewportPadding,I=T.x2+T.anchorPointX+this.viewportPadding,j=T.y2+T.anchorPointY+this.viewportPadding;return!this.isInsideGrid(E,w,I,j)||this.grid.hitTest(E,w,I,j)?{box:[]}:{box:[E,w,I,j]}}},{key:"insertCollisionBox",value:function(T,E){var w={featureIndex:E};this.grid.insert(w,T[0],T[1],T[2],T[3])}},{key:"project",value:function(T,E,w){var I=cr.e.fromValues(E,w,0,1),j=cr.e.create(),ne=cr.b.fromValues.apply(cr.b,Vt()(T));return cr.e.transformMat4(j,I,ne),{x:(j[0]/j[3]+1)/2*this.width+this.viewportPadding,y:(-j[1]/j[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(T,E,w,I){return w>=0&&T<this.gridRightBoundary&&I>=0&&E<this.gridBottomBoundary}}]),d}();function Cf(d,A){var T;if(typeof Symbol=="undefined"||d[Symbol.iterator]==null){if(Array.isArray(d)||(T=sc(d))||A&&d&&typeof d.length=="number"){T&&(d=T);var E=0,w=function(){};return{s:w,n:function(){return E>=d.length?{done:!0}:{done:!1,value:d[E++]}},e:function(ke){throw ke},f:w}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,j=!1,ne;return{s:function(){T=d[Symbol.iterator]()},n:function(){var ke=T.next();return I=ke.done,ke},e:function(ke){j=!0,ne=ke},f:function(){try{!I&&T.return!=null&&T.return()}finally{if(j)throw ne}}}}function sc(d,A){if(!!d){if(typeof d=="string")return Vc(d,A);var T=Object.prototype.toString.call(d).slice(8,-1);if(T==="Object"&&d.constructor&&(T=d.constructor.name),T==="Map"||T==="Set")return Array.from(d);if(T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T))return Vc(d,A)}}function Vc(d,A){(A==null||A>d.length)&&(A=d.length);for(var T=0,E=new Array(A);T<A;T++)E[T]=d[T];return E}function sf(d){var A=.5,T=.5;switch(d){case"right":case"top-right":case"bottom-right":A=1;break;case"left":case"top-left":case"bottom-left":A=0;break;default:A=.5}switch(d){case"bottom":case"bottom-right":case"bottom-left":T=1;break;case"top":case"top-right":case"top-left":T=0;break;default:T=.5}return{horizontalAlign:A,verticalAlign:T}}function uf(d,A,T,E,w){if(!!w){var I=d[E],j=I.glyph;if(j)for(var ne=A[j].advance*I.scale,ge=(d[E].x+ne)*w,ke=T;ke<=E;ke++)d[ke].x-=ge}}function Gl(d,A,T,E,w,I,j){var ne=(A-T)*w,ge=(-E*j+.5)*I,ke=Cf(d),Dt;try{for(ke.s();!(Dt=ke.n()).done;){var Jt=Dt.value;Jt.x+=ne,Jt.y+=ge}}catch(Or){ke.e(Or)}finally{ke.f()}}function lf(d,A,T,E,w,I,j){var ne=-8,ge=0,ke=ne,Dt=0,Jt=d.positionedGlyphs,Or=I==="right"?1:I==="left"?0:.5,Fr=Jt.length;T.forEach(function(Oi){if(Oi.split("").forEach(function(pa){var va=A[pa],so=0;va&&(Jt.push({glyph:pa,x:ge,y:ke+so,vertical:!1,scale:1,metrics:va}),ge+=va.advance+j)}),Jt.length!==Fr){var Ga=ge-j;Dt=Math.max(Ga,Dt),uf(Jt,A,Fr,Jt.length-1,Or)}ge=0,ke+=E});var bn=sf(w),gn=bn.horizontalAlign,kn=bn.verticalAlign;Gl(Jt,Or,gn,kn,Dt,E,T.length);var Pi=ke-ne;d.top+=-kn*Pi,d.bottom=d.top+Pi,d.left+=-gn*Dt,d.right=d.left+Dt}function Mu(d,A,T,E,w,I){var j=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],ne=d.split(`
`),ge=[],ke={positionedGlyphs:ge,top:j[1],bottom:j[1],left:j[0],right:j[0],lineCount:ne.length,text:d};return lf(ke,A,ne,T,E,w,I),ge.length?ke:!1}function Ra(d){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],T=arguments.length>2?arguments[2]:void 0,E=d.positionedGlyphs,w=E===void 0?[]:E,I=[],j=Cf(w),ne;try{for(j.s();!(ne=j.n()).done;){var ge=ne.value,ke=ge.metrics,Dt=4,Jt=ke.advance*ge.scale/2,Or=T?[ge.x+Jt,ge.y]:[0,0],Fr=T?[0,0]:[ge.x+Jt+A[0],ge.y+A[1]],bn=(0-Dt)*ge.scale-Jt+Fr[0],gn=(0-Dt)*ge.scale+Fr[1],kn=bn+ke.width*ge.scale,Pi=gn+ke.height*ge.scale,Oi={x:bn,y:gn},Ga={x:kn,y:gn},pa={x:bn,y:Pi},va={x:kn,y:Pi};I.push({tl:Oi,tr:Ga,bl:pa,br:va,tex:ke,glyphOffset:Or})}}catch(so){j.e(so)}finally{j.f()}return I}function eu(d,A){var T;if(typeof Symbol=="undefined"||d[Symbol.iterator]==null){if(Array.isArray(d)||(T=Go(d))||A&&d&&typeof d.length=="number"){T&&(d=T);var E=0,w=function(){};return{s:w,n:function(){return E>=d.length?{done:!0}:{done:!1,value:d[E++]}},e:function(ke){throw ke},f:w}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,j=!1,ne;return{s:function(){T=d[Symbol.iterator]()},n:function(){var ke=T.next();return I=ke.done,ke},e:function(ke){j=!0,ne=ke},f:function(){try{!I&&T.return!=null&&T.return()}finally{if(j)throw ne}}}}function Go(d,A){if(!!d){if(typeof d=="string")return Iu(d,A);var T=Object.prototype.toString.call(d).slice(8,-1);if(T==="Object"&&d.constructor&&(T=d.constructor.name),T==="Map"||T==="Set")return Array.from(d);if(T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T))return Iu(d,A)}}function Iu(d,A){(A==null||A>d.length)&&(A=d.length);for(var T=0,E=new Array(A);T<A;T++)E[T]=d[T];return E}function ji(d){var A=Da();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function Da(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var js=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform float u_stroke_opacity: 1.0;
uniform vec4 u_stroke : [0, 0, 0, 1];
uniform float u_strokeWidth : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "picking"
void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  lowp float buff = (6.0 - u_strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke.rgb, u_stroke.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,tu=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;
attribute float a_Rotate;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
   v_fontScale = fontScale;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
 highp float angle_sin = sin(a_Rotate);
 highp float angle_cos = cos(a_Rotate);
 mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  gl_Position = vec4(projected_position.xy / projected_position.w
    + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function Hl(d){var A=this,T=d.id,E=[],w=[];if(!A.glyphInfoMap||!A.glyphInfoMap[T])return{vertices:[],indices:[],size:7};var I=A.glyphInfoMap[T].centroid,j=I.length===2?[I[0],I[1],0]:I;return A.glyphInfoMap[T].glyphQuads.forEach(function(ne,ge){E.push.apply(E,Vt()(j).concat([ne.tex.x,ne.tex.y+ne.tex.height,ne.tl.x,ne.tl.y],Vt()(j),[ne.tex.x+ne.tex.width,ne.tex.y+ne.tex.height,ne.tr.x,ne.tr.y],Vt()(j),[ne.tex.x+ne.tex.width,ne.tex.y,ne.br.x,ne.br.y],Vt()(j),[ne.tex.x,ne.tex.y,ne.bl.x,ne.bl.y])),w.push(0+ge*4,1+ge*4,2+ge*4,2+ge*4,3+ge*4,0+ge*4)}),{vertices:E,indices:w,size:7}}var uc=function(d){F()(T,d);var A=ji(T);function T(){var E;Z()(this,T);for(var w=arguments.length,I=new Array(w),j=0;j<w;j++)I[j]=arguments[j];return E=A.call.apply(A,[this].concat(I)),E.glyphInfo=void 0,E.glyphInfoMap={},E.texture=void 0,E.currentZoom=-1,E.extent=void 0,E.textureHeight=0,E.textCount=0,E.preTextStyle={},E.buildModels=function(){return E.initGlyph(),E.updateTexture(),E.filterGlyphs(),[E.layer.buildLayerModel({moduleName:"pointText",vertexShader:tu,fragmentShader:js,triangulation:Hl.bind(xt()(E)),depth:{enable:!1},blend:E.getBlend()})]},E}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=I===void 0?1:I,ne=w.stroke,ge=ne===void 0?"#fff":ne,ke=w.strokeWidth,Dt=ke===void 0?0:ke,Jt=w.strokeOpacity,Or=Jt===void 0?1:Jt,Fr=w.textAnchor,bn=Fr===void 0?"center":Fr,gn=w.textAllowOverlap,kn=gn===void 0?!1:gn,Pi=w.halo,Oi=Pi===void 0?.5:Pi,Ga=w.gamma,pa=Ga===void 0?2:Ga,va=this.fontService,so=va.canvas,Li=va.mapping;return Object.keys(Li).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(Li).length),this.preTextStyle={textAnchor:bn,textAllowOverlap:kn},{u_opacity:j,u_stroke_opacity:Or,u_sdf_map:this.texture,u_stroke:Object(Le.s)(ge),u_halo_blur:Oi,u_gamma_scale:pa,u_sdf_map_size:[so.width,so.height],u_strokeWidth:Dt}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var w=this.layer.getLayerConfig(),I=w.textAnchor,j=I===void 0?"center":I,ne=w.textAllowOverlap,ge=ne===void 0?!0:ne;return this.preTextStyle={textAnchor:j,textAllowOverlap:ge},this.buildModels()}},{key:"needUpdate",value:function(){var w=this.layer.getLayerConfig(),I=w.textAllowOverlap,j=I===void 0?!1:I,ne=this.mapService.getZoom(),ge=this.mapService.getBounds(),ke=Object(Le.j)(this.extent,ge);return!j&&(Math.abs(this.currentZoom-ne)>1||!ke)||j!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:S.AttributeType.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(I,j,ne,ge){var ke=I.rotate,Dt=ke===void 0?0:ke;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:S.AttributeType.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(I,j,ne,ge){return[ne[5],ne[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(I,j,ne,ge){var ke=I.size,Dt=ke===void 0?12:ke;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:S.AttributeType.Attribute,descriptor:{name:"a_tex",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(I,j,ne,ge){return[ne[3],ne[4]]}}})}},{key:"textExtent",value:function(){var w=this.mapService.getBounds();return Object(Le.r)(w,.5)}},{key:"initTextFont",value:function(){var w=this.layer.getLayerConfig(),I=w.fontWeight,j=I===void 0?"400":I,ne=w.fontFamily,ge=ne===void 0?"sans-serif":ne,ke=this.layer.getEncodedData(),Dt=[];ke.forEach(function(Jt){var Or=Jt.shape,Fr=Or===void 0?"":Or;Fr=Fr.toString();var bn=eu(Fr),gn;try{for(bn.s();!(gn=bn.n()).done;){var kn=gn.value;Dt.indexOf(kn)===-1&&Dt.push(kn)}}catch(Pi){bn.e(Pi)}finally{bn.f()}}),this.fontService.setFontOptions({characterSet:Dt,fontWeight:j,fontFamily:ge})}},{key:"generateGlyphLayout",value:function(){var w=this,I=this.fontService.mapping,j=this.layer.getLayerConfig(),ne=j.spacing,ge=ne===void 0?2:ne,ke=j.textAnchor,Dt=ke===void 0?"center":ke,Jt=j.textOffset,Or=this.layer.getEncodedData();this.glyphInfo=Or.map(function(Fr){var bn=Fr.shape,gn=bn===void 0?"":bn,kn=Fr.coordinates,Pi=Fr.id,Oi=Fr.size,Ga=Oi===void 0?1:Oi,pa=Mu(gn.toString(),I,Ga,Dt,"center",ge,Jt),va=Ra(pa,Jt,!1);return Fr.shaping=pa,Fr.glyphQuads=va,Fr.centroid=Re(kn),w.glyphInfoMap[Pi]={shaping:pa,glyphQuads:va,centroid:Re(kn)},Fr})}},{key:"filterGlyphs",value:function(){var w=this,I=this.layer.getLayerConfig(),j=I.padding,ne=j===void 0?[4,4]:j,ge=I.textAllowOverlap,ke=ge===void 0?!1:ge;if(!ke){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var Dt=this.rendererService.getViewportSize(),Jt=Dt.width,Or=Dt.height,Fr=new Ff(Jt,Or),bn=this.glyphInfo.filter(function(gn){var kn=gn.shaping,Pi=gn.id,Oi=Pi===void 0?0:Pi,Ga=gn.centroid,pa=gn.size,va=pa/24,so=w.mapService.lngLatToContainer(Ga),Li=Fr.placeCollisionBox({x1:kn.left*va-ne[0],x2:kn.right*va+ne[0],y1:kn.top*va-ne[1],y2:kn.bottom*va+ne[1],anchorPointX:so.x,anchorPointY:so.y}),uo=Li.box;return uo&&uo.length?(Fr.insertCollisionBox(uo,Oi),!0):!1});bn.forEach(function(gn){w.glyphInfoMap[gn.id]=gn})}}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var w=this.rendererService.createTexture2D,I=this.fontService.canvas;this.textureHeight=I.height,this.texture&&this.texture.destroy(),this.texture=w({data:I,mag:S.gl.LINEAR,min:S.gl.LINEAR,width:I.width,height:I.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:tu,fragmentShader:js,triangulation:Hl.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),T}(pt),wf={fill:ic,image:qs,normal:ll,extrude:Pa,text:uc,icon:ac},zo=wf;function Zl(d){var A=ya();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function ya(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Ki=function(d){F()(T,d);var A=Zl(T);function T(){var E;Z()(this,T);for(var w=arguments.length,I=new Array(w),j=0;j<w;j++)I[j]=arguments[j];return E=A.call.apply(A,[this].concat(I)),E.type="PointLayer",E}return o()(T,[{key:"buildModels",value:function(){var w=this.getModelType();this.layerModel=new zo[w](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var w=this.getModelType(),I={normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return I[w]}},{key:"getModelType",value:function(){var w=this.getEncodedData(),I=this.getLayerConfig(),j=I.shape2d,ne=I.shape3d,ge=this.iconService.getIconMap(),ke=w.find(function(Jt){return Jt.hasOwnProperty("shape")});if(ke){var Dt=ke.shape;return Dt==="dot"?"normal":(j==null?void 0:j.indexOf(Dt))!==-1?"fill":(ne==null?void 0:ne.indexOf(Dt))!==-1?"extrude":ge.hasOwnProperty(Dt)?"image":this.fontService.getGlyph(Dt)!==""?"icon":"text"}else return"normal"}}]),T}(re);function fo(d){var A=ys();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function ys(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var wl=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,$a=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,Mn=function(d){F()(T,d);var A=fo(T);function T(){return Z()(this,T),A.apply(this,arguments)}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=I===void 0?1:I;return{u_opacity:j}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:$a,fragmentShader:wl,triangulation:pi})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:S.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:S.gl.STATIC_DRAW,data:[],type:S.gl.FLOAT},size:3,update:function(I,j,ne,ge,ke){return ke}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:S.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(I,j,ne,ge){var ke=I.size,Dt=ke===void 0?10:ke;return Array.isArray(Dt)?[Dt[0]]:[Dt]}}})}}]),T}(pt);function zs(d){var A=wc();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function wc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var cl=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,vu=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`,Us=function(d){F()(T,d);var A=zs(T);function T(){return Z()(this,T),A.apply(this,arguments)}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=I===void 0?1:I;return{u_opacity:j}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:vu,fragmentShader:cl,triangulation:eo,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){}}]),T}(pt),Ou={fill:Us,line:gs,extrude:Mn,text:uc,point_fill:ic,point_image:qs,point_normal:ll,point_extrude:Pa},an=Ou;function Gc(d){var A=lc();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function lc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Wl=function(d){F()(T,d);var A=Gc(T);function T(){var E;Z()(this,T);for(var w=arguments.length,I=new Array(w),j=0;j<w;j++)I[j]=arguments[j];return E=A.call.apply(A,[this].concat(I)),E.type="PolygonLayer",E}return o()(T,[{key:"buildModels",value:function(){var w=this.getModelType();this.layerModel=new an[w](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var w,I=this.styleAttributeService.getLayerStyleAttribute("shape"),j=I==null||(w=I.scale)===null||w===void 0?void 0:w.field;return j==="fill"?"fill":j==="extrude"?"extrude":j==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var w=this.getEncodedData(),I=this.getLayerConfig(),j=I.shape2d,ne=I.shape3d,ge=this.iconService.getIconMap(),ke=w.find(function(Jt){return Jt.hasOwnProperty("shape")});if(ke){var Dt=ke.shape;return Dt==="dot"?"point_normal":(j==null?void 0:j.indexOf(Dt))!==-1?"point_fill":(ne==null?void 0:ne.indexOf(Dt))!==-1?"point_extrude":ge.hasOwnProperty(Dt)?"point_image":"text"}else return"fill"}}]),T}(re);function mu(d){var A=Gi();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function Gi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var cf=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }


}
`,ff=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Vs=function(d){F()(T,d);var A=mu(T);function T(){var E;Z()(this,T);for(var w=arguments.length,I=new Array(w),j=0;j<w;j++)I[j]=arguments[j];return E=A.call.apply(A,[this].concat(I)),E.texture=void 0,E.colorTexture=void 0,E}return o()(T,[{key:"getUninforms",value:function(){var w=this.layer.getLayerConfig(),I=w.opacity,j=I===void 0?1:I,ne=w.clampLow,ge=ne===void 0?!0:ne,ke=w.clampHigh,Dt=ke===void 0?!0:ke,Jt=w.noDataValue,Or=Jt===void 0?-9999999:Jt,Fr=w.domain,bn=Fr===void 0?[0,1]:Fr;return this.updateColorTexure(),{u_opacity:j||1,u_texture:this.texture,u_domain:bn,u_clampLow:ge,u_clampHigh:typeof Dt!="undefined"?Dt:ge,u_noDataValue:Or,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(){var w=this.layer.getSource(),I=this.rendererService.createTexture2D,j=w.data.dataArray[0];this.texture=I({data:j.data,width:j.width,height:j.height,format:S.gl.LUMINANCE,type:S.gl.FLOAT});var ne=this.layer.getLayerConfig(),ge=ne.rampColors,ke=Object(Le.n)(ge);return this.colorTexture=I({data:ke.data,width:ke.width,height:ke.height,flipY:!1}),[this.layer.buildLayerModel({moduleName:"RasterImageData",vertexShader:ff,fragmentShader:cf,triangulation:Di,primitive:S.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:S.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:2,update:function(I,j,ne,ge){return[ne[3],ne[4]]}}})}},{key:"updateColorTexure",value:function(){var w=this.rendererService.createTexture2D,I=this.layer.getLayerConfig(),j=I.rampColors,ne=Object(Le.n)(j);this.colorTexture=w({data:ne.data,width:ne.width,height:ne.height,flipY:!1})}}]),T}(pt),fl={raster:Vs,raster3d:Vs},Hc=fl;function Xl(d){var A=Ns();return function(){var E=$()(d),w;if(A){var I=$()(this).constructor;w=Reflect.construct(E,arguments,I)}else w=E.apply(this,arguments);return q()(this,w)}}function Ns(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}var Ho=function(d){F()(T,d);var A=Xl(T);function T(){var E;Z()(this,T);for(var w=arguments.length,I=new Array(w),j=0;j<w;j++)I[j]=arguments[j];return E=A.call.apply(A,[this].concat(I)),E.type="RasterLayer",E}return o()(T,[{key:"buildModels",value:function(){var w=this.getModelType();this.layerModel=new Hc[w](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var w=this.getModelType(),I={raster:{},raster3d:{}};return I[w]}},{key:"getModelType",value:function(){return"raster"}}]),T}(re),ss,us,Ti,Lu,Zo,ho,Ru,Ju;function gu(d,A){var T=Object.keys(d);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(d);A&&(E=E.filter(function(w){return Object.getOwnPropertyDescriptor(d,w).enumerable})),T.push.apply(T,E)}return T}function Ms(d){for(var A=1;A<arguments.length;A++){var T=arguments[A]!=null?arguments[A]:{};A%2?gu(Object(T),!0).forEach(function(E){st()(d,E,T[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(T)):gu(Object(T)).forEach(function(E){Object.defineProperty(d,E,Object.getOwnPropertyDescriptor(T,E))})}return d}var ru=(ss=Object(dt.injectable)(),us=Object(dt.inject)(S.TYPES.IGlobalConfigService),Ti=Object(dt.inject)(S.TYPES.ILogService),ss(Lu=(Zo=(Ju=function(){function d(){Z()(this,d),Me()(this,"configService",ho,this),Me()(this,"logger",Ru,this)}return o()(d,[{key:"apply",value:function(T,E){var w=this,I=E.styleAttributeService;T.hooks.init.tap("DataMappingPlugin",function(){w.generateMaping(T,{styleAttributeService:I})}),T.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return T.dataState.dataMappingNeedUpdate=!1,w.generateMaping(T,{styleAttributeService:I}),!0}),T.hooks.beforeRender.tap("DataMappingPlugin",function(){if(!T.layerModelNeedUpdate){var j=I.getLayerStyleAttributes()||[],ne=I.getLayerStyleAttribute("filter"),ge=T.getSource().data.dataArray,ke=j.filter(function(Jt){return Jt.needRemapping}),Dt=ge;(ne==null?void 0:ne.needRemapping)&&(ne==null?void 0:ne.scale)&&(Dt=ge.filter(function(Jt){return w.applyAttributeMapping(ne,Jt)[0]})),ke.length&&((ne==null?void 0:ne.needRemapping)?(T.setEncodedData(w.mapping(j,Dt)),ne.needRemapping=!1):T.setEncodedData(w.mapping(ke,Dt,T.getEncodedData())),w.logger.debug("remapping finished"),T.emit("remapping",null))}})}},{key:"generateMaping",value:function(T,E){var w=this,I=E.styleAttributeService,j=I.getLayerStyleAttributes()||[],ne=I.getLayerStyleAttribute("filter"),ge=T.getSource().data.dataArray,ke=ge;(ne==null?void 0:ne.scale)&&(ke=ge.filter(function(Dt){return w.applyAttributeMapping(ne,Dt)[0]})),T.setEncodedData(this.mapping(j,ke))}},{key:"mapping",value:function(T,E,w){var I=this;return E.map(function(j,ne){var ge=w?w[ne]:{},ke=Ms({id:j._id,coordinates:j.coordinates},ge);return T.filter(function(Dt){return Dt.scale!==void 0}).forEach(function(Dt){var Jt=I.applyAttributeMapping(Dt,j);Dt.needRemapping=!1,Dt.name==="color"&&(Jt=Jt.map(function(Or){return Object(Le.s)(Or)})),ke[Dt.name]=Array.isArray(Jt)&&Jt.length===1?Jt[0]:Jt}),ke})}},{key:"applyAttributeMapping",value:function(T,E){var w;if(!T.scale)return[];var I=(T==null||(w=T.scale)===null||w===void 0?void 0:w.scalers)||[],j=[];return I.forEach(function(ne){var ge,ke=ne.field;(E.hasOwnProperty(ke)||((ge=T.scale)===null||ge===void 0?void 0:ge.type)==="variable")&&j.push(E[ke])}),T.mapping?T.mapping(j):[]}}]),d}(),Ju),ho=De()(Zo.prototype,"configService",[us],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ru=De()(Zo.prototype,"logger",[Ti],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zo))||Lu),Jn=a("rlAn"),Bn,Pl,xs,Wo=(Bn=Object(dt.injectable)(),Bn(Pl=(xs=function(){function d(){Z()(this,d),this.mapService=void 0}return o()(d,[{key:"apply",value:function(T){var E=this;this.mapService=T.getContainer().get(S.TYPES.IMapService),T.hooks.init.tap("DataSourcePlugin",function(){var w=T.sourceOption,I=w.data,j=w.options;T.setSource(new Jn.default(I,j)),E.updateClusterData(T)}),T.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var w=E.updateClusterData(T),I=T.dataState.dataSourceNeedUpdate;return T.dataState.dataSourceNeedUpdate=!1,w||I})}},{key:"updateClusterData",value:function(T){var E=T.getSource(),w=E.cluster,I=E.clusterOptions,j=I.zoom,ne=j===void 0?0:j,ge=I.maxZoom,ke=ge===void 0?16:ge,Dt=this.mapService.getZoom()-1;return w&&Math.abs(ne-Dt)>1&&ke>ne?(E.updateClusterData(Math.floor(Dt)),!0):!1}}]),d}(),xs))||Pl),No=a("7tbW"),nu=a.n(No),Du=a("4qC0"),cc=a.n(Du),na=a("J2iB"),po=a.n(na),hl=function(d,A){return d<A?-1:d>A?1:d>=A?0:NaN},dl=function(d){return d.length===1&&(d=fc(d)),{left:function(T,E,w,I){for(w==null&&(w=0),I==null&&(I=T.length);w<I;){var j=w+I>>>1;d(T[j],E)<0?w=j+1:I=j}return w},right:function(T,E,w,I){for(w==null&&(w=0),I==null&&(I=T.length);w<I;){var j=w+I>>>1;d(T[j],E)>0?I=j:w=j+1}return w}}};function fc(d){return function(A,T){return hl(d(A),T)}}var zu=dl(hl),Is=zu.right,Yl=zu.left,Gs=Is,Pf=function(d,A){A==null&&(A=Kl);for(var T=0,E=d.length-1,w=d[0],I=new Array(E<0?0:E);T<E;)I[T]=A(w,w=d[++T]);return I};function Kl(d,A){return[d,A]}var Zc=function(d,A,T){var E=d.length,w=A.length,I=new Array(E*w),j,ne,ge,ke;for(T==null&&(T=Kl),j=ge=0;j<E;++j)for(ke=d[j],ne=0;ne<w;++ne,++ge)I[ge]=T(ke,A[ne]);return I},_f=function(d,A){return A<d?-1:A>d?1:A>=d?0:NaN},bs=function(d){return d===null?NaN:+d},Nu=function(d,A){var T=d.length,E=0,w=-1,I=0,j,ne,ge=0;if(A==null)for(;++w<T;)isNaN(j=bs(d[w]))||(ne=j-I,I+=ne/++E,ge+=ne*(j-I));else for(;++w<T;)isNaN(j=bs(A(d[w],w,d)))||(ne=j-I,I+=ne/++E,ge+=ne*(j-I));if(E>1)return ge/(E-1)},Wc=function(d,A){var T=Nu(d,A);return T&&Math.sqrt(T)},_l=function(d,A){var T=d.length,E=-1,w,I,j;if(A==null){for(;++E<T;)if((w=d[E])!=null&&w>=w)for(I=j=w;++E<T;)(w=d[E])!=null&&(I>w&&(I=w),j<w&&(j=w))}else for(;++E<T;)if((w=A(d[E],E,d))!=null&&w>=w)for(I=j=w;++E<T;)(w=A(d[E],E,d))!=null&&(I>w&&(I=w),j<w&&(j=w));return[I,j]},Ml=Array.prototype,hc=Ml.slice,Qu=Ml.map,Fs=function(d){return function(){return d}},dc=function(d){return d},pl=function(d,A,T){d=+d,A=+A,T=(w=arguments.length)<2?(A=d,d=0,1):w<3?1:+T;for(var E=-1,w=Math.max(0,Math.ceil((A-d)/T))|0,I=new Array(w);++E<w;)I[E]=d+E*T;return I},vl=Math.sqrt(50),Il=Math.sqrt(10),s=Math.sqrt(2),i=function(d,A,T){var E,w=-1,I,j,ne;if(A=+A,d=+d,T=+T,d===A&&T>0)return[d];if((E=A<d)&&(I=d,d=A,A=I),(ne=n(d,A,T))===0||!isFinite(ne))return[];if(ne>0)for(d=Math.ceil(d/ne),A=Math.floor(A/ne),j=new Array(I=Math.ceil(A-d+1));++w<I;)j[w]=(d+w)*ne;else for(d=Math.floor(d*ne),A=Math.ceil(A*ne),j=new Array(I=Math.ceil(d-A+1));++w<I;)j[w]=(d-w)/ne;return E&&j.reverse(),j};function n(d,A,T){var E=(A-d)/Math.max(0,T),w=Math.floor(Math.log(E)/Math.LN10),I=E/Math.pow(10,w);return w>=0?(I>=vl?10:I>=Il?5:I>=s?2:1)*Math.pow(10,w):-Math.pow(10,-w)/(I>=vl?10:I>=Il?5:I>=s?2:1)}function l(d,A,T){var E=Math.abs(A-d)/Math.max(0,T),w=Math.pow(10,Math.floor(Math.log(E)/Math.LN10)),I=E/w;return I>=vl?w*=10:I>=Il?w*=5:I>=s&&(w*=2),A<d?-w:w}var y=function(d){return Math.ceil(Math.log(d.length)/Math.LN2)+1},M=function(){var d=dc,A=_l,T=y;function E(w){var I,j=w.length,ne,ge=new Array(j);for(I=0;I<j;++I)ge[I]=d(w[I],I,w);var ke=A(ge),Dt=ke[0],Jt=ke[1],Or=T(ge,Dt,Jt);Array.isArray(Or)||(Or=l(Dt,Jt,Or),Or=pl(Math.ceil(Dt/Or)*Or,Jt,Or));for(var Fr=Or.length;Or[0]<=Dt;)Or.shift(),--Fr;for(;Or[Fr-1]>Jt;)Or.pop(),--Fr;var bn=new Array(Fr+1),gn;for(I=0;I<=Fr;++I)gn=bn[I]=[],gn.x0=I>0?Or[I-1]:Dt,gn.x1=I<Fr?Or[I]:Jt;for(I=0;I<j;++I)ne=ge[I],Dt<=ne&&ne<=Jt&&bn[Gs(Or,ne,0,Fr)].push(w[I]);return bn}return E.value=function(w){return arguments.length?(d=typeof w=="function"?w:Fs(w),E):d},E.domain=function(w){return arguments.length?(A=typeof w=="function"?w:Fs([w[0],w[1]]),E):A},E.thresholds=function(w){return arguments.length?(T=typeof w=="function"?w:Array.isArray(w)?Fs(hc.call(w)):Fs(w),E):T},E},L=function(d,A,T){if(T==null&&(T=bs),!!(E=d.length)){if((A=+A)<=0||E<2)return+T(d[0],0,d);if(A>=1)return+T(d[E-1],E-1,d);var E,w=(E-1)*A,I=Math.floor(w),j=+T(d[I],I,d),ne=+T(d[I+1],I+1,d);return j+(ne-j)*(w-I)}},B=function(d,A,T){return d=Qu.call(d,bs).sort(hl),Math.ceil((T-A)/(2*(L(d,.75)-L(d,.25))*Math.pow(d.length,-1/3)))},oe=function(d,A,T){return Math.ceil((T-A)/(3.5*Wc(d)*Math.pow(d.length,-1/3)))},Te=function(d,A){var T=d.length,E=-1,w,I;if(A==null){for(;++E<T;)if((w=d[E])!=null&&w>=w)for(I=w;++E<T;)(w=d[E])!=null&&w>I&&(I=w)}else for(;++E<T;)if((w=A(d[E],E,d))!=null&&w>=w)for(I=w;++E<T;)(w=A(d[E],E,d))!=null&&w>I&&(I=w);return I},Ge=function(d,A){var T=d.length,E=T,w=-1,I,j=0;if(A==null)for(;++w<T;)isNaN(I=bs(d[w]))?--E:j+=I;else for(;++w<T;)isNaN(I=bs(A(d[w],w,d)))?--E:j+=I;if(E)return j/E},Ke=function(d,A){var T=d.length,E=-1,w,I=[];if(A==null)for(;++E<T;)isNaN(w=bs(d[E]))||I.push(w);else for(;++E<T;)isNaN(w=bs(A(d[E],E,d)))||I.push(w);return L(I.sort(hl),.5)},et=function(d){for(var A=d.length,T,E=-1,w=0,I,j;++E<A;)w+=d[E].length;for(I=new Array(w);--A>=0;)for(j=d[A],T=j.length;--T>=0;)I[--w]=j[T];return I},Ft=function(d,A){var T=d.length,E=-1,w,I;if(A==null){for(;++E<T;)if((w=d[E])!=null&&w>=w)for(I=w;++E<T;)(w=d[E])!=null&&I>w&&(I=w)}else for(;++E<T;)if((w=A(d[E],E,d))!=null&&w>=w)for(I=w;++E<T;)(w=A(d[E],E,d))!=null&&I>w&&(I=w);return I},Rt=function(d,A){for(var T=A.length,E=new Array(T);T--;)E[T]=d[A[T]];return E},Yt=function(d,A){if(!!(T=d.length)){var T,E=0,w=0,I,j=d[w];for(A==null&&(A=hl);++E<T;)(A(I=d[E],j)<0||A(j,j)!==0)&&(j=I,w=E);if(A(j,j)===0)return w}},zt=function(d,A,T){for(var E=(T==null?d.length:T)-(A=A==null?0:+A),w,I;E;)I=Math.random()*E--|0,w=d[E+A],d[E+A]=d[I+A],d[I+A]=w;return d},jt=function(d,A){var T=d.length,E=-1,w,I=0;if(A==null)for(;++E<T;)(w=+d[E])&&(I+=w);else for(;++E<T;)(w=+A(d[E],E,d))&&(I+=w);return I},rr=function(d){if(!(I=d.length))return[];for(var A=-1,T=Ft(d,nr),E=new Array(T);++A<T;)for(var w=-1,I,j=E[A]=new Array(I);++w<I;)j[w]=d[w][A];return E};function nr(d){return d.length}var zr=function(){return rr(arguments)};function pr(d,A){switch(arguments.length){case 0:break;case 1:this.range(d);break;default:this.range(A).domain(d);break}return this}function Ar(d,A){switch(arguments.length){case 0:break;case 1:this.interpolator(d);break;default:this.interpolator(A).domain(d);break}return this}var wr="$";function sn(){}sn.prototype=$r.prototype={constructor:sn,has:function(A){return wr+A in this},get:function(A){return this[wr+A]},set:function(A,T){return this[wr+A]=T,this},remove:function(A){var T=wr+A;return T in this&&delete this[T]},clear:function(){for(var A in this)A[0]===wr&&delete this[A]},keys:function(){var A=[];for(var T in this)T[0]===wr&&A.push(T.slice(1));return A},values:function(){var A=[];for(var T in this)T[0]===wr&&A.push(this[T]);return A},entries:function(){var A=[];for(var T in this)T[0]===wr&&A.push({key:T.slice(1),value:this[T]});return A},size:function(){var A=0;for(var T in this)T[0]===wr&&++A;return A},empty:function(){for(var A in this)if(A[0]===wr)return!1;return!0},each:function(A){for(var T in this)T[0]===wr&&A(this[T],T.slice(1),this)}};function $r(d,A){var T=new sn;if(d instanceof sn)d.each(function(ne,ge){T.set(ge,ne)});else if(Array.isArray(d)){var E=-1,w=d.length,I;if(A==null)for(;++E<w;)T.set(E,d[E]);else for(;++E<w;)T.set(A(I=d[E],E,d),I)}else if(d)for(var j in d)T.set(j,d[j]);return T}var xn=$r,In=function(){var d=[],A=[],T,E,w;function I(ne,ge,ke,Dt){if(ge>=d.length)return T!=null&&ne.sort(T),E!=null?E(ne):ne;for(var Jt=-1,Or=ne.length,Fr=d[ge++],bn,gn,kn=xn(),Pi,Oi=ke();++Jt<Or;)(Pi=kn.get(bn=Fr(gn=ne[Jt])+""))?Pi.push(gn):kn.set(bn,[gn]);return kn.each(function(Ga,pa){Dt(Oi,pa,I(Ga,ge,ke,Dt))}),Oi}function j(ne,ge){if(++ge>d.length)return ne;var ke,Dt=A[ge-1];return E!=null&&ge>=d.length?ke=ne.entries():(ke=[],ne.each(function(Jt,Or){ke.push({key:Or,values:j(Jt,ge)})})),Dt!=null?ke.sort(function(Jt,Or){return Dt(Jt.key,Or.key)}):ke}return w={object:function(ge){return I(ge,0,ei,si)},map:function(ge){return I(ge,0,Ii,$i)},entries:function(ge){return j(I(ge,0,Ii,$i),0)},key:function(ge){return d.push(ge),w},sortKeys:function(ge){return A[d.length-1]=ge,w},sortValues:function(ge){return T=ge,w},rollup:function(ge){return E=ge,w}}};function ei(){return{}}function si(d,A,T){d[A]=T}function Ii(){return xn()}function $i(d,A,T){d.set(A,T)}function wn(){}var ui=xn.prototype;wn.prototype=Si.prototype={constructor:wn,has:ui.has,add:function(A){return A+="",this[wr+A]=A,this},remove:ui.remove,clear:ui.clear,values:ui.keys,size:ui.size,empty:ui.empty,each:ui.each};function Si(d,A){var T=new wn;if(d instanceof wn)d.each(function(I){T.add(I)});else if(d){var E=-1,w=d.length;if(A==null)for(;++E<w;)T.add(d[E]);else for(;++E<w;)T.add(A(d[E],E,d))}return T}var Hn=Si,Ei=function(d){var A=[];for(var T in d)A.push(T);return A},ii=function(d){var A=[];for(var T in d)A.push(d[T]);return A},Ni=function(d){var A=[];for(var T in d)A.push({key:T,value:d[T]});return A},Hi=Array.prototype,no=Hi.map,za=Hi.slice,Mo={name:"implicit"};function _a(){var d=xn(),A=[],T=[],E=Mo;function w(I){var j=I+"",ne=d.get(j);if(!ne){if(E!==Mo)return E;d.set(j,ne=A.push(I))}return T[(ne-1)%T.length]}return w.domain=function(I){if(!arguments.length)return A.slice();A=[],d=xn();for(var j=-1,ne=I.length,ge,ke;++j<ne;)d.has(ke=(ge=I[j])+"")||d.set(ke,A.push(ge));return w},w.range=function(I){return arguments.length?(T=za.call(I),w):T.slice()},w.unknown=function(I){return arguments.length?(E=I,w):E},w.copy=function(){return _a(A,T).unknown(E)},pr.apply(w,arguments),w}function Ja(){var d=_a().unknown(void 0),A=d.domain,T=d.range,E=[0,1],w,I,j=!1,ne=0,ge=0,ke=.5;delete d.unknown;function Dt(){var Jt=A().length,Or=E[1]<E[0],Fr=E[Or-0],bn=E[1-Or];w=(bn-Fr)/Math.max(1,Jt-ne+ge*2),j&&(w=Math.floor(w)),Fr+=(bn-Fr-w*(Jt-ne))*ke,I=w*(1-ne),j&&(Fr=Math.round(Fr),I=Math.round(I));var gn=pl(Jt).map(function(kn){return Fr+w*kn});return T(Or?gn.reverse():gn)}return d.domain=function(Jt){return arguments.length?(A(Jt),Dt()):A()},d.range=function(Jt){return arguments.length?(E=[+Jt[0],+Jt[1]],Dt()):E.slice()},d.rangeRound=function(Jt){return E=[+Jt[0],+Jt[1]],j=!0,Dt()},d.bandwidth=function(){return I},d.step=function(){return w},d.round=function(Jt){return arguments.length?(j=!!Jt,Dt()):j},d.padding=function(Jt){return arguments.length?(ne=Math.min(1,ge=+Jt),Dt()):ne},d.paddingInner=function(Jt){return arguments.length?(ne=Math.min(1,Jt),Dt()):ne},d.paddingOuter=function(Jt){return arguments.length?(ge=+Jt,Dt()):ge},d.align=function(Jt){return arguments.length?(ke=Math.max(0,Math.min(1,Jt)),Dt()):ke},d.copy=function(){return Ja(A(),E).round(j).paddingInner(ne).paddingOuter(ge).align(ke)},pr.apply(Dt(),arguments)}function Os(d){var A=d.copy;return d.padding=d.paddingOuter,delete d.paddingInner,delete d.paddingOuter,d.copy=function(){return Os(A())},d}function Ls(){return Os(Ja.apply(null,arguments).paddingInner(1))}var yu=a("FmoU");function Fu(d,A,T,E,w){var I=d*d,j=I*d;return((1-3*d+3*I-j)*A+(4-6*I+3*j)*T+(1+3*d+3*I-3*j)*E+j*w)/6}var Ss=function(d){var A=d.length-1;return function(T){var E=T<=0?T=0:T>=1?(T=1,A-1):Math.floor(T*A),w=d[E],I=d[E+1],j=E>0?d[E-1]:2*w-I,ne=E<A-1?d[E+2]:2*I-w;return Fu((T-E/A)*A,j,w,I,ne)}},Bs=function(d){var A=d.length;return function(T){var E=Math.floor(((T%=1)<0?++T:T)*A),w=d[(E+A-1)%A],I=d[E%A],j=d[(E+1)%A],ne=d[(E+2)%A];return Fu((T-E/A)*A,w,I,j,ne)}},Bu=function(d){return function(){return d}};function xu(d,A){return function(T){return d+T*A}}function qu(d,A,T){return d=Math.pow(d,T),A=Math.pow(A,T)-d,T=1/T,function(E){return Math.pow(d+E*A,T)}}function $l(d,A){var T=A-d;return T?xu(d,T>180||T<-180?T-360*Math.round(T/360):T):Bu(isNaN(d)?A:d)}function ml(d){return(d=+d)==1?iu:function(A,T){return T-A?qu(A,T,d):Bu(isNaN(A)?T:A)}}function iu(d,A){var T=A-d;return T?xu(d,T):Bu(isNaN(d)?A:d)}var pc=function d(A){var T=ml(A);function E(w,I){var j=T((w=Object(yu.b)(w)).r,(I=Object(yu.b)(I)).r),ne=T(w.g,I.g),ge=T(w.b,I.b),ke=iu(w.opacity,I.opacity);return function(Dt){return w.r=j(Dt),w.g=ne(Dt),w.b=ge(Dt),w.opacity=ke(Dt),w+""}}return E.gamma=d,E}(1);function bu(d){return function(A){var T=A.length,E=new Array(T),w=new Array(T),I=new Array(T),j,ne;for(j=0;j<T;++j)ne=Object(yu.b)(A[j]),E[j]=ne.r||0,w[j]=ne.g||0,I[j]=ne.b||0;return E=d(E),w=d(w),I=d(I),ne.opacity=1,function(ge){return ne.r=E(ge),ne.g=w(ge),ne.b=I(ge),ne+""}}}var Eo=bu(Ss),gl=bu(Bs),Jl=function(d,A){A||(A=[]);var T=d?Math.min(A.length,d.length):0,E=A.slice(),w;return function(I){for(w=0;w<T;++w)E[w]=d[w]*(1-I)+A[w]*I;return E}};function Rs(d){return ArrayBuffer.isView(d)&&!(d instanceof DataView)}var To=function(d,A){return(Rs(A)?Jl:vo)(d,A)};function vo(d,A){var T=A?A.length:0,E=d?Math.min(T,d.length):0,w=new Array(E),I=new Array(T),j;for(j=0;j<E;++j)w[j]=vc(d[j],A[j]);for(;j<T;++j)I[j]=A[j];return function(ne){for(j=0;j<E;++j)I[j]=w[j](ne);return I}}var es=function(d,A){var T=new Date;return d=+d,A=+A,function(E){return T.setTime(d*(1-E)+A*E),T}},Ao=function(d,A){return d=+d,A=+A,function(T){return d*(1-T)+A*T}},io=function(d,A){var T={},E={},w;(d===null||typeof d!="object")&&(d={}),(A===null||typeof A!="object")&&(A={});for(w in A)w in d?T[w]=vc(d[w],A[w]):E[w]=A[w];return function(I){for(w in T)E[w]=T[w](I);return E}},ts=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yl=new RegExp(ts.source,"g");function Pc(d){return function(){return d}}function Xc(d){return function(A){return d(A)+""}}var el=function(d,A){var T=ts.lastIndex=yl.lastIndex=0,E,w,I,j=-1,ne=[],ge=[];for(d=d+"",A=A+"";(E=ts.exec(d))&&(w=yl.exec(A));)(I=w.index)>T&&(I=A.slice(T,I),ne[j]?ne[j]+=I:ne[++j]=I),(E=E[0])===(w=w[0])?ne[j]?ne[j]+=w:ne[++j]=w:(ne[++j]=null,ge.push({i:j,x:Ao(E,w)})),T=yl.lastIndex;return T<A.length&&(I=A.slice(T),ne[j]?ne[j]+=I:ne[++j]=I),ne.length<2?ge[0]?Xc(ge[0].x):Pc(A):(A=ge.length,function(ke){for(var Dt=0,Jt;Dt<A;++Dt)ne[(Jt=ge[Dt]).i]=Jt.x(ke);return ne.join("")})},vc=function(d,A){var T=typeof A,E;return A==null||T==="boolean"?Bu(A):(T==="number"?Ao:T==="string"?(E=Object(yu.a)(A))?(A=E,pc):el:A instanceof yu.a?pc:A instanceof Date?es:Rs(A)?Jl:Array.isArray(A)?vo:typeof A.valueOf!="function"&&typeof A.toString!="function"||isNaN(A)?io:Ao)(d,A)},Ol=function(d,A){return d=+d,A=+A,function(T){return Math.round(d*(1-T)+A*T)}},Hs=function(d){return function(){return d}},Fo=function(d){return+d},Ql=[0,1];function Es(d){return d}function ql(d,A){return(A-=d=+d)?function(T){return(T-d)/A}:Hs(isNaN(A)?NaN:.5)}function hf(d){var A=d[0],T=d[d.length-1],E;return A>T&&(E=A,A=T,T=E),function(w){return Math.max(A,Math.min(T,w))}}function Zf(d,A,T){var E=d[0],w=d[1],I=A[0],j=A[1];return w<E?(E=ql(w,E),I=T(j,I)):(E=ql(E,w),I=T(I,j)),function(ne){return I(E(ne))}}function lh(d,A,T){var E=Math.min(d.length,A.length)-1,w=new Array(E),I=new Array(E),j=-1;for(d[E]<d[0]&&(d=d.slice().reverse(),A=A.slice().reverse());++j<E;)w[j]=ql(d[j],d[j+1]),I[j]=T(A[j],A[j+1]);return function(ne){var ge=Gs(d,ne,1,E)-1;return I[ge](w[ge](ne))}}function xl(d,A){return A.domain(d.domain()).range(d.range()).interpolate(d.interpolate()).clamp(d.clamp()).unknown(d.unknown())}function Mf(){var d=Ql,A=Ql,T=vc,E,w,I,j=Es,ne,ge,ke;function Dt(){return ne=Math.min(d.length,A.length)>2?lh:Zf,ge=ke=null,Jt}function Jt(Or){return isNaN(Or=+Or)?I:(ge||(ge=ne(d.map(E),A,T)))(E(j(Or)))}return Jt.invert=function(Or){return j(w((ke||(ke=ne(A,d.map(E),Ao)))(Or)))},Jt.domain=function(Or){return arguments.length?(d=no.call(Or,Fo),j===Es||(j=hf(d)),Dt()):d.slice()},Jt.range=function(Or){return arguments.length?(A=za.call(Or),Dt()):A.slice()},Jt.rangeRound=function(Or){return A=za.call(Or),T=Ol,Dt()},Jt.clamp=function(Or){return arguments.length?(j=Or?hf(d):Es,Jt):j!==Es},Jt.interpolate=function(Or){return arguments.length?(T=Or,Dt()):T},Jt.unknown=function(Or){return arguments.length?(I=Or,Jt):I},function(Or,Fr){return E=Or,w=Fr,Dt()}}function df(d,A){return Mf()(d,A)}var Bf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ku(d){if(!(A=Bf.exec(d)))throw new Error("invalid format: "+d);var A;return new mc({fill:A[1],align:A[2],sign:A[3],symbol:A[4],zero:A[5],width:A[6],comma:A[7],precision:A[8]&&A[8].slice(1),trim:A[9],type:A[10]})}ku.prototype=mc.prototype;function mc(d){this.fill=d.fill===void 0?" ":d.fill+"",this.align=d.align===void 0?">":d.align+"",this.sign=d.sign===void 0?"-":d.sign+"",this.symbol=d.symbol===void 0?"":d.symbol+"",this.zero=!!d.zero,this.width=d.width===void 0?void 0:+d.width,this.comma=!!d.comma,this.precision=d.precision===void 0?void 0:+d.precision,this.trim=!!d.trim,this.type=d.type===void 0?"":d.type+""}mc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};var Wf=function(d){return Math.abs(d=Math.round(d))>=1e21?d.toLocaleString("en").replace(/,/g,""):d.toString(10)};function _c(d,A){if((T=(d=A?d.toExponential(A-1):d.toExponential()).indexOf("e"))<0)return null;var T,E=d.slice(0,T);return[E.length>1?E[0]+E.slice(2):E,+d.slice(T+1)]}var Mc=function(d){return d=_c(Math.abs(d)),d?d[1]:NaN},Ic=function(d,A){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Mc(A)/3)))*3-Mc(Math.abs(d)))},Xf=function(d,A){return function(T,E){for(var w=T.length,I=[],j=0,ne=d[0],ge=0;w>0&&ne>0&&(ge+ne+1>E&&(ne=Math.max(1,E-ge)),I.push(T.substring(w-=ne,w+ne)),!((ge+=ne+1)>E));)ne=d[j=(j+1)%d.length];return I.reverse().join(A)}},Yf=function(d){return function(A){return A.replace(/[0-9]/g,function(T){return d[+T]})}},Kf=function(d){e:for(var A=d.length,T=1,E=-1,w;T<A;++T)switch(d[T]){case".":E=w=T;break;case"0":E===0&&(E=T),w=T;break;default:if(!+d[T])break e;E>0&&(E=0);break}return E>0?d.slice(0,E)+d.slice(w+1):d},If,ch=function(d,A){var T=_c(d,A);if(!T)return d+"";var E=T[0],w=T[1],I=w-(If=Math.max(-8,Math.min(8,Math.floor(w/3)))*3)+1,j=E.length;return I===j?E:I>j?E+new Array(I-j+1).join("0"):I>0?E.slice(0,I)+"."+E.slice(I):"0."+new Array(1-I).join("0")+_c(d,Math.max(0,A+I-1))[0]},ec=function(d,A){var T=_c(d,A);if(!T)return d+"";var E=T[0],w=T[1];return w<0?"0."+new Array(-w).join("0")+E:E.length>w+1?E.slice(0,w+1)+"."+E.slice(w+1):E+new Array(w-E.length+2).join("0")},Yc={"%":function(A,T){return(A*100).toFixed(T)},b:function(A){return Math.round(A).toString(2)},c:function(A){return A+""},d:Wf,e:function(A,T){return A.toExponential(T)},f:function(A,T){return A.toFixed(T)},g:function(A,T){return A.toPrecision(T)},o:function(A){return Math.round(A).toString(8)},p:function(A,T){return ec(A*100,T)},r:ec,s:ch,X:function(A){return Math.round(A).toString(16).toUpperCase()},x:function(A){return Math.round(A).toString(16)}},mo=function(d){return d},tc=Array.prototype.map,Of=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],Kc=function(d){var A=d.grouping===void 0||d.thousands===void 0?mo:Xf(tc.call(d.grouping,Number),d.thousands+""),T=d.currency===void 0?"":d.currency[0]+"",E=d.currency===void 0?"":d.currency[1]+"",w=d.decimal===void 0?".":d.decimal+"",I=d.numerals===void 0?mo:Yf(tc.call(d.numerals,String)),j=d.percent===void 0?"%":d.percent+"",ne=d.minus===void 0?"-":d.minus+"",ge=d.nan===void 0?"NaN":d.nan+"";function ke(Jt){Jt=ku(Jt);var Or=Jt.fill,Fr=Jt.align,bn=Jt.sign,gn=Jt.symbol,kn=Jt.zero,Pi=Jt.width,Oi=Jt.comma,Ga=Jt.precision,pa=Jt.trim,va=Jt.type;va==="n"?(Oi=!0,va="g"):Yc[va]||(Ga===void 0&&(Ga=12),pa=!0,va="g"),(kn||Or==="0"&&Fr==="=")&&(kn=!0,Or="0",Fr="=");var so=gn==="$"?T:gn==="#"&&/[boxX]/.test(va)?"0"+va.toLowerCase():"",Li=gn==="$"?E:/[%p]/.test(va)?j:"",uo=Yc[va],Oo=/[defgprs%]/.test(va);Ga=Ga===void 0?6:/[gprs]/.test(va)?Math.max(1,Math.min(21,Ga)):Math.max(0,Math.min(20,Ga));function Ys(ra){var Ds=so,ns=Li,xf,kh,Dc;if(va==="c")ns=uo(ra)+ns,ra="";else{ra=+ra;var Ch=ra<0||1/ra<0;if(ra=isNaN(ra)?ge:uo(Math.abs(ra),Ga),pa&&(ra=Kf(ra)),Ch&&+ra==0&&bn!=="+"&&(Ch=!1),Ds=(Ch?bn==="("?bn:ne:bn==="-"||bn==="("?"":bn)+Ds,ns=(va==="s"?Of[8+If/3]:"")+ns+(Ch&&bn==="("?")":""),Oo){for(xf=-1,kh=ra.length;++xf<kh;)if(Dc=ra.charCodeAt(xf),48>Dc||Dc>57){ns=(Dc===46?w+ra.slice(xf+1):ra.slice(xf))+ns,ra=ra.slice(0,xf);break}}}Oi&&!kn&&(ra=A(ra,Infinity));var dh=Ds.length+ra.length+ns.length,ef=dh<Pi?new Array(Pi-dh+1).join(Or):"";switch(Oi&&kn&&(ra=A(ef+ra,ef.length?Pi-ns.length:Infinity),ef=""),Fr){case"<":ra=Ds+ra+ns+ef;break;case"=":ra=Ds+ef+ra+ns;break;case"^":ra=ef.slice(0,dh=ef.length>>1)+Ds+ra+ns+ef.slice(dh);break;default:ra=ef+Ds+ra+ns;break}return I(ra)}return Ys.toString=function(){return Jt+""},Ys}function Dt(Jt,Or){var Fr=ke((Jt=ku(Jt),Jt.type="f",Jt)),bn=Math.max(-8,Math.min(8,Math.floor(Mc(Or)/3)))*3,gn=Math.pow(10,-bn),kn=Of[8+bn/3];return function(Pi){return Fr(gn*Pi)+kn}}return{format:ke,formatPrefix:Dt}},au,Ll,Lf;Rf({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Rf(d){return au=Kc(d),Ll=au.format,Lf=au.formatPrefix,au}var Oc=function(d,A){return d=Math.abs(d),A=Math.abs(A)-d,Math.max(0,Mc(A)-Mc(d))+1},pf=function(d){return Math.max(0,-Mc(Math.abs(d)))},$c=function(d,A,T,E){var w=l(d,A,T),I;switch(E=ku(E==null?",f":E),E.type){case"s":{var j=Math.max(Math.abs(d),Math.abs(A));return E.precision==null&&!isNaN(I=Ic(w,j))&&(E.precision=I),Lf(E,j)}case"":case"e":case"g":case"p":case"r":{E.precision==null&&!isNaN(I=Oc(w,Math.max(Math.abs(d),Math.abs(A))))&&(E.precision=I-(E.type==="e"));break}case"f":case"%":{E.precision==null&&!isNaN(I=pf(w))&&(E.precision=I-(E.type==="%")*2);break}}return Ll(E)};function Rl(d){var A=d.domain;return d.ticks=function(T){var E=A();return i(E[0],E[E.length-1],T==null?10:T)},d.tickFormat=function(T,E){var w=A();return $c(w[0],w[w.length-1],T==null?10:T,E)},d.nice=function(T){T==null&&(T=10);var E=A(),w=0,I=E.length-1,j=E[w],ne=E[I],ge;return ne<j&&(ge=j,j=ne,ne=ge,ge=w,w=I,I=ge),ge=n(j,ne,T),ge>0?(j=Math.floor(j/ge)*ge,ne=Math.ceil(ne/ge)*ge,ge=n(j,ne,T)):ge<0&&(j=Math.ceil(j*ge)/ge,ne=Math.floor(ne*ge)/ge,ge=n(j,ne,T)),ge>0?(E[w]=Math.floor(j/ge)*ge,E[I]=Math.ceil(ne/ge)*ge,A(E)):ge<0&&(E[w]=Math.ceil(j*ge)/ge,E[I]=Math.floor(ne*ge)/ge,A(E)),d},d}function ee(){var d=df(Es,Es);return d.copy=function(){return xl(d,ee())},pr.apply(d,arguments),Rl(d)}function ie(d){var A;function T(E){return isNaN(E=+E)?A:E}return T.invert=T,T.domain=T.range=function(E){return arguments.length?(d=no.call(E,Fo),T):d.slice()},T.unknown=function(E){return arguments.length?(A=E,T):A},T.copy=function(){return ie(d).unknown(A)},d=arguments.length?no.call(d,Fo):[0,1],Rl(T)}var D=function(d,A){d=d.slice();var T=0,E=d.length-1,w=d[T],I=d[E],j;return I<w&&(j=T,T=E,E=j,j=w,w=I,I=j),d[T]=A.floor(w),d[E]=A.ceil(I),d};function U(d){return Math.log(d)}function Se(d){return Math.exp(d)}function tt(d){return-Math.log(-d)}function Ut(d){return-Math.exp(-d)}function qt(d){return isFinite(d)?+("1e"+d):d<0?0:d}function er(d){return d===10?qt:d===Math.E?Math.exp:function(A){return Math.pow(d,A)}}function _r(d){return d===Math.E?Math.log:d===10&&Math.log10||d===2&&Math.log2||(d=Math.log(d),function(A){return Math.log(A)/d})}function en(d){return function(A){return-d(-A)}}function Rn(d){var A=d(U,Se),T=A.domain,E=10,w,I;function j(){return w=_r(E),I=er(E),T()[0]<0?(w=en(w),I=en(I),d(tt,Ut)):d(U,Se),A}return A.base=function(ne){return arguments.length?(E=+ne,j()):E},A.domain=function(ne){return arguments.length?(T(ne),j()):T()},A.ticks=function(ne){var ge=T(),ke=ge[0],Dt=ge[ge.length-1],Jt;(Jt=Dt<ke)&&(Or=ke,ke=Dt,Dt=Or);var Or=w(ke),Fr=w(Dt),bn,gn,kn,Pi=ne==null?10:+ne,Oi=[];if(!(E%1)&&Fr-Or<Pi){if(Or=Math.round(Or)-1,Fr=Math.round(Fr)+1,ke>0){for(;Or<Fr;++Or)for(gn=1,bn=I(Or);gn<E;++gn)if(kn=bn*gn,!(kn<ke)){if(kn>Dt)break;Oi.push(kn)}}else for(;Or<Fr;++Or)for(gn=E-1,bn=I(Or);gn>=1;--gn)if(kn=bn*gn,!(kn<ke)){if(kn>Dt)break;Oi.push(kn)}}else Oi=i(Or,Fr,Math.min(Fr-Or,Pi)).map(I);return Jt?Oi.reverse():Oi},A.tickFormat=function(ne,ge){if(ge==null&&(ge=E===10?".0e":","),typeof ge!="function"&&(ge=Ll(ge)),ne===Infinity)return ge;ne==null&&(ne=10);var ke=Math.max(1,E*ne/A.ticks().length);return function(Dt){var Jt=Dt/I(Math.round(w(Dt)));return Jt*E<E-.5&&(Jt*=E),Jt<=ke?ge(Dt):""}},A.nice=function(){return T(D(T(),{floor:function(ge){return I(Math.floor(w(ge)))},ceil:function(ge){return I(Math.ceil(w(ge)))}}))},A}function $n(){var d=Rn(Mf()).domain([1,10]);return d.copy=function(){return xl(d,$n()).base(d.base())},pr.apply(d,arguments),d}function ri(d){return function(A){return Math.sign(A)*Math.log1p(Math.abs(A/d))}}function Mi(d){return function(A){return Math.sign(A)*Math.expm1(Math.abs(A))*d}}function Ri(d){var A=1,T=d(ri(A),Mi(A));return T.constant=function(E){return arguments.length?d(ri(A=+E),Mi(A)):A},Rl(T)}function fa(){var d=Ri(Mf());return d.copy=function(){return xl(d,fa()).constant(d.constant())},pr.apply(d,arguments)}function ua(d){return function(A){return A<0?-Math.pow(-A,d):Math.pow(A,d)}}function Na(d){return d<0?-Math.sqrt(-d):Math.sqrt(d)}function go(d){return d<0?-d*d:d*d}function ao(d){var A=d(Es,Es),T=1;function E(){return T===1?d(Es,Es):T===.5?d(Na,go):d(ua(T),ua(1/T))}return A.exponent=function(w){return arguments.length?(T=+w,E()):T},Rl(A)}function Va(){var d=ao(Mf());return d.copy=function(){return xl(d,Va()).exponent(d.exponent())},pr.apply(d,arguments),d}function Co(){return Va.apply(null,arguments).exponent(.5)}function Xi(){var d=[],A=[],T=[],E;function w(){var j=0,ne=Math.max(1,A.length);for(T=new Array(ne-1);++j<ne;)T[j-1]=L(d,j/ne);return I}function I(j){return isNaN(j=+j)?E:A[Gs(T,j)]}return I.invertExtent=function(j){var ne=A.indexOf(j);return ne<0?[NaN,NaN]:[ne>0?T[ne-1]:d[0],ne<T.length?T[ne]:d[d.length-1]]},I.domain=function(j){if(!arguments.length)return d.slice();d=[];for(var ne=0,ge=j.length,ke;ne<ge;++ne)ke=j[ne],ke!=null&&!isNaN(ke=+ke)&&d.push(ke);return d.sort(hl),w()},I.range=function(j){return arguments.length?(A=za.call(j),w()):A.slice()},I.unknown=function(j){return arguments.length?(E=j,I):E},I.quantiles=function(){return T.slice()},I.copy=function(){return Xi().domain(d).range(A).unknown(E)},pr.apply(I,arguments)}function Qa(){var d=0,A=1,T=1,E=[.5],w=[0,1],I;function j(ge){return ge<=ge?w[Gs(E,ge,0,T)]:I}function ne(){var ge=-1;for(E=new Array(T);++ge<T;)E[ge]=((ge+1)*A-(ge-T)*d)/(T+1);return j}return j.domain=function(ge){return arguments.length?(d=+ge[0],A=+ge[1],ne()):[d,A]},j.range=function(ge){return arguments.length?(T=(w=za.call(ge)).length-1,ne()):w.slice()},j.invertExtent=function(ge){var ke=w.indexOf(ge);return ke<0?[NaN,NaN]:ke<1?[d,E[0]]:ke>=T?[E[T-1],A]:[E[ke-1],E[ke]]},j.unknown=function(ge){return arguments.length&&(I=ge),j},j.thresholds=function(){return E.slice()},j.copy=function(){return Qa().domain([d,A]).range(w).unknown(I)},pr.apply(Rl(j),arguments)}function ls(){var d=[.5],A=[0,1],T,E=1;function w(I){return I<=I?A[Gs(d,I,0,E)]:T}return w.domain=function(I){return arguments.length?(d=za.call(I),E=Math.min(d.length,A.length-1),w):d.slice()},w.range=function(I){return arguments.length?(A=za.call(I),E=Math.min(d.length,A.length-1),w):A.slice()},w.invertExtent=function(I){var j=A.indexOf(I);return[d[j-1],d[j]]},w.unknown=function(I){return arguments.length?(T=I,w):T},w.copy=function(){return ls().domain(d).range(A).unknown(T)},pr.apply(w,arguments)}var Sa=new Date,Ma=new Date;function gi(d,A,T,E){function w(I){return d(I=arguments.length===0?new Date:new Date(+I)),I}return w.floor=function(I){return d(I=new Date(+I)),I},w.ceil=function(I){return d(I=new Date(I-1)),A(I,1),d(I),I},w.round=function(I){var j=w(I),ne=w.ceil(I);return I-j<ne-I?j:ne},w.offset=function(I,j){return A(I=new Date(+I),j==null?1:Math.floor(j)),I},w.range=function(I,j,ne){var ge=[],ke;if(I=w.ceil(I),ne=ne==null?1:Math.floor(ne),!(I<j)||!(ne>0))return ge;do ge.push(ke=new Date(+I)),A(I,ne),d(I);while(ke<I&&I<j);return ge},w.filter=function(I){return gi(function(j){if(j>=j)for(;d(j),!I(j);)j.setTime(j-1)},function(j,ne){if(j>=j)if(ne<0)for(;++ne<=0;)for(;A(j,-1),!I(j););else for(;--ne>=0;)for(;A(j,1),!I(j););})},T&&(w.count=function(I,j){return Sa.setTime(+I),Ma.setTime(+j),d(Sa),d(Ma),Math.floor(T(Sa,Ma))},w.every=function(I){return I=Math.floor(I),!isFinite(I)||!(I>0)?null:I>1?w.filter(E?function(j){return E(j)%I==0}:function(j){return w.count(0,j)%I==0}):w}),w}var Bo=gi(function(d){d.setMonth(0,1),d.setHours(0,0,0,0)},function(d,A){d.setFullYear(d.getFullYear()+A)},function(d,A){return A.getFullYear()-d.getFullYear()},function(d){return d.getFullYear()});Bo.every=function(d){return!isFinite(d=Math.floor(d))||!(d>0)?null:gi(function(A){A.setFullYear(Math.floor(A.getFullYear()/d)*d),A.setMonth(0,1),A.setHours(0,0,0,0)},function(A,T){A.setFullYear(A.getFullYear()+T*d)})};var gc=Bo,$f=Bo.range,vh=gi(function(d){d.setDate(1),d.setHours(0,0,0,0)},function(d,A){d.setMonth(d.getMonth()+A)},function(d,A){return A.getMonth()-d.getMonth()+(A.getFullYear()-d.getFullYear())*12},function(d){return d.getMonth()}),Jf=vh,ju=vh.range,Qf=1e3,vf=6e4,qf=36e5,Ph=864e5,mh=6048e5;function Df(d){return gi(function(A){A.setDate(A.getDate()-(A.getDay()+7-d)%7),A.setHours(0,0,0,0)},function(A,T){A.setDate(A.getDate()+T*7)},function(A,T){return(T-A-(T.getTimezoneOffset()-A.getTimezoneOffset())*vf)/mh})}var fh=Df(0),eh=Df(1),gh=Df(2),jh=Df(3),kf=Df(4),jf=Df(5),_h=Df(6),xe=fh.range,Fe=eh.range,At=gh.range,xr=jh.range,Rr=kf.range,Pr=jf.range,br=_h.range,Yr=gi(function(d){d.setHours(0,0,0,0)},function(d,A){d.setDate(d.getDate()+A)},function(d,A){return(A-d-(A.getTimezoneOffset()-d.getTimezoneOffset())*vf)/Ph},function(d){return d.getDate()-1}),tn=Yr,on=Yr.range,rn=gi(function(d){d.setTime(d-d.getMilliseconds()-d.getSeconds()*Qf-d.getMinutes()*vf)},function(d,A){d.setTime(+d+A*qf)},function(d,A){return(A-d)/qf},function(d){return d.getHours()}),cn=rn,Pn=rn.range,mn=gi(function(d){d.setTime(d-d.getMilliseconds()-d.getSeconds()*Qf)},function(d,A){d.setTime(+d+A*vf)},function(d,A){return(A-d)/vf},function(d){return d.getMinutes()}),un=mn,Sr=mn.range,gr=gi(function(d){d.setTime(d-d.getMilliseconds())},function(d,A){d.setTime(+d+A*Qf)},function(d,A){return(A-d)/Qf},function(d){return d.getUTCSeconds()}),Kr=gr,On=gr.range,Dr=gi(function(){},function(d,A){d.setTime(+d+A)},function(d,A){return A-d});Dr.every=function(d){return d=Math.floor(d),!isFinite(d)||!(d>0)?null:d>1?gi(function(A){A.setTime(Math.floor(A/d)*d)},function(A,T){A.setTime(+A+T*d)},function(A,T){return(T-A)/d}):Dr};var Qn=Dr,qr=Dr.range;function Gr(d){return gi(function(A){A.setUTCDate(A.getUTCDate()-(A.getUTCDay()+7-d)%7),A.setUTCHours(0,0,0,0)},function(A,T){A.setUTCDate(A.getUTCDate()+T*7)},function(A,T){return(T-A)/mh})}var Hr=Gr(0),Qr=Gr(1),Yn=Gr(2),ai=Gr(3),ln=Gr(4),Wr=Gr(5),jr=Gr(6),vi=Hr.range,di=Qr.range,Nn=Yn.range,ea=ai.range,Ai=ln.range,Ji=Wr.range,ma=jr.range,Xo=gi(function(d){d.setUTCHours(0,0,0,0)},function(d,A){d.setUTCDate(d.getUTCDate()+A)},function(d,A){return(A-d)/Ph},function(d){return d.getUTCDate()-1}),Ts=Xo,ta=Xo.range,wo=gi(function(d){d.setUTCMonth(0,1),d.setUTCHours(0,0,0,0)},function(d,A){d.setUTCFullYear(d.getUTCFullYear()+A)},function(d,A){return A.getUTCFullYear()-d.getUTCFullYear()},function(d){return d.getUTCFullYear()});wo.every=function(d){return!isFinite(d=Math.floor(d))||!(d>0)?null:gi(function(A){A.setUTCFullYear(Math.floor(A.getUTCFullYear()/d)*d),A.setUTCMonth(0,1),A.setUTCHours(0,0,0,0)},function(A,T){A.setUTCFullYear(A.getUTCFullYear()+T*d)})};var Fa=wo,As=wo.range;function rs(d){if(0<=d.y&&d.y<100){var A=new Date(-1,d.m,d.d,d.H,d.M,d.S,d.L);return A.setFullYear(d.y),A}return new Date(d.y,d.m,d.d,d.H,d.M,d.S,d.L)}function ko(d){if(0<=d.y&&d.y<100){var A=new Date(Date.UTC(-1,d.m,d.d,d.H,d.M,d.S,d.L));return A.setUTCFullYear(d.y),A}return new Date(Date.UTC(d.y,d.m,d.d,d.H,d.M,d.S,d.L))}function cs(d,A,T){return{y:d,m:A,d:T,H:0,M:0,S:0,L:0}}function Zs(d){var A=d.dateTime,T=d.date,E=d.time,w=d.periods,I=d.days,j=d.shortDays,ne=d.months,ge=d.shortMonths,ke=Qi(w),Dt=fs(w),Jt=Qi(I),Or=fs(I),Fr=Qi(j),bn=fs(j),gn=Qi(ne),kn=fs(ne),Pi=Qi(ge),Oi=fs(ge),Ga={a:Ch,A:dh,b:ef,B:dd,c:null,d:se,e:se,f:mr,g:Yi,G:ka,H:he,I:Ye,j:Lt,L:Bt,m:yr,M:Ir,p:sd,q:pd,Q:rd,s:ld,S:Xr,u:Jr,U:jn,V:Ci,w:mi,W:la,x:null,X:null,y:Bi,Y:Ia,Z:jo,"%":Xh},pa={a:vd,A:ud,b:md,B:Wh,c:null,d:Dl,e:Dl,f:Jc,g:rh,G:nl,H:Ha,I:ia,j:rc,L:Uf,m:mf,M:tl,p:gd,q:td,Q:rd,s:ld,S:gf,u:rl,U:su,V:Uo,w:qa,W:ks,x:null,X:null,y:th,Y:Mh,Z:yc,"%":Xh},va={a:Ys,A:ra,b:Ds,B:ns,c:xf,d:sr,e:sr,f:m,g:Ui,G:Dn,H:b,I:b,j:lr,L:f,m:Kt,M:p,p:Oo,q:Qe,Q:k,s:te,S:c,u:Lc,U:wt,V:Tr,w:Ws,W:vr,x:kh,X:Dc,y:Ui,Y:Dn,Z:yt,"%":_};Ga.x=so(T,Ga),Ga.X=so(E,Ga),Ga.c=so(A,Ga),pa.x=so(T,pa),pa.X=so(E,pa),pa.c=so(A,pa);function so(Zi,Wa){return function(ga){var zn=[],zc=-1,Ps=0,tf=Zi.length,rf,wh,yd;for(ga instanceof Date||(ga=new Date(+ga));++zc<tf;)Zi.charCodeAt(zc)===37&&(zn.push(Zi.slice(Ps,zc)),(wh=Yo[rf=Zi.charAt(++zc)])!=null?rf=Zi.charAt(++zc):wh=rf==="e"?" ":"0",(yd=Wa[rf])&&(rf=yd(ga,wh)),zn.push(rf),Ps=zc+1);return zn.push(Zi.slice(Ps,zc)),zn.join("")}}function Li(Zi,Wa){return function(ga){var zn=cs(1900,void 0,1),zc=uo(zn,Zi,ga+="",0),Ps,tf;if(zc!=ga.length)return null;if("Q"in zn)return new Date(zn.Q);if("s"in zn)return new Date(zn.s*1e3+("L"in zn?zn.L:0));if(Wa&&!("Z"in zn)&&(zn.Z=0),"p"in zn&&(zn.H=zn.H%12+zn.p*12),zn.m===void 0&&(zn.m="q"in zn?zn.q:0),"V"in zn){if(zn.V<1||zn.V>53)return null;"w"in zn||(zn.w=1),"Z"in zn?(Ps=ko(cs(zn.y,0,1)),tf=Ps.getUTCDay(),Ps=tf>4||tf===0?Qr.ceil(Ps):Qr(Ps),Ps=Ts.offset(Ps,(zn.V-1)*7),zn.y=Ps.getUTCFullYear(),zn.m=Ps.getUTCMonth(),zn.d=Ps.getUTCDate()+(zn.w+6)%7):(Ps=rs(cs(zn.y,0,1)),tf=Ps.getDay(),Ps=tf>4||tf===0?eh.ceil(Ps):eh(Ps),Ps=tn.offset(Ps,(zn.V-1)*7),zn.y=Ps.getFullYear(),zn.m=Ps.getMonth(),zn.d=Ps.getDate()+(zn.w+6)%7)}else("W"in zn||"U"in zn)&&("w"in zn||(zn.w="u"in zn?zn.u%7:"W"in zn?1:0),tf="Z"in zn?ko(cs(zn.y,0,1)).getUTCDay():rs(cs(zn.y,0,1)).getDay(),zn.m=0,zn.d="W"in zn?(zn.w+6)%7+zn.W*7-(tf+5)%7:zn.w+zn.U*7-(tf+6)%7);return"Z"in zn?(zn.H+=zn.Z/100|0,zn.M+=zn.Z%100,ko(zn)):rs(zn)}}function uo(Zi,Wa,ga,zn){for(var zc=0,Ps=Wa.length,tf=ga.length,rf,wh;zc<Ps;){if(zn>=tf)return-1;if(rf=Wa.charCodeAt(zc++),rf===37){if(rf=Wa.charAt(zc++),wh=va[rf in Yo?Wa.charAt(zc++):rf],!wh||(zn=wh(Zi,ga,zn))<0)return-1}else if(rf!=ga.charCodeAt(zn++))return-1}return zn}function Oo(Zi,Wa,ga){var zn=ke.exec(Wa.slice(ga));return zn?(Zi.p=Dt[zn[0].toLowerCase()],ga+zn[0].length):-1}function Ys(Zi,Wa,ga){var zn=Fr.exec(Wa.slice(ga));return zn?(Zi.w=bn[zn[0].toLowerCase()],ga+zn[0].length):-1}function ra(Zi,Wa,ga){var zn=Jt.exec(Wa.slice(ga));return zn?(Zi.w=Or[zn[0].toLowerCase()],ga+zn[0].length):-1}function Ds(Zi,Wa,ga){var zn=Pi.exec(Wa.slice(ga));return zn?(Zi.m=Oi[zn[0].toLowerCase()],ga+zn[0].length):-1}function ns(Zi,Wa,ga){var zn=gn.exec(Wa.slice(ga));return zn?(Zi.m=kn[zn[0].toLowerCase()],ga+zn[0].length):-1}function xf(Zi,Wa,ga){return uo(Zi,A,Wa,ga)}function kh(Zi,Wa,ga){return uo(Zi,T,Wa,ga)}function Dc(Zi,Wa,ga){return uo(Zi,E,Wa,ga)}function Ch(Zi){return j[Zi.getDay()]}function dh(Zi){return I[Zi.getDay()]}function ef(Zi){return ge[Zi.getMonth()]}function dd(Zi){return ne[Zi.getMonth()]}function sd(Zi){return w[+(Zi.getHours()>=12)]}function pd(Zi){return 1+~~(Zi.getMonth()/3)}function vd(Zi){return j[Zi.getUTCDay()]}function ud(Zi){return I[Zi.getUTCDay()]}function md(Zi){return ge[Zi.getUTCMonth()]}function Wh(Zi){return ne[Zi.getUTCMonth()]}function gd(Zi){return w[+(Zi.getUTCHours()>=12)]}function td(Zi){return 1+~~(Zi.getUTCMonth()/3)}return{format:function(Wa){var ga=so(Wa+="",Ga);return ga.toString=function(){return Wa},ga},parse:function(Wa){var ga=Li(Wa+="",!1);return ga.toString=function(){return Wa},ga},utcFormat:function(Wa){var ga=so(Wa+="",pa);return ga.toString=function(){return Wa},ga},utcParse:function(Wa){var ga=Li(Wa+="",!0);return ga.toString=function(){return Wa},ga}}}var Yo={"-":"",_:" ","0":"0"},oi=/^\s*\d+/,ou=/^%/,Ba=/[\\^$*+?|[\]().{}]/g;function _n(d,A,T){var E=d<0?"-":"",w=(E?-d:d)+"",I=w.length;return E+(I<T?new Array(T-I+1).join(A)+w:w)}function Fi(d){return d.replace(Ba,"\\$&")}function Qi(d){return new RegExp("^(?:"+d.map(Fi).join("|")+")","i")}function fs(d){for(var A={},T=-1,E=d.length;++T<E;)A[d[T].toLowerCase()]=T;return A}function Ws(d,A,T){var E=oi.exec(A.slice(T,T+1));return E?(d.w=+E[0],T+E[0].length):-1}function Lc(d,A,T){var E=oi.exec(A.slice(T,T+1));return E?(d.u=+E[0],T+E[0].length):-1}function wt(d,A,T){var E=oi.exec(A.slice(T,T+2));return E?(d.U=+E[0],T+E[0].length):-1}function Tr(d,A,T){var E=oi.exec(A.slice(T,T+2));return E?(d.V=+E[0],T+E[0].length):-1}function vr(d,A,T){var E=oi.exec(A.slice(T,T+2));return E?(d.W=+E[0],T+E[0].length):-1}function Dn(d,A,T){var E=oi.exec(A.slice(T,T+4));return E?(d.y=+E[0],T+E[0].length):-1}function Ui(d,A,T){var E=oi.exec(A.slice(T,T+2));return E?(d.y=+E[0]+(+E[0]>68?1900:2e3),T+E[0].length):-1}function yt(d,A,T){var E=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(A.slice(T,T+6));return E?(d.Z=E[1]?0:-(E[2]+(E[3]||"00")),T+E[0].length):-1}function Qe(d,A,T){var E=oi.exec(A.slice(T,T+1));return E?(d.q=E[0]*3-3,T+E[0].length):-1}function Kt(d,A,T){var E=oi.exec(A.slice(T,T+2));return E?(d.m=E[0]-1,T+E[0].length):-1}function sr(d,A,T){var E=oi.exec(A.slice(T,T+2));return E?(d.d=+E[0],T+E[0].length):-1}function lr(d,A,T){var E=oi.exec(A.slice(T,T+3));return E?(d.m=0,d.d=+E[0],T+E[0].length):-1}function b(d,A,T){var E=oi.exec(A.slice(T,T+2));return E?(d.H=+E[0],T+E[0].length):-1}function p(d,A,T){var E=oi.exec(A.slice(T,T+2));return E?(d.M=+E[0],T+E[0].length):-1}function c(d,A,T){var E=oi.exec(A.slice(T,T+2));return E?(d.S=+E[0],T+E[0].length):-1}function f(d,A,T){var E=oi.exec(A.slice(T,T+3));return E?(d.L=+E[0],T+E[0].length):-1}function m(d,A,T){var E=oi.exec(A.slice(T,T+6));return E?(d.L=Math.floor(E[0]/1e3),T+E[0].length):-1}function _(d,A,T){var E=ou.exec(A.slice(T,T+1));return E?T+E[0].length:-1}function k(d,A,T){var E=oi.exec(A.slice(T));return E?(d.Q=+E[0],T+E[0].length):-1}function te(d,A,T){var E=oi.exec(A.slice(T));return E?(d.s=+E[0],T+E[0].length):-1}function se(d,A){return _n(d.getDate(),A,2)}function he(d,A){return _n(d.getHours(),A,2)}function Ye(d,A){return _n(d.getHours()%12||12,A,2)}function Lt(d,A){return _n(1+tn.count(gc(d),d),A,3)}function Bt(d,A){return _n(d.getMilliseconds(),A,3)}function mr(d,A){return Bt(d,A)+"000"}function yr(d,A){return _n(d.getMonth()+1,A,2)}function Ir(d,A){return _n(d.getMinutes(),A,2)}function Xr(d,A){return _n(d.getSeconds(),A,2)}function Jr(d){var A=d.getDay();return A===0?7:A}function jn(d,A){return _n(fh.count(gc(d)-1,d),A,2)}function Zn(d){var A=d.getDay();return A>=4||A===0?kf(d):kf.ceil(d)}function Ci(d,A){return d=Zn(d),_n(kf.count(gc(d),d)+(gc(d).getDay()===4),A,2)}function mi(d){return d.getDay()}function la(d,A){return _n(eh.count(gc(d)-1,d),A,2)}function Bi(d,A){return _n(d.getFullYear()%100,A,2)}function Yi(d,A){return d=Zn(d),_n(d.getFullYear()%100,A,2)}function Ia(d,A){return _n(d.getFullYear()%1e4,A,4)}function ka(d,A){var T=d.getDay();return d=T>=4||T===0?kf(d):kf.ceil(d),_n(d.getFullYear()%1e4,A,4)}function jo(d){var A=d.getTimezoneOffset();return(A>0?"-":(A*=-1,"+"))+_n(A/60|0,"0",2)+_n(A%60,"0",2)}function Dl(d,A){return _n(d.getUTCDate(),A,2)}function Ha(d,A){return _n(d.getUTCHours(),A,2)}function ia(d,A){return _n(d.getUTCHours()%12||12,A,2)}function rc(d,A){return _n(1+Ts.count(Fa(d),d),A,3)}function Uf(d,A){return _n(d.getUTCMilliseconds(),A,3)}function Jc(d,A){return Uf(d,A)+"000"}function mf(d,A){return _n(d.getUTCMonth()+1,A,2)}function tl(d,A){return _n(d.getUTCMinutes(),A,2)}function gf(d,A){return _n(d.getUTCSeconds(),A,2)}function rl(d){var A=d.getUTCDay();return A===0?7:A}function su(d,A){return _n(Hr.count(Fa(d)-1,d),A,2)}function Rc(d){var A=d.getUTCDay();return A>=4||A===0?ln(d):ln.ceil(d)}function Uo(d,A){return d=Rc(d),_n(ln.count(Fa(d),d)+(Fa(d).getUTCDay()===4),A,2)}function qa(d){return d.getUTCDay()}function ks(d,A){return _n(Qr.count(Fa(d)-1,d),A,2)}function th(d,A){return _n(d.getUTCFullYear()%100,A,2)}function rh(d,A){return d=Rc(d),_n(d.getUTCFullYear()%100,A,2)}function Mh(d,A){return _n(d.getUTCFullYear()%1e4,A,4)}function nl(d,A){var T=d.getUTCDay();return d=T>=4||T===0?ln(d):ln.ceil(d),_n(d.getUTCFullYear()%1e4,A,4)}function yc(){return"+0000"}function Xh(){return"%"}function rd(d){return+d}function ld(d){return Math.floor(+d/1e3)}var Cs,nh,cd,e,t;r({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function r(d){return Cs=Zs(d),nh=Cs.format,cd=Cs.parse,e=Cs.utcFormat,t=Cs.utcParse,Cs}var u=1e3,h=u*60,g=h*60,C=g*24,O=C*7,G=C*30,Q=C*365;function ve(d){return new Date(d)}function Ae(d){return d instanceof Date?+d:+new Date(+d)}function _e(d,A,T,E,w,I,j,ne,ge){var ke=df(Es,Es),Dt=ke.invert,Jt=ke.domain,Or=ge(".%L"),Fr=ge(":%S"),bn=ge("%I:%M"),gn=ge("%I %p"),kn=ge("%a %d"),Pi=ge("%b %d"),Oi=ge("%B"),Ga=ge("%Y"),pa=[[j,1,u],[j,5,5*u],[j,15,15*u],[j,30,30*u],[I,1,h],[I,5,5*h],[I,15,15*h],[I,30,30*h],[w,1,g],[w,3,3*g],[w,6,6*g],[w,12,12*g],[E,1,C],[E,2,2*C],[T,1,O],[A,1,G],[A,3,3*G],[d,1,Q]];function va(Li){return(j(Li)<Li?Or:I(Li)<Li?Fr:w(Li)<Li?bn:E(Li)<Li?gn:A(Li)<Li?T(Li)<Li?kn:Pi:d(Li)<Li?Oi:Ga)(Li)}function so(Li,uo,Oo,Ys){if(Li==null&&(Li=10),typeof Li=="number"){var ra=Math.abs(Oo-uo)/Li,Ds=dl(function(ns){return ns[2]}).right(pa,ra);Ds===pa.length?(Ys=l(uo/Q,Oo/Q,Li),Li=d):Ds?(Ds=pa[ra/pa[Ds-1][2]<pa[Ds][2]/ra?Ds-1:Ds],Ys=Ds[1],Li=Ds[0]):(Ys=Math.max(l(uo,Oo,Li),1),Li=ne)}return Ys==null?Li:Li.every(Ys)}return ke.invert=function(Li){return new Date(Dt(Li))},ke.domain=function(Li){return arguments.length?Jt(no.call(Li,Ae)):Jt().map(ve)},ke.ticks=function(Li,uo){var Oo=Jt(),Ys=Oo[0],ra=Oo[Oo.length-1],Ds=ra<Ys,ns;return Ds&&(ns=Ys,Ys=ra,ra=ns),ns=so(Li,Ys,ra,uo),ns=ns?ns.range(Ys,ra+1):[],Ds?ns.reverse():ns},ke.tickFormat=function(Li,uo){return uo==null?va:ge(uo)},ke.nice=function(Li,uo){var Oo=Jt();return(Li=so(Li,Oo[0],Oo[Oo.length-1],uo))?Jt(D(Oo,Li)):ke},ke.copy=function(){return xl(ke,_e(d,A,T,E,w,I,j,ne,ge))},ke}var it=function(){return pr.apply(_e(gc,Jf,fh,tn,cn,un,Kr,Qn,nh).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},_t=gi(function(d){d.setUTCDate(1),d.setUTCHours(0,0,0,0)},function(d,A){d.setUTCMonth(d.getUTCMonth()+A)},function(d,A){return A.getUTCMonth()-d.getUTCMonth()+(A.getUTCFullYear()-d.getUTCFullYear())*12},function(d){return d.getUTCMonth()}),Tt=_t,Xt=_t.range,Zt=gi(function(d){d.setUTCMinutes(0,0,0)},function(d,A){d.setTime(+d+A*qf)},function(d,A){return(A-d)/qf},function(d){return d.getUTCHours()}),ir=Zt,hr=Zt.range,Er=gi(function(d){d.setUTCSeconds(0,0)},function(d,A){d.setTime(+d+A*vf)},function(d,A){return(A-d)/vf},function(d){return d.getUTCMinutes()}),kr=Er,Nr=Er.range,vn=function(){return pr.apply(_e(Fa,Tt,Hr,Ts,ir,kr,Kr,Qn,e).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function hn(){var d=0,A=1,T,E,w,I,j=Es,ne=!1,ge;function ke(Dt){return isNaN(Dt=+Dt)?ge:j(w===0?.5:(Dt=(I(Dt)-T)*w,ne?Math.max(0,Math.min(1,Dt)):Dt))}return ke.domain=function(Dt){return arguments.length?(T=I(d=+Dt[0]),E=I(A=+Dt[1]),w=T===E?0:1/(E-T),ke):[d,A]},ke.clamp=function(Dt){return arguments.length?(ne=!!Dt,ke):ne},ke.interpolator=function(Dt){return arguments.length?(j=Dt,ke):j},ke.unknown=function(Dt){return arguments.length?(ge=Dt,ke):ge},function(Dt){return I=Dt,T=Dt(d),E=Dt(A),w=T===E?0:1/(E-T),ke}}function Ln(d,A){return A.domain(d.domain()).interpolator(d.interpolator()).clamp(d.clamp()).unknown(d.unknown())}function qn(){var d=Rl(hn()(Es));return d.copy=function(){return Ln(d,qn())},Ar.apply(d,arguments)}function Kn(){var d=Rn(hn()).domain([1,10]);return d.copy=function(){return Ln(d,Kn()).base(d.base())},Ar.apply(d,arguments)}function Fn(){var d=Ri(hn());return d.copy=function(){return Ln(d,Fn()).constant(d.constant())},Ar.apply(d,arguments)}function wi(){var d=ao(hn());return d.copy=function(){return Ln(d,wi()).exponent(d.exponent())},Ar.apply(d,arguments)}function li(){return wi.apply(null,arguments).exponent(.5)}function ti(){var d=[],A=Es;function T(E){if(!isNaN(E=+E))return A((Gs(d,E)-1)/(d.length-1))}return T.domain=function(E){if(!arguments.length)return d.slice();d=[];for(var w=0,I=E.length,j;w<I;++w)j=E[w],j!=null&&!isNaN(j=+j)&&d.push(j);return d.sort(hl),T},T.interpolator=function(E){return arguments.length?(A=E,T):A},T.copy=function(){return ti(A).domain(d)},Ar.apply(T,arguments)}function aa(){var d=0,A=.5,T=1,E,w,I,j,ne,ge=Es,ke,Dt=!1,Jt;function Or(Fr){return isNaN(Fr=+Fr)?Jt:(Fr=.5+((Fr=+ke(Fr))-w)*(Fr<w?j:ne),ge(Dt?Math.max(0,Math.min(1,Fr)):Fr))}return Or.domain=function(Fr){return arguments.length?(E=ke(d=+Fr[0]),w=ke(A=+Fr[1]),I=ke(T=+Fr[2]),j=E===w?0:.5/(w-E),ne=w===I?0:.5/(I-w),Or):[d,A,T]},Or.clamp=function(Fr){return arguments.length?(Dt=!!Fr,Or):Dt},Or.interpolator=function(Fr){return arguments.length?(ge=Fr,Or):ge},Or.unknown=function(Fr){return arguments.length?(Jt=Fr,Or):Jt},function(Fr){return ke=Fr,E=Fr(d),w=Fr(A),I=Fr(T),j=E===w?0:.5/(w-E),ne=w===I?0:.5/(I-w),Or}}function Vi(){var d=Rl(aa()(Es));return d.copy=function(){return Ln(d,Vi())},Ar.apply(d,arguments)}function Za(){var d=Rn(aa()).domain([.1,1,10]);return d.copy=function(){return Ln(d,Za()).base(d.base())},Ar.apply(d,arguments)}function yi(){var d=Ri(aa());return d.copy=function(){return Ln(d,yi()).constant(d.constant())},Ar.apply(d,arguments)}function ha(){var d=ao(aa());return d.copy=function(){return Ln(d,ha()).exponent(d.exponent())},Ar.apply(d,arguments)}function Ko(){return ha.apply(null,arguments).exponent(.5)}var Ca,$o,Jo,hs,Su,ds,il,uu,al,lu=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Xs=(Ca={},st()(Ca,S.ScaleTypes.LINEAR,ee),st()(Ca,S.ScaleTypes.POWER,Va),st()(Ca,S.ScaleTypes.LOG,$n),st()(Ca,S.ScaleTypes.IDENTITY,ie),st()(Ca,S.ScaleTypes.TIME,it),st()(Ca,S.ScaleTypes.QUANTILE,Xi),st()(Ca,S.ScaleTypes.QUANTIZE,Qa),st()(Ca,S.ScaleTypes.THRESHOLD,ls),st()(Ca,S.ScaleTypes.CAT,_a),Ca),cu=($o=Object(dt.injectable)(),Jo=Object(dt.inject)(S.TYPES.IGlobalConfigService),hs=Object(dt.inject)(S.TYPES.ILogService),$o(Su=(ds=(al=function(){function d(){Z()(this,d),Me()(this,"configService",il,this),Me()(this,"logger",uu,this),this.scaleCache={},this.scaleOptions={}}return o()(d,[{key:"apply",value:function(T,E){var w=this,I=E.styleAttributeService;T.hooks.init.tap("FeatureScalePlugin",function(){w.scaleOptions=T.getScaleOptions();var j=I.getLayerStyleAttributes(),ne=T.getSource().data.dataArray;ne.length!==0&&w.caculateScalesForAttributes(j||[],ne)}),T.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){w.scaleOptions=T.getScaleOptions();var j=I.getLayerStyleAttributes(),ne=T.getSource().data.dataArray;return w.caculateScalesForAttributes(j||[],ne),T.layerModelNeedUpdate=!0,!0}),T.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!T.layerModelNeedUpdate){w.scaleOptions=T.getScaleOptions();var j=I.getLayerStyleAttributes();if(j){var ne=T.getSource().data.dataArray;if(ne.length===0)return;var ge=j.filter(function(ke){return ke.needRescale});ge.length&&(w.caculateScalesForAttributes(ge,ne),w.logger.debug("rescale finished"))}}})}},{key:"isNumber",value:function(T){return!isNaN(parseFloat(T))&&isFinite(T)}},{key:"caculateScalesForAttributes",value:function(T,E){var w=this;this.scaleCache={},T.forEach(function(I){if(I.scale){var j=I.scale,ne=I.name;j.names=w.parseFields(I.scale.field||[]);var ge=[];j.names.forEach(function(ke){ge.push(w.getOrCreateScale(ke,I,E))}),ge.some(function(ke){return ke.type===S.StyleScaleType.VARIABLE})?(j.type=S.StyleScaleType.VARIABLE,ge.forEach(function(ke){if(!j.callback){var Dt;if(j.values&&j.values!=="text"){var Jt;if(((Jt=ke.option)===null||Jt===void 0?void 0:Jt.type)==="linear"&&j.values.length>2){var Or=ke.scale.ticks(j.values.length);ne==="color"&&ke.scale.domain(Or)}ke.scale.range(j.values)}else((Dt=ke.option)===null||Dt===void 0?void 0:Dt.type)==="cat"&&ke.scale.range(ke.option.domain)}})):(j.type=S.StyleScaleType.CONSTANT,j.defaultValues=ge.map(function(ke,Dt){return ke.scale(j.names[Dt])})),j.scalers=ge.map(function(ke){return{field:ke.field,func:ke.scale,option:ke.option}}),I.needRescale=!1}})}},{key:"getOrCreateScale",value:function(T,E,w){var I,j=[T,E.name].join("_"),ne=(I=E.scale)===null||I===void 0?void 0:I.values,ge=this.createScale(T,E.name,ne,w);return ge}},{key:"parseFields",value:function(T){return Array.isArray(T)?T:cc()(T)?T.split("*"):[T]}},{key:"createScale",value:function(T,E,w,I){var j,ne=this.scaleOptions[E]&&this.scaleOptions[E].field===T?this.scaleOptions[E]:this.scaleOptions[T],ge={field:T,scale:void 0,type:S.StyleScaleType.VARIABLE,option:ne};if(!I||!I.length)return ne&&ne.type?ge.scale=this.createDefaultScale(ne):(ge.scale=_a([T]),ge.type=S.StyleScaleType.CONSTANT),ge;var ke=(j=I.find(function(Or){return!po()(Or[T])}))===null||j===void 0?void 0:j[T];if(this.isNumber(T)||po()(ke)&&!ne)ge.scale=_a([T]),ge.type=S.StyleScaleType.CONSTANT;else{var Dt=ne&&ne.type||this.getDefaultType(ke);w==="text"&&(Dt=S.ScaleTypes.CAT);var Jt=this.createDefaultScaleConfig(Dt,T,I);Object.assign(Jt,ne),ge.scale=this.createDefaultScale(Jt),ge.option=Jt}return ge}},{key:"getDefaultType",value:function(T){var E=S.ScaleTypes.LINEAR;return typeof T=="string"&&(E=lu.test(T)?S.ScaleTypes.TIME:S.ScaleTypes.CAT),E}},{key:"createDefaultScaleConfig",value:function(T,E,w){var I={type:T},j=(w==null?void 0:w.map(function(ne){return ne[E]}))||[];return T!==S.ScaleTypes.CAT&&T!==S.ScaleTypes.QUANTILE?I.domain=_l(j):T===S.ScaleTypes.CAT?I.domain=nu()(j):T===S.ScaleTypes.QUANTILE&&(I.domain=j),I}},{key:"createDefaultScale",value:function(T){var E=T.type,w=T.domain,I=Xs[E]();return w&&I.domain(w),I}}]),d}(),al),il=De()(ds.prototype,"configService",[Jo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uu=De()(ds.prototype,"logger",[hs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ds))||Su),Ea,da,oo,Po,Eu,Io,Qo,Uu;function xa(d,A){var T=Object.keys(d);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(d);A&&(E=E.filter(function(w){return Object.getOwnPropertyDescriptor(d,w).enumerable})),T.push.apply(T,E)}return T}function ih(d){for(var A=1;A<arguments.length;A++){var T=arguments[A]!=null?arguments[A]:{};A%2?xa(Object(T),!0).forEach(function(E){st()(d,E,T[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(T)):xa(Object(T)).forEach(function(E){Object.defineProperty(d,E,Object.getOwnPropertyDescriptor(T,E))})}return d}var Qc=(Ea=Object(dt.injectable)(),da=Object(dt.inject)(S.TYPES.ICameraService),oo=Object(dt.inject)(S.TYPES.IRendererService),Ea(Po=(Eu=(Uu=function(){function d(){Z()(this,d),Me()(this,"cameraService",Io,this),Me()(this,"rendererService",Qo,this)}return o()(d,[{key:"apply",value:function(T){T.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){T.models.forEach(function(E){E.addUniforms(ih({},T.layerModel.getAnimateUniforms()))})})}}]),d}(),Uu),Io=De()(Eu.prototype,"cameraService",[da],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qo=De()(Eu.prototype,"rendererService",[oo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eu))||Po),yf,xc,Vu=(yf=Object(dt.injectable)(),yf(xc=function(){function d(){Z()(this,d)}return o()(d,[{key:"apply",value:function(T){T.hooks.init.tap("LayerModelPlugin",function(){T.prepareBuildModel(),T.buildModels(),T.styleNeedUpdate=!1}),T.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return T.prepareBuildModel(),T.clearModels(),T.buildModels(),T.layerModelNeedUpdate=!1,!1})}}]),d}())||xc),Vf,Gf,ah=(Vf=Object(dt.injectable)(),Vf(Gf=function(){function d(){Z()(this,d)}return o()(d,[{key:"apply",value:function(T){T.hooks.afterInit.tap("LayerStylePlugin",function(){T.updateLayerConfig({});var E=T.getLayerConfig(),w=E.autoFit,I=E.fitBoundsOptions;w&&setTimeout(function(){T.fitBounds(I)},100)})}}]),d}())||Gf),Ih,zf;function Oh(d,A){var T=Object.keys(d);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(d);A&&(E=E.filter(function(w){return Object.getOwnPropertyDescriptor(d,w).enumerable})),T.push.apply(T,E)}return T}function oh(d){for(var A=1;A<arguments.length;A++){var T=arguments[A]!=null?arguments[A]:{};A%2?Oh(Object(T),!0).forEach(function(E){st()(d,E,T[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(T)):Oh(Object(T)).forEach(function(E){Object.defineProperty(d,E,Object.getOwnPropertyDescriptor(T,E))})}return d}var yh={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},Yh={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},Uh={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Kh={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},xh=["ambient","diffuse","specular"];function Lh(d){var A={u_DirectionalLights:new Array(3).fill(oh({},Uh)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(oh({},Kh)),u_NumOfSpotLights:0};return(!d||!d.length)&&(d=[Yh]),d.forEach(function(T,E){var w=T.type,I=w===void 0?"directional":w,j=Be()(T,["type"]),ne=yh[I].lights,ge=yh[I].num,ke=A[ge];A[ne][ke]=oh(oh({},A[ne][ke]),j),A[ge]++}),A}var $h=(Ih=Object(dt.injectable)(),Ih(zf=function(){function d(){Z()(this,d)}return o()(d,[{key:"apply",value:function(T){T.hooks.beforeRender.tap("LightingPlugin",function(){var E=T.getLayerConfig(),w=E.enableLighting;w&&T.models.forEach(function(I){return I.addUniforms(oh({},Lh()))})})}}]),d}())||zf),bh,sh,hh={NONE:0,ENCODE:1,HIGHLIGHT:2},Jh=(bh=Object(dt.injectable)(),bh(sh=function(){function d(){Z()(this,d)}return o()(d,[{key:"apply",value:function(T,E){var w=E.rendererService,I=E.styleAttributeService;T.hooks.init.tap("PixelPickingPlugin",function(){var j=T.getLayerConfig(),ne=j.enablePicking;I.registerStyleAttribute({name:"pickingColor",type:S.AttributeType.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:S.gl.FLOAT},size:3,update:function(ke,Dt){var Jt=ke.id;return ne?Object(Le.l)(Jt):[0,0,0]}}})}),T.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var j=T.getLayerConfig(),ne=j.enablePicking;ne&&T.isVisible()&&T.models.forEach(function(ge){return ge.addUniforms({u_PickingStage:hh.ENCODE})})}),T.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var j=T.getLayerConfig(),ne=j.enablePicking;ne&&T.isVisible()&&T.models.forEach(function(ge){return ge.addUniforms({u_PickingStage:hh.HIGHLIGHT})})}),T.hooks.beforeHighlight.tap("PixelPickingPlugin",function(j){var ne=T.getLayerConfig(),ge=ne.highlightColor,ke=typeof ge=="string"?Object(Le.s)(ge):ge||[1,0,0,1];T.updateLayerConfig({pickedFeatureID:Object(Le.k)(new Uint8Array(j))}),T.models.forEach(function(Dt){return Dt.addUniforms({u_PickingStage:hh.HIGHLIGHT,u_PickingColor:j,u_HighlightColor:ke.map(function(Jt){return Jt*255})})})}),T.hooks.beforeSelect.tap("PixelPickingPlugin",function(j){var ne=T.getLayerConfig(),ge=ne.selectColor,ke=typeof ge=="string"?Object(Le.s)(ge):ge||[1,0,0,1];T.updateLayerConfig({pickedFeatureID:Object(Le.k)(new Uint8Array(j))}),T.models.forEach(function(Dt){return Dt.addUniforms({u_PickingStage:hh.HIGHLIGHT,u_PickingColor:j,u_HighlightColor:ke.map(function(Jt){return Jt*255})})})})}}]),d}())||sh),Vh,Sh,Gh,Rh,Eh,Hh,Zh=(Vh=Object(dt.injectable)(),Sh=Object(dt.inject)(S.TYPES.ILogService),Vh(Gh=(Rh=(Hh=function(){function d(){Z()(this,d),Me()(this,"logger",Eh,this)}return o()(d,[{key:"apply",value:function(T,E){var w=this,I=E.styleAttributeService;T.hooks.init.tap("RegisterStyleAttributePlugin",function(){w.registerBuiltinAttributes(I)})}},{key:"registerBuiltinAttributes",value:function(T){T.registerStyleAttribute({name:"position",type:S.AttributeType.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:S.gl.FLOAT},size:3,update:function(w,I,j){return j.length===2?[j[0],j[1],0]:[j[0],j[1],j[2]]}}}),T.registerStyleAttribute({name:"filter",type:S.AttributeType.Attribute,descriptor:{name:"filter",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:1,update:function(w,I){var j=w.filter;return j?[1]:[0]}}}),T.registerStyleAttribute({name:"color",type:S.AttributeType.Attribute,descriptor:{name:"a_Color",buffer:{usage:S.gl.DYNAMIC_DRAW,data:[],type:S.gl.FLOAT},size:4,update:function(w,I){var j=w.color;return!j||!j.length?[1,1,1,1]:j}}})}}]),d}(),Hh),Eh=De()(Rh.prototype,"logger",[Sh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rh))||Gh),Dh,zh,Th,Nh,Ah,Hf,Fh,Qh,qh,nd,id=(Dh=Object(dt.injectable)(),zh=Object(dt.inject)(S.TYPES.ICameraService),Th=Object(dt.inject)(S.TYPES.ICoordinateSystemService),Nh=Object(dt.inject)(S.TYPES.IRendererService),Dh(Ah=(Hf=(nd=function(){function d(){Z()(this,d),Me()(this,"cameraService",Fh,this),Me()(this,"coordinateSystemService",Qh,this),Me()(this,"rendererService",qh,this)}return o()(d,[{key:"apply",value:function(T){var E=this;T.hooks.beforeRender.tap("ShaderUniformPlugin",function(){E.coordinateSystemService.refresh();var w=E.rendererService.getViewportSize(),I=w.width,j=w.height;T.models.forEach(function(ne){var ge;return ne.addUniforms((ge={},st()(ge,S.CameraUniform.ProjectionMatrix,E.cameraService.getProjectionMatrix()),st()(ge,S.CameraUniform.ViewMatrix,E.cameraService.getViewMatrix()),st()(ge,S.CameraUniform.ViewProjectionMatrix,E.cameraService.getViewProjectionMatrix()),st()(ge,S.CameraUniform.Zoom,E.cameraService.getZoom()),st()(ge,S.CameraUniform.ZoomScale,E.cameraService.getZoomScale()),st()(ge,S.CameraUniform.FocalDistance,E.cameraService.getFocalDistance()),st()(ge,S.CameraUniform.CameraPosition,E.cameraService.getCameraPosition()),st()(ge,S.CoordinateUniform.CoordinateSystem,E.coordinateSystemService.getCoordinateSystem()),st()(ge,S.CoordinateUniform.ViewportCenter,E.coordinateSystemService.getViewportCenter()),st()(ge,S.CoordinateUniform.ViewportCenterProjection,E.coordinateSystemService.getViewportCenterProjection()),st()(ge,S.CoordinateUniform.PixelsPerDegree,E.coordinateSystemService.getPixelsPerDegree()),st()(ge,S.CoordinateUniform.PixelsPerDegree2,E.coordinateSystemService.getPixelsPerDegree2()),st()(ge,S.CoordinateUniform.PixelsPerMeter,E.coordinateSystemService.getPixelsPerMeter()),st()(ge,"u_ViewportSize",[I,j]),st()(ge,"u_DevicePixelRatio",window.devicePixelRatio),st()(ge,"u_ModelMatrix",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),st()(ge,"u_PickingBuffer",T.getLayerConfig().pickingBuffer||0),ge))})})}}]),d}(),nd),Fh=De()(Hf.prototype,"cameraService",[zh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qh=De()(Hf.prototype,"coordinateSystemService",[Th],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qh=De()(Hf.prototype,"rendererService",[Nh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hf))||Ah),ad,ed,Sd=(ad=Object(dt.injectable)(),ad(ed=function(){function d(){Z()(this,d)}return o()(d,[{key:"apply",value:function(T){T.hooks.beforeRender.tap("UpdateModelPlugin",function(){T.layerModel&&T.layerModel.needUpdate()})}}]),d}())||ed),fd,Bh,ws,qc,hd,uh,od=(fd=Object(dt.injectable)(),Bh=Object(dt.inject)(S.TYPES.ILogService),fd(ws=(qc=(uh=function(){function d(){Z()(this,d),Me()(this,"logger",hd,this)}return o()(d,[{key:"apply",value:function(T,E){var w=this,I=E.styleAttributeService;T.hooks.init.tap("UpdateStyleAttributePlugin",function(){w.initStyleAttribute(T,{styleAttributeService:I})}),T.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){T.layerModelNeedUpdate||w.updateStyleAtrribute(T,{styleAttributeService:I})})}},{key:"updateStyleAtrribute",value:function(T,E){var w=this,I=E.styleAttributeService,j=I.getLayerStyleAttributes()||[],ne=I.getLayerStyleAttribute("filter"),ge=I.getLayerStyleAttribute("shape");if(ne&&ne.needRegenerateVertices||ge&&ge.needRegenerateVertices){T.layerModelNeedUpdate=!0,j.forEach(function(ke){return ke.needRegenerateVertices=!1});return}j.filter(function(ke){return ke.needRegenerateVertices}).forEach(function(ke){I.updateAttributeByFeatureRange(ke.name,T.getEncodedData(),ke.featureRange.startIndex,ke.featureRange.endIndex),ke.needRegenerateVertices=!1,w.logger.debug("regenerate vertex attributes: ".concat(ke.name," finished"))})}},{key:"initStyleAttribute",value:function(T,E){var w=this,I=E.styleAttributeService,j=I.getLayerStyleAttributes()||[];j.filter(function(ne){return ne.needRegenerateVertices}).forEach(function(ne){I.updateAttributeByFeatureRange(ne.name,T.getEncodedData(),ne.featureRange.startIndex,ne.featureRange.endIndex),ne.needRegenerateVertices=!1,w.logger.debug("init vertex attributes: ".concat(ne.name," finished"))})}}]),d}(),uh),hd=De()(qc.prototype,"logger",[Bh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qc))||ws);S.container.bind(S.TYPES.ILayerPlugin).to(Wo).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(Zh).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(cu).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(ru).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(ah).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(od).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(Sd).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(Ne).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(id).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(Qc).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to($h).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(Jh).inRequestScope(),S.container.bind(S.TYPES.ILayerPlugin).to(Vu).inRequestScope()},t2Dn:function(we,x,a){var S=a("hypo"),v=a("ljhN");function Z(N,o,X){(X!==void 0&&!v(N[o],X)||X===void 0&&!(o in N))&&S(N,o,X)}we.exports=Z},u6S6:function(we,x,a){var S=a("6acW"),v=a("sgoq"),Z=v(function(N,o,X){return o=o.toLowerCase(),N+(X?S(o):o)});we.exports=Z},uhBA:function(we,x,a){"use strict";var S=Object.prototype.hasOwnProperty,v="~";function Z(){}Object.create&&(Z.prototype=Object.create(null),new Z().__proto__||(v=!1));function N(K,q,Ce){this.fn=K,this.context=q,this.once=Ce||!1}function o(K,q,Ce,$,He){if(typeof Ce!="function")throw new TypeError("The listener must be a function");var Be=new N(Ce,$||K,He),ce=v?v+q:q;return K._events[ce]?K._events[ce].fn?K._events[ce]=[K._events[ce],Be]:K._events[ce].push(Be):(K._events[ce]=Be,K._eventsCount++),K}function X(K,q){--K._eventsCount==0?K._events=new Z:delete K._events[q]}function F(){this._events=new Z,this._eventsCount=0}F.prototype.eventNames=function(){var q=[],Ce,$;if(this._eventsCount===0)return q;for($ in Ce=this._events)S.call(Ce,$)&&q.push(v?$.slice(1):$);return Object.getOwnPropertySymbols?q.concat(Object.getOwnPropertySymbols(Ce)):q},F.prototype.listeners=function(q){var Ce=v?v+q:q,$=this._events[Ce];if(!$)return[];if($.fn)return[$.fn];for(var He=0,Be=$.length,ce=new Array(Be);He<Be;He++)ce[He]=$[He].fn;return ce},F.prototype.listenerCount=function(q){var Ce=v?v+q:q,$=this._events[Ce];return $?$.fn?1:$.length:0},F.prototype.emit=function(q,Ce,$,He,Be,ce){var st=v?v+q:q;if(!this._events[st])return!1;var ut=this._events[st],Me=arguments.length,bt,xt;if(ut.fn){switch(ut.once&&this.removeListener(q,ut.fn,void 0,!0),Me){case 1:return ut.fn.call(ut.context),!0;case 2:return ut.fn.call(ut.context,Ce),!0;case 3:return ut.fn.call(ut.context,Ce,$),!0;case 4:return ut.fn.call(ut.context,Ce,$,He),!0;case 5:return ut.fn.call(ut.context,Ce,$,He,Be),!0;case 6:return ut.fn.call(ut.context,Ce,$,He,Be,ce),!0}for(xt=1,bt=new Array(Me-1);xt<Me;xt++)bt[xt-1]=arguments[xt];ut.fn.apply(ut.context,bt)}else{var Mt=ut.length,De;for(xt=0;xt<Mt;xt++)switch(ut[xt].once&&this.removeListener(q,ut[xt].fn,void 0,!0),Me){case 1:ut[xt].fn.call(ut[xt].context);break;case 2:ut[xt].fn.call(ut[xt].context,Ce);break;case 3:ut[xt].fn.call(ut[xt].context,Ce,$);break;case 4:ut[xt].fn.call(ut[xt].context,Ce,$,He);break;default:if(!bt)for(De=1,bt=new Array(Me-1);De<Me;De++)bt[De-1]=arguments[De];ut[xt].fn.apply(ut[xt].context,bt)}}return!0},F.prototype.on=function(q,Ce,$){return o(this,q,Ce,$,!1)},F.prototype.once=function(q,Ce,$){return o(this,q,Ce,$,!0)},F.prototype.removeListener=function(q,Ce,$,He){var Be=v?v+q:q;if(!this._events[Be])return this;if(!Ce)return X(this,Be),this;var ce=this._events[Be];if(ce.fn)ce.fn===Ce&&(!He||ce.once)&&(!$||ce.context===$)&&X(this,Be);else{for(var st=0,ut=[],Me=ce.length;st<Me;st++)(ce[st].fn!==Ce||He&&!ce[st].once||$&&ce[st].context!==$)&&ut.push(ce[st]);ut.length?this._events[Be]=ut.length===1?ut[0]:ut:X(this,Be)}return this},F.prototype.removeAllListeners=function(q){var Ce;return q?(Ce=v?v+q:q,this._events[Ce]&&X(this,Ce)):(this._events=new Z,this._eventsCount=0),this},F.prototype.off=F.prototype.removeListener,F.prototype.addListener=F.prototype.on,F.prefixed=v,F.EventEmitter=F,we.exports=F},ujMp:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.circularDependencyToException=x.listMetadataForTarget=x.listRegisteredBindingsForServiceIdentifier=x.getServiceIdentifierAsString=x.getFunctionName=void 0;var S=a("MON2");function v(q){if(typeof q=="function"){var Ce=q;return Ce.name}else{if(typeof q=="symbol")return q.toString();var Ce=q;return Ce}}x.getServiceIdentifierAsString=v;function Z(q,Ce,$){var He="",Be=$(q,Ce);return Be.length!==0&&(He=`
Registered bindings:`,Be.forEach(function(ce){var st="Object";ce.implementationType!==null&&(st=K(ce.implementationType)),He=He+`
 `+st,ce.constraint.metaData&&(He=He+" - "+ce.constraint.metaData)})),He}x.listRegisteredBindingsForServiceIdentifier=Z;function N(q,Ce){return q.parentRequest===null?!1:q.parentRequest.serviceIdentifier===Ce?!0:N(q.parentRequest,Ce)}function o(q){function Ce(He,Be){Be===void 0&&(Be=[]);var ce=v(He.serviceIdentifier);return Be.push(ce),He.parentRequest!==null?Ce(He.parentRequest,Be):Be}var $=Ce(q);return $.reverse().join(" --> ")}function X(q){q.childRequests.forEach(function(Ce){if(N(Ce,Ce.serviceIdentifier)){var $=o(Ce);throw new Error(S.CIRCULAR_DEPENDENCY+" "+$)}else X(Ce)})}x.circularDependencyToException=X;function F(q,Ce){if(Ce.isTagged()||Ce.isNamed()){var $="",He=Ce.getNamedTag(),Be=Ce.getCustomTags();return He!==null&&($+=He.toString()+`
`),Be!==null&&Be.forEach(function(ce){$+=ce.toString()+`
`})," "+q+`
 `+q+" - "+$}else return" "+q}x.listMetadataForTarget=F;function K(q){if(q.name)return q.name;var Ce=q.toString(),$=Ce.match(/^function\s*([^\s(]+)/);return $?$[1]:"Anonymous function: "+Ce}x.getFunctionName=K},"vN+2":function(we,x){function a(){}we.exports=a},"w/wX":function(we,x,a){var S=a("QqLw"),v=a("ExA7"),Z="[object Set]";function N(o){return v(o)&&S(o)==Z}we.exports=N},w26f:function(we,x,a){(function(S){var v=200,Z="__lodash_hash_undefined__",N=1/0,o="[object Function]",X="[object GeneratorFunction]",F=/[\\^$.*+?()[\]{}|]/g,K=/^\[object .+?Constructor\]$/,q=typeof S=="object"&&S&&S.Object===Object&&S,Ce=typeof self=="object"&&self&&self.Object===Object&&self,$=q||Ce||Function("return this")();function He(ot,$e){var Vt=ot?ot.length:0;return!!Vt&&st(ot,$e,0)>-1}function Be(ot,$e,Vt){for(var dr=-1,Zr=ot?ot.length:0;++dr<Zr;)if(Vt($e,ot[dr]))return!0;return!1}function ce(ot,$e,Vt,dr){for(var Zr=ot.length,cr=Vt+(dr?1:-1);dr?cr--:++cr<Zr;)if($e(ot[cr],cr,ot))return cr;return-1}function st(ot,$e,Vt){if($e!==$e)return ce(ot,ut,Vt);for(var dr=Vt-1,Zr=ot.length;++dr<Zr;)if(ot[dr]===$e)return dr;return-1}function ut(ot){return ot!==ot}function Me(ot,$e){return ot.has($e)}function bt(ot,$e){return ot==null?void 0:ot[$e]}function xt(ot){var $e=!1;if(ot!=null&&typeof ot.toString!="function")try{$e=!!(ot+"")}catch(Vt){}return $e}function Mt(ot){var $e=-1,Vt=Array(ot.size);return ot.forEach(function(dr){Vt[++$e]=dr}),Vt}var De=Array.prototype,ar=Function.prototype,$t=Object.prototype,Ht=$["__core-js_shared__"],vt=function(){var ot=/[^.]+$/.exec(Ht&&Ht.keys&&Ht.keys.IE_PROTO||"");return ot?"Symbol(src)_1."+ot:""}(),Ze=ar.toString,Et=$t.hasOwnProperty,Le=$t.toString,at=RegExp("^"+Ze.call(Et).replace(F,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Wt=De.splice,St=re($,"Map"),dt=re($,"Set"),H=re(Object,"create");function z(ot){var $e=-1,Vt=ot?ot.length:0;for(this.clear();++$e<Vt;){var dr=ot[$e];this.set(dr[0],dr[1])}}function V(){this.__data__=H?H(null):{}}function be(ot){return this.has(ot)&&delete this.__data__[ot]}function me(ot){var $e=this.__data__;if(H){var Vt=$e[ot];return Vt===Z?void 0:Vt}return Et.call($e,ot)?$e[ot]:void 0}function le(ot){var $e=this.__data__;return H?$e[ot]!==void 0:Et.call($e,ot)}function fe(ot,$e){var Vt=this.__data__;return Vt[ot]=H&&$e===void 0?Z:$e,this}z.prototype.clear=V,z.prototype.delete=be,z.prototype.get=me,z.prototype.has=le,z.prototype.set=fe;function Ne(ot){var $e=-1,Vt=ot?ot.length:0;for(this.clear();++$e<Vt;){var dr=ot[$e];this.set(dr[0],dr[1])}}function lt(){this.__data__=[]}function rt(ot){var $e=this.__data__,Vt=gt($e,ot);if(Vt<0)return!1;var dr=$e.length-1;return Vt==dr?$e.pop():Wt.call($e,Vt,1),!0}function ue(ot){var $e=this.__data__,Vt=gt($e,ot);return Vt<0?void 0:$e[Vt][1]}function ye(ot){return gt(this.__data__,ot)>-1}function Ue(ot,$e){var Vt=this.__data__,dr=gt(Vt,ot);return dr<0?Vt.push([ot,$e]):Vt[dr][1]=$e,this}Ne.prototype.clear=lt,Ne.prototype.delete=rt,Ne.prototype.get=ue,Ne.prototype.has=ye,Ne.prototype.set=Ue;function ft(ot){var $e=-1,Vt=ot?ot.length:0;for(this.clear();++$e<Vt;){var dr=ot[$e];this.set(dr[0],dr[1])}}function Oe(){this.__data__={hash:new z,map:new(St||Ne),string:new z}}function Ve(ot){return Xe(this,ot).delete(ot)}function P(ot){return Xe(this,ot).get(ot)}function R(ot){return Xe(this,ot).has(ot)}function J(ot,$e){return Xe(this,ot).set(ot,$e),this}ft.prototype.clear=Oe,ft.prototype.delete=Ve,ft.prototype.get=P,ft.prototype.has=R,ft.prototype.set=J;function de(ot){var $e=-1,Vt=ot?ot.length:0;for(this.__data__=new ft;++$e<Vt;)this.add(ot[$e])}function je(ot){return this.__data__.set(ot,Z),this}function We(ot){return this.__data__.has(ot)}de.prototype.add=de.prototype.push=je,de.prototype.has=We;function gt(ot,$e){for(var Vt=ot.length;Vt--;)if(ht(ot[Vt][0],$e))return Vt;return-1}function nt(ot){if(!pt(ot)||Gt(ot))return!1;var $e=Pt(ot)||xt(ot)?at:K;return $e.test(ur(ot))}function Nt(ot,$e,Vt){var dr=-1,Zr=He,cr=ot.length,Un=!0,Sn=[],ni=Sn;if(Vt)Un=!1,Zr=Be;else if(cr>=v){var fi=$e?null:Y(ot);if(fi)return Mt(fi);Un=!1,Zr=Me,ni=new de}else ni=$e?[]:Sn;e:for(;++dr<cr;){var Wn=ot[dr],Gn=$e?$e(Wn):Wn;if(Wn=Vt||Wn!==0?Wn:0,Un&&Gn===Gn){for(var Ee=ni.length;Ee--;)if(ni[Ee]===Gn)continue e;$e&&ni.push(Gn),Sn.push(Wn)}else Zr(ni,Gn,Vt)||(ni!==Sn&&ni.push(Gn),Sn.push(Wn))}return Sn}var Y=dt&&1/Mt(new dt([,-0]))[1]==N?function(ot){return new dt(ot)}:Pe;function Xe(ot,$e){var Vt=ot.__data__;return Je($e)?Vt[typeof $e=="string"?"string":"hash"]:Vt.map}function re(ot,$e){var Vt=bt(ot,$e);return nt(Vt)?Vt:void 0}function Je(ot){var $e=typeof ot;return $e=="string"||$e=="number"||$e=="symbol"||$e=="boolean"?ot!=="__proto__":ot===null}function Gt(ot){return!!vt&&vt in ot}function ur(ot){if(ot!=null){try{return Ze.call(ot)}catch($e){}try{return ot+""}catch($e){}}return""}function ct(ot){return ot&&ot.length?Nt(ot):[]}function ht(ot,$e){return ot===$e||ot!==ot&&$e!==$e}function Pt(ot){var $e=pt(ot)?Le.call(ot):"";return $e==o||$e==X}function pt(ot){var $e=typeof ot;return!!ot&&($e=="object"||$e=="function")}function Pe(){}we.exports=ct}).call(this,a("yLpj"))},wclG:function(we,x,a){var S=a("pFRH"),v=a("88Gu"),Z=v(S);we.exports=Z},wnjb:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.MetadataReader=void 0;var S=a("xfSm"),v=function(){function Z(){}return Z.prototype.getConstructorMetadata=function(N){var o=Reflect.getMetadata(S.PARAM_TYPES,N),X=Reflect.getMetadata(S.TAGGED,N);return{compilerGeneratedMetadata:o,userGeneratedMetadata:X||{}}},Z.prototype.getPropertiesMetadata=function(N){var o=Reflect.getMetadata(S.TAGGED_PROP,N)||[];return o},Z}();x.MetadataReader=v},wrZu:function(we,x,a){var S=a("+K+b"),v=a("XYm9"),Z=a("b2z7"),N=a("otv/"),o=a("yP5f"),X="[object Boolean]",F="[object Date]",K="[object Map]",q="[object Number]",Ce="[object RegExp]",$="[object Set]",He="[object String]",Be="[object Symbol]",ce="[object ArrayBuffer]",st="[object DataView]",ut="[object Float32Array]",Me="[object Float64Array]",bt="[object Int8Array]",xt="[object Int16Array]",Mt="[object Int32Array]",De="[object Uint8Array]",ar="[object Uint8ClampedArray]",$t="[object Uint16Array]",Ht="[object Uint32Array]";function vt(Ze,Et,Le){var at=Ze.constructor;switch(Et){case ce:return S(Ze);case X:case F:return new at(+Ze);case st:return v(Ze,Le);case ut:case Me:case bt:case xt:case Mt:case De:case ar:case $t:case Ht:return o(Ze,Le);case K:return new at;case q:case He:return new at(Ze);case Ce:return Z(Ze);case $:return new at;case Be:return N(Ze)}}we.exports=vt},wy8a:function(we,x,a){var S=a("KxBF");function v(Z,N,o){var X=Z.length;return o=o===void 0?X:o,!N&&o>=X?Z:S(Z,N,o)}we.exports=v},xfSm:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.POST_CONSTRUCT=x.DESIGN_PARAM_TYPES=x.PARAM_TYPES=x.TAGGED_PROP=x.TAGGED=x.MULTI_INJECT_TAG=x.INJECT_TAG=x.OPTIONAL_TAG=x.UNMANAGED_TAG=x.NAME_TAG=x.NAMED_TAG=void 0,x.NAMED_TAG="named",x.NAME_TAG="name",x.UNMANAGED_TAG="unmanaged",x.OPTIONAL_TAG="optional",x.INJECT_TAG="inject",x.MULTI_INJECT_TAG="multi_inject",x.TAGGED="inversify:tagged",x.TAGGED_PROP="inversify:tagged_props",x.PARAM_TYPES="inversify:paramtypes",x.DESIGN_PARAM_TYPES="design:paramtypes",x.POST_CONSTRUCT="post_construct"},xfeJ:function(we,x){function a(S){return Function.toString.call(S).indexOf("[native code]")!==-1}we.exports=a},xiII:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.Request=void 0;var S=a("d9O0"),v=function(){function Z(N,o,X,F,K){this.id=S.id(),this.serviceIdentifier=N,this.parentContext=o,this.parentRequest=X,this.target=K,this.childRequests=[],this.bindings=Array.isArray(F)?F:[F],this.requestScope=X===null?new Map:null}return Z.prototype.addChildRequest=function(N,o,X){var F=new Z(N,this.parentContext,this,o,X);return this.childRequests.push(F),F},Z}();x.Request=v},xp6e:function(we,x,a){"use strict";(function(S){a.d(x,"a",function(){return me}),a.d(x,"b",function(){return lt}),a.d(x,"c",function(){return H}),a.d(x,"d",function(){return Ne});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function v(rt,ue,ye,Ue){function ft(Oe){return Oe instanceof ye?Oe:new ye(function(Ve){Ve(Oe)})}return new(ye||(ye=Promise))(function(Oe,Ve){function P(de){try{J(Ue.next(de))}catch(je){Ve(je)}}function R(de){try{J(Ue.throw(de))}catch(je){Ve(je)}}function J(de){de.done?Oe(de.value):ft(de.value).then(P,R)}J((Ue=Ue.apply(rt,ue||[])).next())})}function Z(rt,ue){var ye={label:0,sent:function(){if(Oe[0]&1)throw Oe[1];return Oe[1]},trys:[],ops:[]},Ue,ft,Oe,Ve;return Ve={next:P(0),throw:P(1),return:P(2)},typeof Symbol=="function"&&(Ve[Symbol.iterator]=function(){return this}),Ve;function P(J){return function(de){return R([J,de])}}function R(J){if(Ue)throw new TypeError("Generator is already executing.");for(;ye;)try{if(Ue=1,ft&&(Oe=J[0]&2?ft.return:J[0]?ft.throw||((Oe=ft.return)&&Oe.call(ft),0):ft.next)&&!(Oe=Oe.call(ft,J[1])).done)return Oe;switch(ft=0,Oe&&(J=[J[0]&2,Oe.value]),J[0]){case 0:case 1:Oe=J;break;case 4:return ye.label++,{value:J[1],done:!1};case 5:ye.label++,ft=J[1],J=[0];continue;case 7:J=ye.ops.pop(),ye.trys.pop();continue;default:if(Oe=ye.trys,!(Oe=Oe.length>0&&Oe[Oe.length-1])&&(J[0]===6||J[0]===2)){ye=0;continue}if(J[0]===3&&(!Oe||J[1]>Oe[0]&&J[1]<Oe[3])){ye.label=J[1];break}if(J[0]===6&&ye.label<Oe[1]){ye.label=Oe[1],Oe=J;break}if(Oe&&ye.label<Oe[2]){ye.label=Oe[2],ye.ops.push(J);break}Oe[2]&&ye.ops.pop(),ye.trys.pop();continue}J=ue.call(rt,ye)}catch(de){J=[6,de],ft=0}finally{Ue=Oe=0}if(J[0]&5)throw J[1];return{value:J[0]?J[1]:void 0,done:!0}}}function N(rt,ue){var ye=typeof Symbol=="function"&&rt[Symbol.iterator];if(!ye)return rt;var Ue=ye.call(rt),ft,Oe=[],Ve;try{for(;(ue===void 0||ue-- >0)&&!(ft=Ue.next()).done;)Oe.push(ft.value)}catch(P){Ve={error:P}}finally{try{ft&&!ft.done&&(ye=Ue.return)&&ye.call(Ue)}finally{if(Ve)throw Ve.error}}return Oe}function o(){for(var rt=[],ue=0;ue<arguments.length;ue++)rt=rt.concat(N(arguments[ue]));return rt}function X(rt){return rt&&rt.__esModule&&Object.prototype.hasOwnProperty.call(rt,"default")?rt.default:rt}function F(rt,ue){return ue={exports:{}},rt(ue,ue.exports),ue.exports}var K=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0}),ue.default=ye;function ye(Ue){return Ue&&typeof Ue.length=="number"&&Ue.length>=0&&Ue.length%1==0}rt.exports=ue.default});X(K);var q=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0}),ue.default=function(ye){return function(){for(var Ue=[],ft=arguments.length;ft--;)Ue[ft]=arguments[ft];var Oe=Ue.pop();return ye.call(this,Ue,Oe)}},rt.exports=ue.default});X(q);var Ce=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0}),ue.fallback=ft,ue.wrap=Oe;var ye=ue.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,Ue=ue.hasNextTick=typeof S=="object"&&typeof S.nextTick=="function";function ft(P){setTimeout(P,0)}function Oe(P){return function(R){for(var J=[],de=arguments.length-1;de-- >0;)J[de]=arguments[de+1];return P(function(){return R.apply(void 0,J)})}}var Ve;ye?Ve=setImmediate:Ue?Ve=S.nextTick:Ve=ft,ue.default=Oe(Ve)});X(Ce);var $=Ce.fallback,He=Ce.wrap,Be=Ce.hasSetImmediate,ce=Ce.hasNextTick,st=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0}),ue.default=Oe;var ye=ft(q),Ue=ft(Ce);function ft(R){return R&&R.__esModule?R:{default:R}}function Oe(R){return(0,ut.isAsync)(R)?function(){for(var J=[],de=arguments.length;de--;)J[de]=arguments[de];var je=J.pop(),We=R.apply(this,J);return Ve(We,je)}:(0,ye.default)(function(J,de){var je;try{je=R.apply(this,J)}catch(We){return de(We)}if(je&&typeof je.then=="function")return Ve(je,de);de(null,je)})}function Ve(R,J){return R.then(function(de){P(J,null,de)},function(de){P(J,de&&de.message?de:new Error(de))})}function P(R,J,de){try{R(J,de)}catch(je){(0,Ue.default)(function(We){throw We},je)}}rt.exports=ue.default});X(st);var ut=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0}),ue.isAsyncIterable=ue.isAsyncGenerator=ue.isAsync=void 0;var ye=Ue(st);function Ue(R){return R&&R.__esModule?R:{default:R}}function ft(R){return R[Symbol.toStringTag]==="AsyncFunction"}function Oe(R){return R[Symbol.toStringTag]==="AsyncGenerator"}function Ve(R){return typeof R[Symbol.asyncIterator]=="function"}function P(R){if(typeof R!="function")throw new Error("expected a function");return ft(R)?(0,ye.default)(R):R}ue.default=P,ue.isAsync=ft,ue.isAsyncGenerator=Oe,ue.isAsyncIterable=Ve});X(ut);var Me=ut.isAsyncIterable,bt=ut.isAsyncGenerator,xt=ut.isAsync,Mt=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0}),ue.default=ye;function ye(Ue,ft){if(ft===void 0&&(ft=Ue.length),!ft)throw new Error("arity is undefined");function Oe(){for(var Ve=this,P=[],R=arguments.length;R--;)P[R]=arguments[R];return typeof P[ft-1]=="function"?Ue.apply(this,P):new Promise(function(J,de){P[ft-1]=function(je){for(var We=[],gt=arguments.length-1;gt-- >0;)We[gt]=arguments[gt+1];if(je)return de(je);J(We.length>1?We:We[0])},Ue.apply(Ve,P)})}return Object.defineProperty(Oe,"name",{configurable:!0,value:"awaitable("+Ue.name+")"}),Oe}rt.exports=ue.default});X(Mt);var De=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0});var ye=Oe(K),Ue=Oe(ut),ft=Oe(Mt);function Oe(Ve){return Ve&&Ve.__esModule?Ve:{default:Ve}}ue.default=(0,ft.default)(function(Ve,P,R){var J=(0,ye.default)(P)?[]:{};Ve(P,function(de,je,We){(0,Ue.default)(de)(function(gt){for(var nt,Nt=[],Y=arguments.length-1;Y-- >0;)Nt[Y]=arguments[Y+1];Nt.length<2&&(nt=Nt,Nt=nt[0]),J[je]=Nt,We(gt)})},function(de){return R(de,J)})},3),rt.exports=ue.default});X(De);var ar=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0}),ue.default=ye;function ye(Ue){function ft(){for(var Oe=[],Ve=arguments.length;Ve--;)Oe[Ve]=arguments[Ve];if(Ue!==null){var P=Ue;Ue=null,P.apply(this,Oe)}}return Object.assign(ft,Ue),ft}rt.exports=ue.default});X(ar);var $t=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0}),ue.default=function(ye){return ye[Symbol.iterator]&&ye[Symbol.iterator]()},rt.exports=ue.default});X($t);var Ht=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0}),ue.default=R;var ye=ft(K),Ue=ft($t);function ft(J){return J&&J.__esModule?J:{default:J}}function Oe(J){var de=-1,je=J.length;return function(){return++de<je?{value:J[de],key:de}:null}}function Ve(J){var de=-1;return function(){var We=J.next();return We.done?null:(de++,{value:We.value,key:de})}}function P(J){var de=J?Object.keys(J):[],je=-1,We=de.length;return function(){var nt=de[++je];return je<We?{value:J[nt],key:nt}:null}}function R(J){if((0,ye.default)(J))return Oe(J);var de=(0,Ue.default)(J);return de?Ve(de):P(J)}rt.exports=ue.default});X(Ht);var vt=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0}),ue.default=ye;function ye(Ue){return function(){for(var ft=[],Oe=arguments.length;Oe--;)ft[Oe]=arguments[Oe];if(Ue===null)throw new Error("Callback was already called.");var Ve=Ue;Ue=null,Ve.apply(this,ft)}}rt.exports=ue.default});X(vt);var Ze=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0});var ye={};ue.default=ye,rt.exports=ue.default});X(Ze);var Et=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0}),ue.default=ft;var ye=Ue(Ze);function Ue(Oe){return Oe&&Oe.__esModule?Oe:{default:Oe}}function ft(Oe,Ve,P,R){var J=!1,de=!1,je=!1,We=0,gt=0;function nt(){We>=Ve||je||J||(je=!0,Oe.next().then(function(Xe){var re=Xe.value,Je=Xe.done;if(!(de||J)){if(je=!1,Je){J=!0,We<=0&&R(null);return}We++,P(re,gt,Nt),gt++,nt()}}).catch(Y))}function Nt(Xe,re){if(We-=1,!de){if(Xe)return Y(Xe);if(Xe===!1){J=!0,de=!0;return}if(re===ye.default||J&&We<=0)return J=!0,R(null);nt()}}function Y(Xe){de||(je=!1,J=!0,R(Xe))}nt()}rt.exports=ue.default});X(Et);var Le=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0});var ye=P(ar),Ue=P(Ht),ft=P(vt),Oe=P(Et),Ve=P(Ze);function P(R){return R&&R.__esModule?R:{default:R}}ue.default=function(R){return function(J,de,je){if(je=(0,ye.default)(je),R<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!J)return je(null);if((0,ut.isAsyncGenerator)(J))return(0,Oe.default)(J,R,de,je);if((0,ut.isAsyncIterable)(J))return(0,Oe.default)(J[Symbol.asyncIterator](),R,de,je);var We=(0,Ue.default)(J),gt=!1,nt=!1,Nt=0,Y=!1;function Xe(Je,Gt){if(!nt)if(Nt-=1,Je)gt=!0,je(Je);else if(Je===!1)gt=!0,nt=!0;else{if(Gt===Ve.default||gt&&Nt<=0)return gt=!0,je(null);Y||re()}}function re(){for(Y=!0;Nt<R&&!gt;){var Je=We();if(Je===null){gt=!0,Nt<=0&&je(null);return}Nt+=1,de(Je.value,Je.key,(0,ft.default)(Xe))}Y=!1}re()}},rt.exports=ue.default});X(Le);var at=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0});var ye=Oe(Le),Ue=Oe(ut),ft=Oe(Mt);function Oe(P){return P&&P.__esModule?P:{default:P}}function Ve(P,R,J,de){return(0,ye.default)(R)(P,(0,Ue.default)(J),de)}ue.default=(0,ft.default)(Ve,4),rt.exports=ue.default});X(at);var Wt=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0});var ye=ft(at),Ue=ft(Mt);function ft(Ve){return Ve&&Ve.__esModule?Ve:{default:Ve}}function Oe(Ve,P,R){return(0,ye.default)(Ve,1,P,R)}ue.default=(0,Ue.default)(Oe,3),rt.exports=ue.default});X(Wt);var St=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0}),ue.default=Oe;var ye=ft(De),Ue=ft(Wt);function ft(Ve){return Ve&&Ve.__esModule?Ve:{default:Ve}}function Oe(Ve,P){return(0,ye.default)(Ue.default,Ve,P)}rt.exports=ue.default}),dt=X(St),H=function(){function rt(){for(var ue=arguments,ye=[],Ue=0;Ue<arguments.length;Ue++)ye[Ue]=ue[Ue];this.args=[],this.tasks=[]}return rt.prototype.call=function(){for(var ue=arguments,ye=[],Ue=0;Ue<arguments.length;Ue++)ye[Ue]=ue[Ue];return this.args=ye,dt(this.tasks)},rt.prototype.tap=function(ue,ye){var Ue=this;this.tasks.push(function(ft){ye.apply(void 0,o(Ue.args)),ft(null,ue)})},rt}(),z=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0});var ye=J(K),Ue=J(Ze),ft=J(at),Oe=J(ar),Ve=J(vt),P=J(ut),R=J(Mt);function J(gt){return gt&&gt.__esModule?gt:{default:gt}}function de(gt,nt,Nt){Nt=(0,Oe.default)(Nt);var Y=0,Xe=0,re=gt.length,Je=!1;re===0&&Nt(null);function Gt(ur,ct){ur===!1&&(Je=!0),Je!==!0&&(ur?Nt(ur):(++Xe===re||ct===Ue.default)&&Nt(null))}for(;Y<re;Y++)nt(gt[Y],Y,(0,Ve.default)(Gt))}function je(gt,nt,Nt){return(0,ft.default)(gt,Infinity,nt,Nt)}function We(gt,nt,Nt){var Y=(0,ye.default)(gt)?de:je;return Y(gt,(0,P.default)(nt),Nt)}ue.default=(0,R.default)(We,3),rt.exports=ue.default});X(z);var V=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0}),ue.default=Oe;var ye=ft(z),Ue=ft(De);function ft(Ve){return Ve&&Ve.__esModule?Ve:{default:Ve}}function Oe(Ve,P){return(0,Ue.default)(ye.default,Ve,P)}rt.exports=ue.default}),be=X(V),me=function(){function rt(){for(var ue=arguments,ye=[],Ue=0;Ue<arguments.length;Ue++)ye[Ue]=ue[Ue];this.tasks=[]}return rt.prototype.promise=function(){for(var ue=arguments,ye=[],Ue=0;Ue<arguments.length;Ue++)ye[Ue]=ue[Ue];return be(this.tasks)},rt.prototype.tapPromise=function(ue,ye){var Ue=this;this.tasks.push(function(ft){return v(Ue,void 0,void 0,function(){return Z(this,function(Oe){switch(Oe.label){case 0:return[4,ye()];case 1:return Oe.sent(),ft(null,ue),[2]}})})})},rt}(),le=F(function(rt,ue){Object.defineProperty(ue,"__esModule",{value:!0});var ye=Ve(ar),Ue=Ve(vt),ft=Ve(ut),Oe=Ve(Mt);function Ve(R){return R&&R.__esModule?R:{default:R}}function P(R,J){if(J=(0,ye.default)(J),!Array.isArray(R))return J(new Error("First argument to waterfall must be an array of functions"));if(!R.length)return J();var de=0;function je(gt){var nt=(0,ft.default)(R[de++]);nt.apply(void 0,gt.concat([(0,Ue.default)(We)]))}function We(gt){for(var nt=[],Nt=arguments.length-1;Nt-- >0;)nt[Nt]=arguments[Nt+1];if(gt!==!1){if(gt||de===R.length)return J.apply(void 0,[gt].concat(nt));je(nt)}}je([])}ue.default=(0,Oe.default)(P),rt.exports=ue.default}),fe=X(le),Ne=function(){function rt(){for(var ue=arguments,ye=[],Ue=0;Ue<arguments.length;Ue++)ye[Ue]=ue[Ue];this.tasks=[]}return rt.prototype.call=function(){for(var ue=arguments,ye=[],Ue=0;Ue<arguments.length;Ue++)ye[Ue]=ue[Ue];return fe(this.tasks)},rt.prototype.tap=function(ue,ye){this.tasks.length===0?this.tasks.push(function(Ue){var ft=ye();Ue(ft?null:!1,ft)}):this.tasks.push(function(Ue,ft){var Oe=ye();ft(Oe?null:!1,ue)})},rt}(),lt=function(){function rt(){for(var ue=arguments,ye=[],Ue=0;Ue<arguments.length;Ue++)ye[Ue]=ue[Ue];this.tasks=[]}return rt.prototype.call=function(){for(var ue=arguments,ye=[],Ue=0;Ue<arguments.length;Ue++)ye[Ue]=ue[Ue];return dt(this.tasks)},rt.prototype.tap=function(ue,ye){this.tasks.push(function(Ue){var ft=ye();Ue(ft,ue)})},rt}()}).call(this,a("Q2Ig"))},yG8O:function(we,x){function a(S,v,Z,N){!Z||Object.defineProperty(S,v,{enumerable:Z.enumerable,configurable:Z.configurable,writable:Z.writable,value:Z.initializer?Z.initializer.call(N):void 0})}we.exports=a},yHx3:function(we,x){var a=Object.prototype,S=a.hasOwnProperty;function v(Z){var N=Z.length,o=new Z.constructor(N);return N&&typeof Z[0]=="string"&&S.call(Z,"index")&&(o.index=Z.index,o.input=Z.input),o}we.exports=v},yLV6:function(we,x,a){var S;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(v,Z,N,o){"use strict";var X=["","webkit","Moz","MS","ms","o"],F=Z.createElement("div"),K="function",q=Math.round,Ce=Math.abs,$=Date.now;function He(kt,ze,It){return setTimeout(Mt(kt,It),ze)}function Be(kt,ze,It){return Array.isArray(kt)?(ce(kt,It[ze],It),!0):!1}function ce(kt,ze,It){var fr;if(!!kt)if(kt.forEach)kt.forEach(ze,It);else if(kt.length!==o)for(fr=0;fr<kt.length;)ze.call(It,kt[fr],fr,kt),fr++;else for(fr in kt)kt.hasOwnProperty(fr)&&ze.call(It,kt[fr],fr,kt)}function st(kt,ze,It){var fr="DEPRECATED METHOD: "+ze+`
`+It+` AT 
`;return function(){var nn=new Error("get-stack-trace"),yn=nn&&nn.stack?nn.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Vn=v.console&&(v.console.warn||v.console.log);return Vn&&Vn.call(v.console,fr,yn),kt.apply(this,arguments)}}var ut;typeof Object.assign!="function"?ut=function(ze){if(ze===o||ze===null)throw new TypeError("Cannot convert undefined or null to object");for(var It=Object(ze),fr=1;fr<arguments.length;fr++){var nn=arguments[fr];if(nn!==o&&nn!==null)for(var yn in nn)nn.hasOwnProperty(yn)&&(It[yn]=nn[yn])}return It}:ut=Object.assign;var Me=st(function(ze,It,fr){for(var nn=Object.keys(It),yn=0;yn<nn.length;)(!fr||fr&&ze[nn[yn]]===o)&&(ze[nn[yn]]=It[nn[yn]]),yn++;return ze},"extend","Use `assign`."),bt=st(function(ze,It){return Me(ze,It,!0)},"merge","Use `assign`.");function xt(kt,ze,It){var fr=ze.prototype,nn;nn=kt.prototype=Object.create(fr),nn.constructor=kt,nn._super=fr,It&&ut(nn,It)}function Mt(kt,ze){return function(){return kt.apply(ze,arguments)}}function De(kt,ze){return typeof kt==K?kt.apply(ze&&ze[0]||o,ze):kt}function ar(kt,ze){return kt===o?ze:kt}function $t(kt,ze,It){ce(Et(ze),function(fr){kt.addEventListener(fr,It,!1)})}function Ht(kt,ze,It){ce(Et(ze),function(fr){kt.removeEventListener(fr,It,!1)})}function vt(kt,ze){for(;kt;){if(kt==ze)return!0;kt=kt.parentNode}return!1}function Ze(kt,ze){return kt.indexOf(ze)>-1}function Et(kt){return kt.trim().split(/\s+/g)}function Le(kt,ze,It){if(kt.indexOf&&!It)return kt.indexOf(ze);for(var fr=0;fr<kt.length;){if(It&&kt[fr][It]==ze||!It&&kt[fr]===ze)return fr;fr++}return-1}function at(kt){return Array.prototype.slice.call(kt,0)}function Wt(kt,ze,It){for(var fr=[],nn=[],yn=0;yn<kt.length;){var Vn=ze?kt[yn][ze]:kt[yn];Le(nn,Vn)<0&&fr.push(kt[yn]),nn[yn]=Vn,yn++}return It&&(ze?fr=fr.sort(function(xo,_o){return xo[ze]>_o[ze]}):fr=fr.sort()),fr}function St(kt,ze){for(var It,fr,nn=ze[0].toUpperCase()+ze.slice(1),yn=0;yn<X.length;){if(It=X[yn],fr=It?It+nn:ze,fr in kt)return fr;yn++}return o}var dt=1;function H(){return dt++}function z(kt){var ze=kt.ownerDocument||kt;return ze.defaultView||ze.parentWindow||v}var V=/mobile|tablet|ip(ad|hone|od)|android/i,be="ontouchstart"in v,me=St(v,"PointerEvent")!==o,le=be&&V.test(navigator.userAgent),fe="touch",Ne="pen",lt="mouse",rt="kinect",ue=25,ye=1,Ue=2,ft=4,Oe=8,Ve=1,P=2,R=4,J=8,de=16,je=P|R,We=J|de,gt=je|We,nt=["x","y"],Nt=["clientX","clientY"];function Y(kt,ze){var It=this;this.manager=kt,this.callback=ze,this.element=kt.element,this.target=kt.options.inputTarget,this.domHandler=function(fr){De(kt.options.enable,[kt])&&It.handler(fr)},this.init()}Y.prototype={handler:function(){},init:function(){this.evEl&&$t(this.element,this.evEl,this.domHandler),this.evTarget&&$t(this.target,this.evTarget,this.domHandler),this.evWin&&$t(z(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Ht(this.element,this.evEl,this.domHandler),this.evTarget&&Ht(this.target,this.evTarget,this.domHandler),this.evWin&&Ht(z(this.element),this.evWin,this.domHandler)}};function Xe(kt){var ze,It=kt.options.inputClass;return It?ze=It:me?ze=Gn:le?ze=Re:be?ze=Ur:ze=Un,new ze(kt,re)}function re(kt,ze,It){var fr=It.pointers.length,nn=It.changedPointers.length,yn=ze&ye&&fr-nn==0,Vn=ze&(ft|Oe)&&fr-nn==0;It.isFirst=!!yn,It.isFinal=!!Vn,yn&&(kt.session={}),It.eventType=ze,Je(kt,It),kt.emit("hammer.input",It),kt.recognize(It),kt.session.prevInput=It}function Je(kt,ze){var It=kt.session,fr=ze.pointers,nn=fr.length;It.firstInput||(It.firstInput=ct(ze)),nn>1&&!It.firstMultiple?It.firstMultiple=ct(ze):nn===1&&(It.firstMultiple=!1);var yn=It.firstInput,Vn=It.firstMultiple,Ua=Vn?Vn.center:yn.center,xo=ze.center=ht(fr);ze.timeStamp=$(),ze.deltaTime=ze.timeStamp-yn.timeStamp,ze.angle=ot(Ua,xo),ze.distance=Pe(Ua,xo),Gt(It,ze),ze.offsetDirection=pt(ze.deltaX,ze.deltaY);var _o=Pt(ze.deltaTime,ze.deltaX,ze.deltaY);ze.overallVelocityX=_o.x,ze.overallVelocityY=_o.y,ze.overallVelocity=Ce(_o.x)>Ce(_o.y)?_o.x:_o.y,ze.scale=Vn?Vt(Vn.pointers,fr):1,ze.rotation=Vn?$e(Vn.pointers,fr):0,ze.maxPointers=It.prevInput?ze.pointers.length>It.prevInput.maxPointers?ze.pointers.length:It.prevInput.maxPointers:ze.pointers.length,ur(It,ze);var Ro=kt.element;vt(ze.srcEvent.target,Ro)&&(Ro=ze.srcEvent.target),ze.target=Ro}function Gt(kt,ze){var It=ze.center,fr=kt.offsetDelta||{},nn=kt.prevDelta||{},yn=kt.prevInput||{};(ze.eventType===ye||yn.eventType===ft)&&(nn=kt.prevDelta={x:yn.deltaX||0,y:yn.deltaY||0},fr=kt.offsetDelta={x:It.x,y:It.y}),ze.deltaX=nn.x+(It.x-fr.x),ze.deltaY=nn.y+(It.y-fr.y)}function ur(kt,ze){var It=kt.lastInterval||ze,fr=ze.timeStamp-It.timeStamp,nn,yn,Vn,Ua;if(ze.eventType!=Oe&&(fr>ue||It.velocity===o)){var xo=ze.deltaX-It.deltaX,_o=ze.deltaY-It.deltaY,Ro=Pt(fr,xo,_o);yn=Ro.x,Vn=Ro.y,nn=Ce(Ro.x)>Ce(Ro.y)?Ro.x:Ro.y,Ua=pt(xo,_o),kt.lastInterval=ze}else nn=It.velocity,yn=It.velocityX,Vn=It.velocityY,Ua=It.direction;ze.velocity=nn,ze.velocityX=yn,ze.velocityY=Vn,ze.direction=Ua}function ct(kt){for(var ze=[],It=0;It<kt.pointers.length;)ze[It]={clientX:q(kt.pointers[It].clientX),clientY:q(kt.pointers[It].clientY)},It++;return{timeStamp:$(),pointers:ze,center:ht(ze),deltaX:kt.deltaX,deltaY:kt.deltaY}}function ht(kt){var ze=kt.length;if(ze===1)return{x:q(kt[0].clientX),y:q(kt[0].clientY)};for(var It=0,fr=0,nn=0;nn<ze;)It+=kt[nn].clientX,fr+=kt[nn].clientY,nn++;return{x:q(It/ze),y:q(fr/ze)}}function Pt(kt,ze,It){return{x:ze/kt||0,y:It/kt||0}}function pt(kt,ze){return kt===ze?Ve:Ce(kt)>=Ce(ze)?kt<0?P:R:ze<0?J:de}function Pe(kt,ze,It){It||(It=nt);var fr=ze[It[0]]-kt[It[0]],nn=ze[It[1]]-kt[It[1]];return Math.sqrt(fr*fr+nn*nn)}function ot(kt,ze,It){It||(It=nt);var fr=ze[It[0]]-kt[It[0]],nn=ze[It[1]]-kt[It[1]];return Math.atan2(nn,fr)*180/Math.PI}function $e(kt,ze){return ot(ze[1],ze[0],Nt)+ot(kt[1],kt[0],Nt)}function Vt(kt,ze){return Pe(ze[0],ze[1],Nt)/Pe(kt[0],kt[1],Nt)}var dr={mousedown:ye,mousemove:Ue,mouseup:ft},Zr="mousedown",cr="mousemove mouseup";function Un(){this.evEl=Zr,this.evWin=cr,this.pressed=!1,Y.apply(this,arguments)}xt(Un,Y,{handler:function(ze){var It=dr[ze.type];It&ye&&ze.button===0&&(this.pressed=!0),It&Ue&&ze.which!==1&&(It=ft),!!this.pressed&&(It&ft&&(this.pressed=!1),this.callback(this.manager,It,{pointers:[ze],changedPointers:[ze],pointerType:lt,srcEvent:ze}))}});var Sn={pointerdown:ye,pointermove:Ue,pointerup:ft,pointercancel:Oe,pointerout:Oe},ni={2:fe,3:Ne,4:lt,5:rt},fi="pointerdown",Wn="pointermove pointerup pointercancel";v.MSPointerEvent&&!v.PointerEvent&&(fi="MSPointerDown",Wn="MSPointerMove MSPointerUp MSPointerCancel");function Gn(){this.evEl=fi,this.evWin=Wn,Y.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}xt(Gn,Y,{handler:function(ze){var It=this.store,fr=!1,nn=ze.type.toLowerCase().replace("ms",""),yn=Sn[nn],Vn=ni[ze.pointerType]||ze.pointerType,Ua=Vn==fe,xo=Le(It,ze.pointerId,"pointerId");yn&ye&&(ze.button===0||Ua)?xo<0&&(It.push(ze),xo=It.length-1):yn&(ft|Oe)&&(fr=!0),!(xo<0)&&(It[xo]=ze,this.callback(this.manager,yn,{pointers:It,changedPointers:[ze],pointerType:Vn,srcEvent:ze}),fr&&It.splice(xo,1))}});var Ee={touchstart:ye,touchmove:Ue,touchend:ft,touchcancel:Oe},pe="touchstart",W="touchstart touchmove touchend touchcancel";function ae(){this.evTarget=pe,this.evWin=W,this.started=!1,Y.apply(this,arguments)}xt(ae,Y,{handler:function(ze){var It=Ee[ze.type];if(It===ye&&(this.started=!0),!!this.started){var fr=Ie.call(this,ze,It);It&(ft|Oe)&&fr[0].length-fr[1].length==0&&(this.started=!1),this.callback(this.manager,It,{pointers:fr[0],changedPointers:fr[1],pointerType:fe,srcEvent:ze})}}});function Ie(kt,ze){var It=at(kt.touches),fr=at(kt.changedTouches);return ze&(ft|Oe)&&(It=Wt(It.concat(fr),"identifier",!0)),[It,fr]}var qe={touchstart:ye,touchmove:Ue,touchend:ft,touchcancel:Oe},Ct="touchstart touchmove touchend touchcancel";function Re(){this.evTarget=Ct,this.targetIds={},Y.apply(this,arguments)}xt(Re,Y,{handler:function(ze){var It=qe[ze.type],fr=mt.call(this,ze,It);!fr||this.callback(this.manager,It,{pointers:fr[0],changedPointers:fr[1],pointerType:fe,srcEvent:ze})}});function mt(kt,ze){var It=at(kt.touches),fr=this.targetIds;if(ze&(ye|Ue)&&It.length===1)return fr[It[0].identifier]=!0,[It,It];var nn,yn,Vn=at(kt.changedTouches),Ua=[],xo=this.target;if(yn=It.filter(function(_o){return vt(_o.target,xo)}),ze===ye)for(nn=0;nn<yn.length;)fr[yn[nn].identifier]=!0,nn++;for(nn=0;nn<Vn.length;)fr[Vn[nn].identifier]&&Ua.push(Vn[nn]),ze&(ft|Oe)&&delete fr[Vn[nn].identifier],nn++;if(!!Ua.length)return[Wt(yn.concat(Ua),"identifier",!0),Ua]}var Qt=2500,Br=25;function Ur(){Y.apply(this,arguments);var kt=Mt(this.handler,this);this.touch=new Re(this.manager,kt),this.mouse=new Un(this.manager,kt),this.primaryTouch=null,this.lastTouches=[]}xt(Ur,Y,{handler:function(ze,It,fr){var nn=fr.pointerType==fe,yn=fr.pointerType==lt;if(!(yn&&fr.sourceCapabilities&&fr.sourceCapabilities.firesTouchEvents)){if(nn)or.call(this,It,fr);else if(yn&&An.call(this,fr))return;this.callback(ze,It,fr)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function or(kt,ze){kt&ye?(this.primaryTouch=ze.changedPointers[0].identifier,Vr.call(this,ze)):kt&(ft|Oe)&&Vr.call(this,ze)}function Vr(kt){var ze=kt.changedPointers[0];if(ze.identifier===this.primaryTouch){var It={x:ze.clientX,y:ze.clientY};this.lastTouches.push(It);var fr=this.lastTouches,nn=function(){var Vn=fr.indexOf(It);Vn>-1&&fr.splice(Vn,1)};setTimeout(nn,Qt)}}function An(kt){for(var ze=kt.srcEvent.clientX,It=kt.srcEvent.clientY,fr=0;fr<this.lastTouches.length;fr++){var nn=this.lastTouches[fr],yn=Math.abs(ze-nn.x),Vn=Math.abs(It-nn.y);if(yn<=Br&&Vn<=Br)return!0}return!1}var dn=St(F.style,"touchAction"),Cr=dn!==o,Tn="compute",fn="auto",En="manipulation",Cn="none",pn="pan-x",Lr="pan-y",hi=_i();function xi(kt,ze){this.manager=kt,this.set(ze)}xi.prototype={set:function(ze){ze==Tn&&(ze=this.compute()),Cr&&this.manager.element.style&&hi[ze]&&(this.manager.element.style[dn]=ze),this.actions=ze.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ze=[];return ce(this.manager.recognizers,function(It){De(It.options.enable,[It])&&(ze=ze.concat(It.getTouchAction()))}),ki(ze.join(" "))},preventDefaults:function(ze){var It=ze.srcEvent,fr=ze.offsetDirection;if(this.manager.session.prevented){It.preventDefault();return}var nn=this.actions,yn=Ze(nn,Cn)&&!hi[Cn],Vn=Ze(nn,Lr)&&!hi[Lr],Ua=Ze(nn,pn)&&!hi[pn];if(yn){var xo=ze.pointers.length===1,_o=ze.distance<2,Ro=ze.deltaTime<250;if(xo&&_o&&Ro)return}if(!(Ua&&Vn)&&(yn||Vn&&fr&je||Ua&&fr&We))return this.preventSrc(It)},preventSrc:function(ze){this.manager.session.prevented=!0,ze.preventDefault()}};function ki(kt){if(Ze(kt,Cn))return Cn;var ze=Ze(kt,pn),It=Ze(kt,Lr);return ze&&It?Cn:ze||It?ze?pn:Lr:Ze(kt,En)?En:fn}function _i(){if(!Cr)return!1;var kt={},ze=v.CSS&&v.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(It){kt[It]=ze?v.CSS.supports("touch-action",It):!0}),kt}var eo=1,pi=2,Ta=4,Di=8,bi=Di,ci=16,ja=32;function ps(kt){this.options=ut({},this.defaults,kt||{}),this.id=H(),this.manager=null,this.options.enable=ar(this.options.enable,!0),this.state=eo,this.simultaneous={},this.requireFail=[]}ps.prototype={defaults:{},set:function(ze){return ut(this.options,ze),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ze){if(Be(ze,"recognizeWith",this))return this;var It=this.simultaneous;return ze=Gu(ze,this),It[ze.id]||(It[ze.id]=ze,ze.recognizeWith(this)),this},dropRecognizeWith:function(ze){return Be(ze,"dropRecognizeWith",this)?this:(ze=Gu(ze,this),delete this.simultaneous[ze.id],this)},requireFailure:function(ze){if(Be(ze,"requireFailure",this))return this;var It=this.requireFail;return ze=Gu(ze,this),Le(It,ze)===-1&&(It.push(ze),ze.requireFailure(this)),this},dropRequireFailure:function(ze){if(Be(ze,"dropRequireFailure",this))return this;ze=Gu(ze,this);var It=Le(this.requireFail,ze);return It>-1&&this.requireFail.splice(It,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ze){return!!this.simultaneous[ze.id]},emit:function(ze){var It=this,fr=this.state;function nn(yn){It.manager.emit(yn,ze)}fr<Di&&nn(It.options.event+to(fr)),nn(It.options.event),ze.additionalEvent&&nn(ze.additionalEvent),fr>=Di&&nn(It.options.event+to(fr))},tryEmit:function(ze){if(this.canEmit())return this.emit(ze);this.state=ja},canEmit:function(){for(var ze=0;ze<this.requireFail.length;){if(!(this.requireFail[ze].state&(ja|eo)))return!1;ze++}return!0},recognize:function(ze){var It=ut({},ze);if(!De(this.options.enable,[this,It])){this.reset(),this.state=ja;return}this.state&(bi|ci|ja)&&(this.state=eo),this.state=this.process(It),this.state&(pi|Ta|Di|ci)&&this.tryEmit(It)},process:function(ze){},getTouchAction:function(){},reset:function(){}};function to(kt){return kt&ci?"cancel":kt&Di?"end":kt&Ta?"move":kt&pi?"start":""}function lo(kt){return kt==de?"down":kt==J?"up":kt==P?"left":kt==R?"right":""}function Gu(kt,ze){var It=ze.manager;return It?It.get(kt):kt}function qi(){ps.apply(this,arguments)}xt(qi,ps,{defaults:{pointers:1},attrTest:function(ze){var It=this.options.pointers;return It===0||ze.pointers.length===It},process:function(ze){var It=this.state,fr=ze.eventType,nn=It&(pi|Ta),yn=this.attrTest(ze);return nn&&(fr&Oe||!yn)?It|ci:nn||yn?fr&ft?It|Di:It&pi?It|Ta:pi:ja}});function Oa(){qi.apply(this,arguments),this.pX=null,this.pY=null}xt(Oa,qi,{defaults:{event:"pan",threshold:10,pointers:1,direction:gt},getTouchAction:function(){var ze=this.options.direction,It=[];return ze&je&&It.push(Lr),ze&We&&It.push(pn),It},directionTest:function(ze){var It=this.options,fr=!0,nn=ze.distance,yn=ze.direction,Vn=ze.deltaX,Ua=ze.deltaY;return yn&It.direction||(It.direction&je?(yn=Vn===0?Ve:Vn<0?P:R,fr=Vn!=this.pX,nn=Math.abs(ze.deltaX)):(yn=Ua===0?Ve:Ua<0?J:de,fr=Ua!=this.pY,nn=Math.abs(ze.deltaY))),ze.direction=yn,fr&&nn>It.threshold&&yn&It.direction},attrTest:function(ze){return qi.prototype.attrTest.call(this,ze)&&(this.state&pi||!(this.state&pi)&&this.directionTest(ze))},emit:function(ze){this.pX=ze.deltaX,this.pY=ze.deltaY;var It=lo(ze.direction);It&&(ze.additionalEvent=this.options.event+It),this._super.emit.call(this,ze)}});function is(){qi.apply(this,arguments)}xt(is,qi,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Cn]},attrTest:function(ze){return this._super.attrTest.call(this,ze)&&(Math.abs(ze.scale-1)>this.options.threshold||this.state&pi)},emit:function(ze){if(ze.scale!==1){var It=ze.scale<1?"in":"out";ze.additionalEvent=this.options.event+It}this._super.emit.call(this,ze)}});function ca(){ps.apply(this,arguments),this._timer=null,this._input=null}xt(ca,ps,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[fn]},process:function(ze){var It=this.options,fr=ze.pointers.length===It.pointers,nn=ze.distance<It.threshold,yn=ze.deltaTime>It.time;if(this._input=ze,!nn||!fr||ze.eventType&(ft|Oe)&&!yn)this.reset();else if(ze.eventType&ye)this.reset(),this._timer=He(function(){this.state=bi,this.tryEmit()},It.time,this);else if(ze.eventType&ft)return bi;return ja},reset:function(){clearTimeout(this._timer)},emit:function(ze){this.state===bi&&(ze&&ze.eventType&ft?this.manager.emit(this.options.event+"up",ze):(this._input.timeStamp=$(),this.manager.emit(this.options.event,this._input)))}});function Ya(){qi.apply(this,arguments)}xt(Ya,qi,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Cn]},attrTest:function(ze){return this._super.attrTest.call(this,ze)&&(Math.abs(ze.rotation)>this.options.threshold||this.state&pi)}});function qo(){qi.apply(this,arguments)}xt(qo,qi,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:je|We,pointers:1},getTouchAction:function(){return Oa.prototype.getTouchAction.call(this)},attrTest:function(ze){var It=this.options.direction,fr;return It&(je|We)?fr=ze.overallVelocity:It&je?fr=ze.overallVelocityX:It&We&&(fr=ze.overallVelocityY),this._super.attrTest.call(this,ze)&&It&ze.offsetDirection&&ze.distance>this.options.threshold&&ze.maxPointers==this.options.pointers&&Ce(fr)>this.options.velocity&&ze.eventType&ft},emit:function(ze){var It=lo(ze.offsetDirection);It&&this.manager.emit(this.options.event+It,ze),this.manager.emit(this.options.event,ze)}});function sa(){ps.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}xt(sa,ps,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[En]},process:function(ze){var It=this.options,fr=ze.pointers.length===It.pointers,nn=ze.distance<It.threshold,yn=ze.deltaTime<It.time;if(this.reset(),ze.eventType&ye&&this.count===0)return this.failTimeout();if(nn&&yn&&fr){if(ze.eventType!=ft)return this.failTimeout();var Vn=this.pTime?ze.timeStamp-this.pTime<It.interval:!0,Ua=!this.pCenter||Pe(this.pCenter,ze.center)<It.posThreshold;this.pTime=ze.timeStamp,this.pCenter=ze.center,!Ua||!Vn?this.count=1:this.count+=1,this._input=ze;var xo=this.count%It.taps;if(xo===0)return this.hasRequireFailures()?(this._timer=He(function(){this.state=bi,this.tryEmit()},It.interval,this),pi):bi}return ja},failTimeout:function(){return this._timer=He(function(){this.state=ja},this.options.interval,this),ja},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==bi&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function yo(kt,ze){return ze=ze||{},ze.recognizers=ar(ze.recognizers,yo.defaults.preset),new as(kt,ze)}yo.VERSION="2.0.7",yo.defaults={domEvents:!1,touchAction:Tn,enable:!0,inputTarget:null,inputClass:null,preset:[[Ya,{enable:!1}],[is,{enable:!1},["rotate"]],[qo,{direction:je}],[Oa,{direction:je},["swipe"]],[sa],[sa,{event:"doubletap",taps:2},["tap"]],[ca]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var co=1,Tu=2;function as(kt,ze){this.options=ut({},yo.defaults,ze||{}),this.options.inputTarget=this.options.inputTarget||kt,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=kt,this.input=Xe(this),this.touchAction=new xi(this,this.options.touchAction),bl(this,!0),ce(this.options.recognizers,function(It){var fr=this.add(new It[0](It[1]));It[2]&&fr.recognizeWith(It[2]),It[3]&&fr.requireFailure(It[3])},this)}as.prototype={set:function(ze){return ut(this.options,ze),ze.touchAction&&this.touchAction.update(),ze.inputTarget&&(this.input.destroy(),this.input.target=ze.inputTarget,this.input.init()),this},stop:function(ze){this.session.stopped=ze?Tu:co},recognize:function(ze){var It=this.session;if(!It.stopped){this.touchAction.preventDefaults(ze);var fr,nn=this.recognizers,yn=It.curRecognizer;(!yn||yn&&yn.state&bi)&&(yn=It.curRecognizer=null);for(var Vn=0;Vn<nn.length;)fr=nn[Vn],It.stopped!==Tu&&(!yn||fr==yn||fr.canRecognizeWith(yn))?fr.recognize(ze):fr.reset(),!yn&&fr.state&(pi|Ta|Di)&&(yn=It.curRecognizer=fr),Vn++}},get:function(ze){if(ze instanceof ps)return ze;for(var It=this.recognizers,fr=0;fr<It.length;fr++)if(It[fr].options.event==ze)return It[fr];return null},add:function(ze){if(Be(ze,"add",this))return this;var It=this.get(ze.options.event);return It&&this.remove(It),this.recognizers.push(ze),ze.manager=this,this.touchAction.update(),ze},remove:function(ze){if(Be(ze,"remove",this))return this;if(ze=this.get(ze),ze){var It=this.recognizers,fr=Le(It,ze);fr!==-1&&(It.splice(fr,1),this.touchAction.update())}return this},on:function(ze,It){if(ze!==o&&It!==o){var fr=this.handlers;return ce(Et(ze),function(nn){fr[nn]=fr[nn]||[],fr[nn].push(It)}),this}},off:function(ze,It){if(ze!==o){var fr=this.handlers;return ce(Et(ze),function(nn){It?fr[nn]&&fr[nn].splice(Le(fr[nn],It),1):delete fr[nn]}),this}},emit:function(ze,It){this.options.domEvents&&_s(ze,It);var fr=this.handlers[ze]&&this.handlers[ze].slice();if(!(!fr||!fr.length)){It.type=ze,It.preventDefault=function(){It.srcEvent.preventDefault()};for(var nn=0;nn<fr.length;)fr[nn](It),nn++}},destroy:function(){this.element&&bl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function bl(kt,ze){var It=kt.element;if(!!It.style){var fr;ce(kt.options.cssProps,function(nn,yn){fr=St(It.style,yn),ze?(kt.oldCssProps[fr]=It.style[fr],It.style[fr]=nn):It.style[fr]=kt.oldCssProps[fr]||""}),ze||(kt.oldCssProps={})}}function _s(kt,ze){var It=Z.createEvent("Event");It.initEvent(kt,!0,!0),It.gesture=ze,ze.target.dispatchEvent(It)}ut(yo,{INPUT_START:ye,INPUT_MOVE:Ue,INPUT_END:ft,INPUT_CANCEL:Oe,STATE_POSSIBLE:eo,STATE_BEGAN:pi,STATE_CHANGED:Ta,STATE_ENDED:Di,STATE_RECOGNIZED:bi,STATE_CANCELLED:ci,STATE_FAILED:ja,DIRECTION_NONE:Ve,DIRECTION_LEFT:P,DIRECTION_RIGHT:R,DIRECTION_UP:J,DIRECTION_DOWN:de,DIRECTION_HORIZONTAL:je,DIRECTION_VERTICAL:We,DIRECTION_ALL:gt,Manager:as,Input:Y,TouchAction:xi,TouchInput:Re,MouseInput:Un,PointerEventInput:Gn,TouchMouseInput:Ur,SingleTouchInput:ae,Recognizer:ps,AttrRecognizer:qi,Tap:sa,Pan:Oa,Swipe:qo,Pinch:is,Rotate:Ya,Press:ca,on:$t,off:Ht,each:ce,merge:bt,extend:Me,assign:ut,inherit:xt,bindFn:Mt,prefixed:St});var Lo=typeof v!="undefined"?v:typeof self!="undefined"?self:{};Lo.Hammer=yo,S=function(){return yo}.call(x,a,x,we),S!==o&&(we.exports=S)})(window,document,"Hammer")},yMAV:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.Plan=void 0;var S=function(){function v(Z,N){this.parentContext=Z,this.rootRequest=N}return v}();x.Plan=S},yP5f:function(we,x,a){var S=a("+K+b");function v(Z,N){var o=N?S(Z.buffer):Z.buffer;return new Z.constructor(o,Z.byteOffset,Z.length)}we.exports=v},yU0y:function(we,x,a){"use strict";a.d(x,"b",function(){return S}),a.d(x,"a",function(){return v}),a.d(x,"c",function(){return Z});var S=1e-6,v=typeof Float32Array!="undefined"?Float32Array:Array,Z=Math.random;function N(K){v=K}var o=Math.PI/180;function X(K){return K*o}function F(K,q){return Math.abs(K-q)<=S*Math.max(1,Math.abs(K),Math.abs(q))}Math.hypot||(Math.hypot=function(){for(var K=0,q=arguments.length;q--;)K+=arguments[q]*arguments[q];return Math.sqrt(K)})},yXPU:function(we,x){function a(v,Z,N,o,X,F,K){try{var q=v[F](K),Ce=q.value}catch($){N($);return}q.done?Z(Ce):Promise.resolve(Ce).then(o,X)}function S(v){return function(){var Z=this,N=arguments;return new Promise(function(o,X){var F=v.apply(Z,N);function K(Ce){a(F,o,X,K,q,"next",Ce)}function q(Ce){a(F,o,X,K,q,"throw",Ce)}K(void 0)})}}we.exports=S},ycre:function(we,x,a){var S=a("711d"),v=S("length");we.exports=v},z4Hk:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.BindingWhenSyntax=void 0;var S=a("406g"),v=a("RR/i"),Z=function(){function N(o){this._binding=o}return N.prototype.when=function(o){return this._binding.constraint=o,new S.BindingOnSyntax(this._binding)},N.prototype.whenTargetNamed=function(o){return this._binding.constraint=v.namedConstraint(o),new S.BindingOnSyntax(this._binding)},N.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(o){var X=o.target!==null&&!o.target.isNamed()&&!o.target.isTagged();return X},new S.BindingOnSyntax(this._binding)},N.prototype.whenTargetTagged=function(o,X){return this._binding.constraint=v.taggedConstraint(o)(X),new S.BindingOnSyntax(this._binding)},N.prototype.whenInjectedInto=function(o){return this._binding.constraint=function(X){return v.typeConstraint(o)(X.parentRequest)},new S.BindingOnSyntax(this._binding)},N.prototype.whenParentNamed=function(o){return this._binding.constraint=function(X){return v.namedConstraint(o)(X.parentRequest)},new S.BindingOnSyntax(this._binding)},N.prototype.whenParentTagged=function(o,X){return this._binding.constraint=function(F){return v.taggedConstraint(o)(X)(F.parentRequest)},new S.BindingOnSyntax(this._binding)},N.prototype.whenAnyAncestorIs=function(o){return this._binding.constraint=function(X){return v.traverseAncerstors(X,v.typeConstraint(o))},new S.BindingOnSyntax(this._binding)},N.prototype.whenNoAncestorIs=function(o){return this._binding.constraint=function(X){return!v.traverseAncerstors(X,v.typeConstraint(o))},new S.BindingOnSyntax(this._binding)},N.prototype.whenAnyAncestorNamed=function(o){return this._binding.constraint=function(X){return v.traverseAncerstors(X,v.namedConstraint(o))},new S.BindingOnSyntax(this._binding)},N.prototype.whenNoAncestorNamed=function(o){return this._binding.constraint=function(X){return!v.traverseAncerstors(X,v.namedConstraint(o))},new S.BindingOnSyntax(this._binding)},N.prototype.whenAnyAncestorTagged=function(o,X){return this._binding.constraint=function(F){return v.traverseAncerstors(F,v.taggedConstraint(o)(X))},new S.BindingOnSyntax(this._binding)},N.prototype.whenNoAncestorTagged=function(o,X){return this._binding.constraint=function(F){return!v.traverseAncerstors(F,v.taggedConstraint(o)(X))},new S.BindingOnSyntax(this._binding)},N.prototype.whenAnyAncestorMatches=function(o){return this._binding.constraint=function(X){return v.traverseAncerstors(X,o)},new S.BindingOnSyntax(this._binding)},N.prototype.whenNoAncestorMatches=function(o){return this._binding.constraint=function(X){return!v.traverseAncerstors(X,o)},new S.BindingOnSyntax(this._binding)},N}();x.BindingWhenSyntax=Z},zEVN:function(we,x,a){var S=a("Gi0A"),v=a("sEf8"),Z=a("mdPL"),N=Z&&Z.isMap,o=N?v(N):S;we.exports=o},zZ0H:function(we,x){function a(S){return S}we.exports=a},zZPE:function(we,x){var a="[object Object]";function S(He){var Be=!1;if(He!=null&&typeof He.toString!="function")try{Be=!!(He+"")}catch(ce){}return Be}function v(He,Be){return function(ce){return He(Be(ce))}}var Z=Function.prototype,N=Object.prototype,o=Z.toString,X=N.hasOwnProperty,F=o.call(Object),K=N.toString,q=v(Object.getPrototypeOf,Object);function Ce(He){return!!He&&typeof He=="object"}function $(He){if(!Ce(He)||K.call(He)!=a||S(He))return!1;var Be=q(He);if(Be===null)return!0;var ce=X.call(Be,"constructor")&&Be.constructor;return typeof ce=="function"&&ce instanceof ce&&o.call(ce)==F}we.exports=$},zoYe:function(we,x,a){var S=a("nmnc"),v=a("eUgh"),Z=a("Z0cm"),N=a("/9aa"),o=1/0,X=S?S.prototype:void 0,F=X?X.toString:void 0;function K(q){if(typeof q=="string")return q;if(Z(q))return v(q,K)+"";if(N(q))return F?F.call(q):"";var Ce=q+"";return Ce=="0"&&1/q==-o?"-0":Ce}we.exports=K},zvhG:function(we,x){we.exports=a;function a(S,v,Z,N){this.cx=3*S,this.bx=3*(Z-S)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*v,this.by=3*(N-v)-this.cy,this.ay=1-this.cy-this.by,this.p1x=S,this.p1y=N,this.p2x=Z,this.p2y=N}a.prototype.sampleCurveX=function(S){return((this.ax*S+this.bx)*S+this.cx)*S},a.prototype.sampleCurveY=function(S){return((this.ay*S+this.by)*S+this.cy)*S},a.prototype.sampleCurveDerivativeX=function(S){return(3*this.ax*S+2*this.bx)*S+this.cx},a.prototype.solveCurveX=function(S,v){typeof v=="undefined"&&(v=1e-6);var Z,N,o,X,F;for(o=S,F=0;F<8;F++){if(X=this.sampleCurveX(o)-S,Math.abs(X)<v)return o;var K=this.sampleCurveDerivativeX(o);if(Math.abs(K)<1e-6)break;o=o-X/K}if(Z=0,N=1,o=S,o<Z)return Z;if(o>N)return N;for(;Z<N;){if(X=this.sampleCurveX(o),Math.abs(X-S)<v)return o;S>X?Z=o:N=o,o=(N-Z)*.5+Z}return o},a.prototype.solve=function(S,v){return this.sampleCurveY(this.solveCurveX(S,v))}},zxMA:function(we,x,a){"use strict";Object.defineProperty(x,"__esModule",{value:!0}),x.QueryableString=void 0;var S=function(){function v(Z){this.str=Z}return v.prototype.startsWith=function(Z){return this.str.indexOf(Z)===0},v.prototype.endsWith=function(Z){var N="",o=Z.split("").reverse().join("");return N=this.str.split("").reverse().join(""),this.startsWith.call({str:N},o)},v.prototype.contains=function(Z){return this.str.indexOf(Z)!==-1},v.prototype.equals=function(Z){return this.str===Z},v.prototype.value=function(){return this.str},v}();x.QueryableString=S}}]);
